'**************************************************************************************************************
''' <summary> 
''' Load Pro card stage iwill navigate to Load staging page and will trigger the Run function., 
''' </summary>
''' <author>Aspire Team</author>
''' <datecreated>1 November 2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>Completed</endstate>
'Change Control: 
'Date of Change 	Author 		Description of change
'*************************************************************************************************************
Public Function LoadProCardStage()
Dim LinkName, i,oDescObj,oLinkObject,appLinkDesc,oLoadProCardLink
'Check the No of transcation before Load
Call QueryViewerBeforeLoad()

'LinkName="Load ProCard Stage"
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

wait(5)


'Click on the Procard stage link. 
With Browser("PeopleSoft Browser").Page("ProcurementCardsCenter Page").Frame("TargetContent").Link("LoadProCardStage")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

'This function will enter all the mandatory fields in teh Stagiing page and click on Add button
LoadorAddFile()

'Wait for the application to sync
 app_SearchSync()
 
 'to verify that the file is already existing;. 
 
 With Browser("PeopleSoft Browser").Page("LoadProCardStage").Frame("TargetContent").WebEdit("CardIssuer")
 If .Exist(15) Then
      AddNewValue()
   Else
      ModifyExistingValue()
 End If
 End With


' If Browser("PeopleSoft Browser").Page("ProcurementCards").Frame("TargetContent").WebTable("ViewAll").Exist(nMaxWait) Then
'      Set oDescObj=Description.Create
'      oDescObj("MicClass").Value="Link"
'      oDescObj("text").value=GlobalDictionary("RunControlIdValue")
'      Set oLinkObject=Browser("PeopleSoft Browser").Page("ProcurementCards").Frame("TargetContent").WebTable("ViewAll").ChildObjects(oDescObj)
'      If oLinkObject(0).exist(nMaxWait) Then
'          ModifyExistingValue()
'          Else
'          AddNewValue()
'     End If
' End If
 
 app_SearchSync()
 app_SearchSync()
 
'Click on Run button
With Browser("PeopleSoft Browser").Page("LoadProCardStage").Frame("TargetContent").WebButton("Run")
If .Exist(6) Then
	.Click
End If
End With


Browser("PeopleSoft Browser").Sync

app_SearchSync()

With Browser("PeopleSoft Browser").Page("LoadProCardStage").PSFrame("ProcessScheduler").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

Browser("PeopleSoft Browser").Sync

app_SearchSync()

app_SearchSync()

'Click on Process Monitor link
With Browser("PeopleSoft Browser").Page("LoadProCardStage").Frame("TargetContent").Link("ProcessMonitor")
If .Exist(6) Then
	.Click
End If
End With

appProcessName="PO_CCPCRDSTG"

'This will Run and Monitor the results.
Call CheckProcessMontiorStatus(appProcessName)

app_SearchSync()
app_SearchSync()

Call QueryViewerAfterLoad()

appNoOfTranscationLoaded=(GlobalDictionary("appNoofRowsAfterLoad")-GlobalDictionary("appNoofRowsBeforeLoad"))
If appNoOfTranscationLoaded=0 Then
Reporter.ReportEvent micFail,"The total no of ","transcation loaded is 0"	
Else
Reporter.ReportEvent micPass,"THe total no of","transactionm loaded is"&appNoOfTranscationLoaded
End If

Environment.Value("appNoOfTranscations")=appNoOfTranscationLoaded

Set objExcel=CreateObject("Excel.Application")
Set oObjWorkBook=objExcel.Workbooks.Open("C:\AutoSource_Prod\PSFINUFT\Data\PCARD_Stage_Data")
Set objDriverSheet =oObjWorkBook.Worksheets("PC_02_03_CorrectStagingErrors")
For i=1 to 13
appVarName=objDriverSheet.cells(i,"A")
If appVarName="NoOfTrans" Then
objDriverSheet.cells(i,"B")=appNoOfTranscationLoaded
Exit For
End If
Next

oObjWorkBook.Save
oObjWorkBook.Close
objExcel.Quit

End Function

'**************************************************************************************************************
''' <summary> 
''' Load and Run file is to navigate to the check for the existance of file and run the process accorddingle. 
''' </summary>
''' <author>Aspire Team</author>
''' <datecreated>1 November 2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>Completed</endstate>
''' <returns type="NA"> True if found and clicked</returns>
'Change Control: 
'Date of Change 	Author 		Description of change
'**************************************************************************************************************

Public Function LoadorAddFile()
Dim appElementDescription,oAddNewValue,oRunControlId,RunControlID
'click on the Add new value tab. 
WIth Browser("PeopleSoft Browser").Page("LoadProCardStage").Frame("TargetContent").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth 

RunControlID=GlobalDictionary("RunControlIdValue") & inVoiceNumberGeneration
'Waiting for the onbjects to be loaded 
WaitForSomeTime()

'wait(5)

'Enter the value in the Run control ID text box
With Browser("PeopleSoft Browser").Page("LoadProCardStage").Frame("TargetContent").WebEdit("RunControlId")
If .Exist(nMINWAIT) Then
	.Set RunControlID
End If
End WIth 

'Wait for the application to sync
app_SearchSync()
 
 'Click on Add Button to add the file
 With Browser("PeopleSoft Browser").Page("LoadProCardStage").Frame("TargetContent").WebButton("Add")
 	If .Exist(6) Then
 		.Click
 	End If
 End With  
     
End Function

'**************************************************************************************************************
''' <summary> 
''' ModifyExistingValue is to modify the existing file name and run the process. 
''' </summary>
''' <author>Aspire Team</author>
''' <datecreated>1 November 2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>Completed</endstate>
''' <returns type="NA"> True if found and clicked</returns>
'Change Control: 
'Date of Change 	Author 		Description of change
'**************************************************************************************************************

Public Function ModifyExistingValue()
Dim oTable,oDesc, oTable2
app_SearchSync()
'check for the table and search for the existing value and click
	Set oTable=Browser("PeopleSoft Browser").Page("ProcurementCards").Frame("TargetContent").WebTable("ViewAll")
	Set oDesc=Description.Create
	oDesc("MicClass").value="Link"
	'oDesc("name").value="LOAD_DCARD"
	Set oTable2=oTable.ChildObjects(oDesc)
	oTable2(1).click

app_SearchSync()

'Create our object for interacting with files
Set objFSO = CreateObject("Scripting.FileSystemObject")

strDirectoryPath=GlobalDictionary("FilePath")
'Assign the working directory to an object
Set objFolder = objFSO.GetFolder(strDirectoryPath)

Set objFiles = objFolder.Files

For Each f in objFiles
	If InStr(1, f.Name, GlobalDictionary("FileName"), vbTextCompare) >= 1 AND InStr(1, f.Name, GlobalDictionary("FileType"), vbTextCompare) >= 1 Then
	Set oFile = f
	Exit For
	End  If
Next

FileName=oFile.Name

GlobalDictionary("ExactFileName")=GlobalDictionary("FilePath")&FileName

'Enter the file name to be loaded
With Browser("PeopleSoft Browser").Page("LoadProCardStage").Frame("TargetContent").WebEdit("FIleName")
          If .Exist(6) Then
          	  .Set GlobalDictionary("ExactFileName")
          End If
End With
End Function

'**************************************************************************************************************
''' <summary> 
''' Add New Value is to add the values for running the file. 
''' </summary>
''' <author>Aspire Team</author>
''' <datecreated>1 November 2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>Completed</endstate>
''' <returns type="NA"> True if found and clicked</returns>
'Change Control: 
'Date of Change 	Author 		Description of change
'**************************************************************************************************************

Public Function AddNewValue()
'Enter the value in Card issuer Text box
With Browser("PeopleSoft Browser").Page("LoadProCardStage").Frame("TargetContent").WebEdit("CardIssuer")
    If .Exist(6) Then
	   .Set GlobalDictionary("CardIssuer")
    End If
End With

'Select the VIsa commercial format option from the data souorce DDLB
With Browser("PeopleSoft Browser").Page("LoadProCardStage").Frame("TargetContent").WebList("DataSource")
   If .Exist(6) Then
   	  .Select GlobalDictionary("DataSource")
   End If
End With

'Wait for the Blue colour Search to end
For i=0 to 2
	app_SearchSync()
Next 

'Create our object for interacting with files
Set objFSO = CreateObject("Scripting.FileSystemObject")

strDirectoryPath=GlobalDictionary("FilePath")
'Assign the working directory to an object
Set objFolder = objFSO.GetFolder(strDirectoryPath)

Set objFiles = objFolder.Files

For Each f in objFiles
	If InStr(1, f.Name, GlobalDictionary("FileName"), vbTextCompare) >= 1 AND InStr(1, f.Name, GlobalDictionary("FileType"), vbTextCompare) >= 1 Then
	Set oFile = f
	Exit For
	End  If
Next

FileName=oFile.Name

GlobalDictionary("ExactFileName")=GlobalDictionary("FilePath")&FileName

'Enter the file name to be loaded
With Browser("PeopleSoft Browser").Page("LoadProCardStage").Frame("TargetContent").WebEdit("FIleName")
          If .Exist(6) Then
          	  .Set GlobalDictionary("ExactFileName")
          End If
End With

''Wait for the Blue colour Search to end
app_SearchSync()

End Function

'**************************************************************************************************************
''' <summary> 
''' ModifyExistingValue is to enter the values in the Web text box. 
''' </summary>
''' <author>Aspire Team</author>
''' <datecreated>1 November 2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>Completed</endstate>
''' <returns type="NA"> True if found and clicked</returns>
'Change Control: 
'Date of Change 	Author 		Description of change
'**************************************************************************************************************

Public Function WebEdit_Enter(name,value)
Dim oWedEditDesc, oWebEditBoxes,oWebEditCount, i, appWebeditName
Set oWedEditDesc=Description.Create
oWedEditDesc("MicClass").value="WebEdit"
oWedEditDesc("html tag").value="input"
Set oWebEditBoxes=  Browser("PeopleSoft Browser").Page("index:=1").ChildObjects(oWedEditDesc)
oWebEditCount=oWebEditBoxes.count
For i =0 to oWebEditCount
	appWebeditName=oWebEditBoxes(i).getROproperty("name")
	If Trim(appWebeditName)=Trim(name) Then
		oWebEditBoxes(i).set value
		WebEdit_Enter=True
		Exit For
		Else
		WebEdit_Enter=False
	End If
Next
End Function

'**************************************************************************************************************
''' <summary> 
'''THis funvtion is  used to Click on any button present int he Web page. 
''' </summary>
''' <author>Aspire Team</author>
''' <datecreated>1 November 2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>Completed</endstate>
''' <returns type="NA"> True if found and clicked</returns>
'Change Control: 
'Date of Change 	Author 		Description of change
'**************************************************************************************************************

Public Function Button_Click(name)
Dim oWebButtonDesc, oWebButtons, oWebButtonCount, appWebButtonName,i
Set oWebButtonDesc=Description.Create
oWebButtonDesc("MicClass").value="WebButton"
oWebButtonDesc("html tag").value="INPUT"
Set oWebButtons=Browser("PeopleSoft Browser").Page("index:=1").ChildObjects(oWebButtonDesc)
oWebButtonCount=oWebButtons.count
For i=0 to oWebButtonCount
	appWebButtonName=oWebButtons(i).getRoProperty("name")
	If Trim(appWebButtonName)=Trim(name) Then
		oWebButtons(i).click
		Button_Click=True
		Exit For
		Else
		Button_Click=False
	End If
Next
End Function

'**************************************************************************************************************
''' <summary> 
'''This function is used to click on refresh button untill the Status becomes sucess. 
''' </summary>
''' <author>Aspire Team</author>
''' <datecreated>1 November 2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>Completed</endstate>
''' <returns type="NA"> True if found and clicked</returns>
'Change Control: 
'Date of Change 	Author 		Description of change

'Comment : Not used anywhere so this function has commented
'**************************************************************************************************************

'Public Function ClickRefreshUntilSucess()
'Dim RunStatus,CurrentInstanceNumber,CurrentRunStatus
'app_SearchSync()
'With Browser("ProcessMonitor").Page("BrowserMonitor").Frame("TargetContent").WebTable("ProcessList")
'If .Exist(6) Then
'CurrentRunStatus=.GetCellData(2,8)
'Do While(Trim(CurrentRunStatus)) <> "Success"
'         			         If Trim(CurrentRunStatus)="No Success" Then
'         			          	Exit Do
'         			         Else
'         	                       With Browser("ProcessMonitor").Page("BrowserMonitor").Frame("TargetContent").WebButton("Refresh")
'         	                    	      If .Exist(nMaxWait) Then
'         	                    	      wait(8)
'         	                    	      	    .Click
'         	                    	      	    CurrentRunStatus=Browser("ProcessMonitor").Page("BrowserMonitor").Frame("TargetContent").WebTable("ProcessList").GetCellData(2,8)
'         	                    	      End If
'         	                    End With
'                              End If 
'         	               Loop
'         	               End If
'         	               End With
''Search for the instance number and find the status of the Run. It will click on Refresh button untill the Status become sucess or it will exit the loop once ths status beomce no sucess.. 
'With Browser("ProcessMonitor").Page("BrowserMonitor").Frame("TargetContent").WebTable("ProcessList")
'         If .Exist(6) Then
'         	For i=1 to .RowCount
'         		CurrentInstanceNumber=.GetCellData(i,2)
'         		If instr(1,CurrentInstanceNumber, GlobalDictionary("instanceNumber"))>0 Then
'         			CurrentRunStatus=.GetCellData(i,8)
'         			Do While(Trim(CurrentRunStatus)) <> "Success"
'         			         If Trim(CurrentRunStatus)="No Success" Then
'         			          	Exit Do
'         			         Else
'         	                       With Browser("ProcessMonitor").Page("BrowserMonitor").Frame("TargetContent").WebButton("Refresh")
'         	                    	      If .Exist(6) Then
'         	                    	      	    .Click
'         	                    	      End If
'         	                    End With
'                              End If 
'         	               Loop
'         		End If
'         	Next
'         End If
'End With
'End Function

'**************************************************************************************************************
''' <summary> 
'''This function is used to open the ALerts page. 
''' </summary>
''' <author>Aspire Team</author>
''' <datecreated>1 November 2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>Completed</endstate>
''' <returns type="NA"> True if found and clicked</returns>
'Change Control: 
'Date of Change 	Author 		Description of change
'**************************************************************************************************************

Public Function OpenRunAlertsPage()
Dim i, arrProperty, arrValue,RequestIdValue,RequestIdDescription,QueryName,RunControlIdValue,ProcessName,ProcessCategory,oAddNewValue,objAddValueDesc
Dim oRunControlID,objRunControlDesc
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

app_SearchSync()

RequestIdValue=GlobalDictionary("RequestIdValue")
RequestIdDescription=GlobalDictionary("RequestIdDescription")
QueryName=GlobalDictionary("QueryName")
RunControlIdValue=GlobalDictionary("RunControlIdValue")
ProcessName=GlobalDictionary("ProcessName")
ProcessCategory=GlobalDictionary("ProcessCategory")

'Click on new Add new value button
With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth 

app_SearchSync()

 'enter the Run control value int he Text box
 WIth Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebEdit("RunControlId")
 If .Exist(nMINWAIT) Then
 	.Set RunControlIdValue
 End If
 End With 
 
app_SearchSync()

'click on Add Button
WIth Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth 

app_SearchSync()

Browser("PeopleSoft Browser").Sync

If Not Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebEdit("RequestID").Exist(nMaxWait) Then
	If Browser("creationtime:=0").page("index:=1").WebTable("html id:=PTSRCHRESULTS","html tag:=TABLE","name:=Run Control ID").Exist(2) Then
	   For i=2 to Browser("creationtime:=0").page("index:=1").WebTable("html id:=PTSRCHRESULTS","html tag:=TABLE","name:=Run Control ID").RowCount
	   	appRunControl=Browser("creationtime:=0").page("index:=1").WebTable("html id:=PTSRCHRESULTS","html tag:=TABLE","name:=Run Control ID").GetCellData(i,1)
	   	If instr(1,appRunControl,RunControlIdValue)>0 Then
	   		Browser("creationtime:=0").page("index:=1").WebTable("html id:=PTSRCHRESULTS","html tag:=TABLE","name:=Run Control ID").ChildItem(i,1,"Link",0).click
	   	End If
	   Next
End If
End If

'Enter the Request ID value and Request ID description

app_SearchSync()

wait(2)

'Set wsh=CreateObject("Wscript.Shell")
'With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebEdit("RequestID")
'If .Exist(nMINWAIT) Then
'	.Click
'	.Set ""
'End If
'End  With 
'
'Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebEdit("RequestID").Click
'wsh.SendKeys "PCARD"
'Set wsh=Nothing
'Set oReqID=Browser("RunAlerts").Page("RunAlerts").Frame("TargetContent").WebEdit("RequestID")
'If oReqID.Exist(nMaxWait) Then
'	oReqID.Set RequestIdValue
'End If
With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebEdit("RequestID")
	If .Exist(nMINWAIT) Then
		.Set "PCARD"
	End If
End With
app_SearchSync()


With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebEdit("RequestDescription")
 If .Exist(nMINWAIT) Then
 	.Set RunControlIdValue
 End If
 End With 

app_SearchSync()

'Select the Process frequency radio button
radioBtnVal="A"
With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebRadioGroup("ProcessFrequency")
 If .Exist(nMINWAIT) Then
 	.Select radioBtnVal
 End If
 End With

app_SearchSync()
'Select the Query option Radio button
radioBtnVal2="3"
With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebRadioGroup("QueryOption")
 If .Exist(nMINWAIT) Then
 	.Select radioBtnVal2
 End If
 End With


app_SearchSync()
'Enter the query name, Process name and Process category
Set oQueryName=Browser("creationtime:=0").Page("index:=0").Image("html id:=QRYNAME\$prompt\$img\$0","html tag:=IMG","name:=QRYNAME\$prompt\$img\$0")
QueryaltValue=oQueryName.Object.alt
QueryhtmlID="EOEN_AL_QRY_VW_QRYNAME"
Querydescrp=oQueryName.GetROProperty("innertext")

call click_Lookup_Img_And_Select_Item_PCARD(QueryaltValue,QueryhtmlID, QueryName, Querydescrp)

app_SearchSync()
Set oProcesName=Browser("creationtime:=0").Page("index:=0").Image("html id:=EOEN_PRCS_NAME\$prompt\$img\$0","html tag:=IMG","name:=EOEN_PRCS_NAME\$prompt\$img\$0")
ProcessAltValue=oProcesName.Object.alt
ProcesshtmlID="EOEN_AL_PRCS_VW_EOEN_PRCS_NAME"
ProcessDesc=oProcesName.GetROProperty("innertext")

call click_Lookup_Img_And_Select_Item_PCARD(ProcessAltValue,ProcesshtmlID, ProcessName, ProcessDesc)

app_SearchSync()
Set oProcessCategory=Browser("creationtime:=0").Page("index:=0").Image("html id:=EOEN_CATEGORY\$prompt\$img\$0","html tag:=IMG","name:=EOEN_CATEGORY\$prompt\$img\$0")
processCataltValue=oProcessCategory.Object.alt
ProcessCatehtmlId="EOEN_AL_CATG_VW_EOEN_CATEGORY"
ProcessCatDesc=oProcessCategory.GetROProperty("innertext")
call click_Lookup_Img_And_Select_Item_PCARD(processCataltValue,ProcessCatehtmlId, ProcessCategory, ProcessCatDesc)

For i=0 to 1
app_SearchSync()
Next

'Click on Run button
With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebButton("Run")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

For i=0 to 1
app_SearchSync()
Next

With Browser("PeopleSoft Browser").Page("RunAlerts").PSFrame("ProcessSchedulerRequest").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  with 

For i=0 to 1
app_SearchSync()
Next

With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").Link("ProcessMonitor")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

finalProcessins="EOEN_ALERT"
'Check the process monitor to check for Sucess and posted
Call CheckProcessMontiorStatus(finalProcessins)

End Function

'**************************************************************************************************************
''' <summary> 
'''This function is used to click Run button and monitor the process. 
''' </summary>
''' <author>Aspire Team</author>
''' <datecreated>1 November 2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>Completed</endstate>
''' <returns type="NA"> True if found and clicked</returns>
'Change Control: 
'Date of Change 	Author 		Description of change
'**************************************************************************************************************
	
Public Function RunAndProcessMonitor()

'Click on Run Button
Dim appInstanceNumberWithoutTrim,appInstanceNumber,oOkButton,appBtnDesc
With Browser("PeopleSoft Browser").Page("LoadProCardStage").Frame("TargetContent").WebButton("Run")
If .Exist(6) Then
	.Click
End If
End With

Browser("PeopleSoft Browser").Sync

app_SearchSync()

'Get the process Name
dtProcessName=(GlobalDictionary("ProcessNameIn"))
With Browser("PeopleSoft Browser").Page("RunAlerts").PSFrame("ProcessSchedulerRequest").WebTable("ProcessList")
If .Exist(nMINWAIT) Then
	For i=2 to .RowCount
		appProcessName=.GetCellData(i,3)
		If instr(1,appProcessName,dtProcessName)>0 Then
			Set oCheckBox=.ChildItem(i,1,"WebCheckBox",0)
			Call WriteToReport(micPass,"The process Name selected is", "is"&appProcessName,False)
			If oCheckBox.Exist(nMINWAIT) Then
				If oCheckBox.GetRoProperty("checked")=0 Then
					oCheckBox.click
					Exit For
				End If
			End If
		End If
	Next
End If
End  WIth 

'Click on OK button displayed in the Frame 
With Browser("creationtime:=0").Page("index:=1").WebButton("html id:=#ICSave","html tag:=INPUT","name:=OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth 

app_SearchSync()

'Get the instance number present to validate in upcoming steps
appInstanceNumberWithoutTrim = Browser("creationtime:=0").Page("index:=1").WebElement("innertext:=Process Instance:.*", "index:=1").GetROProperty("innertext")
appInstanceNumber=Trim(Mid(appInstanceNumberWithoutTrim,19))
app_SearchSync()
GlobalDictionary("instanceNumber")=appInstanceNumber
    
'Click on Process Monitor link
With Browser("PeopleSoft Browser").Page("LoadProCardStage").Frame("TargetContent").Link("ProcessMonitor")
If .Exist(6) Then
	.Click
End If
End With

sProcessName=GLobalDictionary("ProcessName")
'Click on Refresh button untill Sucess is posted
CheckProcessMontiorStatus_PCARD ()
	
End Function
			
'**************************************************************************************************************
''' <summary> 
'''This function is used to wait for the browser to load the page fully upon processing. 
''' </summary>
''' <author>Aspire Team</author>
''' <datecreated>1 November 2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>Completed</endstate>
''' <returns type="NA"> True if found and clicked</returns>
'Change Control: 
'Date of Change 	Author 		Description of change
'**************************************************************************************************************
Public Function WaitForSomeTime()
      Dim i
	Do While (Browser("PeopleSoft Browser").Object.Busy=True)
		i=i+1
		If i>45 Then
		   Exit Do
	End If
	Loop 
End Function

'**************************************************************************************************************
''' <summary> 
'''This function is used to wait for the page to load fully. It will check for the Blue Processing image to disappear. 
''' </summary>
''' <author>Aspire Team</author>
''' <datecreated>1 November 2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>Completed</endstate>
''' <returns type="NA"> True if found and clicked</returns>
'Change Control: 
'Date of Change 	Author 		Description of change
'**************************************************************************************************************
Public Function app_SearchSync()
	Dim x,rc
	For x = 0 to 100
		wait(7)
		rc=Browser("PeopleSoft Browser").Page("ProcurementCards").Frame("TargetContent").Image("ProcessingImage").Exist(6)
                 If rc=False Then
                 	Exit For
                 End If                 
	Next
End Function

'**************************************************************************************************************
''' <summary> 
'''This function is used to check for the staging errors and correct if any. 
''' </summary>
''' <author>Aspire Team</author>
''' <datecreated>6 November 2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>Completed</endstate>
''' <returns type="NA"> True if found and clicked</returns>
'Change Control: 
'Date of Change 	Author 		Description of change
'**************************************************************************************************************
Public Function CheckAndCorrectStagingErrors()


'Navigate to the Load statements page
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

'Enter the control ID and click on the Add button
With Browser("PeopleSoft Browser").Page("LoadStatements").Frame("TargetContent").WebElement("AddNewValue")
If .Exist(nMinWait) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"),"is present and clicked" , false)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"),"is not present" , false)
End If
End WIth

app_SearchSync()

With Browser("PeopleSoft Browser").Page("LoadStatements").Frame("TargetContent").WebEdit("RunControlID")
If .Exist(nMainWait) Then
	.Set (GlobalDictionary("RunControlIdValue"))&inVoiceNumberGeneration
	Call WriteToReport(micPass,""&.GetROProperty("innertext"),"is present and value is set" , false)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"),"is not present" , false)
End If
End WIth

app_SearchSync()
With Browser("PeopleSoft Browser").Page("LoadStatements").Frame("TargetContent").WebButton("Add")
If .Exist(nMinWait) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"),"is present and clicked" , false)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"),"is not present" , false)
End If
End WIth


'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
	app_SearchSync()
Next

With Browser("PeopleSoft Browser").Page("LoadStatements").Frame("TargetContent").WebCheckBox("LoadDelete")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="1" Then
		.Click
	End If
End If
End  WIth 

'CLick on Run button
With Browser("PeopleSoft Browser").Page("LoadStatements").Frame("TargetContent").WebButton("Run")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

app_SearchSync()
With Browser("PeopleSoft Browser").Page("LoadStatements").PSFrame("ProcessScheduler").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

app_SearchSync()

appProcessName="PO_CCLOADLD"

With Browser("PeopleSoft Browser").Page("LoadStatements").Frame("TargetContent").Link("ProcessMonitor")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

app_SearchSync()

'Check the process monitor to check for Sucess and posted
Call CheckProcessMontiorStatus (appProcessName)

app_SearchSync()

'CLick on Go back to load statement
With Browser("PeopleSoft Browser").Page("LoadStatements").Frame("TargetContent").Link("GoBack")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

app_SearchSync()

With Browser("PeopleSoft Browser").Page("Process Monitor").WebButton("PM_btnNo")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

app_SearchSync()

appNoOfTranscations=(GlobalDictionary("NoOfTrans"))
'Check in the Process request tables for finding total number of errors int he file
'Dim appColumnName,dtColumnName,i,TotalErrorCount
'dtColumnName="Total Rows with Error in the Staging Table"
'With Browser("PeopleSoft Browser").Page("LoadStatements").Frame("TargetContent").WebTable("ProcessRequestParameters")
'	If .Exist(nMaxWait) Then
'		For i=1 to .RowCount
'			appColumnName=.GetCellData(i,2)
'			If instr(1,Trim(appColumnName),Trim(dtColumnName))>0 Then
'				TotalErrorCount=.GetCellData(i+1,2)
'				If TotalErrorCount=appNoOfTranscations Then
'					Call WriteToReport(micFail, "All the transcation loaded", "are errros ", false)
'					Else
'					Call WriteToReport(micPass,"the Files is","are present",false)
'				End If
'			End If
'		Next
'	End If
'End With 


With Browser("PeopleSoft Browser").Page("LoadStatements").Frame("TargetContent").WebElement("StagingErrors")
If .Exist(nMINWAIT) Then
	appErrorCount=.GetROProperty("innertext")
	If appErrorCount=appNoOfTranscations Then
		If appNoOfTranscations="0" Then
			Reporter.ReportEvent micDone,"No Transcation were loaded","and no transcation is in error"
			Else
			Reporter.ReportEvent micFail,"All transcation loaded","were incorrectr"
		End If
	End If
End If
End  With 


'COrrect the Errors
CorrectStagingErrors()

'Get the Emplyee ID and supervisor ID to be fetched
Call GetStagedEmpIdandSupervisorID()

app_SearchSync()

				
				GlobalDictionary("TotalUsers")="2"
				call retrieveUserID()
				
				app_SearchSync()
				Call GetSuperVisorDetailsAndUpdateExcel()
								
End Function	

'********************************************************************
	
Public Function CorrectStagingErrors()
Dim NoOfRows,i
'Navigate to the Load statements page
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

'Check the number of errors in the Staging table
With Browser("PeopleSoft Browser").Page("CorrectErrors").Frame("TargetContents").WebTable("ListOfStagedError")
       If .Exist(nMaxWait) Then
       	NoOfRows=.RowCount
       	If NoOfRows>1 Then
       		Call WriteToReport(micPass,"Total error count is","total error count is"&NoOfRows,false)
       		Else
       		Call WriteToReport(micPass,"Total error count is","total error count is 0",false)
       	End If
       End If
End With

End Function
	
'********************************************************************


'Comment : Not used anywhere so it is commented
'
'Public Function CountTotalNumberOfRowsBeforeAndAfterRun()
'
'SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))
'
''Waiting for the application sync
'For i=0 to 2
'	Browser("PeopleSoft Browser").Sync
'Next
'
''enter the QUERY name and click on search button
'With Browser("QueryViewer").Page("QueryViewer").Frame("TargetContent").WebEdit("BeginsWith")
'If .Exist(nMaxWait) Then
'	.Set (GlobalDictionary("QueryName"))
'End If
'End With
'
'With Browser("QueryViewer").Page("QueryViewer").Frame("TargetContent").WebButton("Search")
'If .Exist(nMaxWait) Then
'	.Click
'End If
'End With
'
'app_SearchSync()
'
'With Browser("QueryViewer").Page("QueryViewer").Frame("TargetContent").WebTable("QueryTable")
'If .Exist(nMaxWait) Then
'	For i=1 to .RowCount
'		appQueryName=.GetCellData(i,1)
'		If instr(1,appQueryName,GlobalDictionary("QueryName"))>0 Then
'			Set oChildObject=.ChildItem(i,5,"Link",0)
'			If oChildObject.exist(5) Then
'				oChildObject.click
'				Exit For
'			End If
'		End If
'	Next
'End If
'End WIth
'
'Browser("Query").Sync
'
'NavigationButton=Browser("Query").Page("Query").WebButton("NextNavigation").Exist(2)
'With Browser("Query").Page("Query").WebTable("HTMLTable")
'Do
'If .Exist(nMaxWait) Then
'	rowCount=.RowCount
'End If
'Browser("Query").Page("Query").WebButton("NextNavigation")
'Loop While (NavigationButton=false)
'End With
'
'If .Exist(nMaxWait) Then
'	rowCount=.RowCount
'End If
'End Function

'********************************************************************

Public Function CheckProcessMontiorStatus_PCARD()	
sInstacneNumber=GlobalDictionary("instanceNumber")


If Browser("creationtime:=0").Page("index:=1").WebButton("html id:=REFRESH_BTN","html tag:=INPUT","name:=Refresh").Exist(nMaxWait) Then
		with Browser("creationtime:=0").Page("index:=1")
			wait(nMINWAIT)
			'.WebEdit("html id:=PMN_FILTER_WRK_PRCSNAME","html tag:=INPUT","name:=PMN_FILTER_WRK_PRCSNAME").Set sProcessName
			.WebEdit("html id:=PMN_DERIVED_PRCSINSTANCE","html tag:=INPUT","name:=PMN_DERIVED_PRCSINSTANCE").Set sInstacneNumber
			.WebButton("html id:=REFRESH_BTN","html tag:=INPUT","name:=Refresh").Click	
			WriteToReport micDone, "Process Monitor : " & sProcessName , "Check Run status and Distribution status for process [" & sInstacneNumber &"].", false				
	sStatus="Success"
			
			Set oTable=Browser("creationtime:=0").Page("index:=1").WebTable("class:=PSLEVEL1GRID","html tag:=TABLE","name:=Select")
			If oTable.Exist(nMaxWait) Then
				'appRunStatus=oTable.GetCellData(2,8)
				Set Runstatus=Browser("creationtime:=0").Page("index:=1").WebElement("html id:=PMN_PRCSLIST_RUNSTATUSDESCR\$0","html tag:=SPAN")
			wait(nMINWAIT)
				While Browser("creationtime:=0").Page("index:=1").WebTable("class:=PSLEVEL1GRID","html tag:=TABLE","name:=Select").GetCellData(2,8)<>sStatus and nCount<2 
					wait(nMINWAIT)
					nCount = nCount+1
					Browser("creationtime:=0").Page("index:=1").WebButton("html id:=REFRESH_BTN","html tag:=INPUT","name:=Refresh").Click
				Wend
				
			End If
			
			
			dStatus="Posted"
			If Browser("creationtime:=0").Page("index:=1").WebTable("class:=PSLEVEL1GRID","html tag:=TABLE","name:=Select").GetCellData(2,8) = "Success" Then
				Set oDiststatus=Browser("creationtime:=0").Page("index:=1").WebElement("html id:=PMN_PRCSLIST_DISTSTATUS\$0","html tag:=SPAN")
				While Browser("creationtime:=0").Page("index:=1").WebTable("class:=PSLEVEL1GRID","html tag:=TABLE","name:=Select").GetCellData(2,9)<>dStatus and nCount<5
					wait(nMINWAIT)
					nCount = nCount+1
					Browser("creationtime:=0").Page("index:=1").WebButton("html id:=REFRESH_BTN","html tag:=INPUT","name:=Refresh").Click
				Wend
				If oDiststatus.GetROProperty("innertext") = "Posted" Then
					WriteToReport micPass, "Process Monitor", "able to successfully complete process = [ " & nProcessInstance &"]", false
				End If
			Else
				WriteToReport micFail, "Process Monitor", "Unable to successfully complete process = [ " & nProcessInstance &"]", false
			End If
		
		End With
	else
		WriteToReport micFail, "Process Monitor", "Unable to click Refresh to check status", false
	End If	
	End Function
	
'********************************************************************
	
Public Function ReviewBankStatement()

'Navigate to Procrement card center page
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

'Click on Review Bank statement link
With Browser("PeopleSoft Browser").Page("ProcurementCardsCenter Page").Frame("TargetContent").Link("ReviewBankStatement")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and clicked",false)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth

'Wait for the browser sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

'wait for the objects to load
app_SearchSync()

'Review Statement page will be launched. 
With Browser("PeopleSoft Browser").Page("ReviewBankStatement").Frame("ReviewBankStatement").WebList("RoleName")
If .Exist(nMINWAIT) Then
	.Select 1
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and following option is selected"&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth 

app_SearchSync()
SearchString="PCard"
'Select the Card issuer
With Browser("PeopleSoft Browser").Page("ReviewBankStatement").Frame("ReviewBankStatement").WebEdit("CardIssuer")
If .Exist(nMINWAIT) Then
	.Set SearchString
End If
'     altValue=.Object.alt
'     htmlIDSearch="CC_CARD_TBL_VW_CREDIT_CARD_VENDOR"
'SearchString="PCARD"
'     descImage=.GetROProperty("innertext")
'    call click_Lookup_Img_And_Select_Item(altValue, htmlIDSearch, SearchString, descImage)
End With

'seelct the Billing date
'appBillingDate="10/22/2018"
'With Browser("PeopleSoft Browser").Page("ReviewBankStatement").Frame("ReviewBankStatement").WebEdit("BilllingDate")
'If .Exist(nMINWAIT) Then
'	.Set appBillingDate
'	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and following field is set"&.GetROProperty("value"),False)
'	Else
'	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
'End If
'End WIth


With Browser("PeopleSoft Browser").Page("ReviewBankStatement").Frame("ReviewBankStatement").Image("BillingDate_Mag")
If .Exist(nMINWAIT) Then
	.Click
	''wait for the ojects to get loaded
app_SearchSync()


With Browser("PeopleSoft Browser").Page("ReviewBankStatement").PSFrame("LookUpBilling").WebTable("BillingDate")
If .Exist(nMINWAIT) Then
	RowCount=.RowCount
	appBillingDate=.GetCellData(RowCount,1)
	GlobalDictionary("BillingDate")=appBillingDate
	Reporter.ReportEvent micPass,"The Billing date","selected is"&appBillingDate
	Set oLink=.ChildItem(RowCount,1,"Link",0)
	If oLink.exist(nMINWAIT) Then
		oLink.click
	End If
End If
End  With 
	
End If
End  WIth




With Browser("PeopleSoft Browser").Page("ReviewBankStatement").Frame("ReviewBankStatement").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and clicked",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End With

For i=0 to 3
'wait for the ojects to get loaded
app_SearchSync()	
Next

'Check the Review Bank statement page and cehck for the Status as approved. If it is approved, 4.03 test case will be triggered. If it is not apptovedf 4.02 test case will be triggered. 
'With Browser("PeopleSoft Browser").Page("ReviewBankStatement").Frame("ReviewBankStatement").WebTable("TranscationSummary")
'iFlag=False
'If .Exist(nMINWAIT) Then
'	For i=1 to .RowCount
'		appRunStatus=.GetCellData(i,8)
'		If appRunStatus<>"Approved" Then
'			iFlag=True
'		End If
'		If iFlag=True Then
'			Exit For
'		End If
'	Next
'End If
'End With

With Browser("PeopleSoft Browser").Page("ReviewBankStatement").Frame("ReviewBankStatement").WebTable("TranscationSummary")
iFlag=False
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
		If .GetCellData(i,8)="Verified" or .GetCellData(i,8)="Staged" Then
		iFlag=True
		Exit For
		End  If 
	Next
	
End  If 
End  With

If iFlag=False Then
	Call  StageVouchers()
	Else
	Call RunAllUnapprovedQuery()
End If


End Function

'********************************************************************

Public Function RunAllUnapprovedQuery()

'Navigate to Query Viewer
SelectMainMenu1(GlobalDictionary("QueryViewer"))

'Waiting for the application sync
For i=0 to 1
	Browser("PeopleSoft Browser").Sync
Next

'Set the Query in begins with
With Browser("PeopleSoft Browser").Page("Query Viewer").PSFrame("Query Viewer").WebEdit("SearchText")
If .Exist(nMINWAIT) Then
	.Set (GlobalDictionary("QueryName"))
End If
End  WIth 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("Query Viewer").PSFrame("Query Viewer").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()


With Browser("PeopleSoft Browser").Page("Query Viewer").Frame("TargetContent").WebTable("QueryTable")
If .Exist(nMINWAIT) Then
	Set oHTMLLink=.ChildItem(2,5,"Link",0)
	If oHTMLLink.exist(nMINWAIT) Then
		oHTMLLink.click
	End If
End If
End  With 

For i=0 to 2
'wait for the ojects to get loaded
app_SearchSync()
Next

'Get the no of rows
With Browser("PeopleSoft Browser NewTab").Page("QueryResults").WebElement("QueryViewer_TotalRows")
If .Exist(nMINWAIT) Then
	appNoOfRows=.GetROProperty("innertext")
	appaftersplit=split(appNoOfRows,"of")
	GlobalDictionary("appNoofRowsBeforeLoad")=Trim(appaftersplit(1))
	If GlobalDictionary("appNoofRowsBeforeLoad")>1 Then
		Reporter.ReportEvent micPass,"There are some","un Approved transcation in the billing period"
	End If
	Reporter.ReportEvent micPass,"THe total no of Rows","is" &appaftersplit(1)
End If
End  With

Browser("PeopleSoft Browser NewTab").Close

For i=0 to 2
'wait for the ojects to get loaded
app_SearchSync()
Next

'Navigate to Procrement card center page
SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

'click on Reconcile link
With Browser("PeopleSoft Browser").Page("ProcurementCardsCenter Page").Frame("TargetContent").Link("ReconcileStatement")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and clicked",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",False)
End If
End WIth 

'enter the details in the Statemtn reconcile page. 
app_SearchSync()

'Select the ROle name with POCARD Admin
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebList("RoleName")
If .Exist(nMINWAIT) Then
	.Select 1
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and selected with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth 

app_SearchSync()

'Select the card issuers as PCARD
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebList("CardIssuer")
If .Exist(nMINWAIT) Then
	.Select 1
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and selected with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth

app_SearchSync()
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").Image("BillingDate")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 



With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("BillingDate").WebTable("BillingDate")
If .Exist(nMINWAIT) Then
	RowCount=.RowCount
	appBillingDate=.GetCellData(RowCount,1)
	GlobalDictionary("BillingDate")=appBillingDate
	Reporter.ReportEvent micPass,"The Billing date","selected is"&appBillingDate
	Set oLink=.ChildItem(RowCount,1,"Link",0)
	If oLink.exist(nMINWAIT) Then
		oLink.click
	End If
End If
End  With  

app_SearchSync()

'clear the transcation dates details
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebEdit("Transcation From")
If .Exist(nMINWAIT) Then
	.Set dateadd("m","-4",date)
	Reporter.ReportEvent micDone,"The Transcation date","is set with"&dateadd("m","-4",date)
End If
End With 

app_SearchSync()

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebEdit("Transcation To")
If .Exist(nMINWAIT) Then
	.Set Date
	Reporter.ReportEvent micDone,"The Transcation date","is set with"&Date
End If
End With 


'clickon search button
WIth Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and clicked",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End With 

Browser("PeopleSoft Browser").Sync
app_SearchSync()

'CLick on Select All button
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").Link("SelectAll")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and clicked",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth 

Browser("PeopleSoft Browser").Sync
app_SearchSync()

'click on Approve Button
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and clicked",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth 

'save the page
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and clicked",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth 

Call  StageVouchers()
End Function


Public Function StageVouchers()
'Navigate to Procurement card center page. 
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next


'click on More hyperlink to view the stage vouchers. 
With Browser("PeopleSoft Browser").Page("ProcurementCardsCenter Page").Frame("TargetContent").Link("More_inProcess Statements")
If .Exist(nMINWAIT) Then
        .Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and clicked",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End With 


'click on Load stage vouchers hyperlink
With Browser("PeopleSoft Browser").Page("ProcurementCardsCenter Page").Frame("TargetContent").Link("LoadVoucherStage")
If .Exist(nMINWAIT) Then
     .Click 
     Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and clicked",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End With 

app_SearchSync()

'add the control ID value or use the existing one. 

'click on Add new Value button
With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and clicked",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth 


dtControlIDvalue="STAGE_VOUCHERS"
'enter the COntrol ID value. 
With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").WebEdit("RunControlID_1")
If .Exist(nMINWAIT) Then
	.Set dtControlIDvalue & RandomNumberGeneraion & Day(Date)
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with"&.GetROProperty("value"),false)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth 

'click on Sarch BUtton
With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with"&.GetROProperty("value"),false)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth 


'check if the table exists. If exists use the existing to load the vouchers. If not create the new one. 
With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").WebElement("SearchAlert")
If .Exist(nMINWAIT) Then
      Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present",false)
      
      
	Set SearchResults=Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").WebTable("RunCOntrolIDValue")
	For i=1 to SearchResults.RowCount
		appRunControlID=SearchResults.GetCellData(i,1)
		If instr(1,appRunControlID,dtControlIDvalue)>0 Then
			Set oSearchResultslink=SearchResults.ChildItem(i,1,"Link",0)
			If oSearchResultslink.exist(nMINWAIT) Then
				oSearchResultslink.click
				Exit For
			End If
		End If
	Next
End If
Set SearchResults=Nothing
Set oSearchResultslink=Nothing
End WIth 

'Enter the values in process requerst parameters page and click on Run button
'Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").CaptureBitmap

'enter the SETID value
dtSetIdValue="SHARE"
With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").WebEdit("SetID")
If .Exist(nMINWAIT) Then
	.Set dtSetIdValue
	   Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with" &.GetROProperty("value"),False)
	   Else
	   Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth 

dtCardIssuer="PCARD"
'set the card issuer
With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").WebEdit("CardIssuer")
If .Exist(nMINWAIT) Then
	.Set dtCardIssuer
	   Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with" &.GetROProperty("value"),false)
	   Else
	   Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End With 

'dtBillingDate="09/20/2018"
''set the Billing date
'With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").WebEdit("BillingDate")
'If .Exist(nMINWAIT) Then
'	.Set dtBillingDate
'	 Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with" &.GetROProperty("value"),false)
'	   Else
'	   Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
'End If
'End With 


With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").Image("BillingDate")
If .Exist(nMINWAIT) Then
	.Click
	''wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("LookUpBilling").WebTable("LookUpBilling")
If .Exist(nMINWAIT) Then
	RowCount=.RowCount
	appBillingDate=.GetCellData(RowCount,1)
	GlobalDictionary("BillingDate")=appBillingDate
	Reporter.ReportEvent micPass,"The Billing date","selected is"&appBillingDate
	Set oLink=.ChildItem(RowCount,1,"Link",0)
	If oLink.exist(nMINWAIT) Then
		oLink.click
	End If
End If
End  With 
	
End If
End  WIth

Set objExcel=CreateObject("Excel.Application")
Set oObjWorkBook=objExcel.Workbooks.Open("C:\AutoSource_Prod\PSFINUFT\Data\PCARD_Stage_Data")
Set objDriverSheet =oObjWorkBook.Worksheets("PC_04_05_PostPCardVouchers")
For i=1 to 30
appVarName=objDriverSheet.cells(i,"A")
If appVarName="InvoiceDate" Then
objDriverSheet.cells(i,"B")=GlobalDictionary("BillingDate")
Exit For
End If
Next

oObjWorkBook.Save
oObjWorkBook.Close
objExcel.Quit


'set the value in Create vouchers
With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").WebList("CreateVouchers")
If .Exist(nMINWAIT) Then
	.Select 1
	   Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with" &.GetROProperty("value"),false)
	   Else
	   Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth 

'Enter the BUsiness UNits
dtBusinessUnits="00000"
With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").WebEdit("BusinessUnits")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnits
	   Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with" &.GetROProperty("value"),false)
	   Else
	   Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End With 

dtVoucherLines="50"
'Set the max voucher lines
With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").WebEdit("MaxVoucherLines")
If .Exist(nMINWAIT) Then
	.Set dtVoucherLines
End If
End WIth 

'click on Run button
With Browser("PeopleSoft Browser").Page("LoadVoucherStage").PSFrame("TargetContent").WebButton("Run")
If .Exist(nMINWAIT) Then
	.Click
	   Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present",false)
	   Else
	   Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End With

With Browser("PeopleSoft Browser").Page("RunAlerts").PSFrame("ProcessSchedulerRequest").WebTable("ProcessList")
If .Exist(nMINWAIT) Then
	appProcessName=.GetCellData(2,3)
	Call WriteToReport(micPass,"The process Name is ", "is"&appProcessName,false)
End If
End  With 


'click on Ok button
Set oOk=Browser("PeopleSoft Browser").Page("RunAlerts").PSFrame("ProcessSchedulerRequest").WebButton("Ok")
If oOk.Exist(nMINWAIT) Then
	oOk.Click
	   Call WriteToReport(micPass,"Ok button ", "is present and clicked",false)
	   Else
	   Call WriteToReport(micFail,"Ok button", "is not present",True)
End If



'click on Process Monitor Link
With Browser("PeopleSoft Browser").Page("LoadVoucherStage").Frame("TargetContent").Link("ProcessMonitor")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and clicked",false)
	   Else
	   Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present",True)
End If
End WIth 

'Wait for the application to load
app_SearchSync()


'Clickon refrech button unitll the job is sucess and posted
Call CheckProcessMontiorStatus (appProcessName)

wITH Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").Link("Details")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Detail").Link("Message Log")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

appdescription1="1 rows selected "
With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Message Log").WebElement("MessageText")
Call WriteToReport(micPass,"Message text is present", "and displayedf as folows"&appdescription1,False)
If .Exist(nMINWAIT) Then
	appdescription=.GetROProperty("innertext")
	Call WriteToReport(micPass,"Message text is present", "and displayedf as folows"&appdescription,False)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Message Log").WebButton("Return")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Detail").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 
End Function	
	
Public Function BuildVouchers()
'navigate to Voucher Build page
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

app_SearchSync()

RequestId=(GlobalDictionary("RequestId"))
RunControlId=(GlobalDictionary("RunControlId")) & RandomNumberGeneraion & Day(Date) 
appdescription=(GlobalDictionary("appdescription"))
appFromDate=DateAdd("m","-6",Date)
appToDate=Date
appVouchersBuildInterface=(GlobalDictionary("appVouchersBuildInterface"))
dtDesc=(GlobalDictionary("dtDesc"))


'click on Add new vaLue button
With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",false)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
End If
End With 

'enter the RUN control ID in the text field
With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebEdit("RunControlId")
If .Exist(nMINWAIT) Then
	.Set RunControlId
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and set with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
End If
End WIth 


'Click on Add Button
With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
End If
End With 

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

app_SearchSync()

'ENter all the values in Vouchers Build page and click on RUN button


'Enter the Request ID
With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebEdit("RequestId")
If .Exist(nMINWAIT) Then
	.Set RequestId
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and set with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
End If
End With 


'Enter the Description

With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebEdit("Description")
If .Exist(nMINWAIT) Then
	.Set appdescription
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and set with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
End If
End WIth 

'Enter from date and TO date

With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebEdit("FromDate")
If .Exist(nMINWAIT) Then
	.Set appFromDate
End If
End With 



With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebEdit("ToDate")
If .Exist(nMINWAIT) Then
	.Set appToDate
End If
End With


'select the vouchers buoild interface

With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebList("VoucherBuildInterface")
If .Exist(nMINWAIT) Then
	.Select appVouchersBuildInterface
End If
End With 


'select the checkbox
With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebCheckBox("PublishVoucherMessage")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 


'clicko n RUN button
With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebButton("Run")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
End If
End WIth 

app_SearchSync()


'search for teh Table and selecyt the checkbox for Voucher build

With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("ModWin").WebTable("ProcessList")
If .Exist(nMINWAIT) Then
	For i=2 to .RowCount
		appDesc=.GetCellData(i,2)
		If instr(1,appDesc,dtDesc)>0 Then
			appProcessList=.GetCellData(i,3)
			Call WriteToReport(micPass,"The Process Name is","is "&appProcessList,False)
			Set oCheckBoxObject=.ChildItem(i,1,"WebCheckBox",0)
			If oCheckBoxObject.exist(nMINWAIT) Then
				oCheckBoxObject.click
				Exit For
				       Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",False)
	                            Else
	                            Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
			End If
		End If
	Next
	Else
	 Call WriteToReport(micFail,"Process List webtale","is not present ",True)
End If
End With


app_SearchSync()
'Click on Ok button
With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("ModWin").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
	     Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",False)
	     Else
	     Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
End If
End WIth 

app_SearchSync()

'CLick on Process Monitor
WIth Browser("PeopleSoft Browser").Page("VoucherBuildRequest").Link("ProcessMonitor")
If .Exist(nMINWAIT) Then
	.Click
            Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",False)
	     Else
	     Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
End If
End With 

app_SearchSync()

finalProcessins="AP_VCHRBLD"
'Check the process monitor to check for Sucess and posted
Call CheckProcessMontiorStatus (finalProcessins)

End Function




Public Function ExpressPayments()

Dim dtBusinessUnit,SupplierId,VoucherStyle


	WriteToReport micDone, "Process Payments", "Starting add invoice", false
	dtBusinessUnit = GlobalDictionary("BusinessUnit")
	SupplierId = GlobalDictionary("SupplierId")
	VoucherStyle=GlobalDictionary("VoucherStyle")
	
	'Step 2 - Select from Main Menu Accounts Payable Vouchers Add/Update Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

	'Step - Select tab 'Find an Existing Value'
	'- Enter value in Business Unit
	' - Enter value in SUPPLIER ID 
	' -Select Voucher Style
	'- Click on Add button
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("ContentFrame")
	
		.WebElement("FindExiting Value Tab").Click
		
		'Wait for Element visible
		'.WebEdit("BusinessUnit").WaitProperty("visible",True,2000)
		WriteToReport micDone, "Voucher Entry", "Find an existing value", false
		
		'Enter values in to the specific field
		.WebEdit("BusinessUnit").Set dtBusinessUnit
		.WebEdit("SupplierId").Set SupplierId
		'.WebEdit("VoucherIdFEV").Set GlobalDictionary("VoucherID")
		
		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("VoucherIdFEV")
		If .Exist(nMINWAIT) Then
			.Set GlobalDictionary("VoucherID")
		End If
		End  With 


		
		WriteToReport micDone, "Find an Existing Value", "Find an Existing Value for Business = [ " & dtBusinessUnit &"]  SupplierId = [ " & SupplierId &"]  VoucherStyle = [ " & VoucherStyle &"]", false
		
		.WebButton("SearchButton").Click		
		WriteToReport micDone, "Voucher Entry", "Search Button", false

	End with
	
	app_SearchSync()
	
	'CLick on Paymentsd tab
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("tabPayments")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With 
	
	app_SearchSync()
	
	
	'CLick on Express payment link
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").Link("ExpressPayment")
	If .Exist(nMINWAIT) Then
		.Click
	End If
    End  WIth 
    
    app_SearchSync()
    
    WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebList("PSTNServer")
    If .Exist(nMINWAIT) Then
    	.Select 1
    End If
    End  With 

    
    'click on Create payment button
    With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("CreatePayment")
    If .Exist(nMINWAIT) Then
    	.Click
    End If
    End  With 
    
    app_SearchSync()
    
    PCardCurrentPaymentStatus=PCard_GetPaymentStatus()
    
    Call PCard_refreshTillStatuschaged(PCardCurrentPaymentStatus)
    
    'Get the number of scheduled paymenbt
	 With Browser("PeopleSoft Browser").Page("ExpressPayment").PSFrame("ManageExpressPayment").WebElement("PaymentScheduled")
	 If .Exist(nMINWAIT) Then
	 	appPaymentScheuled=.GetROProperty("innertext")
	 	Reporter.ReportEvent micDone,"The number of payment scheuled ","before payment processing is"&appPaymentScheuled
	 End If
	 End  With 
   
   WIth Browser("PeopleSoft Browser").Page("ExpressPayment").PSFrame("ManageExpressPayment").WebList("ServerName")
   If .Exist(nMINWAIT) Then
   	.Select 1
   End If
   End  With 

   
   
   'CLick on Process button at bottom of financial geteway
   With Browser("PeopleSoft Browser").Page("ExpressPayment").PSFrame("ManageExpressPayment").WebButton("Financial_Process")
     If .Exist(nMINWAIT) Then
     	.Click
     End If
   End With
   
   app_SearchSync()
   
   PCardCurrentPaymentStatus=PCard_GetPaymentStatus()
    
   Call PCard_refreshTillStatuschaged(PCardCurrentPaymentStatus)
   
       'Get the number of scheduled paymenbt
 With Browser("PeopleSoft Browser").Page("ExpressPayment").PSFrame("ManageExpressPayment").WebElement("PaymentScheduled")
 If .Exist(nMINWAIT) Then
	 appPaymentScheuled=.GetROProperty("innertext")
	 Reporter.ReportEvent micDone,"The number of payment scheuled ","after payment processing is"&appPaymentScheuled
End If
End  With
   
End Function

Public Function PCard_GetPaymentStatus()
With Browser("PeopleSoft Browser").Page("ExpressPayment").PSFrame("ManageExpressPayment").WebElement("PaymentStatus")
If .Exist(nMINWAIT) Then
	appStatus=.GetROProperty("innertext")
End If
End With 

PCard_GetPaymentStatus=appStatus
	
End Function


Public Function PCard_refreshTillStatuschaged(currentStatus)
	Dim appstatus,ncount,appStepname
	appstatus=PCard_GetPaymentStatus()
	ncount=0
	do While StrComp(appstatus,currentStatus,1)=0 OR StrComp(appstatus,"running",1)=0 or ncount>700 
		If Browser("PeopleSoft Browser").Page("ExpressPayment").PSFrame("ManageExpressPayment").WebButton("Refresh").exist(nminwait) Then
			Browser("PeopleSoft Browser").Page("ExpressPayment").PSFrame("ManageExpressPayment").WebButton("Refresh").Click
		End If
		wait(2):ncount=ncount+1'app_SearchSync()
		appstatus=PCard_GetPaymentStatus()
	loop
	If StrComp(appstatus,currentStatus,1)<>0 Then
		Call WriteToReport(micPass,"Status changed successfully ","Status changed from "&currentStatus &" to "&appstatus ,false)
	End If
End Function

Public Function PaymentPosting()

Dim RunControl,RequestID,Descriptions,ProcessFrequency,PostVoucherOption,appInstanceNumberWithoutTrim,appInstanceNumber


	WriteToReport micDone, "Process Payments", "Starting add invoice", false
	RunControl = GlobalDictionary("RunControl")
	RequestID = GlobalDictionary("RequestID")
	Descriptions = GlobalDictionary("Description")
	ProcessFrequency = GlobalDictionary("ProcessFrequency")
	PostVoucherOption = GlobalDictionary("PostVoucherOption")
	
	'Step 2 - Select from Main Menu Accounts Payable Vouchers Add/Update Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

	'Step - Select tab 'Find an Existing Value'
	'- Enter value in Business Unit
	' - Enter value in SUPPLIER ID 
	' -Select Voucher Style
	'- Click on Add button
	
	With Browser("PeopleSoft Browser").Page("Payment Page")
	
		.WebElement("Add New Value Tab").Click
		
		'Wait for Element visible
		'.WebEdit("BusinessUnit").WaitProperty("visible",True,2000)
		WriteToReport micDone, "Payment Posting Request", "Add a New Value", false
		
		'Enter values in to the specific field
		.WebEdit("Run Control Id").Set RunControl & inVoiceNumberGeneration
		
		WriteToReport micDone, "Payment Posting Request", "Add a New Value [ " & RunControl &"]  as Run control Id", false
		
		.WebButton("Add Button").Click		
		WriteToReport micDone, "Voucher Entry", "Add Button", false

	End with
	
	if Browser("PeopleSoft Browser").Page("Payment Page").PSFrame("Target Frame").WebTable("View All Table").Exist(5) Then
	with Browser("PeopleSoft Browser").Page("Payment Page").PSFrame("Target Frame").WebTable("View All Table")
	
		If .Exist(2) Then
		WriteToReport micDone, "Payment Posting Request", "Given Control Id already exists", false
			For i=1 to .RowCount
         		TableControlId=.GetCellData(i,1)
         		If instr(1,RunControl, TableControlId)>0 Then
         			.ChildItem(i,1,"Link",0).click
         			Exit for 
         		End if
         		Next
         	End If
	End with
	End If
	
	With Browser("PeopleSoft Browser").Page("Payment Page")
		
		WriteToReport micDone, "Payment Posting Request", "Process Request Parameters ", false
		
		'Enter values in to the specific field
		.WebEdit("Request Id").Set RequestID
		.WebEdit("Description").Set Descriptions
		
		.WebList("Process Frequency").Select ProcessFrequency
		.WebList("Post Payment Option").Select PostVoucherOption
		
		'WriteToReport micDone, "Process Request Parameters", "Process Request Parameters for Request Id = [ " & RequestID &"] &  Description = [ " & Descriptions &"] & Frequency = [ " & ProcessFrequency &"] & as Parameters", false
		End With
		
		With Browser("PeopleSoft Browser").Page("Payment Page")
		.WebButton("Run Button").Click		
		WriteToReport micDone, "Payment Posting", "Run Button", false
		
		Wait 4
		
		.PSFrame("Process scheduler Request").WebButton("Ok Button").Click
		WriteToReport micDone, "Payment Posting", "Click Ok Button", false
		
		End With
		
		'Get Latest instance Number 
		appInstanceNumberWithoutTrim=Browser("creationtime:=0").Page("index:=1").WebElement("innertext:=Process Instance:.*","index:=1").GetROProperty("innertext")
		appInstanceNumber=Trim(Mid(appInstanceNumberWithoutTrim,18))
		app_SearchSync()
		WriteToReport micDone, "Latest Instance", "Instance =[ " & appInstanceNumber &"]", false
		GlobalDictionary("instanceNumber")=appInstanceNumber
		
		With Browser("PeopleSoft Browser").Page("Payment Page")
		Wait 3
		.Link("Process Monitor").Click
		WriteToReport micDone, "Payment Posting", "Click Process Monito for verify the results ", false
		'Refresh the process until success
		CheckProcessMontiorStatus_PCARD ()

	End with
	
End Function

Public Function ReviewVoucherAccounting1()

Dim QueryValue
Dim SearchValue


	WriteToReport micDone, "Review Voucher Accounting", "Search for a query that begins with CDW_AP_PCARD", false
	QueryValue = GlobalDictionary("QueryValue")
	SearchValue="CDW_AP_PCARD_VOUCHERS"
	'Step 2 - Select from Main Menu Accounts Payable Vouchers Add/Update Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

	'Step - Select tab 'Find an Existing Value'
	'- Enter value in Business Unit
	' - Enter value in SUPPLIER ID 
	' -Select Voucher Style
	'- Click on Add button
	'Browser("PeopleSoft Browser").Page("Query Viewer").PSFrame("Query Viewer").WebEdit("SearchText").Set


	With Browser("PeopleSoft Browser").Page("Query Viewer").PSFrame("Query Viewer")
	
		.WebEdit("SearchText").Set QueryValue
		WriteToReport micDone, "Review Voucher Accounting Search Page", "Query = [ " & QueryValue &"]", false
		wait 1
		.WebButton("Search").Click		
		WriteToReport micDone, "Voucher Entry", "Add Button", false

	End with
	

	with Browser("PeopleSoft Browser").Page("Query Viewer").Frame("TargetContent").WebTable("QueryTable")
	If .Exist(2) Then
		WriteToReport micDone, "Query Viewer result ", "Results are displayed", false
			For i=1 to .RowCount
         		TableControlId=.GetCellData(i,2)
         		If instr(1,SearchValue, TableControlId)>0 Then
         			.ChildItem(i,1,"Link",0).click
         			Exit for 
         		End if
         		Next
         	End If
	End with
	
	
		'Get Latest instance Number 
		appInstanceNumberWithoutTrim=Browser("creationtime:=0").Page("index:=1").WebElement("innertext:=Process Instance:.*","index:=1").GetROProperty("innertext")
		appInstanceNumber=Trim(Mid(appInstanceNumberWithoutTrim,18))
		app_SearchSync()
		WriteToReport micDone, "Latest Instance", "Instance =[ " & appInstanceNumber &"]", false
		GlobalDictionary("instanceNumber")=appInstanceNumber
		
		With Browser("PeopleSoft Browser").Page("Payment Page")
		Wait 3
		.Link("Process Monitor").Click
		WriteToReport micDone, "Payment Posting", "Click Process Monito for verify the results ", false
		'Refresh the process until success
		CheckProcessMontiorStatus_PCARD ()

	End with
	
End Function

'Public Function ApproveCardHolderTranscation()
'	'Navigate to  eProcurement > Procurement Card Center
'	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
'	
'	'click on Reconcile statement
'	
'End Function

Public Function click_Lookup_Img_And_Select_Item_PCARD(altValueImg, htmlIDSearch, searchString, desc)
	Dim objLookup, bFlag
	bFlag = False
	Err.Clear
	On Error Resume Next
	If pageObj.exist(30) Then
		Set objLookup = pageObj.Image("alt:=" & altValueImg, "index:=0")
		If objLookup.exist(30) Then
			objLookup.click
			If pageObj.WebEdit("html id:=" & htmlIDSearch).exist(30) Then
				pageObj.WebEdit("html id:=" & htmlIDSearch).Set searchString

				'Original web button html id:="Lookup" has been replaced with #ICSearch
				If pageObj.WebButton("html id:=#ICSearch").Exist(5) Then
					pageObj.WebButton("html id:=#ICSearch").Click

				'The button exists on a PSFrame that is dynamically created due to the objLookup.Click earlier. Sometimes that is needed to find it.
				ElseIf pageObj.PSFrame("title:=Look Up.*").WebButton("html id:=#ICSearch").Exist(5) Then
					pageObj.PSFrame("title:=Look Up.*").WebButton("html id:=#ICSearch").Click
				
				'The PSFrames are dynamically named and generated and not always disposed of between function calls, so we need to grab the most recent one without knowing the name or ID
				Else
					Dim objDesc, i, objFrames
					
					'create a description object for PSFrames
					Set objDesc = Description.Create()
					objDesc("micclass").Value = "PSFrame"
					Set objFrames = pageObj.ChildObjects(objDesc)
					
					'Once our description object was used for PSFrames, use it again for WebButtons
					Set objDesc = Description.Create()
					objDesc("micclass").Value = "WebButton"

					'By grabbing the last frame, this ensures we get the top-most(on our display) PSFrame object
					i = objFrames.count - 1
					If objFrames(i).WebButton("html id:=#ICSearch").Exist(5) Then
						objFrames(i).WebButton("html id:=#ICSearch").Click
					Else
						WriteToReport micFail, "Click_Lookup_Img_And_Select_Item", "Search Button not found on page", True
					End If
					
					'Cleanup
					Set objDesc = Nothing
					Set objFrames = Nothing
				End If

				If pageObj.Link("outertext:=" & searchString, "index:=0").exist(30) Then
					WriteToReport micDone, "" & searchString, "" & searchString & " is displayed on look up results", True
					pageObj.Link("outertext:=" & searchString, "index:=0").click
					Call WriteToReport(micPass, "" & desc, "" & desc & " value is displayed on look up results and selected value is " & searchString, False)
					bFlag = True
				Else
					Call WriteToReport(micFail, "" & desc, "" & desc & " value " & searchString & " is not displayed on look up results", True)
				End If
			'Not all reference values have popups
			ElseIf pageObj.Webbutton("Class:=PSPUSHBUTTONTBOK", "html id:=#ICOK", "name:=OK").Exist(10) Then
				pageObj.Webbutton("Class:=PSPUSHBUTTONTBOK", "html id:=#ICOK", "name:=OK").Click
				Wait 1
				pageObj.WebEdit("html id:=PAYMENT_ID_ITEM_REF_VALUE\$0").Set searchString
			Else
				Call WriteToReport(micFail, "look up window", "look up window is not displayed", True)
			End If
		Else
			Call WriteToReport(micFail, "" & altValueImg & " Image", "" & altValueImg & " icon is not displayed", True)
		End If
	Else
		Call WriteToReport(micFail, "Page object", "page is not displayed", True)
	End If

	click_Lookup_Img_And_Select_Item_PCARD = bFlag
	On Error GoTo 0
End Function


Public Function ReconcileCardHolderStatement()

'LinkName="Load ProCard Stage"
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

wait(5)

'CLick on Reconcile Statemtn link
With Browser("PeopleSoft Browser").Page("ProcurementCardsCenter Page").Frame("TargetContent").Link("ReconcileStatement")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth

'Click on Search button if Exists
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebEdit("Transcation From")
	If .Exist(nMINWAIT) Then
		.Set dateadd("m","-4",date)
		Reporter.ReportEvent micDone,"The Transcation date selected frm","is"&dateadd("m","-4",date)
	End If
	End  With 
	
	'wait for the ojects to get loaded
app_SearchSync()


	With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebEdit("Transcation To")
	If .Exist(nMINWAIT) Then
		.Set Date
	End If
	End  WIth 

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 


End If
End  With 

For i=0 to 2
'wait for the ojects to get loaded
app_SearchSync()
Next

'Click on Search link
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").Link("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth

'wait for the ojects to get loaded
app_SearchSync()

dtRoleName="PCard User"
dtCardIssuer=GlobalDictionary("CardIssuer")

'Enter allthe mandatory details in the poage

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebList("Recon_RoleName")
If .Exist(nMINWAIT) Then
	.Select dtRoleName
	Reporter.ReportEvent micPass,"The ROle Name","is set with"&dtRoleName
End If
End  WIth 

'CLick on Magnifyung glass in the EMp ID
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").Image("EmpID_Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

''wait for the ojects to get loaded
app_SearchSync()

'CLick on Emp ID
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("LookUpEmpID").Link("EmpID")
If .Exist(nMINWAIT) Then
	GLobalDictionary("EmpID")=.GetROProperty("innertext")
	Reporter.ReportEvent micDone,"The Employee iD","is"&GLobalDictionary("EmpID")
	.Click
End If
End  WIth 

'Select the bank name
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebList("CardIssuer")
If .Exist(nMINWAIT) Then
	.Select dtCardIssuer
	Reporter.ReportEvent micDone,"The Card Issuer","is present and set with"&dtCardIssuer
End If
End  With 

'Select the transcation date
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebEdit("Recon_TransDateFrom")
If .Exist(nMINWAIT) Then
	.Set dateadd("m","-4",date)
	Reporter.ReportEvent micDone,"The Transcation date","is set with"&dateadd("m","-4",date)
End If
End  With 


With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebEdit("Recon_TransDateTo")
If .Exist(nMINWAIT) Then
	.Set Date
End If
End  With 


With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").Image("BillingDate")
If .Exist(nMINWAIT) Then
	.Click
	''wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("BillingDate").WebTable("BillingDate")
If .Exist(nMINWAIT) Then
	RowCount=.RowCount
	appBillingDate=.GetCellData(RowCount,1)
	GlobalDictionary("BillingDate")=appBillingDate
	Reporter.ReportEvent micPass,"The Billing date","selected is"&appBillingDate
	Set oLink=.ChildItem(RowCount,1,"Link",0)
	If oLink.exist(nMINWAIT) Then
		oLink.click
	End If
End If
End  With 
	
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With

app_SearchSync()
app_SearchSync()

WIth Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If .Exist(nMINWAIT) Then
If Not(Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Exist(nMINWAIT)) Then
	dtRow=.GetRowWithCellText("Staged",4)
	rowCount=.RowCount
	If dtRow=-1 Then
		Reporter.ReportEvent micFail,"There are no","transcation","in staged status"
		ElseIf Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow-1).Exist(nMINWAIT) Then
		If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow-1).GetRoProperty("value")="Verified" Then
			j=dtRow
			For i=j To rowCount
				If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow).Exist(nMINWAIT) Then
					If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow).GetRoProperty("value")="Staged" Then
					GlobalDictionary("RowNumber")=dtRow+1
					AppTransAmount=.GetCellData(dtRow+1,5)
					GlobalDictionary("TransAmount")=AppTransAmount
					Reporter.ReportEvent micDone,"The Transcation amount for","selected is"&AppTransAmount
					Set oCheckBox=.ChildItem(dtRow+1,1,"WebCheckBox",0)
					If oCheckBox.exist(nMINWAIT) Then
					oCheckBox.click
					
					Exit For
					End If
					End  If
				End If
				If dtRow=rowCount Then
					Reporter.ReportEvent micFail,"There are no Transcation","in staged status"
					Exit For
				End If
				dtRow=dtRow+1
			Next
			Else
		GlobalDictionary("RowNumber")=dtRow
		AppTransAmount=.GetCellData(dtRow,5)
		GlobalDictionary("TransAmount")=AppTransAmount
		Set oCheckBox=.ChildItem(dtRow,1,"WebCheckBox",0)
		If oCheckBox.exist(nMINWAIT) Then
		If oCheckBox.GetRoProperty("checked")=0 Then
		 oCheckBox.click
	End If
	End  If
		End If
			
	End  If
End If
End  If 
End  With 

'Find the staged
WIth Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If .Exist(nMINWAIT) Then
Do While Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Exist(nMINWAIT)
	dtRow=.GetRowWithCellText("Staged",4)
	rowCount=.RowCount
	If dtRow=-1 Then
		Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Click
		ElseIf Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow-1).Exist(nMINWAIT) Then
		If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow-1).GetRoProperty("value")="Verified" Then
			j=dtRow
			For i=j To rowCount
				If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow).Exist(nMINWAIT) Then
					If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow).GetRoProperty("value")="Staged" Then
					GlobalDictionary("RowNumber")=dtRow+1
					AppTransAmount=.GetCellData(dtRow+1,5)
					GlobalDictionary("TransAmount")=AppTransAmount
					Reporter.ReportEvent micDone,"The Transcation amount for","selected is"&AppTransAmount
					Set oCheckBox=.ChildItem(dtRow+1,1,"WebCheckBox",0)
					If oCheckBox.exist(nMINWAIT) Then
					oCheckBox.click
					Exit Do
					Exit For
					End If
					End  If
				End If
				If dtRow=rowCount Then
					Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Click
					Exit For
				End If
				dtRow=dtRow+1
			Next
			Else
		GlobalDictionary("RowNumber")=dtRow
		AppTransAmount=.GetCellData(dtRow,5)
		GlobalDictionary("TransAmount")=AppTransAmount
		Set oCheckBox=.ChildItem(dtRow,1,"WebCheckBox",0)
		If oCheckBox.exist(nMINWAIT) Then
		If oCheckBox.GetRoProperty("checked")=0 Then
		 oCheckBox.click
		 Exit Do
		 Else
		 Exit Do
	End If
	End  If
		End If
			
	End  If
Loop
End  If 
End  With
		



For i=0 to 2 
'wait for the ojects to get loaded
app_SearchSync()		
Next
	'GlobalDictionary("dtRow")=dtRow
'With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
'If .Exist(nMINWAIT) Then
'dtRow=.GetRowWithCellText("Staged",6)
'AppTransAmount=.GetCellData(dtRow,7)
'GlobalDictionary("TransAmount")=AppTransAmount
'Set oCheckBox=.ChildItem(dtRow,1,"WebCheckBox",0)
'If oCheckBox.exist(nMINWAIT) Then
'If oCheckBox.GetRoProperty("checked")=0 Then
' oCheckBox.click	
'End If
'End  If	
'End If
'End  WIth 
'

'clicko n Billing Tab
WIth Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebElement("BillingTab")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth

app_SearchSync()

dtComments="Chicago taxi expense"
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If .Exist(nMINWAIT) Then

	For i=1 to Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").RowCount 
	appAmount=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").GetCellData(i,4)
	If appAmount=GlobalDictionary("TransAmount") Then
		Set oTextBox=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").ChildItem(i,2,"WebEdit",0)
		If oTextBox.exist(nMINWAIT) Then
			oTextBox.set dtComments
			Reporter.ReportEvent micDone,"The Comments","entered is"&dtComments
			Exit For
		End If	
	End If
	If i=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").RowCount Then
		i=1
		wait(2)
		Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Click
	wait(5)
	End If
	Next
	End  If
End  WIth

app_SearchSync()



'CLick on Save Button
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

app_SearchSync()

'CLick on Transcation tab
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebElement("TranscationTab")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth

app_SearchSync()

'Search for the Table and click on the comments tab
Set TranscationTable=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If TranscationTable.exist(nMINWAIT) Then
dtRow=GlobalDictionary("RowNumber")
APmerchantName=TranscationTable.GetCellData(dtRow,3)
	Set oCommentBox=TranscationTable.childItem(dtRow,7,"Image",0)
	WriteToReport micPass, "One transcation is ", "Selected is "&APmerchantName, False
	If oCommentBox.exist(nMINWAIT) Then
		oCommentBox.click
	End If

app_SearchSync()

'entert the comments and click on Ok button
dtComments="This is only for Test"
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ProCard_Comments").WebEdit("Comments")
If .Exist(nMINWAIT) Then
	.Set dtComments
End If
End With

app_SearchSync()

'click on Ok button
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ProCard_Comments").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth

app_SearchSync()

'CLick on Distributon image
Set TranscationTable=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If TranscationTable.exist(nMINWAIT) Then
dtRow=GlobalDictionary("RowNumber")
Set oDistributionImage=TranscationTable.ChildItem(dtRow,8,"Image",0)
If oDistributionImage.exist(nMINWAIT) Then
	oDistributionImage.click
End If
End  If

app_SearchSync()

dtDeptNo="09781"
'Remote teh dept and enter the new DEPT number
Set oDistributionTable=Browser("creationtime:=0").Page("index:=1").WebTable("html id:=tdgbrCC_TRANS_DIST.*","name:=DISTRIB_PCT.*")
If oDistributionTable.Exist(nMINWAIT) Then
	Set oDeptNoTextBox=oDistributionTable.ChildItem(1,7,"WebEdit",0)
	If oDeptNoTextBox.exist(nMINWAIT) Then
		oDeptNoTextBox.set dtDeptNo
	End If
End If


'CLIck on OK button
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("ProCard_AccountDistribution").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

app_SearchSync()

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Verify")
If .Exist(nMINWAIT) Then
	.Click
	WriteToReport micPass, "Vertify buton is ", "Present and clicekd", False
End If
End  With 

app_SearchSync()

'click on Save button
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Save")	
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth

Else
WriteToReport micFail, "Reconcile Statment is", "Not present and not able to enter the details", True
End If
Set TranscationTable=Nothing

End Function


Public Function DisputeTranscation()

'LinkName="Load ProCard Stage"
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

wait(5)

'CLick on Reconcile Statemtn link
With Browser("PeopleSoft Browser").Page("ProcurementCardsCenter Page").Frame("TargetContent").Link("ReconcileStatement")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth

'Click on Search button if Exists
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebEdit("Transcation From")
	If .Exist(nMINWAIT) Then
		.Set dateadd("m","-4",date)
		Reporter.ReportEvent micDone,"The Transcation date selected frm","is"&dateadd("m","-4",date)
	End If
	End  With 
	
	'wait for the ojects to get loaded
app_SearchSync()


	With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebEdit("Transcation To")
	If .Exist(nMINWAIT) Then
		.Set Date
	End If
	End  WIth 

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 


End If
End  With 

For i=0 to 2
'wait for the ojects to get loaded
app_SearchSync()
Next

'Click on Search link
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").Link("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth

'wait for the ojects to get loaded
app_SearchSync()

dtRoleName="PCard User"
dtCardIssuer=GlobalDictionary("CardIssuer")

'Enter allthe mandatory details in the poage

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebList("Recon_RoleName")
If .Exist(nMINWAIT) Then
	.Select dtRoleName
	Reporter.ReportEvent micPass,"The ROle Name","is set with"&dtRoleName
End If
End  WIth 

'CLick on Magnifyung glass in the EMp ID
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").Image("EmpID_Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

''wait for the ojects to get loaded
app_SearchSync()

'CLick on Emp ID
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("LookUpEmpID").Link("EmpID")
If .Exist(nMINWAIT) Then
	GLobalDictionary("EmpID")=.GetROProperty("innertext")
	Reporter.ReportEvent micDone,"The Employee iD","is"&GLobalDictionary("EmpID")
	.Click
End If
End  WIth 

'Select the bank name
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebList("CardIssuer")
If .Exist(nMINWAIT) Then
	.Select dtCardIssuer
	Reporter.ReportEvent micDone,"The Card Issuer","is present and set with"&dtCardIssuer
End If
End  With 

'Select the transcation date
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebEdit("Recon_TransDateFrom")
If .Exist(nMINWAIT) Then
	.Set dateadd("m","-4",date)
	Reporter.ReportEvent micDone,"The Transcation date","is set with"&dateadd("m","-4",date)
End If
End  With 

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebEdit("Recon_TransDateTo")
If .Exist(nMINWAIT) Then
	.Set Date
End If
End  With 

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").Image("BillingDate")
If .Exist(nMINWAIT) Then
	.Click
	''wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("BillingDate").WebTable("BillingDate")
If .Exist(nMINWAIT) Then
	RowCount=.RowCount
	appBillingDate=.GetCellData(RowCount,1)
	GlobalDictionary("BillingDate")=appBillingDate
	Reporter.ReportEvent micPass,"The Billing date","selected is"&appBillingDate
	Set oLink=.ChildItem(RowCount,1,"Link",0)
	If oLink.exist(nMINWAIT) Then
		oLink.click
	End If
End If
End  With 
	
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With

'Wait for the application to sync
app_SearchSync()
app_SearchSync()
 


WIth Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If .Exist(nMINWAIT) Then
If Not(Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Exist(nMINWAIT)) Then
	
	dtRow=.GetRowWithCellText("Staged",4)
	rowCount=.RowCount
	If dtRow=-1 Then
		Reporter.ReportEvent micFail,"There are no data with","staged status"
		ElseIf Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow-1).Exist(nMINWAIT) Then
		If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow-1).GetRoProperty("value")="Verified" Then
			j=dtRow
			For i=j To rowCount
				If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow).Exist(nMINWAIT) Then
					If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow).GetRoProperty("value")="Staged" Then
					GlobalDictionary("RowNumber")=dtRow+1
					AppTransAmount=.GetCellData(dtRow+1,5)
					GlobalDictionary("TransAmount")=AppTransAmount
					Reporter.ReportEvent micDone,"The Transcation amount for","selected is"&AppTransAmount
					Set oCheckBox=.ChildItem(dtRow+1,1,"WebCheckBox",0)
					If oCheckBox.exist(nMINWAIT) Then
					oCheckBox.click
					
					Exit For
					End If
					End  If
				End If
				If dtRow=rowCount Then
					Reporter.ReportEvent micFail,"There are no","date with staged status"
					Exit For
				End If
				dtRow=dtRow+1
			Next
			Else
		GlobalDictionary("RowNumber")=dtRow
		AppTransAmount=.GetCellData(dtRow,5)
		GlobalDictionary("TransAmount")=AppTransAmount
		Set oCheckBox=.ChildItem(dtRow,1,"WebCheckBox",0)
		If oCheckBox.exist(nMINWAIT) Then
		If oCheckBox.GetRoProperty("checked")=0 Then
		 oCheckBox.click
		 
	End If
	End  If
		End If
			
	End  If
End If
End  If
End  With 


'Find the staged
'Find the staged
WIth Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If .Exist(nMINWAIT) Then
Do While Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Exist(nMINWAIT)
	dtRow=.GetRowWithCellText("Staged",4)
	rowCount=.RowCount
	If dtRow=-1 Then
		Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Click
		ElseIf Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow-1).Exist(nMINWAIT) Then
		If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow-1).GetRoProperty("value")="Verified" Then
			j=dtRow
			For i=j To rowCount
				If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow).Exist(nMINWAIT) Then
					If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow).GetRoProperty("value")="Staged" Then
					GlobalDictionary("RowNumber")=dtRow+1
					AppTransAmount=.GetCellData(dtRow+1,5)
					GlobalDictionary("TransAmount")=AppTransAmount
					Reporter.ReportEvent micDone,"The Transcation amount for","selected is"&AppTransAmount
					Set oCheckBox=.ChildItem(dtRow+1,1,"WebCheckBox",0)
					If oCheckBox.exist(nMINWAIT) Then
					oCheckBox.click
					Exit Do
					Exit For
					End If
					End  If
				End If
				If dtRow=rowCount Then
					Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Click
					Exit For
				End If
				dtRow=dtRow+1
			Next
			Else
		GlobalDictionary("RowNumber")=dtRow
		AppTransAmount=.GetCellData(dtRow,5)
		GlobalDictionary("TransAmount")=AppTransAmount
		Set oCheckBox=.ChildItem(dtRow,1,"WebCheckBox",0)
		If oCheckBox.exist(nMINWAIT) Then
		If oCheckBox.GetRoProperty("checked")=0 Then
		 oCheckBox.click
		 Exit Do
		 Else
		 Exit Do
	End If
	End  If
		End If
			
	End  If
Loop
End  If 
End  With
			
		


For i=0 to 2 
'wait for the ojects to get loaded
app_SearchSync()		
Next



'clicko n Billing Tab
WIth Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebElement("BillingTab")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth

'Enter hte Description fort eh disputefd amount
'dtDescription="Chicago taxi expense"
'Enter the description in the Transcation
dtComments="Disputing Chanrge-Amount wrong"
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If .Exist(nMINWAIT) Then

	For i=1 to Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").RowCount 
	appAmount=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").GetCellData(i,4)
	If appAmount=GlobalDictionary("TransAmount") Then
		Set oTextBox=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").ChildItem(i,2,"WebEdit",0)
		If oTextBox.exist(nMINWAIT) Then
			oTextBox.set dtComments
			Reporter.ReportEvent micDone,"The Comments","entered is"&dtComments
			Set oAmountTextBox=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").ChildItem(i,7,"WebEdit",0)
			If oAmountTextBox.Exist(nMINWAIT) Then
			dtAmountDispute="10"
				oAmountTextBox.set dtAmountDispute
			End If
			Exit For
		End If	
	End If
	If i=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").RowCount Then
		i=1
		wait(2)
		Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Click
	wait(5)
	End If
	Next
	End  If
End  WIth
	

'CLick on save button
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Navigate to Following Section fto check the disputed
'eProcurement > Procurement Card Center > Reconcile > Review Disputes
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

'CLick on Recoling disputes
With Browser("PeopleSoft Browser").Page("ProcurementCardsCenter Page").Frame("TargetContent").Link("ReconcileDisputes")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'Enter the ROle name as card holder
'dtRoleName=
With Browser("PeopleSoft Browser").Page("ReviewDisputes").Frame("TargetContent").WebList("RoleName")
If .Exist(nMINWAIT) Then
	.Select dtRoleName
End If
End  With 

'Clickon Search button
With Browser("PeopleSoft Browser").Page("ReviewDisputes").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Check whether Disputes is present
With Browser("PeopleSoft Browser").Page("ReviewDisputes").Frame("TargetContent").WebTable("ReviewDisputes")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"DIspute information is present", "as mentioned",false)
End If
End  WIth 

End Function

Public Function SplitDistribution()
'LinkName="Load ProCard Stage"
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))


dtPercentLine1=(GlobalDictionary("PercentLine1"))
dtGLUnit1=(GlobalDictionary("GLUnit1"))
dtAccount1=(GlobalDictionary("Account1"))
dtDept1=(GlobalDictionary("Dept1"))
dtPercentLine2=(GlobalDictionary("PercentLine2"))
dtGLUnit2=(GlobalDictionary("GLUnit2"))
dtAccount2=(GlobalDictionary("Account2"))
dtDept2=(GlobalDictionary("Dept2"))
dtPercentage1=(GlobalDictionary("Percentage1"))
dtPercentage2=(GlobalDictionary("Percentage2"))


'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

wait(5)

'CLick on Reconcile Statemtn link
With Browser("PeopleSoft Browser").Page("ProcurementCardsCenter Page").Frame("TargetContent").Link("ReconcileStatement")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Reconcile link is present", "and clicked",false)
End If
End WIth

'wait for the objects to load
app_SearchSync()

'Click on Search button if Exists
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebEdit("Transcation From")
	If .Exist(nMINWAIT) Then
		.Set dateadd("m","-4",date)
		Reporter.ReportEvent micDone,"The Transcation date selected frm","is"&dateadd("m","-4",date)
	End If
	End  With 
	
	'wait for the ojects to get loaded
app_SearchSync()


	With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebEdit("Transcation To")
	If .Exist(nMINWAIT) Then
		.Set Date
	End If
	End  WIth 

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 


End If
End  With 

For i=0 to 2
'wait for the ojects to get loaded
app_SearchSync()
Next

'Click on Search link
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").Link("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth

'wait for the ojects to get loaded
app_SearchSync()

dtRoleName="PCard User"
dtCardIssuer=GlobalDictionary("CardIssuer")

'Enter allthe mandatory details in the poage

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebList("Recon_RoleName")
If .Exist(nMINWAIT) Then
	.Select dtRoleName
	Reporter.ReportEvent micPass,"The ROle Name","is set with"&dtRoleName
End If
End  WIth 

'CLick on Magnifyung glass in the EMp ID
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").Image("EmpID_Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

''wait for the ojects to get loaded
app_SearchSync()

'CLick on Emp ID
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("LookUpEmpID").Link("EmpID")
If .Exist(nMINWAIT) Then
	GLobalDictionary("EmpID")=.GetROProperty("innertext")
	Reporter.ReportEvent micDone,"The Employee iD","is"&GLobalDictionary("EmpID")
	.Click
End If
End  WIth 

'Select the bank name
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebList("CardIssuer")
If .Exist(nMINWAIT) Then
	.Select dtCardIssuer
	Reporter.ReportEvent micDone,"The Card Issuer","is present and set with"&dtCardIssuer
End If
End  With 

'Select the transcation date
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebEdit("Recon_TransDateFrom")
If .Exist(nMINWAIT) Then
	.Set dateadd("m","-4",date)
	Reporter.ReportEvent micDone,"The Transcation date","is set with"&dateadd("m","-4",date)
End If
End  With 

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebEdit("Recon_TransDateTo")
If .Exist(nMINWAIT) Then
	.Set Date
	Reporter.ReportEvent micDone,"The Transcation date","is set with"&dateadd("m","-4",date)
End If
End  With


With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").Image("BillingDate")
If .Exist(nMINWAIT) Then
	.Click
	''wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("BillingDate").WebTable("BillingDate")
If .Exist(nMINWAIT) Then
	RowCount=.RowCount
	appBillingDate=.GetCellData(RowCount,1)
	GlobalDictionary("BillingDate")=appBillingDate
	Reporter.ReportEvent micPass,"The Billing date","selected is"&appBillingDate
	Set oLink=.ChildItem(RowCount,1,"Link",0)
	If oLink.exist(nMINWAIT) Then
		oLink.click
	End If
End If
End  With 
	
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With


'Wait for the application to sync
 app_SearchSync()
  app_SearchSync()

WIth Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If .Exist(nMINWAIT) Then
If Not(Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Exist(nMINWAIT)) Then
	dtRow=.GetRowWithCellText("Staged",4)
	rowCount=.RowCount
	If dtRow=-1 Then
		Reporter.ReportEvent micFail,"There are no transcation in ","staged status"
		ElseIf Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow-1).Exist(nMINWAIT) Then
		If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow-1).GetRoProperty("value")="Verified" Then
			j=dtRow
			For i=j To rowCount
				If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow).Exist(nMINWAIT) Then
					If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow).GetRoProperty("value")="Staged" Then
						GlobalDictionary("RowNumber")=dtRow+1
						Set oDIstributionImage=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").ChildItem(GlobalDictionary("RowNumber"),8,"Image",0)
							If oDIstributionImage.exist(nMINWAIT) Then
							oDIstributionImage.click
							'Exit Do
							Exit For
							Call WriteToReport(micPass,"Distribution image is present", "and clicked",false)
								Else
							Call WriteToReport(micFail,"DIstribution IMage", "is not present",True)
							End If
					
					'Exit Do
					Exit For
					End  If
				End If
				If dtRow=rowCount Then
					Reporter.ReportEvent micFail,"There are no transcation in ","staged status"
					Exit For
				End If
				dtRow=dtRow+1
			Next
			Else
		GlobalDictionary("RowNumber")=dtRow
		
		Set oDIstributionImage=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").ChildItem(GlobalDictionary("RowNumber"),8,"Image",0)
			If oDIstributionImage.exist(nMINWAIT) Then
		oDIstributionImage.click
		
		'Exit For
		Call WriteToReport(micPass,"Distribution image is present", "and clicked",false)
		Else
		Call WriteToReport(micFail,"DIstribution IMage", "is not present",True)
		End If
		End If
		
		
	End  If
End If
End  If
End  With 

'Find the staged
WIth Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If .Exist(nMINWAIT) Then
Do While Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Exist(nMINWAIT)
	dtRow=.GetRowWithCellText("Staged",4)
	rowCount=.RowCount
	If dtRow=-1 Then
		Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Click
		ElseIf Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow-1).Exist(nMINWAIT) Then
		If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow-1).GetRoProperty("value")="Verified" Then
			j=dtRow
			For i=j To rowCount
				If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow).Exist(nMINWAIT) Then
					If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebList("name:=CC_STATUS\$"&dtRow).GetRoProperty("value")="Staged" Then
						GlobalDictionary("RowNumber")=dtRow+1
						Set oDIstributionImage=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").ChildItem(GlobalDictionary("RowNumber"),8,"Image",0)
							If oDIstributionImage.exist(nMINWAIT) Then
							oDIstributionImage.click
							Exit Do
							Exit For
							Call WriteToReport(micPass,"Distribution image is present", "and clicked",false)
								Else
							Call WriteToReport(micFail,"DIstribution IMage", "is not present",True)
							End If
					
					Exit Do
					Exit For
					End  If
				End If
				If dtRow=rowCount Then
					Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("Transcation").WebButton("NextButton").Click
					Exit For
				End If
				dtRow=dtRow+1
			Next
			Else
		GlobalDictionary("RowNumber")=dtRow
		
		Set oDIstributionImage=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").ChildItem(GlobalDictionary("RowNumber"),8,"Image",0)
			If oDIstributionImage.exist(nMINWAIT) Then
		oDIstributionImage.click
		Exit Do
		'Exit For
		Call WriteToReport(micPass,"Distribution image is present", "and clicked",false)
		Else
		Call WriteToReport(micFail,"DIstribution IMage", "is not present",True)
		End If
		End If
		
		
	End  If
Loop
End  If 
End  With




'wait for the objects to load
app_SearchSync()
' nnn=Browser("creationtime:=0").page("name:=.*").PSFrame("html id:=ptModFrame_.*","title:=ProCard Account Distribution").WebTable("html tag:=TABLE","html id:=tdgbrCC_TRANS_DIST\$0").rowcount

NewRowcount=Browser("creationtime:=0").page("name:=.*").PSFrame("html id:=ptModFrame_.*","title:=ProCard Account Distribution").WebTable("html tag:=TABLE","html id:=tdgbrCC_TRANS_DIST\$0").RowCount
if(NewRowCount<2) Then
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("ProCard_AccountDistribution").WebButton("AddNewRow")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Able to click the + button to add ", "New row",false)
End If
End  With 

'WAit for the Pop up message to display
With Browser("PeopleSoft Browser").Dialog("NoofRowsToAdd").WinEdit("NoOfRows")
If .Exist(nMINWAIT) Then
	.Set "1"
	Call WriteToReport(micPass,"No of rows is present", "and set to 1",false)
End If
End  With 

'CLick on Ok button
With Browser("PeopleSoft Browser").Dialog("NoofRowsToAdd").WinButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Ok button is present", "and clicked",false)
End If
End  With

End If



'wait for the objects to load
app_SearchSync()


'Enter the Detaili int eh rows
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("ProCard_AccountDistribution").WebTable("Distributions")
If .Exist(nMINWAIT) Then
	'Set the Percentage in LIne 1
	Set PercentLine1=.ChildItem(1,2,"WebEdit",0)
	If PercentLine1.exist(nMINWAIT) Then
		PercentLine1.set dtPercentLine1
		Call WriteToReport(micPass,"PercentLine1 is presnt ", "and set with "&dtPercentLine1,false)
	End If
	
	'Set the GL in line 1
	Set GLUnit1=.ChildItem(1,5,"WebEdit",0)
	If GLUnit1.exist(nMINWAIT) Then
		GLUnit1.set dtGLUnit1
		Call WriteToReport(micPass,"GLUnit1 is presnt ", "and set with "&dtGLUnit1,false)
	End If
	
	'Set the Account inline 1
	Set oAccount1=.ChildItem(1,6,"WebEdit",0)
	If oAccount1.exist(nMINWAIT) Then
		oAccount1.set dtAccount1
		Call WriteToReport(micPass,"oAccount1 is presnt ", "and set with "&dtAccount1,false)
	End If
	
	'Set the Dept in LIONe 1
	Set oDept1=.ChildItem(1,7,"WebEdit",0)
	If oDept1.exist(nMINWAIT) Then
		oDept1.set dtDept1
		Call WriteToReport(micPass,"oDept1 is presnt ", "and set with "&dtDept1,false)
	End If
	
		'Set the Percentage in LIne 2
	Set PercentLine2=.ChildItem(2,2,"WebEdit",0)
	If PercentLine2.exist(nMINWAIT) Then
		PercentLine2.set dtPercentLine2
		Call WriteToReport(micPass,"PercentLine2 is presnt ", "and set with "&dtPercentLine2,false)
	End If
	
	'Set the GL in line 2
	Set GLUnit2=.ChildItem(2,5,"WebEdit",0)
	If GLUnit2.exist(nMINWAIT) Then
		GLUnit2.set dtGLUnit2
		Call WriteToReport(micPass,"GLUnit2 is presnt ", "and set with "&dtGLUnit2,false)
	End If
	
	'Set the Account inline 2
	Set oAccount2=.ChildItem(2,6,"WebEdit",0)
	If oAccount2.exist(nMINWAIT) Then
		oAccount2.set dtAccount2
		Call WriteToReport(micPass,"oAccount2 is presnt ", "and set with "&dtAccount2,false)
	End If
	
	'Set the Dept in LIONe 2
	Set oDept2=.ChildItem(2,7,"WebEdit",0)
	If oDept2.exist(nMINWAIT) Then
		oDept2.set dtDept2
		Call WriteToReport(micPass,"oDept2 is presnt ", "and set with "&dtDept2,false)
	End If
	
Else
	Call WriteToReport(micFail,"Not able to Find the table", "and not able to set the values of Account and Dept",True)
End If	
End With



'click on Ok button
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("ProCard_AccountDistribution").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Ok button is present ", "and clicked",false)
End If
End  With 

'wait for the objects to load
app_SearchSync()



'Clickon Ok button if Pop Up received and enter all the details
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
	With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("ProCard_AccountDistribution").WebTable("Distributions")
	If .Exist Then
		'Set the businessUnit 2
		Set oPCUnit2=.ChildItem(2,10,"WebEdit",0)
		If oPCUnit2.exist(nMINWAIT) Then
			oPCUnit2.set dtPCUnit2
			Call WriteToReport(micPass,"oPCUnit2 is presnt ", "and set with "&dtPCUnit2,false)
		End If
		
		'Set the Project 2
		Set oAccount2=.ChildItem(2,11,"WebEdit",0)
		If oAccount2.exist(nMINWAIT) Then
			oAccount2.set dtAccount2
			Call WriteToReport(micPass,"oAccount2 is presnt ", "and set with "&dtAccount2,false)
		End If
		
		'Set the activity
		Set oActivity=.ChildItem(2,11,"WebEdit",0)
		If oActivity.exist(nMINWAIT) Then
			oActivity.set dtActivity
			Call WriteToReport(micPass,"oActivity is presnt ", "and set with "&dtActivity,false)
		End If
		
		'CLicko n Ok button
		With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("ProCard_AccountDistribution").WebButton("Ok")
		If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Ok button is present ", "and clicked",false)
		End If
		End  With 
		
	End If
	End  With 
End If
End  With 

'wait for the objects to load
app_SearchSync()


'CLick on Save button in the Page
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Save button is present ", "and clicked",false)
End If
End  with 

'Select the Staged row and click oin Split LInk
Set oTable=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If oTable.exist(nMINWAIT) Then
'appGetRow=Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable").GetRowWithCellText("Staged",4)
Set oCheckBox=oTable.ChildItem(GlobalDictionary("RowNumber"),1,"WebCheckBox",0)
If oCheckBox.exist(nMINWAIT) Then
		    If oCheckBox.getRoProperty("checked")="0" Then
		    	oCheckBox.click
		   End If
End  If
End If

'CLick on Spollit link
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").Link("SplitLine")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Split line link is present", "and clicked",false)
	Else
	Call WriteToReport(micFail,"Split line link is not present", "and clicked",True)
End If
End  WIth 

'Clicko n Add New row in the Split new row window
'Click on + button to nadd new row
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("TranscationSplits").WebButton("+")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("TranscationSplits").WebTable("SplitRules")
If .Exist(nMINWAIT) Then
	Set oPercentage1=.ChildItem(1,4,"WebEdit",0)
	If oPercentage1.Exist(nMINWAIT) Then
	    oPercentage1.set dtPercentage1
	 End  If
	 
	 Set oPercentage2=.ChildItem(2,4,"WebEdit",0)
	If oPercentage2.Exist(nMINWAIT) Then
	    oPercentage2.set dtPercentage2
	 End  If	 
	 
	 Else
	 Call WriteToReport(micFail,"Split line webttable is", "is not present",True)
End If
End  With 

'CLick on OK button
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("TranscationSplits").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Verify wheterh the Transcatiomn appear twicew in the poage
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If .Exist(nMINWAIT) Then
	For i=1 To .RowCount
		Set oCheckBox=.ChildItem(i,1,"WebCheckBox",0)
		If oCheckBox.Exist(nMINWAIT) Then
			If oCheckBox.GetROProperty("checked")="1" Then
			    Set oLink=.ChildItem(i,3,"Link",0)
			    Set oLink2=.ChildItem(i+1,3,"Link",0)
			    If oLink.Exist(nMINWAIT) and oLink2.Exist(nMINWAIT) Then
			    	appMerchantName=oLink.getRoProperty("innertext")
			    	appMerchantName2=oLink2.getRoProperty("innertext")
			    	If (appMerchantName=appMerchantName2) Then
			    	     appAmountLine1=.GetCellData(i,5)
			    	     appAmountLine2=.GetCellData(i+1,5)
			    	    
			    		Call WriteToReport(micPass,"The transcation is splitted sucessfully ", "adn amounts are validated and amounht are" &appAmountLine1 &" , "&appAmountLine2 ,false)
			    		 Exit For
			    End If
			    End If
			End  If
		End If
	Next
End If
End  WIth 

'CLickon Save page
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 
End Function

Public Function TranscationNeedsApproved()
'Navigate to following path
'Navigate to Enterprise Components > Events & Notifications >  Alerts > Run Alerts
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
dtRunControlID=(GlobalDictionary("RunControlId"))
QueryName=(GlobalDictionary("QueryName"))
ProcessName=(GlobalDictionary("ProcessName"))
ProcessCategory=(GlobalDictionary("ProcessCategory"))

With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Enter the Run contol ID
With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebEdit("RunControlId")
If .Exist(nMINWAIT) Then
	.Set dtRunControlID
End If
End  WIth 

'Click on Add Button
With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

app_SearchSync()

Browser("PeopleSoft Browser").Sync

If Not Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebEdit("RequestID").Exist(nMaxWait) Then
	If Browser("creationtime:=0").page("index:=1").WebTable("html id:=PTSRCHRESULTS","html tag:=TABLE","name:=Run Control ID").Exist(2) Then
	   For i=2 to Browser("creationtime:=0").page("index:=1").WebTable("html id:=PTSRCHRESULTS","html tag:=TABLE","name:=Run Control ID").RowCount
	   	appRunControl=Browser("creationtime:=0").page("index:=1").WebTable("html id:=PTSRCHRESULTS","html tag:=TABLE","name:=Run Control ID").GetCellData(i,1)
	   	If instr(1,appRunControl,RunControlIdValue)>0 Then
	   		Browser("creationtime:=0").page("index:=1").WebTable("html id:=PTSRCHRESULTS","html tag:=TABLE","name:=Run Control ID").ChildItem(i,1,"Link",0).click
	   	End If
	   Next
End If
End If

'Enter the Request ID value and Request ID description

app_SearchSync()

wait(2)

Set wsh=CreateObject("Wscript.Shell")
With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebEdit("RequestID")
If .Exist(nMINWAIT) Then
	.Click
	.Set ""
End If
End  With 

Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebEdit("RequestID").Click
wsh.SendKeys "1"
Set wsh=Nothing
'Set oReqID=Browser("RunAlerts").Page("RunAlerts").Frame("TargetContent").WebEdit("RequestID")
'If oReqID.Exist(nMaxWait) Then
'	oReqID.Set RequestIdValue
'End If
app_SearchSync()


With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebEdit("RequestDescription")
 If .Exist(nMINWAIT) Then
 	.Set dtRunControlID
 End If
 End With 

app_SearchSync()

'Select the Process frequency radio button
radioBtnVal="A"
With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebRadioGroup("ProcessFrequency")
 If .Exist(nMINWAIT) Then
 	.Select radioBtnVal
 End If
 End With

app_SearchSync()
'Select the Query option Radio button
radioBtnVal2="3"
With Browser("PeopleSoft Browser").Page("RunAlerts").Frame("TargetContent").WebRadioGroup("QueryOption")
 If .Exist(nMINWAIT) Then
 	.Select radioBtnVal2
 End If
 End With
 
app_SearchSync()
'Enter the query name, Process name and Process category
Set oQueryName=Browser("creationtime:=0").Page("index:=0").Image("html id:=QRYNAME\$prompt\$img\$0","html tag:=IMG","name:=QRYNAME\$prompt\$img\$0")
QueryaltValue=oQueryName.Object.alt
QueryhtmlID="EOEN_AL_QRY_VW_QRYNAME"
Querydescrp=oQueryName.GetROProperty("innertext")

call click_Lookup_Img_And_Select_Item_PCARD(QueryaltValue,QueryhtmlID, QueryName, Querydescrp)

app_SearchSync()
Set oProcesName=Browser("creationtime:=0").Page("index:=0").Image("html id:=EOEN_PRCS_NAME\$prompt\$img\$0","html tag:=IMG","name:=EOEN_PRCS_NAME\$prompt\$img\$0")
ProcessAltValue=oProcesName.Object.alt
ProcesshtmlID="EOEN_AL_PRCS_VW_EOEN_PRCS_NAME"
ProcessDesc=oProcesName.GetROProperty("innertext")

call click_Lookup_Img_And_Select_Item_PCARD(ProcessAltValue,ProcesshtmlID, ProcessName, ProcessDesc)

app_SearchSync()
Set oProcessCategory=Browser("creationtime:=0").Page("index:=0").Image("html id:=EOEN_CATEGORY\$prompt\$img\$0","html tag:=IMG","name:=EOEN_CATEGORY\$prompt\$img\$0")
processCataltValue=oProcessCategory.Object.alt
ProcessCatehtmlId="EOEN_AL_CATG_VW_EOEN_CATEGORY"
ProcessCatDesc=oProcessCategory.GetROProperty("innertext")
call click_Lookup_Img_And_Select_Item_PCARD(processCataltValue,ProcessCatehtmlId, ProcessCategory, ProcessCatDesc)

For i=0 to 1
app_SearchSync()
Next

'THis funtion will execute the steps to fill all the mandatory fields and click on Run button and monitor the process. 
Call RunAndProcessMonitor()

End Function

Public Function ApproveCardHolderTranscation()
'nAVIGATE TO  eProcurement > Procurement Card Center
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

wait(5)

'CLick on Reconcile Statemtn link
With Browser("PeopleSoft Browser").Page("ProcurementCardsCenter Page").Frame("TargetContent").Link("ReconcileStatement")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Reconcile link is present", "and clicked",false)
End If
End WIth

'wait for the objects to load
app_SearchSync()

'Click on Search button if Exists
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebEdit("Transcation From")
	If .Exist(nMINWAIT) Then
		.Set dateadd("m","-4",date)
		Reporter.ReportEvent micDone,"The Transcation date selected frm","is"&dateadd("m","-4",date)
	End If
	End  With 
	
	'wait for the ojects to get loaded
app_SearchSync()


	With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebEdit("Transcation To")
	If .Exist(nMINWAIT) Then
		.Set Date
	End If
	End  WIth 

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 


End If
End  With 

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").Link("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With



dtRoleName="PCard Approver"
dtCardIssuer=GlobalDictionary("CardIssuer")

'Enter allthe mandatory details in the poage

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebList("Recon_RoleName")
If .Exist(nMINWAIT) Then
	.Select dtRoleName
	Reporter.ReportEvent micPass,"The ROle Name","is set with"&dtRoleName
End If
End  WIth 

'CLick on Magnifyung glass in the EMp ID
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").Image("EmpID_Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

''wait for the ojects to get loaded
app_SearchSync()

'CLick on Emp ID
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("LookUpEmpID").Link("EmpID")
If .Exist(nMINWAIT) Then
	GLobalDictionary("EmpID")=.GetROProperty("innertext")
	Reporter.ReportEvent micDone,"The Employee iD","is"&GLobalDictionary("EmpID")
	.Click
End If
End  WIth 

'Select the bank name
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebList("CardIssuer")
If .Exist(nMINWAIT) Then
	.Select dtCardIssuer
	Reporter.ReportEvent micDone,"The Card Issuer","is present and set with"&dtCardIssuer
End If
End  With 

'Select the transcation date
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebEdit("Recon_TransDateFrom")
If .Exist(nMINWAIT) Then
	.Set dateadd("m","-4",date)
	Reporter.ReportEvent micDone,"The Transcation date","is set with"&dateadd("m","-4",date)
End If
End  With 


With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebEdit("Recon_TransDateTo")
If .Exist(nMINWAIT) Then
	.Set Date
End If
End  With 


With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").Image("BillingDate")
If .Exist(nMINWAIT) Then
	.Click
	''wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("BillingDate").WebTable("BillingDate")
If .Exist(nMINWAIT) Then
	RowCount=.RowCount
	appBillingDate=.GetCellData(RowCount,1)
	GlobalDictionary("BillingDate")=appBillingDate
	Reporter.ReportEvent micPass,"The Billing date","selected is"&appBillingDate
	Set oLink=.ChildItem(RowCount,1,"Link",0)
	If oLink.exist(nMINWAIT) Then
		oLink.click
	End If
End If
End  With 
	
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").PSFrame("ReconWorkBench").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With

For i=0 to 2
'wait for the ojects to get loaded
app_SearchSync()
Next



On Error Resume Next 

With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebTable("TranscationTable")
If .Exist(nMINWAIT) Then
	For i=0 to .RowCount
		If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebList("name:=CC_STATUS\$"&i).Exist(nMINWAIT) Then
			If Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebList("name:=CC_STATUS\$"&i).GetRoProperty("value")="Verified" Then
				appMerchantName=.GetCellData(i+1,6)
				Set oCheckBox=.ChildItem(i+1,1,"WebCheckBox",0)
				If oCheckBox.Exist(nMINWAIT) Then
					If oCheckBox.GetRoProperty("checked")=0 Then
						oCheckBox.Click
						Reporter.ReportEvent micDone,"The CHeck box is selected","for merchant"&appMerchantName
						Exit For
						Else
						Reporter.ReportEvent micDone,"The CHeck box is selected","for merchant"&appMerchantName
						Exit For
					End If
				End If
			End If
			
		End If
		If i=.RowCount Then
			Reporter.ReportEvent micFail,"All the Transcation are","already approved"
			Exittest
		End If
	Next
End If
End  With 

If Err.Number<>0 Then
	Reporter.ReportEvent micFail,"Issue with Transcation table","and the issue is"&Err.Description
End If

On Error GoTo 0

'CLick on Approve button
WIth Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	WriteToReport micPass, "Able to click on APprove", "and approve all the transcations", false
	Else
	WriteToReport micFail, "Not Able to click on Approve", "and not able to approve teh trenascations ", True
End If
End  With 

'Click on Save button
With Browser("PeopleSoft Browser").Page("ReconcileStatementSearch").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

End Function

Public Function POstPCardVouchers()
'Navigate to Below flow
'Accounts Payable > Vouchers > Add/Update > Regular Entry
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

dtBusinessUnit=(GlobalDictionary("BusinessUnit"))
dtInvoiceDate=(GlobalDictionary("InvoiceDate"))
dtSupplierID=(GlobalDictionary("SupplierID"))
dtApprovalStatus=(GlobalDictionary("ApprovalStatus"))
dtEntryStatus=(GlobalDictionary("EntryStatus"))
dtPostVoucherOption=(GlobalDictionary("PostVoucherOption"))
dtProcessFrequency=(GlobalDictionary("ProcessFrequency"))
dtDescription=(GlobalDictionary("Description"))
dtRequestID=(GlobalDictionary("RequestID"))
dtRunControlID=(GlobalDictionary("RunControlID"))

'CLick on Find existing value
With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebElement("FindExistingValue")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 


'ENter the Following details IN THE SEARCH RESULTS
WIth Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebEdit("Voucher_BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	WriteToReport micPass, "Business unbit is present ", "and set with "&dtBusinessUnit, false
End If
End  WIth 

'Invoiuce Date
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("INvoiceDate_FEV")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("InvoiceDate")
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebEdit("Voucher_SupplierId")
If .Exist(nMINWAIT) Then
	.Set dtSupplierID
	WriteToReport micPass, "Supplier ID is present ", "and set with "&dtSupplierID, false
End If
End  WIth 

'CLick on Search buttoin
With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebButton("Voucher_Search")
If .Exist(nMINWAIT) Then
	.Click
	WriteToReport micPass, "Search button is presnert ", "and clicked ", false
End If
End  WIth 

'Wait for the application to sync
 app_SearchSync()
  app_SearchSync()
 With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebTable("Voucher_VoucherIDResults")
 For i=2 to .RowCount
 app_SearchSync()
 app_SearchSync()
   Set VoucherLink=Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebTable("Voucher_VoucherIDResults").ChildItem(i,2,"Link",0)
	If VoucherLink.exist(nMINWAIT) Then
		VoucherLink.click
	End  If
	
	app_SearchSync()
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("PostStatus")
	If .Exist(nMINWAIT) Then
		appPostStatus=.GetROProperty("innertext")
		If Not(instr(1,appPostStatus,"Posted"))>0 Then
			GlobalDIctionary("Row")=i
			WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("ReturntoSearch")
			If .Exist(nMINWAIT) Then
				.Click
			End If
			End  With
			Exit For
			Else
			WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("ReturntoSearch")
			If .Exist(nMINWAIT) Then
				.Click
			End If
			End  With 

		End If
	End If
	End  WIth 
 Next
 End  WIth 
 
 app_SearchSync()
 'Searhc for the Regular voucehr adn click on THe link
 With Browser("PeopleSoft Browser").Page("VoucherBuildRequest").PSFrame("TargetContent").WebTable("Voucher_VoucherIDResults")
 If .Exist(nMINWAIT) Then
 	For i=GlobalDIctionary("Row") to .RowCount
 		appVoucherStyle=.GetCellData(i,10)
 		appPostable=.GetCellData(i,12)
		If appVoucherStyle="Regular" Then
		If appPostable="Postable" Then
			appVoucherID=.GetCellData(i,2)
			appPaymentAmount=.GetCellData(i,5)
			GlobalDictionary("appVoucherID")=appVoucherID
			GlobalDictionary("appPaymentAmount")=appPaymentAmount
			Set VoucherLink=.ChildItem(i,10,"Link",0)
			If VoucherLink.exist(nMINWAIT) Then
				VoucherLink.click
				WriteToReport micPass, "VoucherLink is presnert ", "and clicked ", false
				WriteToReport micPass, "The Voucher ID  ", "is "&appVoucherID, false
				Exit For
			End If
		End If 	
End  If		
 	Next
 End If
 End  With 
 

Set objExcel=CreateObject("Excel.Application")
Set oObjWorkBook=objExcel.Workbooks.Open("C:\AutoSource_Prod\PSFINUFT\Data\PCARD_Stage_Data")
Set objDriverSheet =oObjWorkBook.Worksheets("PC_05_01_ProcessPaymentToBank")
For i=1 to 25
appVarName=objDriverSheet.cells(i,"A")
If appVarName="VoucherID" Then
objDriverSheet.cells(i,"B")="'"&CStr(GlobalDictionary("appVoucherID"))
Exit For
End If
Next

oObjWorkBook.Save
oObjWorkBook.Close
objExcel.Quit
 
 ''Wait for the application to sync
 app_SearchSync()
  
 With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("approvalStatus")
If .Exist(nMINWAIT) Then
 	appApprovalStatus=.GetROProperty("innertext")
 	If appApprovalStatus="Pending" Then
 		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucher_tabInvoice Information")
           If .Exist(nMINWAIT) Then
           	.Click
           End If
          With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SubmitApproval")
          If .Exist(nMINWAIT) Then
          	.Click
          End If
          End  With 
         With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails")
         If .Exist(nMINWAIT) Then
         	.Set Date
         End If
         End  With 
		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK")
		If .Exist(nMINWAIT) Then
			.Click
		End If
		End  With 
		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").Image("ShowPreviousTab")
		If .Exist(nMINWAIT) Then
			.Click
		End If
		End  With 
		
		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("Summary")
		If .Exist(nMINWAIT) Then
			.Click
		End If
		End  With 


           End  With 
           
 	End If
 End If
 End  WIth  
  
  
 
 'Check for the Approved statuwws
 With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("approvalStatus")
 If .Exist(nMINWAIT) Then
 	appApprovalStatus=.GetROProperty("innertext")
 	If appApprovalStatus=dtApprovalStatus Then
 		WriteToReport micPass, "THe status fields is present", "and it is approved", false
 	End If
 End If
 End  WIth 
 
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("EntryStatus")
If .Exist(nMINWAIT) Then
	appEntryStatus=.GetROProperty("innertext")
	If appEntryStatus=dtEntryStatus Then
		WriteToReport micPass, "THe Entry status is present", "and it is posted", false
 		Else
 		WriteToReport micFail, "THe Entry status is not present", "and it is not posted", True
	End If
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("InvoiceDate")
If .Exist(nMINWAIT) Then
	appInvoice=.GetROProperty("innertext")
	If appInvoice=GlobalDictionary("InvoiceDate") Then
		WriteToReport micPass, "THe Invoice is present", "and and set with correct value"&appInvoice, false
	End If
End If
End  WIth 

 'Clicko n INvoice informaiton tab
 WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("InvoiceInformation")
 If .Exist(nMINWAIT) Then
 	.Click
 End If
 End  WIth
 

 'verifying the total amount
 WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total")
If .Exist(nMINWAIT) Then
	appTotalAmount=.GetROProperty("value")
	If instr(1,cdbl(appTotalAmount),GlobalDictionary("appPaymentAmount"))>0 Then
		WriteToReport micPass, "THe Total amout is matching", "with payable amount is "&appTotalAmount, false
	End If
End If
End  WIth 

GlobalDictionary("SignInUser")=GlobalDictionary("Admin")

'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'Navigate to below page
'Accounts Payable > Batch Processes > Vouchers > Voucher Posting
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

'Clicko Add new value
With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
	WriteToReport micPass, "Add new value is present", "and clicked", false
End If
End  WIth 

'Entert the run contol ID
With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("PRCSRUNCNTL_RUN_CNTL_ID")
If .Exist(nMINWAIT) Then
	.Set dtRunControlID & RandomNumberGeneraion & Day(Date) 
	WriteToReport micPass, "Run control ID is present", "and set", false
End If
End  With 

'Clickon Add button
With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
	WriteToReport micPass, "Add Button is present", "and clicked and navigated to nerxt page", false
End If
End With 

'Enter all the details int eh Voucher posting rewuest
'Entet the Request ID
With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("VoucherPostingRequest").WebEdit("RequestID")
If .Exist(nMINWAIT) Then
	.Set dtRequestID
	WriteToReport micPass, "Request ID is present", "and set with"&dtRequestID, false
End If
End  With 

WIth Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("VoucherPostingRequest").WebEdit("Description")
If .Exist(nMINWAIT) Then
	.Set dtDescription
	WriteToReport micPass, "Description is present", "and set with"&dtDescription, false
End If
End  With

With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("VoucherPostingRequest").WebList("ProcessFrequency")
If .Exist(nMINWAIT) Then
	.Select dtProcessFrequency
	WriteToReport micPass, "ProcessFrequency is present", "and set with"&dtProcessFrequency, false
End If
End  With

With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("VoucherPostingRequest").WebList("PostVoucherOption")
If .Exist(nMINWAIT) Then
	.Select dtPostVoucherOption
	WriteToReport micPass, "PostVoucherOption is present", "and set with"&dtPostVoucherOption, false
End If
End  With

With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("VoucherPostingRequest").WebEdit("BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	WriteToReport micPass, "BusinessUnit is present", "and set with"&dtBusinessUnit, false
End If
End  With

''wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("VoucherPostingRequest").WebEdit("VoucherID")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appVoucherID")
End If
End  With 

 
''wait for the ojects to get loaded
app_SearchSync()

'Click on Run button
With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("VoucherPostingRequest").WebButton("Run")
If .Exist(nMINWAIT) Then
	.Click
	WriteToReport micPass, "BusinessUnit is present", "and set with"&dtVoucherID, false
End If
End  With

''wait for the ojects to get loaded
app_SearchSync()

dtDesc="PS/AP Voucher Posting"
'Selectthe check box nad click on Ok button
With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("ProcessSchdeluerRequest").WebTable("ProcessList")
If .Exist(nMINWAIT) Then
	For i=2 to .RowCount
		appDesc=.GetCellData(i,2)
		If instr(1,appDesc,dtDesc)>0 Then
			Set oCheckBoxObject=.ChildItem(i,1,"WebCheckBox",0)
			If oCheckBoxObject.exist(nMINWAIT) Then
				oCheckBoxObject.click
				Exit For
				       Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",False)
	                            Else
	                            Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
			End If
		End If
	Next
	Else
	 Call WriteToReport(micFail,"Process List webtale","is not present ",True)
End If
End  WIth 
	

'CLick on Ok button
With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("ProcessSchdeluerRequest").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 


''get the instance number 
'appInstanceNumberWithoutTrim = Browser("creationtime:=0").Page("index:=1").WebElement("innertext:=Process Instance:.*", "index:=1").GetROProperty("innertext")
'appInstanceNumber=Trim(Mid(appInstanceNumberWithoutTrim,18))
'app_SearchSync()
'GlobalDictionary("instanceNumber")=appInstanceNumber

'CLick on Process monitoer
With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("VoucherPostingRequest").Link("Process Monitor")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",False)
	     Else
	    Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
End If
End With 

For i=0 to 2
	app_SearchSync()
Next

finalProcessins="AP_PSTVCHR"
'Check the process monitor to check for Sucess and posted
Call CheckProcessMontiorStatus(finalProcessins)

''CLickon Refrewsh button
''Click on Refresh Buytton
'With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Refresh")
'If .Exist(nMINWAIT) Then
'	.Click
'	      Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",False)
'	     Else
'	     Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
'End If
'End With


''Set the prpocfess instance in check box
'With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebEdit("InstanceFrom")
'If .Exist(nMINWAIT) Then
'	.Set GlobalDictionary("instanceNumber")
'	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and set with"&.GetROProperty("value"),False)
'	Else
'	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present ",True)
'End If
'End With 

''Click on Refresh Button
'With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Refresh")
'If .Exist(nMINWAIT) Then
'	.Click
'	      Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",False)


'sStatus="Success"
''in the process list table verify whether status becomes sucess and posted
'With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor")
'If .Exist(nMINWAIT) Then
'	While Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor").GetCellData(2,8)<>sStatus and nCount<10
'		wait(nMINWAIT)
'		nCount=nCount+1
'		Set oRefresh=Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Refresh")
'		If oRefresh.Exist(nMINWAIT) Then
'			oRefresh.Click
'		End If
'		Set oRefresh=Nothing
'	Wend
'End If
'End With



'dtStatus="Posted"
''Check the distribution status
'If Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor").GetCellData(2,8)="Success" Then
'	While Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)<>dtStatus and nCount1<10
'		wait(nMINWAIT)
'		nCount1=nCount1+1
'		Set oRefresh=Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Refresh")
'		If oRefresh.Exist(nMINWAIT) Then
'			oRefresh.Click
'		End If
'		Set oRefresh=Nothing
'	Wend
'	If Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)="Posted" Then
'		Call WriteToReport(micPass,"Process Monitor", "able to successfully complete process = [ " & instanceNumber &"]",false)
'		Else
'		Call WriteToReport(micFail,"Process Monitor", "Unable to successfully complete process = [ " & instanceNumber &"]",True)
'	End If
'	Else
'	Call WriteToReport(micFail,"Process Monitor", "Unable to successfully complete process = [ " & instanceNumber &"]",True)
'End If
'
'
'Else
'Call WriteToReport(micFail,"Process Monitor", "Unable to clickon refresh to check the status",True)
'End If
'End With

With Browser("PeopleSoft Browser").Page("Process Monitor").WebButton("PM_btnNo")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 



End Function

Public Function ReviewVoucherAccounting()
'Navigate to below page
'Reporting Tools > Query > Query Viewer
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
dtQuery=(GlobalDictionary("Query"))
dtPrepaidInvoiceNumber=(GlobalDictionary("PrepaidInvoice"))
'eNTETR THE Query view
With Browser("PeopleSoft Browser").Page("Query Viewer").PSFrame("Query Viewer").WebEdit("SearchText")
If .Exist(nMINWAIT) Then
	.Set dtQuery
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Query Viewer").PSFrame("Query Viewer").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 


With Browser("PeopleSoft Browser").Page("Query Viewer").Frame("TargetContent").WebTable("QueryTable")
If .Exist(nMINWAIT) Then
	Set oHTMLLink=.ChildItem(2,5,"Link",0)
	If oHTMLLink.exist(nMINWAIT) Then
		oHTMLLink.click
	End If
End If
End  With 
'wait for the ojects to get loaded
 app_SearchSync()
 
 
 
 'Enter the Prepaid Voucer created in the last sterp
With Browser("PeopleSoft Browser NewTab").Page("QueryResults").WebEdit("PrepaidRef")
If .Exist(nMINWAIT) Then
	.Set dtPrepaidInvoiceNumber
End If
End  With 

With Browser("PeopleSoft Browser NewTab").Page("QueryResults").WebButton("ViewResults")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'Search for the table
With Browser("PeopleSoft Browser NewTab").Page("QueryResults").WebTable("SearchResults")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"THe webtable is present", "and prepaid voucher details re gettign populated",false)
	Else
	Call WriteToReport(micFail,"THe webtable is present", "and prepaid voucher details re gettign populated",false)
End If
End  With 	
End Function


Public Function QueryViewerBeforeLoad()
'Naviagate to below page
'Reporting tools -> QUery -> Query viewew
SelectMainMenu1(GlobalDictionary("QueryMenuSelection"))

dtQueryName=(GlobalDictionary("QueryName"))

'Set the Query in begins with
With Browser("PeopleSoft Browser").Page("Query Viewer").PSFrame("Query Viewer").WebEdit("SearchText")
If .Exist(nMINWAIT) Then
	.Set dtQueryName
End If
End  WIth 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("Query Viewer").PSFrame("Query Viewer").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()


With Browser("PeopleSoft Browser").Page("Query Viewer").Frame("TargetContent").WebTable("QueryTable")
If .Exist(nMINWAIT) Then
	Set oHTMLLink=.ChildItem(2,5,"Link",0)
	If oHTMLLink.exist(nMINWAIT) Then
		oHTMLLink.click
	End If
End If
End  With 

For i=0 to 2
'wait for the ojects to get loaded
app_SearchSync()
Next


'Get the no of rows
With Browser("PeopleSoft Browser NewTab").Page("QueryResults").WebElement("QueryViewer_TotalRows")
If .Exist(nMINWAIT) Then
	appNoOfRows=.GetROProperty("innertext")
	appaftersplit=split(appNoOfRows,"of")
	GlobalDictionary("appNoofRowsBeforeLoad")=Trim(appaftersplit(1))
	Reporter.ReportEvent micPass,"THe total no of Rows","is" &appaftersplit(1)
End If
End  With 

Browser("PeopleSoft Browser NewTab").Close

End Function

Public Function QueryViewerAfterLoad()
'Naviagate to below page
'Reporting tools -> QUery -> Query viewew
SelectMainMenu1(GlobalDictionary("QueryMenuSelection"))

dtQueryName=(GlobalDictionary("QueryName"))



'Set the Query in begins with
With Browser("PeopleSoft Browser").Page("Query Viewer").PSFrame("Query Viewer").WebEdit("SearchText")
If .Exist(nMINWAIT) Then
	.Set dtQueryName
End If
End  WIth 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("Query Viewer").PSFrame("Query Viewer").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()


With Browser("PeopleSoft Browser").Page("Query Viewer").Frame("TargetContent").WebTable("QueryTable")
If .Exist(nMINWAIT) Then
	Set oHTMLLink=.ChildItem(2,5,"Link",0)
	If oHTMLLink.exist(nMINWAIT) Then
		oHTMLLink.click
	End If
End If
End  With 

For i=0 to 2
'wait for the ojects to get loaded
app_SearchSync()
Next


'Get the no of rows
With Browser("PeopleSoft Browser NewTab").Page("QueryResults").WebElement("QueryViewer_TotalRows")
If .Exist(nMINWAIT) Then
	appNoOfRows=.GetROProperty("innertext")
	appaftersplit=split(appNoOfRows,"of")
	GlobalDictionary("appNoofRowsAfterLoad")=Trim(appaftersplit(1))
	Reporter.ReportEvent micPass,"THe total no of Rows","is" &appaftersplit(1)
End If
End  With

Browser("PeopleSoft Browser NewTab").Close

End Function

Public Function GetStagedEmpIdandSupervisorID()
'Naviagate to below page
'Reporting tools -> QUery -> Query viewew
SelectMainMenu1(GlobalDictionary("QueryMenuSelection"))

'SelectMainMenu1(GlobalDictionary("QueryViewer"))
dtQueryName=(GlobalDictionary("dtQueryName"))



'Set the Query in begins with
With Browser("PeopleSoft Browser").Page("Query Viewer").PSFrame("Query Viewer").WebEdit("SearchText")
If .Exist(nMINWAIT) Then
	.Set dtQueryName
End If
End  WIth 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("Query Viewer").PSFrame("Query Viewer").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

With Browser("PeopleSoft Browser").Page("Query Viewer").Frame("TargetContent").WebTable("QueryTable")
If .Exist(nMINWAIT) Then
	Set oHTMLLink=.ChildItem(2,5,"Link",0)
	If oHTMLLink.exist(nMINWAIT) Then
		oHTMLLink.click
	End If
End If
End  With

'wait for the ojects to get loaded
For i=0 to 2
	app_SearchSync()
Next
 



'gET THE User ID
appGetUserId=Browser("PeopleSoft Browser NewTab").Page("QueryResults").WebTable("SearchResults").GetCellData(2,15)
GlobalDictionary("appGetUserId")=appGetUserId
appGetUserName=Browser("PeopleSoft Browser NewTab").Page("QueryResults").WebTable("SearchResults").GetCellData(2,14)
appLastName=split(appGetUserName,",")
Browser("PeopleSoft Browser NewTab").Close

'wait for the ojects to get loaded
 app_SearchSync()

'logout the application
PSFinLogout()

GlobalDictionary("SignInUser")=GlobalDictionary("SignInUser2")
				

'login as approver
UserSignIn()
				
				
'Get the Supervisor and set the value in Excel for corresponding sheet
'Navigate to below page
'GetSuperVisorDetailsSelection="Travel and Expenses > Manage Employee Information > Update Profile"
'Travel and Expenses > Manage Employee Information > Update Profile
SelectMainMenu1(GlobalDictionary("GetSuperVisorDetailsSelection"))
dtSearchBy="Last Name"
With Browser("PeopleSoft Browser").Page("UpdateProfile").PSFrame("TargetContent").WebList("UpdateProfile_SearchBy")
If .Exist(nMINWAIT) Then
	.Select dtSearchBy
End If
End  With 

With Browser("PeopleSoft Browser").Page("UpdateProfile").PSFrame("TargetContent").WebEdit("UpdateProfile_LastName")
If .Exist(nMINWAIT) Then
	.Set appLastName(0)
End If
End  With 

wiTH Browser("PeopleSoft Browser").Page("UpdateProfile").PSFrame("TargetContent").WebButton("UpdateProfie_Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 


'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("UpdateProfile").PSFrame("TargetContent").WebTable("UpdateProfile_SearchResults")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
		appName=.GetCellData(i,3)
		If appName=appGetUserName Then
			Set oLInk=.ChildItem(i,1,"Link",0)
			If oLInk.exist(nMINWAIT) Then
				oLInk.click
				Exit For
			End If
		End If
	Next
End If
End  WIth 


'wait for the ojects to get loaded
app_SearchSync()

WIth Browser("PeopleSoft Browser").Page("UpdateProfile").PSFrame("TargetContent").WebElement("UpdateProfile_OrginazationalData")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 


'wait for the ojects to get loaded
app_SearchSync()

'wait for the ojects to get loaded
app_SearchSync()


With Browser("PeopleSoft Browser").Page("UpdateProfile").PSFrame("TargetContent").WebElement("UpdateProfile_SupName")
If .Exist(nMINWAIT) Then
	appSuppName=.GetROProperty("innertext")
	appLatName=split(appSuppName,",")
	appLatNameUpd=appLatName(1) & " " & appLatName(0)
	GlobalDictionary("appSuppName")=appSuppName
	GlobalDictionary("appLatName")=appLatName
    appGetNewUser=split(appLatNameUpd," ")
    If UBound(appGetNewUser)>1 Then
	GlobalDIctionary("user1")=appGetNewUser(0) & " " & appGetNewUser(2)
	Else
	GlobalDIctionary("user1")=appLatName(1) & " " & appLatName(0)
    End If
	
End If
End  WIth 

GlobalDictionary("SignInUser")=GlobalDictionary("SignInUser2")

End  Function


Public Function GetSuperVisorDetailsAndUpdateExcel()


Set objExcel=CreateObject("Excel.Application")
Set oObjWorkBook=objExcel.Workbooks.Open("C:\AutoSource_Prod\PSFINUFT\Data\PCARD_Stage_Data")
Set objDriverSheet =oObjWorkBook.Worksheets("PC_03_01_ReconCardHolderStmt")
For i=1 to 13
appVarName=objDriverSheet.cells(i,"A")
If appVarName="SignInUser" Then
objDriverSheet.cells(i,"B")=GlobalDictionary("appGetUserId")
Exit For
End If
Next

Set objDriverSheet =oObjWorkBook.Worksheets("PC_03_02_DisputeATransaction")
For i=1 to 13
appVarName=objDriverSheet.cells(i,"A")
If appVarName="SignInUser" Then
objDriverSheet.cells(i,"B")=GlobalDictionary("appGetUserId")
Exit For
End If
Next

Set objDriverSheet =oObjWorkBook.Worksheets("PC_03_03_SplitDistri_TransLine")
For i=1 to 13
appVarName=objDriverSheet.cells(i,"A")
If appVarName="SignInUser" Then
objDriverSheet.cells(i,"B")=GlobalDictionary("appGetUserId")
Exit For
End If
Next

Set objDriverSheet =oObjWorkBook.Worksheets("PC_03_05_App_CardTrans")
For i=1 to 13
appVarName=objDriverSheet.cells(i,"A")
If appVarName="SignInUser" Then
objDriverSheet.cells(i,"B")=GlobalDictionary("userID1")
Exit For
End If
Next

oObjWorkBook.Save
oObjWorkBook.Close
objExcel.Quit

End Function


Function inVoiceNumberGeneration()
	inVoiceNumberGeneration=left(Replace(date,"/",""),4)&left(Replace(Time,":",""),4)&mid(Replace(Time,":",""),8,1)
End Function



'**********************************************************************************************************************

'*********************************************************************************************************************************
''' <summary>  
''' addSpecialRequisition()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "Category,Qty,UOM,SupplierID,price"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'eP_addSpecialRequisition
Public Function addSpecialRequisition(Category,Qty,UOM,SupplierID,price)
Dim strDes
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebEdit("SpecialRequest_Description").Exist(nminwait) Then
			strDes=SupplierID&Replace(Replace(Replace(now,":",""),"/","")," ","")
			.WebEdit("SpecialRequest_Description").Set strDes
			WriteToReport micPass,"Description "," Description field is present and entered as"&price,false
			else
			WriteToReport micfail,"Description "," Description field isn't present ",true
		End If
		If .WebEdit("SpecialRequest_Value").Exist(nminwait) Then
			.WebEdit("SpecialRequest_Value").Set price
			WriteToReport micPass,"Price "," Price field is present and entered as"&price,false
			else
			WriteToReport micfail,"Price "," Price field isn't present ",true
		End If
		If .WebEdit("ServiceRequest_Quantity").Exist(nminwait) Then
			.WebEdit("ServiceRequest_Quantity").Set qty
			WriteToReport micPass,"Quantity "," Quantity field is present and entered as"&qty,false
			else
			WriteToReport micfail,"Quantity "," Quantity field isn't present ",true
		End If
		If .WebEdit("ServiceRequest_UOM").Exist(nminwait) Then
			.WebEdit("ServiceRequest_UOM").Set UOM
			WriteToReport micPass,"UOM "," UOM field is present and entered as"&UOM,false
			else
			WriteToReport micfail,"UOM "," UOM field isn't present ",true
		End If
		If .WebEdit("SpecialRequest_Category").Exist(nminwait) Then
			.WebEdit("SpecialRequest_Category").Set Category
			WriteToReport micPass,"Category "," Category field is present and entered as"&Category,false
			else
			WriteToReport micfail,"Category "," Category field isn't present ",true
		End If
		
		If .WebEdit("SpecialRequest_SupplierID").Exist(nminwait) Then
			.WebEdit("SpecialRequest_SupplierID").Set SupplierID
			WriteToReport micPass,"SupplierID "," SupplierID field is present and entered as"&SupplierID,false
			else
			WriteToReport micfail,"SupplierID "," SupplierID field isn't present ",true
		End If
		
		If .WebCheckBox("SpecialRequest_ShowatVoucher").Exist(nminwait) Then
			.WebCheckBox("SpecialRequest_ShowatVoucher").Set "ON"
		End If
		If .WebCheckBox("SpecialRequest_ShowAtReceipt").Exist(nminwait) Then
			.WebCheckBox("SpecialRequest_ShowAtReceipt").Set "ON"
		End If
		If .WebCheckBox("SpecialRequest_SendtoSupplier").Exist(nminwait) Then
			.WebCheckBox("SpecialRequest_SendtoSupplier").Set "ON"
		End If
		If .WebEdit("SpecialRequest_AdditionalInformation").Exist(nminwait) Then
			.WebEdit("SpecialRequest_AdditionalInformation").Set SupplierID&now
			WriteToReport micPass,"AdditionalInformation "," AdditionalInformation field is present and entered as"&SupplierID&now,false
		End If
		If .WebButton("Add to Cart").Exist(nminwait) Then
			.WebButton("Add to Cart").Click
			WriteToReport micPass,"Add to cart button"," Add to cart button field is present and Clicked",false
			else
			WriteToReport micfail,"Add to cart button "," Add to cart button field isn't present ",true
		End If
End With

End Function


'*********************************************************************************************************************************
''' <summary>  
''' addSpecialRequisition()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "Category,Qty,UOM,SupplierID,price"</note> 
''' </para>
''' </summary>
''' <author>vijay anandan</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'eP_addSpecialRequisition
Public Function EProCANaddSpecialRequisition(Category,Qty,UOM,SupplierID,price)
Dim strDes

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent")
		If .WebEdit("SpecialRequest_Description").Exist(nminwait) Then
			strDes=SupplierID&Replace(Replace(Replace(now,":",""),"/","")," ","")
			.WebEdit("SpecialRequest_Description").Set strDes
			WriteToReport micPass,"Description "," Description field is present and entered as"&price,false
			else
			WriteToReport micfail,"Description "," Description field isn't present ",true
		End If
		If .WebEdit("SpecialRequest_Value").Exist(nminwait) Then
			.WebEdit("SpecialRequest_Value").Set price
			WriteToReport micPass,"Price "," Price field is present and entered as"&price,false
			else
			WriteToReport micfail,"Price "," Price field isn't present ",true
		End If
		If .WebEdit("ServiceRequest_Quantity").Exist(nminwait) Then
			.WebEdit("ServiceRequest_Quantity").Set qty
			WriteToReport micPass,"Quantity "," Quantity field is present and entered as"&qty,false
			else
			WriteToReport micfail,"Quantity "," Quantity field isn't present ",true
		End If
		If .WebEdit("ServiceRequest_UOM").Exist(nminwait) Then
			.WebEdit("ServiceRequest_UOM").Set UOM
			WriteToReport micPass,"UOM "," UOM field is present and entered as"&UOM,false
			else
			WriteToReport micfail,"UOM "," UOM field isn't present ",true
		End If
		If .WebEdit("SpecialRequest_Category").Exist(nminwait) Then
			.WebEdit("SpecialRequest_Category").Set Category
			WriteToReport micPass,"Category "," Category field is present and entered as"&Category,false
			else
			WriteToReport micfail,"Category "," Category field isn't present ",true
		End If
		
		If .WebEdit("SpecialRequest_SupplierID").Exist(nminwait) Then
			.WebEdit("SpecialRequest_SupplierID").Set SupplierID
			WriteToReport micPass,"SupplierID "," SupplierID field is present and entered as"&SupplierID,false
			else
			WriteToReport micfail,"SupplierID "," SupplierID field isn't present ",true
		End If
		
		If .WebCheckBox("SpecialRequest_ShowatVoucher").Exist(nminwait) Then
			.WebCheckBox("SpecialRequest_ShowatVoucher").Set "ON"
		End If
		If .WebCheckBox("SpecialRequest_ShowAtReceipt").Exist(nminwait) Then
			.WebCheckBox("SpecialRequest_ShowAtReceipt").Set "ON"
		End If
		If .WebCheckBox("SpecialRequest_SendtoSupplier").Exist(nminwait) Then
			.WebCheckBox("SpecialRequest_SendtoSupplier").Set "ON"
		End If
		If .WebEdit("SpecialRequest_AdditionalInformation").Exist(nminwait) Then
			.WebEdit("SpecialRequest_AdditionalInformation").Set SupplierID&now
			WriteToReport micPass,"AdditionalInformation "," AdditionalInformation field is present and entered as"&SupplierID&now,false
		End If
		If .WebButton("Add to Cart").Exist(nminwait) Then
			.WebButton("Add to Cart").Click
			WriteToReport micPass,"Add to cart button"," Add to cart button field is present and Clicked",false
			else
			WriteToReport micfail,"Add to cart button "," Add to cart button field isn't present ",true
		End If
End With

End Function
'*********************************************************************************************************************************
''' <summary>  
''' ep_captureApproverNames()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'eP_addSpecialRequisition
Public Function ep_captureApproverNames(objFrame)
	Dim approverList(),i
	Set links=Description.Create
	links("micclass").value="Link"
	links("html tag").value="A"
	links("title").value="View approver/reviewer information"
	Set tablist=objFrame.ChildObjects(links)
	For i = 0 To tablist.Count()-1 Step 1
		ReDim Preserve approverList(i):approverList(i)=tablist(i).getroproperty("innertext")
		WriteToReport micPass,"Approver "&i+1," captured from application as "&approverList(i) ,false
	Next
	ep_captureApproverNames=approverList
End Function
'*********************************************************************************************************************************
''' <summary>  
''' requisitionEntry2DiffCategories1CATapproval1ACCTapproval()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
Public Function requisitionEntry2DiffCategories1CATapproval1ACCTapproval()
Dim i
    'Navigate to below page "eProcurement > Requisition"
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
    
    If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests").Exist(nminwait) Then
        Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests").Click
        WriteToReport micPass,"Special Requests link "," Special Requests field is present and clicked",false
    else
        WriteToReport micfail,"Special Requests link "," Special Requests field isn't present",true
    End If
    app_searchsync()

    businessunit=GlobalDictionary("businessunit")
    Price=GlobalDictionary("Price")
    Qty=GlobalDictionary("Qty")
    UOM=GlobalDictionary("UOM")
    Category=GlobalDictionary("Category")
    SupplierID=GlobalDictionary("SupplierID")
    call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)
    WriteToReport micPass,"Requsistion 1"," Requesition 1 added to the cart successfully",false
    
    Price=GlobalDictionary("Price1")
    Qty=GlobalDictionary("Qty1")
    UOM=GlobalDictionary("UOM")
    Category=GlobalDictionary("Category1")
    SupplierID=GlobalDictionary("SupplierID1")
    call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)
    WriteToReport micPass,"Requsistion 1"," Requesition 1 added to the cart successfully",false
    
    If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout").Exist(nminwait) Then
        Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout").Click
        WriteToReport micPass,"Checkout button "," Checkout is present and clicked",false
    else
        WriteToReport micfail,"Checkout button "," Checkout field isn't present",true
    End If
    app_SearchSync()
    WriteToReport micDone,"chartfield2 for line 1"," adding chartfield2 details",false
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
        If .Image("Expand Section").Exist(nminwait) Then
            .Image("Expand Section").Click
        End If
        If .Image("Expand section Accounting").Exist(nminwait) Then
            .Image("Expand section Accounting").Click
        End If
        
        If .WebElement("Chartfields2_Tab").Exist(nminwait) Then
            .WebElement("Chartfields2_Tab").Click
            WriteToReport micPass,"Checkout button "," Checkout is present and clicked",false
            else
            WriteToReport micfail,"Checkout button "," Checkout field isn't present",true
        End If
        If .WebEdit("Chartfields2_DeptID").Exist(nminwait) Then
            .WebEdit("Chartfields2_DeptID").Set GlobalDictionary("Dept1")
            WriteToReport micPass," in chartfield2"," Dept is present and entered as"&GlobalDictionary("Dept1"),false
        else
            WriteToReport micfail,"Dept in chartfield2 "," field isn't present",true
        End If
        If .WebEdit("Chartfields2_Account").Exist(nminwait) Then
            .WebEdit("Chartfields2_Account").Set GlobalDictionary("Account1")
            WriteToReport micPass,"Account in chartfield2"," Account is present and entered as"&GlobalDictionary("Account1"),false
        else
            WriteToReport micfail,"Account in chartfield2 "," field isn't present",true
        End If
        If .Image("Collapse Section").Exist(nminwait) Then
            .Image("Collapse Section").Click
        End If
    
        app_SearchSync()
        Dim str
        str=.Image("Expand Section").GetROProperty("name")
        .Image("Expand Section").SetTOProperty "name",Left(str,len(str)-1)&"1"
        .Image("Collapse Section").SetTOProperty "Index",1
        WriteToReport micDone,"chartfield2 for line 2"," adding chartfield2 details",false
        If .Image("Expand Section").Exist(nminwait) Then
            .Image("Expand Section").Click
        End If
        If .Image("Expand section Accounting").Exist(nminwait) Then
            .Image("Expand section Accounting").Click
        End If
        If .WebElement("Chartfields2_Tab").Exist(nminwait) Then
            .WebElement("Chartfields2_Tab").Click
            WriteToReport micPass,"Chartfields2_Tab "," Chartfields2_Tab is present and clicked",false
        else
            WriteToReport micfail,"Chartfields2_Tab "," Chartfields2_Tab field isn't present",true
        End If
        If .WebEdit("Chartfields2_DeptID").Exist(nminwait) Then
            .WebEdit("Chartfields2_DeptID").Set GlobalDictionary("Dept2")
            WriteToReport micPass,"Dept in chartfield2"," Dept is present and entered as"&GlobalDictionary("Dept2"),false
        else
            WriteToReport micfail,"Dept in chartfield2 "," field isn't present",true
        End If
        If .WebEdit("Chartfields2_Account").Exist(nminwait) Then
            .WebEdit("Chartfields2_Account").Set GlobalDictionary("Account2")
            WriteToReport micPass,"Account in chartfield2"," Account is present and entered as"&GlobalDictionary("Account2"),false
        else
            WriteToReport micfail,"Account in chartfield2 "," field isn't present",true
        End If
'        If .Image("Collapse Section").Exist(nminwait) Then
'            .Image("Collapse Section").Click
'        End If
        
        app_searchSync()
        
        If .WebCheckBox("ReviewSubmit_SendtoSupplier").Exist(nminwait) Then
            .WebCheckBox("ReviewSubmit_SendtoSupplier").Set"ON"
        End If
        
        If .WebCheckBox("ReviewSubmit_ShowAtReceipt").Exist(nminwait) Then
            .WebCheckBox("ReviewSubmit_ShowAtReceipt").Set "ON"
        End If
        If .WebCheckBox("ReviewSubmit_ShowatVoucher").Exist(nminwait) Then
            .WebCheckBox("ReviewSubmit_ShowatVoucher").Set "ON"
        End If
        If .WebEdit("ReviewSubmit_approvalJustification").Exist(nminwait) Then
            .WebEdit("ReviewSubmit_approvalJustification").Set SupplierID&" "&now
        End If
        If .WebEdit("ReviewSubmit_RequisitionComments").Exist(nminwait) Then
            .WebEdit("ReviewSubmit_RequisitionComments").Set SupplierID&" "&now
        End If
        If .WebButton("Save for Later").Exist(nminwait) Then
            .WebButton("Save for Later").Click
            WriteToReport micPass,"Save for Later "," Save for Later is present and clicked",false
            else:WriteToReport micfail,"Save for Later "," Save for Later isn't present ",true
        End If
        
        app_searchSync()
        
        If .Link("PreviewApprovals").Exist(nminwait) Then
            .Link("PreviewApprovals").Click
            WriteToReport micPass,"PreviewApprovals "," PreviewApprovals is present and clicked",false
            else:WriteToReport micfail,"PreviewApprovals"," PreviewApprovals isn't present ",true
        End If
        
    End With
        wait(3):app_searchSync()
        wait(3):app_searchSync()
        
Dim ApproverList,RequesitionID
        ApproverList=ep_captureApproverNames(Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals"))
        
        If IsArray(ApproverList) Then
            For k = 0 To Ubound(ApproverList) Step 1
                GlobalDictionary("user"&k+1)=ApproverList(k)
            Next
            GlobalDictionary("TotalUsers")=UBound(ApproverList)+2
        End If
        With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")
            If .WebElement("Preview_Status").Exist(nminwait) Then
                WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("Preview_Status").GetROProperty("innertext") ,false
            End If
            If .WebElement("eProApproval_CATapproval").Exist(nminwait) Then
                WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("eProApproval_CATapproval").GetROProperty("innertext") ,false
            End If
            If .WebElement("eProApproval_ACCTapproval").Exist(nminwait) Then
                WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("eProApproval_ACCTapproval").GetROProperty("innertext") ,false
            End If
            If .WebButton("Return").Exist(nminwait) Then
                .WebButton("Return").Click
            End If
        End With
                
        app_searchsync()
        
        

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
        If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
            RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
            WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
        End If
        If .WebButton("Save & submit").Exist(nminwait) Then
            .WebButton("Save & submit").Click
            WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
        End If
End With
    
    With Browser("PeopleSoft Browser").Page("Requisition")
        If .WebElement("Message").Exist(nminwait) Then
            WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
        End If
        If .WebButton("OK").Exist(nminwait) Then
            .WebButton("OK").Click
        End If
    End With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
    If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
        WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
    End If
    If .WebElement("Confirmation_status").Exist(nminwait) Then
        WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
    End If
    If .WebTable("eProApproval").Exist(nminwait) Then
        WriteToReport micPass,"Satus of eProcurement Approval "," Status is "&Replace(Replace(Replace(Replace(Trim(.WebTable("eProApproval").GetROProperty("innertext")),"View/Hide Comments",""),"Start New Path",""),"Comment History",""),"Comments","") ,false
    End If
End With

GlobalDictionary("ReqUser")=GlobalDictionary("SignInUser")
GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
    'signin as admin to get userids
    UserSignIn
    
    'PeopleTools>Security>User Profiles>User Profiles
'    SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
    
    'retrieve user id
    retrieveUserID()
    
    For l = 0 To Ubound(ApproverList) Step 1
        GlobalDictionary("SignInUser")=GlobalDictionary("userID" & l+1)
        
        'signin as admin to get userids
        UserSignIn
        
        'WorkList>WorkList
        SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
        
        If Not ep_approveRequisitionWorklist(Trim(RequesitionID)) Then
            WriteToReport micfail,"Requsition doesn't get approved","Requsition does't approved by approver "&GlobalDictionary("userID" & l),false
            Exit for
        End If
        If Ubound(ApproverList)>l Then
        
            GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
            
            'signin as admin to get userids
            UserSignIn
            
            'WorkList>WorkList
            SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
            call ep_ApproveinMonitorApprovals(RequesitionID,GlobalDictionary("ApprovalProcess"),GlobalDictionary("DefinitionID"),GlobalDictionary("HeaderStatus"),GlobalDictionary("ReqUser"),"")
            Exit for
        End If
        
    Next
End Function


'*********************************************************************************************************************************
''' <summary>  
''' ep_approveRequisitionWorklist()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
Public Function ep_approveRequisitionWorklist(ReqID)

With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	appDate=.GetCellData(2,2)
	k=0
	invoiceDate=CDate(date)
	While instr(1,CDate(appDate),invoiceDate)=0 and k<10
  		Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable").ChildItem(1,2,"Link",0).Click
  		wait(1)
  		appDate=Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable").GetCellData(2,2)
  		k=k+1
   	Wend
End If
End  With 


'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
	'appFrom=.GetCellData(i,1)
	'If instr(1,appFrom,dtFromName )>0 Then
		appDate=.GetCellData(i,2)
		vouNo=.GetCellData(i,6)
'		instr(1,CDate(appDate),GlobalDictionary("invoiceDate"))
		If instr(1,vouNo,ReqID) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	Next
End If
End  With 
wait(3)
	With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Requisition Approval")
		If .WebEdit("Approver Comments").Exist(nminwait) Then
			.WebEdit("Approver Comments").Set GlobalDictionary("SigninUser")&" is approved "&now
			WriteToReport micPass,"Approver comments"," Entered approved comments as "&GlobalDictionary("SigninUser")&" is approved "&now,false
		End If
		If .WebButton("Approve").Exist(nminwait) Then
			.WebButton("Approve").Click
			WriteToReport micPass,"Approve button","Approve button is present and clicked",false
			else:WriteToReport micfail,"Approve button","Approve button isn't present ",true
		End If
		wait(3)
		
	End With

	With Browser("PeopleSoft Browser").Page("Worklist")
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End With
Dim flag:flag=false
	With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Requisition Approval")
		If .WebElement("Confirmation Status").Exist(nminwait) Then
			flag=true:WriteToReport micPass,"Approval confirmation message displayed"," approval confirmation message displayed and as "&.WebElement("Confirmation Status").GetROProperty("innertext"),false
			else:WriteToReport micfail,"Approval confirmation message doesn't displayed"," approval confirmation message isn't displayed",true
		End If
	End With
ep_approveRequisitionWorklist=flag
End Function


'*********************************************************************************************************************************
''' <summary>  
''' requisitionEntrySpecialCharinCommentsandApprove()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

Public Function requisitionEntrySpecialCharinCommentsandApprove()
Dim i
	'Navigate to below page "eProcurement > Requisition"
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests").Click
		WriteToReport micPass,"Special Requests link "," Special Requests field is present and clicked",false
	else
		WriteToReport micfail,"Special Requests link "," Special Requests field isn't present",true
	End If
	app_searchsync()

	businessunit=GlobalDictionary("businessunit")
	Price=GlobalDictionary("Price")
	Qty=GlobalDictionary("Qty")
	UOM=GlobalDictionary("UOM")
	Category=GlobalDictionary("Category")
	SupplierID=GlobalDictionary("SupplierID")
	call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)
	WriteToReport micPass,"Requsistion 1"," Requesition 1 added to the cart successfully",false
	
	
	If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout").Click
		WriteToReport micPass,"Checkout button "," Checkout is present and clicked",false
	else
		WriteToReport micfail,"Checkout button "," Checkout field isn't present",true
	End If
	app_SearchSync()
	WriteToReport micDone,"chartfield2 for line 1"," adding chartfield2 details",false
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .Image("Expand Section").Exist(nminwait) Then
			.Image("Expand Section").Click
		End If
		If .Image("Expand section Accounting").Exist(nminwait) Then
			.Image("Expand section Accounting").Click
		End If
		If .WebElement("Chartfields2_Tab").Exist(nminwait) Then
			.WebElement("Chartfields2_Tab").Click
			WriteToReport micPass,"Checkout button "," Checkout is present and clicked",false
			else
			WriteToReport micfail,"Checkout button "," Checkout field isn't present",true
		End If
		If .WebEdit("Chartfields2_DeptID").Exist(nminwait) Then
			.WebEdit("Chartfields2_DeptID").Set GlobalDictionary("Dept1")
			WriteToReport micPass,"Dept in chartfield2"," Dept is present and entered as"&GlobalDictionary("Dept1"),false
		else
			WriteToReport micfail,"Dept in chartfield2 "," field isn't present",true
		End If
		If .WebEdit("Chartfields2_Account").Exist(nminwait) Then
			.WebEdit("Chartfields2_Account").Set GlobalDictionary("Account1")
			WriteToReport micPass,"Account in chartfield2"," Account is present and entered as"&GlobalDictionary("Account1"),false
		else
			WriteToReport micfail,"Account in chartfield2 "," field isn't present",true
		End If
		If .Image("Collapse Section").Exist(nminwait) Then
			.Image("Collapse Section").Click
		End If
		app_SearchSync()
		
		
		
		If .WebCheckBox("ReviewSubmit_SendtoSupplier").Exist(nminwait) Then
			.WebCheckBox("ReviewSubmit_SendtoSupplier").Set"ON"
		End If
		
		If .WebCheckBox("ReviewSubmit_ShowAtReceipt").Exist(nminwait) Then
			.WebCheckBox("ReviewSubmit_ShowAtReceipt").Set "ON"
		End If
		If .WebCheckBox("ReviewSubmit_ShowatVoucher").Exist(nminwait) Then
			.WebCheckBox("ReviewSubmit_ShowatVoucher").Set "ON"
		End If
		If .WebEdit("ReviewSubmit_approvalJustification").Exist(nminwait) Then
			.WebEdit("ReviewSubmit_approvalJustification").Set GlobalDictionary("ApprovalJustfication")
			WriteToReport micPass,"approval Justification"," approval Justification is present and entered as"&GlobalDictionary("ApprovalJustfication"),false
		else
			WriteToReport micfail,"approval Justification"," approval Justificationfield isn't present",true
		End If
		If .WebEdit("ReviewSubmit_RequisitionComments").Exist(nminwait) Then
			.WebEdit("ReviewSubmit_RequisitionComments").Set GlobalDictionary("ReqComments")
			WriteToReport micPass,"Requisition Comments"," Requisition Comments is present and entered as"&GlobalDictionary("ReqComments"),false
		else
			WriteToReport micfail,"Requisition Comments"," Requisition Comments field isn't present",true
		End If
		If .WebButton("Save for Later").Exist(nminwait) Then
			.WebButton("Save for Later").Click
			WriteToReport micPass,"Save for Later "," Save for Later is present and clicked",false
			else:WriteToReport micfail,"Save for Later "," Save for Later isn't present ",true
		End If
	end with	
		app_searchSync()
	With Browser("PeopleSoft Browser").Page("Requisition")
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Error message displayed"," Expected error message is displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End With
	Set regExpa=New RegExp
	regExpa.global=true:regExpa.Ignorecase=true:regExpa.pattern="\W"
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")	
		If .WebEdit("ReviewSubmit_approvalJustification").Exist(nminwait) Then
			.WebEdit("ReviewSubmit_approvalJustification").Set regExpa.replace(GlobalDictionary("ApprovalJustfication"),"")
			WriteToReport micPass,"approval Justification"," approval Justification is present and entered as"&regExpa.replace(GlobalDictionary("ApprovalJustfication"),""),false
		else
			WriteToReport micfail,"approval Justification"," approval Justificationfield isn't present",true
		End If
		If .WebEdit("ReviewSubmit_RequisitionComments").Exist(nminwait) Then
			.WebEdit("ReviewSubmit_RequisitionComments").Set regExpa.replace(GlobalDictionary("ReqComments"),"")
			WriteToReport micPass,"Requisition Comments"," Requisition Comments is present and entered as"&regExpa.replace(GlobalDictionary("ReqComments"),""),false
		else
			WriteToReport micfail,"Requisition Comments"," Requisition Comments field isn't present",true
		End If
		If .WebButton("Save for Later").Exist(nminwait) Then
			.WebButton("Save for Later").Click
			WriteToReport micPass,"Save for Later "," Save for Later is present and clicked",false
			else:WriteToReport micfail,"Save for Later "," Save for Later isn't present ",true
		End If
		app_searchSync()
		If .Link("PreviewApprovals").Exist(nminwait) Then
			.Link("PreviewApprovals").Click
			WriteToReport micPass,"PreviewApprovals "," PreviewApprovals is present and clicked",false
			else:WriteToReport micfail,"PreviewApprovals"," PreviewApprovals isn't present ",true
		End If
		
	End With
		wait(3):app_searchSync()
		
Dim ApproverList,RequesitionID
		ApproverList=ep_captureApproverNames(Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals"))
		
		If IsArray(ApproverList) Then
			For k = 0 To Ubound(ApproverList) Step 1
				GlobalDictionary("user"&k+1)=ApproverList(k)
			Next
			GlobalDictionary("TotalUsers")=UBound(ApproverList)+2
		End If
		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")
			If .WebElement("Preview_Status").Exist(nminwait) Then
				WriteToReport micPass,"Satus of requsition in Preview approval"," Status is displayed as "&.WebElement("Preview_Status").GetROProperty("innertext") ,false
			End If
			If .WebButton("Return").Exist(nminwait) Then
				.WebButton("Return").Click
			End If
		End With
				
		app_searchsync()
		
		

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
			RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
			WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
		End If
		If .WebButton("Save & submit").Exist(nminwait) Then
			.WebButton("Save & submit").Click
			WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
		End If
End With
	
	With Browser("PeopleSoft Browser").Page("Requisition")
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
	If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
		WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
	End If
	If .WebElement("Confirmation_status").Exist(nminwait) Then
		WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
	End If
End With

GlobalDictionary("ReqUser")=GlobalDictionary("SignInUser")
GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
	'signin as admin to get userids
	UserSignIn
	
	'PeopleTools>Security>User Profiles>User Profiles
'	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	
	'retrieve user id
	retrieveUserID()
	
	For l = 0 To Ubound(ApproverList) Step 1
		WriteToReport micpass,"Email user & Worklist user field updated","Email user & worklist user field is updated for "&GlobalDictionary("userID" & l+1),false
		'update email user
		call ep_updateasEmailUser(GlobalDictionary("userID" & l+1),"ON","do")
	next
	
	For l = 0 To Ubound(ApproverList) Step 1
		GlobalDictionary("SignInUser")=GlobalDictionary("userID" & l+1)
		
		'signin as admin to get userids
		UserSignIn
		
		'WorkList>WorkList
		SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
		
		If Not ep_approveRequisitionWorklist(Trim(RequesitionID)) Then
			WriteToReport micfail,"Requsition doesn't get approved","Requsition does't approved by approver "&GlobalDictionary("userID" & l),false
			Exit for
		End If
'		If Ubound(ApproverList)>l Then
'		
'			GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
'			
'			'signin as admin to get userids
'			UserSignIn
'			
'			'WorkList>WorkList
'			SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
'			call ep_ApproveinMonitorApprovals(RequesitionID,GlobalDictionary("ApprovalProcess"),GlobalDictionary("DefinitionID"),GlobalDictionary("HeaderStatus"),GlobalDictionary("ReqUser"),"")
'			Exit for
'		End If
		
	Next
	
	GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
	'signin as admin to get userids
	UserSignIn
	
	'PeopleTools>Security>User Profiles>User Profiles
	SelectMainMenu1(GlobalDictionary("UserProfileSelection"))
		
	For l = 0 To Ubound(ApproverList) Step 1
		'update email user
		call ep_updateasEmailUser(GlobalDictionary("userID" & l+1),"OFF","do")
	next
End Function

'*********************************************************************************************************************************
''' <summary>  
''' CreateRequisitionByemplateApprovethroughEmail()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

Public Function CreateRequisitionByemplateApprovethroughEmail()
Dim i
	'Navigate to below page "eProcurement > Requisition"
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
'	If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests").Exist(nminwait) Then
'		Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests").Click
'		WriteToReport micPass,"Special Requests link "," Special Requests field is present and clicked",false
'	else
'		WriteToReport micfail,"Special Requests link "," Special Requests field isn't present",true
'	End If
'	app_searchsync()
'
	businessunit=GlobalDictionary("businessunit")
	Price=GlobalDictionary("Price")
	Qty=GlobalDictionary("Qty")
	UOM=GlobalDictionary("UOM")
	Category=GlobalDictionary("Category")
	SupplierID=GlobalDictionary("SupplierID")
'	call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)
'	WriteToReport micPass,"Requsistion 1"," Requesition 1 added to the cart successfully",false
	
	If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Templates").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Templates").Click
		WriteToReport micPass,"Templates link "," Templates field is present and clicked",false
	else
		WriteToReport micfail,"Templates link "," Templates field isn't present",true
	End If
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Templates").WebButton("Add").Exist(nminwait) Then
		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Templates")
			If .WebEdit("Qty").Exist(nminwait) Then
				.WebEdit("Qty").Set GlobalDictionary("Qty")*2
				WriteToReport micPass,"Qty field "," Qty field is present and entered"&GlobalDictionary("Qty")*2 ,false
			else
				WriteToReport micfail,"Qty field "," Qty field isn't present",true
			End If
			If .WebButton("Add").Exist(nminwait) Then
				.WebButton("Add").Click
				WriteToReport micPass,"add button "," Add field is present and clicked",false
			else
				WriteToReport micfail,"Add button "," Add field isn't present",true
			End If
			app_searchsync()
			If .WebElement("AddedToCart").Exist(nminwait) Then
				If .WebElement("TemplatesName").Exist(nminwait) Then
					WriteToReport micPass,"Templates name "," Templates field is present and added to cart "&.WebElement("TemplatesName").GetROProperty("innertext"),false
				else:WriteToReport micPass,"Templates name "," Templates field is present and added to cart ",false
				End If
			else
				WriteToReport micfail,"Templates name "," Templates field isn't present",true
			End If
		End With
	End If
	
	If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout").Click
		WriteToReport micPass,"Checkout button "," Checkout is present and clicked",false
	else
		WriteToReport micfail,"Checkout button "," Checkout field isn't present",true
	End If
	app_SearchSync()
	WriteToReport micDone,"chartfield2 for line 1"," adding chartfield2 details",false
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .Image("Expand Section").Exist(nminwait) Then
			.Image("Expand Section").Click
		End If
		If .Image("Expand section Accounting").Exist(nminwait) Then
			.Image("Expand section Accounting").Click
		End If
		If .WebElement("Chartfields2_Tab").Exist(nminwait) Then
			.WebElement("Chartfields2_Tab").Click
			WriteToReport micPass,"Checkout button "," Checkout is present and clicked",false
			else
			WriteToReport micfail,"Checkout button "," Checkout field isn't present",true
		End If
		If .WebEdit("Chartfields2_DeptID").Exist(nminwait) Then
			.WebEdit("Chartfields2_DeptID").Set GlobalDictionary("Dept1")
			WriteToReport micPass,"Dept in chartfield2"," Dept is present and entered as"&GlobalDictionary("Dept1"),false
		else
			WriteToReport micfail,"Dept in chartfield2 "," field isn't present",true
		End If
		If .WebEdit("Chartfields2_Account").Exist(nminwait) Then
			.WebEdit("Chartfields2_Account").Set GlobalDictionary("Account1")
			WriteToReport micPass,"Account in chartfield2"," Account is present and entered as"&GlobalDictionary("Account1"),false
		else
			WriteToReport micfail,"Account in chartfield2 "," field isn't present",true
		End If
		If .Image("Collapse Section").Exist(nminwait) Then
			.Image("Collapse Section").Click
		End If
		app_SearchSync()
		
		
		
		If .WebCheckBox("ReviewSubmit_SendtoSupplier").Exist(nminwait) Then
			.WebCheckBox("ReviewSubmit_SendtoSupplier").Set"ON"
		End If
		
		If .WebCheckBox("ReviewSubmit_ShowAtReceipt").Exist(nminwait) Then
			.WebCheckBox("ReviewSubmit_ShowAtReceipt").Set "ON"
		End If
		If .WebCheckBox("ReviewSubmit_ShowatVoucher").Exist(nminwait) Then
			.WebCheckBox("ReviewSubmit_ShowatVoucher").Set "ON"
		End If
'		If .WebEdit("ReviewSubmit_approvalJustification").Exist(nminwait) Then
'			.WebEdit("ReviewSubmit_approvalJustification").Set GlobalDictionary("ApprovalJustfication")&now
'			WriteToReport micPass,"approval Justification"," approval Justification is present and entered as"&GlobalDictionary("ApprovalJustfication")&now,false
'		else
'			WriteToReport micfail,"approval Justification"," approval Justificationfield isn't present",true
'		End If
'		If .WebEdit("ReviewSubmit_RequisitionComments").Exist(nminwait) Then
'			.WebEdit("ReviewSubmit_RequisitionComments").Set GlobalDictionary("ReqComments")&now
'			WriteToReport micPass,"Requisition Comments"," Requisition Comments is present and entered as"&GlobalDictionary("ReqComments")&now,false
'		else
'			WriteToReport micfail,"Requisition Comments"," Requisition Comments field isn't present",true
'		End If
'		If .WebButton("Save for Later").Exist(nminwait) Then
'			.WebButton("Save for Later").Click
'			WriteToReport micPass,"Save for Later "," Save for Later is present and clicked",false
'			else:WriteToReport micfail,"Save for Later "," Save for Later isn't present ",true
'		End If
	end with	
		app_searchSync()
'	With Browser("PeopleSoft Browser").Page("Requisition")
'		If .WebElement("Message").Exist(nminwait) Then
'			WriteToReport micPass,"Error message displayed"," Expected error message is displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
'		End If
'		If .WebButton("OK").Exist(nminwait) Then
'			.WebButton("OK").Click
'		End If
'	End With
	Set regExpa=New RegExp
	regExpa.global=true:regExpa.Ignorecase=true:regExpa.pattern="\W"
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")	
		If .WebEdit("ReviewSubmit_approvalJustification").Exist(nminwait) Then
			.WebEdit("ReviewSubmit_approvalJustification").Set regExpa.replace(GlobalDictionary("ApprovalJustfication"),"")
			WriteToReport micPass,"approval Justification"," approval Justification is present and entered as"&regExpa.replace(GlobalDictionary("ApprovalJustfication"),""),false
		else
			WriteToReport micfail,"approval Justification"," approval Justificationfield isn't present",true
		End If
		If .WebEdit("ReviewSubmit_RequisitionComments").Exist(nminwait) Then
			.WebEdit("ReviewSubmit_RequisitionComments").Set regExpa.replace(GlobalDictionary("ReqComments"),"")
			WriteToReport micPass,"Requisition Comments"," Requisition Comments is present and entered as"&regExpa.replace(GlobalDictionary("ReqComments"),""),false
		else
			WriteToReport micfail,"Requisition Comments"," Requisition Comments field isn't present",true
		End If
		If .WebButton("Save for Later").Exist(nminwait) Then
			.WebButton("Save for Later").Click
			WriteToReport micPass,"Save for Later "," Save for Later is present and clicked",false
			else:WriteToReport micfail,"Save for Later "," Save for Later isn't present ",true
		End If
		app_searchSync()
		If .Link("PreviewApprovals").Exist(nminwait) Then
			.Link("PreviewApprovals").Click
			WriteToReport micPass,"PreviewApprovals "," PreviewApprovals is present and clicked",false
			else:WriteToReport micfail,"PreviewApprovals"," PreviewApprovals isn't present ",true
		End If
		
	End With
		wait(3):app_searchSync()
		
Dim ApproverList,RequesitionID
		ApproverList=ep_captureApproverNames(Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals"))
		
		If IsArray(ApproverList) Then
			For k = 0 To Ubound(ApproverList) Step 1
				GlobalDictionary("user"&k+1)=ApproverList(k)
			Next
			GlobalDictionary("TotalUsers")=UBound(ApproverList)+2
		End If
		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")
			If .WebElement("Preview_Status").Exist(nminwait) Then
				WriteToReport micPass,"Satus of requsition in Preview approval"," Status is displayed as "&.WebElement("Preview_Status").GetROProperty("innertext") ,false
			End If
			If .WebButton("Return").Exist(nminwait) Then
				.WebButton("Return").Click
			End If
		End With
				
		app_searchsync()
		
		

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
			RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
			WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
		End If
		If .WebButton("Save & submit").Exist(nminwait) Then
			.WebButton("Save & submit").Click
			WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
		End If
End With
	
	With Browser("PeopleSoft Browser").Page("Requisition")
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
	If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
		WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
	End If
	If .WebElement("Confirmation_status").Exist(nminwait) Then
		WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
	End If
End With

GlobalDictionary("ReqUser")=GlobalDictionary("SignInUser")
GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
	'signin as admin to get userids
	UserSignIn
	
	'PeopleTools>Security>User Profiles>User Profiles
'	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	
	'retrieve user id
	retrieveUserID()
	
	For l = 0 To Ubound(ApproverList) Step 1
		WriteToReport micpass,"Email user & Worklist user field updated","Email user & worklist user field is updated for "&GlobalDictionary("userID" & l+1),false
		'update email user
		call ep_updateasEmailUser(GlobalDictionary("userID" & l+1),"ON","do")
	next
	
	For l = 0 To Ubound(ApproverList) Step 1
		GlobalDictionary("SignInUser")=GlobalDictionary("userID" & l+1)
		
		'signin as admin to get userids
		UserSignIn
		
		'WorkList>WorkList
		SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
		
		If Not ep_approveRequisitionWorklist(Trim(RequesitionID)) Then
			WriteToReport micfail,"Requsition doesn't get approved","Requsition does't approved by approver "&GlobalDictionary("userID" & l),false
			Exit for
		End If
'		If Ubound(ApproverList)>l Then
'		
'			GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
'			
'			'signin as admin to get userids
'			UserSignIn
'			
'			'WorkList>WorkList
'			SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
'			call ep_ApproveinMonitorApprovals(RequesitionID,GlobalDictionary("ApprovalProcess"),GlobalDictionary("DefinitionID"),GlobalDictionary("HeaderStatus"),GlobalDictionary("ReqUser"),"")
'			Exit for
'		End If
		
	Next
	
	GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
	'signin as admin to get userids
	UserSignIn
	
	'PeopleTools>Security>User Profiles>User Profiles
	SelectMainMenu1(GlobalDictionary("UserProfileSelection"))
		
	For l = 0 To Ubound(ApproverList) Step 1
		'update email user
		call ep_updateasEmailUser(GlobalDictionary("userID" & l+1),"OFF","do")
	next
End Function


'*********************************************************************************************************************************
''' <summary>  
''' ep_updateasEmailUser()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "userID,EmailUser,Worklistuser"</note> 
''' </para>"User ID: id of the user",Emailuser - 'ON' if user needs email acess otherwise put 'OFF" ,Worklistuser - 'ON' if user needs Worklist acess otherwise put 'OFF" 
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

Public Function ep_updateasEmailUser(userID,EmailUser,Worklistuser)
	WriteToReport micPass,"Updating the Email user and Worklist user field"," Updating the email user and worklist user field for "&userID,false
	With Browser("PeopleSoft Browser").Page("UserProfiles_Security").PSFrame("UserProfile")
		If .WebList("SearchBy").Exist(nminwait) Then
			.WebList("SearchBy").Select("User ID")
		End If
		If .WebEdit("SearchText").Exist(nminwait) Then
			.WebEdit("SearchText").Set userID
			WriteToReport micPass,"userID"," userID is present and entered as"&userID,false
		else
			WriteToReport micfail,"userID"," userID field isn't present",true
		End If
		If .WebButton("Search").Exist(nminwait) Then
			.WebButton("Search").Click
			WriteToReport micPass,"Search"," Search is present and clicked",false
		else
			WriteToReport micfail,"Search"," Search field isn't present",true
		End If
		If .WebElement("WorkFlowTab").Exist(nminwait) Then
			.WebElement("WorkFlowTab").Click
		End If
		If .WebCheckBox("WorklistUser").Exist(nminwait) AND( (Instr(1,Worklistuser,"yes",1)) OR (Instr(1,Worklistuser,"on",1))) Then
			.WebCheckBox("WorklistUser").Set "ON"
			WriteToReport micPass,"WorklistUser"," WorklistUser is present and checked ON",false
		ElseIf .WebCheckBox("WorklistUser").Exist(nminwait) AND( (Instr(1,Worklistuser,"no",1)) OR (Instr(1,Worklistuser,"off",1))) Then
			.WebCheckBox("WorklistUser").Set "OFF"
			WriteToReport micPass,"WorklistUser"," WorklistUser is present and unchecked OFF",false
		ElseIf .WebCheckBox("WorklistUser").Exist(nminwait) Then
			WriteToReport micPass,"WorklistUser"," WorklistUser is present and doesn't make any changes",false
		else
			WriteToReport micfail,"WorklistUser"," WorklistUser field isn't present",true
		End If
		If .WebCheckBox("EmailUser").Exist(nminwait) AND( (Instr(1,EmailUser,"yes",1)) OR (Instr(1,EmailUser,"on",1))) Then
			.WebCheckBox("EmailUser").Set "ON"
			WriteToReport micPass,"EmailUser"," EmailUser is present and checked ON",false
		ElseIf .WebCheckBox("EmailUser").Exist(nminwait) AND( (Instr(1,EmailUser,"no",1)) OR (Instr(1,EmailUser,"off",1))) Then
			.WebCheckBox("EmailUser").Set "OFF"
			WriteToReport micPass,"EmailUser"," EmailUser is present and unchecked OFF",false
		elseIf .WebCheckBox("EmailUser").Exist(nminwait) Then
			WriteToReport micPass,"EmailUser"," EmailUser is present and doesn't make any changes",false
		else
			WriteToReport micfail,"EmailUser"," EmailUser field isn't present",true
		End If
		
		app_searchsync()
		
		If .WebButton("Save").Exist(nminwait) Then
			.WebButton("Save").Click
			WriteToReport micPass,"Save "," save button is present and clicked",false
		else
			WriteToReport micfail,"Save button"," Save button field isn't present",true
		End If
		
		app_searchsync()
		WriteToReport micPass,"Updated the Email user and Worklist user field"," Updated  email user and worklist user field successfully for "&userID,false
		If .WebButton("Return to Search").Exist(nminwait) Then
			.WebButton("Return to Search").Click
			WriteToReport micPass,"Return to Search "," Return to Search button is present and clicked",false
		else
			WriteToReport micfail,"Return to Search button"," Save button field isn't present",true
		End If
		app_searchsync()
	End With
End Function

'*********************************************************************************************************************************
''' <summary>  
''' RequisitionSettings 
'''Parameter1:	None.
''' <para>
''' <note></note> 
''' </para>
''' </summary>
''' <author>Vijayakumar N</author>
''' <datecreated>3/6/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'eP_'RequisitionSettings 
Public Function RequisitionSettings()

dtBusinessUnit=GlobalDictionary("Setting_BusinessUnit")
dtRequestor = GlobalDictionary("Setting_Requestor")
dtRequisitionName = GlobalDictionary("Setting_RequisitionName")
dtDefaultOption =GlobalDictionary("Setting_DefaultOption")
dtSupplier =GlobalDictionary("Setting_Supplier")
dtCatagory =GlobalDictionary("Setting_Catagory")
dtUOM =GlobalDictionary("Setting_UOM")
dtShipTo =GlobalDictionary("Setting_ShipTo")
dtDueDate =GlobalDictionary("Setting_DueDate")
dtGLUnit =GlobalDictionary("Setting_GLUnit")
dtAccount =GlobalDictionary("Setting_Account")
dtDept =GlobalDictionary("Setting_Dept")
dtPCBusUnit =GlobalDictionary("Setting_PCBusUnit")


With Browser("PeopleSoft Browser").Page("Requisition")

		If .PSFrame("ePro Requisitions").Link("Requisition Settings").Exist(nminwait) Then
 			.PSFrame("ePro Requisitions").Link("Requisition Settings").Click
			Reporter.ReportEvent micPass,"Requisition Settings Page "," Requisition Settings Page displayed successfully"
		Else
			Reporter.ReportEvent micFail,"Requisition Settings Page "," Requisition Settings Page is not displayed "
		End If
		
		If .WebElement("Requisition Settings Title").Exist(nminwait) Then
		Reporter.ReportEvent micPass,"Requisition Settings Page "," Requisition Settings Page displayed successfully"
		End If
End With

app_SearchSync

With Browser("PeopleSoft Browser").Page("Requisition")
	If Not(IsEmpty(dtBusinessUnit))Then
		If .PSFrame("Requisition Settings").WebButton("Business Unit Icon").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebButton("Business Unit Icon").Click
			Reporter.ReportEvent micPass,"Business Unit Icon "," Business Unit icon is present and Clicked"
			Else
			Reporter.ReportEvent micFail,"Business Unit Icon "," Business Unit icon is not displayed "
		End If
		
		'Wait for the application to sync
 		app_SearchSync()
		
		'Set the Business Unit
		If .PSFrame("Requisition Business Unit").WebEdit("Business Unit").Exist(nminwait) Then
			.PSFrame("Requisition Business Unit").WebEdit("Business Unit").Set  dtBusinessUnit
		  	Reporter.ReportEvent micPass,"Business Unit Field  "," Business Unit field is present and entered as"&qty
		  	Else
			Reporter.ReportEvent micFail,"Business Unit  Field"," Business Unit field is not displayed "
		End If
			
		If .PSFrame("Requisition Business Unit").WebButton("Ok").Exist(nminwait) Then
		  	.PSFrame("Requisition Business Unit").WebButton("Ok").Click
		  	Reporter.ReportEvent micPass,"Business Unit Ok button "," Business Unit Ok button is present and clicked"
		  	Else
			Reporter.ReportEvent micFail,"Business Unit Ok button "," Business Unit Ok button is not displayed "
		End If
			
		'Wait for the application to sync
 		app_SearchSync()
 		If .PSFrame("ePro Requisitions").Link("Requisition Settings").Exist(nminwait) Then
 			.PSFrame("ePro Requisitions").Link("Requisition Settings").Click
			Reporter.ReportEvent micPass,"Requisition Settings Page "," Requisition Settings Page displayed successfully"
			Else
			Reporter.ReportEvent micFail,"Requisition Settings Page "," Requisition Settings Page is not displayed "
		End If
 	End If
 			

 	'Set  Requestor
 	If Not(IsEmpty(dtRequestor))Then
 		If .PSFrame("Requisition Settings").WebEdit("Requestor").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebEdit("Requestor").Set dtRequestor
			Reporter.ReportEvent micPass,"Requestor "," Requestor is present and entered as"&dtRequestor
			Else
			Reporter.ReportEvent micFail,"Requestor "," Requestor field is not displayed "
		End If
	End If
		
	'Set  Requisition Name
 	If Not(IsEmpty(dtRequisitionName))Then
 		If .PSFrame("Requisition Settings").WebEdit("Requisition Name").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebEdit("Requisition Name").Set dtRequisitionName
			Reporter.ReportEvent micPass,"Requisition Name "," Requisition Name is present and entered as"&dtRequestor
			Else
			Reporter.ReportEvent micFail,"Requisition Name "," Requisition Name is not displayed "
		End If
	End If
		
	'Set  Default Option 
 	If Not(IsEmpty(dtDefaultOption))Then
 		If(dtDefaultOption="Default") Then
 			If .PSFrame("Requisition Settings").WebRadioGroup("DefaultOption_Default").Exist(nminwait) Then
				.PSFrame("Requisition Settings").WebRadioGroup("DefaultOption_Default").Select ("D")
			Else
			Reporter.ReportEvent micFail,"DefaultOption  "," DefaultOption  is not displayed "
			End If
		ElseIf(dtDefaultOption="Override") Then
			If .PSFrame("Requisition Settings").WebRadioGroup("DefaultOption_Override").Exist(nminwait) Then
				.PSFrame("Requisition Settings").WebRadioGroup("DefaultOption_Override").Select("O")
			Else
			Reporter.ReportEvent micFail,"DefaultOption  "," DefaultOption  is not displayed "
			End If
		End  If
 		Reporter.ReportEvent micPass,"DefaultOption "," DefaultOption is present and the option is"&dtDefaultOption 
 	End If
 		
 	'set Line Default
 	'set Supplier 
 	If Not(IsEmpty(dtSupplier))Then
 		If .PSFrame("Requisition Settings").WebEdit("Supplier").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebEdit("Supplier").Set dtSupplier
			Reporter.ReportEvent micPass,"Supplier Field "," Supplier Field is present and entered as"&dtSupplier
			Else
			Reporter.ReportEvent micFail,"Supplier Field "," Supplier Field is not displayed "
		End If
	End If
		
	'set Catagory 
 	If Not(IsEmpty(dtCatagory))Then
 		If .PSFrame("Requisition Settings").WebEdit("Catagory").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebEdit("Catagory").Set dtCatagory
			Reporter.ReportEvent micPass,"Catagory Field"," Catagory is present and entered as"&dtCatagory
			Else
			Reporter.ReportEvent micFail,"Catagory Field "," Catagory Field is not displayed "
		End If
	End If
		
	'set UOM 
 	If Not(IsEmpty(dtUOM))Then
 		If .PSFrame("Requisition Settings").WebEdit("UOM").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebEdit("UOM").Set dtUOM
			Reporter.ReportEvent micPass,"UOM Field "," UOM is present and entered as"&dtUOM
			Else
			Reporter.ReportEvent micFail,"UOM Field "," UOM Field is not displayed "
		End If
	End If
		
	'set ShipTo
 	If Not(IsEmpty(dtShipTo))Then
 		If .PSFrame("Requisition Settings").WebEdit("ShipTo").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebEdit("ShipTo").Set dtShipTo
			Reporter.ReportEvent micPass,"ShipTo Field "," ShipTo is present and entered as"&dtShipTo
			Else
			Reporter.ReportEvent micFail,"ShipTo Field"," ShipTo Field is not displayed "
		End If
	End If
		
	'set DueDate
 	If Not(IsEmpty(dtDueDate))Then
 		If .PSFrame("Requisition Settings").WebEdit("DueDate").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebEdit("DueDate").Set dtDueDate
			Reporter.ReportEvent micPass,"DueDate Field "," DueDate is present and entered as"&dtDueDate
			Else
			Reporter.ReportEvent micFail,"DueDate Field "," DueDate Field is not displayed "
		End If
	End If
		
	'set GLUnit or Account
 	If Not(IsEmpty(dtGLUnit)) or Not(IsEmpty(dtAccount))Then
 		If .PSFrame("Requisition Settings").WebElement("ChartField1").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebElement("ChartField1").Click
		 	Reporter.ReportEvent micPass,"ChartField1 Tab "," ChartField1 button is present and clicked"
		 	Else
			Reporter.ReportEvent micFail,"ChartField1 Tab "," ChartField1 Tab is not displayed "
		End If
 			
 		If Not(IsEmpty(dtGLUnit))Then
 			If .PSFrame("Requisition Settings").WebEdit("GLUnit").Exist(nminwait) Then
				.PSFrame("Requisition Settings").WebEdit("GLUnit").Set dtGLUnit
				Reporter.ReportEvent micPass,"GLUnit Field "," GLUnit is present and entered as"&dtGLUnit
				Else
				Reporter.ReportEvent micFail,"GLUnit Field "," GLUnit Field is not displayed "
			End If
		End If
			
		If Not(IsEmpty(dtAccount))Then
 			If .PSFrame("Requisition Settings").WebEdit("Account").Exist(nminwait) Then
				.PSFrame("Requisition Settings").WebEdit("Account").Set dtAccount
				Reporter.ReportEvent micPass,"Account Field"," Account Field is present and entered as"&dtAccount
				Else
			Reporter.ReportEvent micFail,"Account Field ","Account Field is not displayed "
			End If
		End If
			
	End If
 			
 			
 	'set Dept
 	If Not(IsEmpty(dtDept))Then
 		If .PSFrame("Requisition Settings").WebElement("ChartField2").Exist(nminwait) Then
		 	.PSFrame("Requisition Settings").WebElement("ChartField2").Click
		  	Reporter.ReportEvent micPass,"ChartField2 Tab "," ChartField2 Tab button is present and clicked"
		  	Else
			Reporter.ReportEvent micFail,"ChartField2 Tab "," ChartField2 Tab is not displayed "
		End If
			
		Wait (1)
			
		If .PSFrame("Requisition Settings").WebEdit("Dept").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebEdit("Dept").Set dtDept
			Reporter.ReportEvent micPass,"Dept Field"," Dept Field is present and entered as"&dtDept
			Else
			Reporter.ReportEvent micFail,"Dept Field"," Dept Field is not displayed "
		End If
	End If
		
	'set PC Bus Unit
 	If Not(IsEmpty(dtPCBusUnit))Then
 		If .PSFrame("Requisition Settings").WebElement("ChartField3").Exist(nminwait) Then
	  		.PSFrame("Requisition Settings").WebElement("ChartField3").Click
	  		Reporter.ReportEvent micPass,"ChartField3 Tab","ChartField3 Tab is present and clicked"
	  		Else
			Reporter.ReportEvent micFail,"ChartField3 Tab "," ChartField3 Tab is not displayed "
		End If
			
		Wait (1)
			
		If .PSFrame("Requisition Settings").WebEdit("PC Bus Unit").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebEdit("PC Bus Unit").Set dtPCBusUnit
			Reporter.ReportEvent micPass,"PC Bus Unit  Field"," PC Bus Unit  Field is present and entered as"&dtPCBusUnit
			Else
			Reporter.ReportEvent micFail,"PC Bus Unit  Field "," PC Bus Unit  Field is not displayed "
		End If
			
	End If
		
	'Click on Ok Button
	If .PSFrame("Requisition Settings").WebButton("Ok").Exist(nminwait) Then
		.PSFrame("Requisition Settings").WebButton("Ok").Click
	  	Reporter.ReportEvent micPass,"Ok Button "," Ok button is present and clicked"
	  	Else
			Reporter.ReportEvent micFail,"Ok Button ","Ok Button is not displayed "
	End If
	
	'Wait for the application to sync
 	app_SearchSync()
 End With 

End Function

'************************************************************************************************************************************

Public Function ManageRequisitionAprroverSearch()
'
dtBusinessUnit = GlobalDictionary("businessUnit")   'Enter if needed
dtStatus= GLobalDictionary("Status")        'ZEnter if needed (Approved, Denied, Pending, On hold, Push back)
dtRequisitionID=GlobalDictionary("RequisitionID")      'Enter if needed
dtDateFrom=GlobalDictionary("dateFrom")       'Enter if needed   (If not entered it will take current date -3 months)
dtRequestorName=GlobalDictionary("RequestorName")       'Enter if needed

'Set the Business Unit
If Not(IsEmpty(dtBusinessUnit)) Then
	With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").WebEdit("ManReqAppr_BusUnit")
       If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,"The Business Unit is present","an set with"&BusinessUnit,false)
	Else
	Call WriteToReport(micFail,"The Business Unit ","The Business Unit is not present",True)
End If
End  With
End If
 

'Set the Status
If Not(IsEmpty(dtStatus))  Then
	With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").WebList("ManReqAppr_Status")
       If .Exist(nMINWAIT) Then
	.Select dtStatus
	Call WriteToReport(micPass,"The Status is present","an set with"&dtStatus,false)
	Else
	Call WriteToReport(micFail,"The Status","The Status is not present",True)
End If
End  With 
End If

'Set the Requisitoin ID
If Not(IsEmpty(dtRequisitionID))  Then
	With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").WebEdit("ManReqAppr_RequisitoinID")
	If .Exist(nMINWAIT) Then
		.Set dtRequisitionID
		Call WriteToReport(micPass,"The Requisition id","an set with"&dtRequisitionID,false)
		Else
	Call WriteToReport(micFail,"The Requisition id","The Requisition id is not present",True)
	End If
	End  With 
End If

'ENter the Date from and adate to
appDateFrom=DateAdd("m","-3",Date)
With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").WebEdit("ManReqAppr_DateFrom")
If Not(IsEmpty(dtDateFrom))  Then	
       If .Exist(nMINWAIT) Then
	.Set dtDateFrom
	Call WriteToReport(micPass,"The DateFrom ","an set with"&dtDateFrom,false)
      End If
      Else
      If .Exist(nMINWAIT) Then
      	.Set appDateFrom
      	Call WriteToReport(micPass,"The DateFrom ","an set with"&appDateFrom,false)
      End If
End If
End  With 

'Ente the Requestor
If Not(IsEmpty(dtRequestorName))  Then
	With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").WebEdit("ManReqAppr_RequstorName")
	If .Exist(nMINWAIT) Then
		.Set dtRequestorName
		Call WriteToReport(micPass,"The RequestorName ","an set with"&dtRequestorName,false)
		Else
	Call WriteToReport(micFail,"The RequestorName Field","The RequestorName Field is not present",True)
	End If
	End  With 
End If

'CLick on Search button
With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").WebButton("ManReqAppr_Search")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The search button","is presen and clicked"
	Else
	Call WriteToReport(micFail,"The search button ","The search button is not present",True)
End If
End  With 

End Function

'***************************************************************************************

Public Function ManageRequisitionbyApproval()

'Navigate to Below path for manage requisiion page
'eProcurement >Manage Requisition Approvals

SelectMainMenu1(GlobalDictionary("ManageRequisitionApprovals"))

'wait for the ojects to get loaded
app_SearchSync()
	
'Enter all the mandatory fields in the manager req page and click on search button
'Before using the function enter all te values in data sheet
GlobalDictionary("Status")="Pending"
Call ManageRequisitionAprroverSearch()

'wait for the ojects to get loaded
For i=0 to 3
	app_SearchSync()
Next

With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").WebTable("ManReqAppr_SearchResults")
If Not .Exist(nMINWAIT) Then
	With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").WebButton("ManReqAppr_Search")
       If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The search button","is presen and clicked"
	Else
	Call WriteToReport(micFail,"The search button ","The search button is not present",True)
End If
End  With 
End If
End  WIth 

'Get the Requisitoin ID and select the status as Approved
changeStatus="Approve"
With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").WebTable("ManReqAppr_SearchResults")
If .Exist(nMINWAIT) Then
'	appRequisitionName=.GetCellData(5,5)
'	GlobalDictionary("appRequisitionName")=appRequisitionName
'	Set oReqID=.ChildItem(5,2,"Link",0)
'	If oReqID.exist(nMINWAIT) Then
'		appReqID=oReqID.getRoProperty("innertext")
'		GlobalDictionary("appRequisitionID")=appReqID
'	End If
	Set oWebList=.ChildItem(2,2,"WebList",0)
	If oWebList.exist(nMINWAIT) Then
		oWebList.select changeStatus
	End If
	Else
	Reporter.ReportEvent micFail,"No requisition is","getting displaeyd for the User"
End If
End  WIth 

'CLick on Submit buttponm
With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").WebButton("ManReqAppr_Submit")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The submit button is present","and clicked"
End If
End  WIth 

'wait for the ojects to get loaded
app_SearchSync()

'Captire the Message
With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("SubmitConfirmation").WebElement("SubConf_WarningMess")
If .Exist(nMINWAIT) Then
	appMessage=.GetROProperty("innertext")
	Reporter.ReportEvent micDone,"The warning message is","displaeyd"&appMessage
End If
End  With 

'Click on Ok button
With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("SubmitConfirmation").WebButton("SubConf_Ok")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The ok button","is present and clicekd"
End If
End With 

'wait for the ojects to get loaded
app_SearchSync()

'Search for the Requisiont Again
'GlobalDictionary("RequisitionID")=GlobalDictionary("appRequisitionID")
Call ManageRequisitionAprroverSearch()

'Check whetrher the Requisition ID is not present in the List
With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").WebTable("ManReqAppr_SearchResults")
If .Exist(nMINWAIT) Then
	Reporter.ReportEvent micFail,"The Requisition is not","yet removed from the list of Pending"
	Else
	Reporter.ReportEvent micPass,"Requisition is sucessfully","removed from the list of Pending"
	With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").WebElement("ManReq_NoResultsFound")
	If .Exist(nMINWAIT) Then
		appMess=.GetROProperty("innertext")
		Reporter.ReportEvent micPass,"Following message is displayed","upon sear4ch"&appMess
	End If
	End  With 
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

'Search for the Requisition with Approve status
'GlobalDictionary("RequisitionID")=GlobalDictionary("appRequisitionID")
GlobalDictionary("Status")="Approved"
Call ManageRequisitionAprroverSearch()

'Check whether the Requision is present
Set oObj=description.Create
oObj("html id").value="PV_APPR_USER_VW_REQ_ID.*"
oObj("html tag").value="A"

Set oLink=Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition").ChildObjects(oObj)
'If oLink.exist(nMINWAIT) Then
	'oLink.click
	'wait(10)
'End If
For i = 0 To oLink.Count-1
	appReqIdAfterApprove=oLink(i).getRoProperty("innertext")
	If appReqIdAfterApprove=GlobalDictionary("RequisitionID") Then
		Reporter.ReportEvent micPass,"The requisition ID","is present"
		oLink(i).click
		Exit For
	End If
Next


Set oObj=Nothing
Set oLink=Nothing

'wait for the ojects to get loaded
app_SearchSync()

'Set objFrame=Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("eProcurementApproval")
''Cehck fo4r ther approver
'ApproverNameList=ep_captureApproverNames(objFrame)
'
'GlobalDictionary("TotalUsers")=Ubound(ApproverNameList)
'For i=0 to  uBound(ApproverNameList)
'GlobalDictionary("user"&i)=ApproverNameList(i)
'Next
'
'Call retrieveUserID()

With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("eProcurementApproval").WebTable("eProAppr_ApprovalTable")
If .Exist(nMINWAIT) Then
	Reporter.ReportEvent micPass,"The approver is","approved"
End If
End  With 

With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("eProcurementApproval")
If .Exist(nMINWAIT) Then
	Set oImg=Description.Create
	oImg("alt").value="Approved"
	oImg("html tag").value="IMG"
	oImg("file name").value="PT_APP_APPROVE_ICN_1\.gif"
End If

Set oImgApproved=.ChildObjects(oImg)
count=oImgApproved.count

Reporter.ReportEvent micDone,"The total no of approver","approved is"&count
End  With 

End Function

'*************************************************************************************

Public Function CreateReqAndReqManApprove()
'Navigate to below path to create the requisition
Category=GlobalDictionary("Category")
Qty=GlobalDictionary("Qty")
UOM=GlobalDictionary("UOM")
SupplierID=GlobalDictionary("SupplierID")
price=GlobalDictionary("price")
dtChartfeild=GlobalDictionary("Account") 
dtDept=GlobalDictionary("Dept")

'Navigate to below navigation
'eProcurement > Requisition > Create Requisition
SelectMainMenu1(GlobalDictionary("CreateRequisition"))

'wait for the ojects to get loaded
app_SearchSync()

'Click on Special request
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micDone,"The special request","is present and clicked"
End If
End  With 

'Crteate the rewquisition
Call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)

'wait for the ojects to get loaded
app_SearchSync()

GlobalDictionary("AcctNo")=dtChartfeild
GlobalDictionary("DeptName")=dtDept

Call EditandSubmitRequitision()

'GlobalDictionary("TotalUsers")=Ubound(ApproverNames)
'For i=0 to  uBound(ApproverNames)
'GlobalDictionary("user"&i)=ApproverNames(i)
'Next
'
''Below function to reterive teh User ID fromt he Secutiry Profiles
''UserProfileSelection
'Call retrieveUserID()

GlobalDictionary("SignInUser")=GlobalDictionary("UserSecurityProfile")

End Function

Public Function FindTheUsersList()
ApproverNames=GlobalDIctionary("ApproverNames")
GlobalDictionary("TotalUsers")=Ubound(ApproverNames)+2
'GlobalDictionary("TotalUsersForApproval")=Ubound(ApproverNames)
For i=0 to  uBound(ApproverNames)
GlobalDictionary("user"&i+1)=ApproverNames(i)
Next

'Below function to reterive teh User ID fromt he Secutiry Profiles
'UserProfileSelection
Call retrieveUserID()

GlobalDictionary("SignInUser")=GlobalDictionary("userID1")

'Loging out of application
Call PSFinLogout()
		
End Function

Public Function ApprovingAllManageRequisition()
	For i=1 to GlobalDictionary("TotalUsers")-1
	
		'Logging to application
		Call UserSignIn()
		
		Call ManageRequisitionbyApproval()
		
		GlobalDictionary("SignInUser")=GlobalDictionary("userID"&i+1)
		
		'Loging out of application
		Call PSFinLogout()
			
	Next
End Function


'*******************************************************************************************************************************************

Public Function ManageRequisitionSearch(businessUnit, RequisitionID)

dtRequestor=GlobalDictionary("RequestorName") 
dtRequitionsName=GlobalDictionary("RequitionsName")
dtRequestState=GlobalDictionary("RequestState")
dtPOID=GlobalDictionary("POID")

'Set the Business Unit
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebEdit("ManReq_BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set businessUnit
	Call WriteToReport(micPass,"BUsiness unit is","is present and set with"&businessUnit,false)
End If
End  With 

'Set the Requistion ID
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebEdit("ManReq_RequisitionID")
If .Exist(nMINWAIT) Then
	.Set RequisitionID
	Call WriteToReport(micPass,"Requisition ID is","is present and set with"&RequisitionID,false)
End If
End  With 

'Set the Requestor ID if needed
If Not(IsEmpty(dtRequestor)) Then
	With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebEdit("ManReq_Requestor")
	If .Exist(nMINWAIT) Then
		.Set dtRequestor
		Call WriteToReport(micPass,"Requestor name  is","is present and set with"&dtRequestor,false)
	End If
	End  With 
End If

'Enter the requisiton name if needed
If Not(IsEmpty(dtRequitionsName)) Then
	With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebEdit("ManReq_RequisitionName")
	If .Exist(nMINWAIT) Then
		.Set dtRequitionsName
		Call WriteToReport(micPass,"Requisition name  is","is present and set with"&dtRequitionsName,false)
	End If
	End  With 
End  If

'Enter PO id if needed
If Not(IsEmpty(dtPOID)) Then
	With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebEdit("ManReq_POId")
	If .Exist(nMINWAIT) Then
		.Set dtPOID
		Call WriteToReport(micPass,"PO Id  is","is present and set with"&dtPOID,false)
	End If
	End  With
End If

'Click on Search button
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebButton("ManReq_Search")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Search button","is present and set with"&dtPOID,false)
End If
End  With 

End Function

'***********************************************************************************

Public Function ManageRequisitionActionGO(PerformAction)
RequisitionID=GlobalDictionary("RequisitionID")
EditRequisition = GlobalDictionary("EditRequisition")    'Give the value as Yes if we ned to edit the requistion further
'Enter the Dropdown based on the user needs
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebTable("ManReq_RequistionList")
'If .Exist(nMINWAIT) Then
	
	Set oLink=Description.Create
	oLink("MicClass").value="Link"
	oLink("class").value="PSHYPERLINK"
	oLink("html id").value="PV_REQ_SRCH_WRK_REQ_ID.*"
	Set oPOId=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").ChildObjects(oLink)
		appPOI=oPOId(0).getRoProperty("innertext")
		If instr(1,Trim(RequisitionID),Trim(appPOI))>0 Then
		Call WriteToReport(micPass,"The seach requisition ID","is present",False)
	End If
	'End If
	
	
	'If we need to edit the reqisition
	If Not(IsEmpty(EditRequisition)) Then
		Set oLink=.ChildItem(5,2,"Link",0)
		If oLink.exist(nMINWAIT) Then
			oLink.click
			Call WriteToReport(micPass,"The Requisition Link is ","is present and clicked",False)
			Exit Function
		End If
	End If
	
	'Perform the action
	Set oDropDown=Description.Create
	oDropDown("MicClass").value="WebList"
	oDropDown("class").value="PSDROPDOWNLIST"
	oDropDown("html id").value="PV_REQSTAT_WRK_PV_REQ_ACTION.*"
	
	Set oAction=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").ChildObjects(oDropDown)
	oAction(0).select PerformAction
	Call WriteToReport(micPass,"Action is present and  ","selected with "&PerformAction,False)
	
	Set oButton=Description.Create
	oButton("MicClass").value="WebButton"
	oButton("class").value="PSPUSHBUTTON"
	oButton("html id").value="PV_REQSTAT_WRK_PV_REQ_ACTION_PB.*"
	
	Set oGOButton=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").ChildObjects(oButton)
	oGOButton(0).click

End  With 

End Function

'*********************************************************************************************************************************
''' <summary>  
''' Create special Requisition 
'''Parameter1:	None.
''' <para>
''' <note></note> 
''' </para>
''' </summary>
''' <author>Vijayakumar N</author>
''' <datecreated>3/6/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'eP_'Copy Requisition
Public Function CreateSpecialReq
'Navigate to below path to create the requisition
Category=GlobalDictionary("Category")
Qty=GlobalDictionary("Qty")
UOM=GlobalDictionary("UOM")
SupplierID=GlobalDictionary("SupplierID")
price=GlobalDictionary("Price")
RequsitionFlag=GlobalDictionary("RequsitionFlag")
dtChartfeild=GlobalDictionary("Account") 
dtDept=GlobalDictionary("Dept")
dtActivity=GlobalDictionary("Activity")

dtComment=GlobalDictionary("Comment")



'Navigate to below navigation
'Main menu Navigation ePro > Requisition
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'wait for the ojects to get loaded
app_SearchSync()

Call RequisitionSettings()

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
	If .Link("Special Requests").Exist(nMINWAIT) Then
		.Link("Special Requests").Click
		Reporter.ReportEvent micPass,"Special Requests Link "," Special Requests Link is displayed and clicked "
	Else
		Reporter.ReportEvent micFail,"Special Requests Link "," Special Requests Link is not displayed "
	End If
End  With

'wait for the ojects to get loaded
app_SearchSync()

'Crteate the rewquisition
Call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)
'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
	If .WebButton("Checkout").Exist(nMINWAIT) Then
		.WebButton("Checkout").Click
		Reporter.ReportEvent micPass,"Checkout Button "," Checkout Button is displayed and clicked "
	Else
		Reporter.ReportEvent micFail,"Checkout Button "," Checkout Button is not displayed "
		
	End If
End  With

Filepath=GlobalDictionary("FilePath")
If Not(IsEmpty(Filepath))Then
 	
 	With Browser("PeopleSoft Browser").Page("Requisition")
 	
 		If .PSFrame("ePro Requisitions").Link("EditComments and Attachement").Exist(nMINWAIT) Then
			.PSFrame("ePro Requisitions").Link("EditComments and Attachement").Click
			Reporter.ReportEvent micPass,"Edit more Comments and Attachments "," Edit more Comments and Attachments link is present and clicked"
		Else
		Reporter.ReportEvent micFail,"Edit more Comments and Attachments Link"," Edit more Comments and Attachments Link is not displayed "
		
		End If
		


		If .PSFrame("Header Comments").WebEdit("comments").Exist(nMINWAIT) Then
			.PSFrame("Header Comments").WebEdit("comments").Set dtComment
			Reporter.ReportEvent micPass,"Comments  "," Comments Edit field is present and set with" &dtComment
			Else
		Reporter.ReportEvent micFail,"Comments"," Comments Field is not displayed "
		End If
		

		If .PSFrame("Header Comments").WebCheckBox("ReviewSubmit_SendtoSupplier").Exist(nMINWAIT) Then
			.PSFrame("Header Comments").WebCheckBox("ReviewSubmit_SendtoSupplier").Click
			Reporter.ReportEvent micPass,"ReviewSubmit_SendtoSupplier  "," ReviewSubmit_SendtoSupplier Check box is present and clicked"
			Else
		Reporter.ReportEvent micFail,"ReviewSubmit_SendtoSupplier Check box"," ReviewSubmit_SendtoSupplier Check box is not displayed "
		End If
		
		If .PSFrame("Header Comments").WebCheckBox("ReviewSubmit_ShowAtReceipt").Exist(nMINWAIT) Then
			.PSFrame("Header Comments").WebCheckBox("ReviewSubmit_ShowAtReceipt").Click
			Reporter.ReportEvent micPass,"ReviewSubmit_ShowAtReceipt  "," ReviewSubmit_ShowAtReceipt Check box is present and clicked"
			Else
		Reporter.ReportEvent micFail,"ReviewSubmit_ShowAtReceipt ","ReviewSubmit_ShowAtReceipt Check box is not displayed "
		End If
		
		If .PSFrame("Header Comments").WebCheckBox("ReviewSubmit_ShowatVoucher").Exist(nMINWAIT) Then
			.PSFrame("Header Comments").WebCheckBox("ReviewSubmit_ShowatVoucher").Click
			Reporter.ReportEvent micPass,"ReviewSubmit_ShowatVoucher  "," ReviewSubmit_ShowatVoucher Check box is present and clicked"
			Else
		Reporter.ReportEvent micFail,"ReviewSubmit_ShowatVoucher Check box"," ReviewSubmit_ShowatVoucher Check box is not displayed "
		End If
		
		If .PSFrame("Header Comments").WebButton("Add Attachement").Exist(nMINWAIT) Then
			.PSFrame("Header Comments").WebButton("Add Attachement").Click
			Reporter.ReportEvent micPass,"Add Attachement button  "," Add Attachement button is present and clicked"
			Else
		Reporter.ReportEvent micFail,"Add Attachement button  "," Add Attachement button is not displayed "
		End If
		
		If .PSFrame("FileAttachment").WebFile("fillaForm_AttachDocs").Exist(nMINWAIT) Then
			.PSFrame("FileAttachment").WebFile("fillaForm_AttachDocs").Set Filepath
			Reporter.ReportEvent micPass,"Attachment file "," Upload Attachment is done successfully with path of =" &Filepath
		Else
		Reporter.ReportEvent micFail,"Attachment file "," Upload Attachment is not displayed "
		End If
		
		app_SearchSync()
		
		If .PSFrame("FileAttachment").WebButton("Upload").Exist(nMINWAIT) Then
			.PSFrame("FileAttachment").WebButton("Upload").Click
			Reporter.ReportEvent micPass,"Upload button "," Upload button present and clicked"
		Else
		Reporter.ReportEvent micFail,"Upload button "," Upload button  is not displayed "
		End If
		
		Wait(1)
		
		If .PSFrame("Header Comments").WebButton("OK").Exist(nMINWAIT) Then
			.PSFrame("Header Comments").WebButton("OK").Click
			Reporter.ReportEvent micPass,"Header Comments "," Header Comments is present and clicked"
		Else
		Reporter.ReportEvent micFail,"Header Comments "," Header Comments  is not displayed "
		End If
		
		app_SearchSync()
		
	End  With	
	
'wait for the ojects to get loaded

End  If	

If Not(IsEmpty(dtChartfeild)) or Not(IsEmpty(dtDept)) Then


'Clickon Expand section
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Expand section is","present and clicekd"
	Else
		Reporter.ReportEvent micFail,"The Expand section is"," The Expand section is not displayed "
End If
End  With 

'Expand the Account section if not
WIth Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand section Accounting")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The accounting section","is expanded"
	Else
	Reporter.ReportEvent micPass,"The Accounting section is","already expanded"
End If
End  With 

'Click on Chartfiedl line 2
WIth Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields2_Tab")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Chartfield tab","is present and clicked"
	Else
		Reporter.ReportEvent micFail,"The Chartfield tab"," The Chartfield tab is not displayed "
End If
End  With 

'Enter th edetails oint eh Chartfield section
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
If .Exist(nMINWAIT) Then
	.Set dtChartfeild
	Reporter.ReportEvent micPass,"Chartfields2_Account Field","Chartfields2_Account is present and set ="&dtChartfeild
	Else
		Reporter.ReportEvent micFail,"Chartfields2_Account Field"," Chartfields2_Account Field is not displayed "
End If
End  With 

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
If .Exist(nMINWAIT) Then
	.Set dtDept
	Reporter.ReportEvent micPass,"Chartfields2_DeptID","Chartfields2_DeptID is present and set "&dtDept
	Else
		Reporter.ReportEvent micFail,"Chartfields2_DeptID"," Chartfields2_DeptID is not displayed "
End If
End  With 

dtProject=GlobalDictionary("ProjectName")
If Not(IsEmpty(dtProject)) Then

'Click on Chartfields3_Tab
WIth Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields3_Tab")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Chartfield 3 tab","is present and clicked"
	Else
		Reporter.ReportEvent micFail,"The Chartfield 3 tab"," The Chartfield tab is not displayed "
End If
End  With 
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chart3_PCBus_Unit")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("Setting_BusinessUnit")
	Reporter.ReportEvent micPass,"Setting_BusinessUnit","Setting_BusinessUnit is present and set "&GlobalDictionary("Setting_BusinessUnit")
	Else
		Reporter.ReportEvent micFail,"Setting_BusinessUnit"," Setting_BusinessUnit is not displayed "
End If
End  With 

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chart3_Project")
If .Exist(nMINWAIT) Then
	.Set dtProject
	Reporter.ReportEvent micPass,"Project","Project field is present and set"&dtProject
	Else
		Reporter.ReportEvent micFail,"Project field"," Project field is not displayed "
End If
End  With

If Not(IsEmpty(dtActivity)) Then
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chart3_Activity")
If .Exist(nMINWAIT) Then
	.Set dtActivity
	Reporter.ReportEvent micPass,"Chart3_Activity","Chart3_Activity field is present and set "&dtProject
	Else
		Reporter.ReportEvent micFail,"Chart3_Activity field"," Chart3_Activity field is not displayed "
End If
End  With
End If





'verify Alert message for Pending project

verifyAlert=GlobalDictionary("Verifyalert")

If verifyAlert Then


	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		
			If .WebButton("Save & submit").Exist(nminwait) Then
				.WebButton("Save & submit").Click
				WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
			End If
	End With
	With Browser("PeopleSoft Browser").Page("Requisition").WebElement("txt_alertmsg")
	
		If .Exist(nminwait) Then
			Alertmessage=.GetROProperty("innertext")
			WriteToReport micPass,"Alert message is diaplyed ",""&Alertmessage,false
		End If
	End With

	With Browser("PeopleSoft Browser").Page("Requisition").WebButton("Alert_OKbutton")
	
		If .Exist(nminwait) Then
			.Click
			WriteToReport micPass,"Ok Button "," Ok Button is present and clicked",false
		End If
	End With

Exit Function
End If



End If

End  If

	
	Wait(1)
	
 	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
 	if .WebEdit("ReviewSubmit_RequisitionComments").Exist(nMINWAIT) Then
 		.WebEdit("ReviewSubmit_RequisitionComments").Set dtComment
			Reporter.ReportEvent micPass,"Comments  "," Comments Edit field is present and set with" &dtComment
			Else
		Reporter.ReportEvent micFail,"Comments"," Comments Field is not displayed "
 	End If
 	
 	if .WebCheckBox("ReviewSubmit_SendtoSupplier").Exist(nMINWAIT) Then
 		.WebCheckBox("ReviewSubmit_SendtoSupplier").Set "ON"
 		Reporter.ReportEvent micPass,"ReviewSubmit_SendtoSupplier  "," ReviewSubmit_SendtoSupplier Checkbox is present and set ON "
			Else
		Reporter.ReportEvent micFail,"ReviewSubmit_SendtoSupplier "," ReviewSubmit_SendtoSupplier  Checkbox is not displayed "
 	End If
 
 	 if .WebCheckBox("ReviewSubmit_ShowAtReceipt").Exist(nMINWAIT) Then
 		.WebCheckBox("ReviewSubmit_SendtoSupplier").Set "ON"
 		Reporter.ReportEvent micPass,"Comments  "," Comments Edit field is present and set with" &dtComment
			Else
		Reporter.ReportEvent micFail,"Comments"," Comments Field is not displayed "
 	End If
 
  	if .WebCheckBox("ReviewSubmit_ShowatVoucher").Exist(nMINWAIT) Then
 		.WebCheckBox("ReviewSubmit_ShowatVoucher").Set "ON"
 		Reporter.ReportEvent micPass,"ReviewSubmit_ShowatVoucher  "," ReviewSubmit_ShowatVoucher Checkbox is present and set ON "
			Else
		Reporter.ReportEvent micFail,"ReviewSubmit_ShowatVoucher "," ReviewSubmit_ShowatVoucher  Checkbox is not displayed "
 	End If

 
  	if .WebButton("Save for Later").Exist(nMINWAIT) Then
 		.WebButton("Save for Later").Click
 		Reporter.ReportEvent micPass,"Save for Later"," Save for Later is present Clicked "
			Else
		Reporter.ReportEvent micFail,"Save for Later "," Save for Later is not displayed "
 	End If
 
  	if .Link("PreviewApprovals").Exist(nMINWAIT) Then
 		.Link("PreviewApprovals").Click
 		Reporter.ReportEvent micPass,"PreviewApprovals  "," PreviewApprovals Link is present and Clicked"
			Else
		Reporter.ReportEvent micFail,"PreviewApprovals"," PreviewApprovals Link is not displayed "
	 End If
	 
End  With
 
 app_SearchSync()
 
 	Dim ApproverList,RequesitionID
	ApproverList=ep_captureApproverNames(Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals"))
		
		If IsArray(ApproverList) Then
			For k = 0 To Ubound(ApproverList) Step 1
				GlobalDictionary("user"&k+1)=ApproverList(k)
			Next
			GlobalDictionary("TotalUsers")=UBound(ApproverList)+2
		End If
		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")
			If .WebElement("Preview_Status").Exist(nminwait) Then
				WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("Preview_Status").GetROProperty("innertext") ,false
			End If
			If .WebButton("Return").Exist(nminwait) Then
				.WebButton("Return").Click
			End If
		End With
				
		app_searchsync()
		
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
			RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
			WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
		End If
		If .WebButton("Save & submit").Exist(nminwait) Then
			.WebButton("Save & submit").Click
			WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
		End If
	End With
	
	With Browser("PeopleSoft Browser").Page("Requisition")
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End With

	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
			WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
		End If
		If .WebElement("Confirmation_status").Exist(nminwait) Then
			WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
		End If
	End With
 
	
	If Not(IsEmpty(RequsitionFlag))Then
	
	GlobalDictionary("RequisitionID")=RequesitionID
	End If
 	GlobalDictionary("SignInUser")=(GlobalDictionary("Approvar"))

End Function



'*********************************************************************************************************************************
''' <summary>  
''' Copy Requisition 
'''Parameter1:	None.
''' <para>
''' <note></note> 
''' </para>
''' </summary>
''' <author>Vijayakumar N</author>
''' <datecreated>3/6/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'eP_'Copy Requisition


'*********************************************************************************************************************************
''' <summary>  
''' Copy Requisition 
'''Parameter1:	None.
''' <para>
''' <note></note> 
''' </para>
''' </summary>
''' <author>Vijayakumar N</author>
''' <datecreated>3/6/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'eP_'Copy Requisition

Public Function CopyRequisition

dtBusinessUnit=GlobalDictionary("businessunit")
RequisitionId=GlobalDictionary("RequisitionID")

'Main menu Navigation ePro > Requisition
SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))

Call ManageRequisitionSearch(dtBusinessUnit,RequisitionId)

app_SearchSync()

Call ManageRequisitionActionGO("Copy")


With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("TargetFrame")

'click yes for alert
If .Exist(nMINWAIT) Then
	If .WebButton("Yes").Exist(nMINWAIT) Then
		.WebButton("Yes").Click
	End If
End If
	
'Wait for the application to sync
 app_SearchSync()
 
 End  With
 
 With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
 
 if .WebEdit("ReviewSubmit_RequisitionComments").Exist(nMINWAIT) Then
 	.WebEdit("ReviewSubmit_RequisitionComments").Set "comment"
 	Call WriteToReport(micPass,"ReviewSubmit_RequisitionComments","is present and set with"&RequisitionID,false)
 End If
 
  if .WebCheckBox("ReviewSubmit_SendtoSupplier").Exist(nMINWAIT) Then
 	.WebCheckBox("ReviewSubmit_SendtoSupplier").Set "ON"
 	Call WriteToReport(micPass,"ReviewSubmit_SendtoSupplier","is present and set with"&RequisitionID,false)
 End If
 
  if .WebCheckBox("ReviewSubmit_ShowAtReceipt").Exist(nMINWAIT) Then
 	.WebCheckBox("ReviewSubmit_SendtoSupplier").Set "ON"
 	Call WriteToReport(micPass,"ReviewSubmit_ShowAtReceipt","is present and set with"&RequisitionID,false)
 End If
 
  if .WebCheckBox("ReviewSubmit_ShowatVoucher").Exist(nMINWAIT) Then
 	.WebCheckBox("ReviewSubmit_ShowatVoucher").Set "ON"
 	Call WriteToReport(micPass,"ReviewSubmit_ShowatVoucher","is present and set with"&RequisitionID,false)
 End If
 
  if .WebButton("Save for Later").Exist(nMINWAIT) Then
 	.WebButton("Save for Later").Click
 	Call WriteToReport(micPass,"Save","is present and Clicked",false)
 End If
 
  if .Link("PreviewApprovals").Exist(nMINWAIT) Then
 	.Link("PreviewApprovals").Click
 	Call WriteToReport(micPass,"PreviewApprovals Link","is present and Clicked",false)
 End If
 
 app_searchsync()
		
 Dim ApproverList,RequesitionID
		ApproverList=ep_captureApproverNames(Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals"))
		
		If IsArray(ApproverList) Then
			For k = 0 To Ubound(ApproverList) Step 1
				GlobalDictionary("user"&k+1)=ApproverList(k)
			Next
			GlobalDictionary("TotalUsers")=UBound(ApproverList)+2
		End If
		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")
			If .WebElement("Preview_Status").Exist(nminwait) Then
				WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("Preview_Status").GetROProperty("innertext") ,false
			End If
			If .WebButton("Return").Exist(nminwait) Then
				.WebButton("Return").Click
			End If
		End With
				
		app_searchsync()
		
		

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
			RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
			WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
		End If
		If .WebButton("Save & submit").Exist(nminwait) Then
			.WebButton("Save & submit").Click
			WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
		End If
End With
	
	With Browser("PeopleSoft Browser").Page("Requisition")
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
	If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
		WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
	End If
	If .WebElement("Confirmation_status").Exist(nminwait) Then
		WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
	End If
End With


 'Review the approvar

 
 
 End  With
 
 End  Function




'*********************************************************************************************************************************
''' <summary>  
''' ep_captureApproverNames()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Vijay anandan</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'*********************************************************************************************************************************
'2.08
Public Function selfapproval

'Navigate to Below page
'eProcurement>Requisition
SignInUser=GlobalDictionary("SignInUser")
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
price=(GlobalDictionary("price"))
qty=(GlobalDictionary("qty"))
UOM=(GlobalDictionary("UOM"))
Category=(GlobalDictionary("Category"))
SupplierID=(GlobalDictionary("SupplierID"))
Desc=(GlobalDictionary("Desc"))
Account=(GlobalDictionary("Account"))
Dept=(GlobalDictionary("Dept"))
PCBussUnit=(GlobalDictionary("PCBussUnit"))
Project=(GlobalDictionary("Project"))
Activity=(GlobalDictionary("Activity"))

	'click on requisition link
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Requisition Settings link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Requisition Settings link is not displayed", "and not clicked",True)
	End If
	End With


	'select override radio button	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebRadioGroup("Override_radbutton")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Override option is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Override option is not displayed", "and not clicked",True)
	End If
	End With
	
	'click  on OK button
      With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"OK button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"OK button is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on special request link
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Special Requests link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Special Requests link is not displayed", "and not clicked",True)
	End If
	End With

	
Call  addSpecialRequisition(Category,Qty,UOM,SupplierID,price)


	'Click on addtocart close button
	 'With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Addtocart_close")
	'If .Exist(nMINWAIT) Then
	'	.Click
	'	Call WriteToReport(micPass,"Addtocart_close button is displayed", "and clicked",False)
	'	Else
	'	Call WriteToReport(micFail,"Addtocart_close button is not displayed", "and not clicked",True)
	'End If
	'End With
	
	'click on checkout button
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Checkout button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Checkout button is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on expand section
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Expand Section is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Expand Section is not displayed", "and not clicked",True)
	End If
	End With

'Wait for the application to sync
 app_SearchSync()
	
	
 'click on expand section accounting
	'With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand section Accounting")
	'If .Exist(nMINWAIT) Then
	'.Click
	'	Call WriteToReport(micPass,"Expand Section Accounting is displayed", "and clicked",False)
	'	Else
	'	Call WriteToReport(micFail,"Expand Section  Accounting is not displayed", "and not clicked",True)
	'End If
	'End With

	'click on chartfield2 Tab
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields2_Tab")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Chartfields2_Tabis displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Chartfields2_Tab is not displayed", "and not clicked",True)
	End If
	End With
	
	'set Account number	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
	    If .Exist(nMINWAIT) Then
		.Set Account
		Call WriteToReport(micPass,"Chartfields2_Account is present ","and set with="&Account, false)
	End If
	End  With 

	'set Dept ID
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
	    If .Exist(nMINWAIT) Then
		.Set Dept
		Call WriteToReport(micPass,"IChartfields2_DeptID is present ","and set with="&Dept, false)
	End If
	End  With 
	
	'CLICK ON Chartfield tab
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields3_Tab")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Chartfields3_Tab is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Chartfields3_Tab is not displayed", "and not clicked",True)
	End If
	End With
	
	'set PCBUS Unit
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chart3_PCBus_Unit")
	    If .Exist(nMINWAIT) Then
		.Set PCBussUnit
		Call WriteToReport(micPass,"Chart3_PCBus_Unit is present ","and set with="&PCBussUnit, false)
	End If
	End  With 
	
	'SET Project
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chart3_Project")
	    If .Exist(nMINWAIT) Then
		.Set Project
		Call WriteToReport(micPass,"Chart3_Project is present ","and set with="&Project, false)
	End If
	End  With 
	
	'SeT activity
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chart3_Activity")
	If .Exist(nMINWAIT) Then
		.Set Activity
		Call WriteToReport(micPass,"Chart3_Activity is present ","and set with="&Activity, false)
	End If
	End  With 
	
	'Click on save and submit button
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save & submit")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Save & submit button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Save & submit button is not displayed", "and not clicked",True)
	End If
	End With

'verify approve status	
with Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("ApproveStatus")
If .Exist(nMINWAIT) Then
		approvalStatus=.GetROProperty("innertext")
		If StrComp(approvalStatus,"Pending",1)=0 Then
			Call WriteToReport(micPass,"Approval status changed to Approved status","is present",false)
			else
'			Call WriteToReport(micFail,"Approval status","doesn't chaged to Approved, Actual status is "&approvalStatus,True)
		End If
End If
End with

'click OK Button
With Browser("PeopleSoft Browser").Page("Requisition").WebButton("Alert_OKbutton")
If .Exist(nMINWAIT) Then
	 .Click
End If
End  WIth

'Wait for the application to sync
 app_SearchSync()

'verify selfapproved status
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("SelfApprovedStatus")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"Self Approved Status","and Green tick is displayed ", false)
End If
End  WIth 
'	
'Wait for the application to sync
 app_SearchSync()	


End Function
'*********************************************************************************************************************************
''' <summary>  
''' ep_captureApproverNames()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Vijay anandan</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'*******************************************************************************************************************
'1.19

Public Function ComboEditError

'Navigate to Below page
'eProcurement>Requisition
SignInUser=GlobalDictionary("SignInUser")
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
businessunit=(GlobalDictionary("businessunit"))
GLunit=(GlobalDictionary("GLunit"))
businessunit1=(GlobalDictionary("businessunit1"))
GLunit1=(GlobalDictionary("GLunit1"))
price=(GlobalDictionary("price"))
qty=(GlobalDictionary("qty"))
UOM=(GlobalDictionary("UOM"))
Category=(GlobalDictionary("Category"))
SupplierID=(GlobalDictionary("SupplierID"))
Account=(GlobalDictionary("Account"))
Dept=(GlobalDictionary("Dept"))
Account1=(GlobalDictionary("Account1"))
Dept1=(GlobalDictionary("Dept1"))
comment=(GlobalDictionary("comment"))

	'click on requisition link
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Requisition Settings link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Requisition Settings link is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on bussiness unit icon
	With Browser("PeopleSoft Browser").Page("Requisition")
	If Not(IsEmpty(businessunit))Then
		If .PSFrame("Requisition Settings").WebButton("Business Unit Icon").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebButton("Business Unit Icon").Click
			Reporter.ReportEvent micPass,"Business Unit Icon "," Business Unit icon is present and Clicked"
		End If
		
		'Wait for the application to sync
 		app_SearchSync()
		
		'Set the Business Unit
		If .PSFrame("Requisition Business Unit").WebEdit("Business Unit").Exist(nminwait) Then
			.PSFrame("Requisition Business Unit").WebEdit("Business Unit").Set  businessunit
		  	Reporter.ReportEvent micPass,"Business Unit  "," Business Unit field is present and entered as"&businessunit
		End If
		end if
		
		'click on ok button			
		If .PSFrame("Requisition Business Unit").WebButton("Ok").Exist(nminwait) Then
		  	.PSFrame("Requisition Business Unit").WebButton("Ok").Click
		  	Reporter.ReportEvent micPass,"Business Unit Ok button "," Business Unit Ok button is present and clicked"
		End If
			
		'Wait for the application to sync
 		app_SearchSync()
 		If .PSFrame("ePro Requisitions").Link("Requisition Settings").Exist(nminwait) Then
 			.PSFrame("ePro Requisitions").Link("Requisition Settings").Click
			Reporter.ReportEvent micPass,"Requisition Settings Page "," Requisition Settings Page displayed successfully"
		End If
	    end with		
	
	'click on chartfield1 tab
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebElement("ChartField1")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"ChartField1 tab is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"ChartField1 tab is not displayed", "and not clicked",True)
	End If
	End With
    
	'set GL Unit
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebEdit("Req_GL_Unit")
	    If .Exist(nMINWAIT) Then
		.Set GLunit
		Call WriteToReport(micPass,"Req_GL_Unit is present ","and set with="&GLunit, false)
	End If
	End  With 
	
    'click on OK button
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"OK button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"OK button is not displayed", "and not clicked",True)
	End If
    End with
    
	'validate alert message
 	  With Browser("PeopleSoft Browser").Page("Requisition")
      If .WebElement("Message").Exist(nminwait) Then
          WriteToReport micPass,"alertMsg is present and displayed as "," These two Business Units must match before adding items to the requisition. "&.WebElement("Message").GetROProperty("innertext"),false
      End If
      If .WebButton("OK").Exist(nminwait) Then
         .WebButton("OK").Click
      End If
      End With
      
 	'Click on requisition link
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Requisition Settings link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Requisition Settings link is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on business unit icon
	With Browser("PeopleSoft Browser").Page("Requisition")
	If Not(IsEmpty(businessunit))Then
		If .PSFrame("Requisition Settings").WebButton("Business Unit Icon").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebButton("Business Unit Icon").Click
			Reporter.ReportEvent micPass,"Business Unit Icon "," Business Unit icon is present and Clicked"
		End If
		
		'Wait for the application to sync
 		app_SearchSync()
		
		'Set the Business Unit
		If .PSFrame("Requisition Business Unit").WebEdit("Business Unit").Exist(nminwait) Then
			.PSFrame("Requisition Business Unit").WebEdit("Business Unit").Set  businessunit
		  	Reporter.ReportEvent micPass,"Business Unit  "," Business Unit field is present and entered as"&businessunit
		End If
		end if
		
	'click on OK button			
		If .PSFrame("Requisition Business Unit").WebButton("Ok").Exist(nminwait) Then
		  	.PSFrame("Requisition Business Unit").WebButton("Ok").Click
		  	Reporter.ReportEvent micPass,"Business Unit Ok button "," Business Unit Ok button is present and clicked"
		End If
			
		'Wait for the application to sync
 		app_SearchSync()
 		If .PSFrame("ePro Requisitions").Link("Requisition Settings").Exist(nminwait) Then
 			.PSFrame("ePro Requisitions").Link("Requisition Settings").Click
			Reporter.ReportEvent micPass,"Requisition Settings Page "," Requisition Settings Page displayed successfully"
		End If
	    end with		
	
	'click on chartfield1 tab
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebElement("ChartField1")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"ChartField1 tab is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"ChartField1 tab is not displayed", "and not clicked",True)
	End If
	End With
	
   	'set GL Unit1
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebEdit("Req_GL_Unit")
	    If .Exist(nMINWAIT) Then
		.Set GLunit1
		Call WriteToReport(micPass,"Req_GL_Unit is present ","and set with="&GLunit1, false)
	End If
	End  With 
	
	'click on OK button 
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
	    Call WriteToReport(micPass,"OK button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"OK button is not displayed", "and not clicked",True)
	End If
    End with
    
	'click on special request link
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Special Requests link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Special Requests link is not displayed", "and not clicked",True)
	End If
	End With

	
Call  addSpecialRequisition(Category,Qty,UOM,SupplierID,price)


'click on addtocart close button
 'With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Addtocart_close")
'	If .Exist(nMINWAIT) Then
'		.Click
'		Call WriteToReport(micPass,"Addtocart_close button is displayed", "and clicked",False)
'		Else
'		Call WriteToReport(micFail,"Addtocart_close button is not displayed", "and not clicked",True)
'	End If
'	End With
	
	'click on checkout button
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Checkout button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Checkout button is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on expand section
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Expand Section is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Expand Section is not displayed", "and not clicked",True)
	End If
	End With

'Wait for the application to sync
 app_SearchSync()
 
 
 'click on expand section accounting
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand section Accounting")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Expand Section Accounting is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Expand Section  Accounting is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on chartfield2 tab
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields2_Tab")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Chartfields2_Tabis displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Chartfields2_Tab is not displayed", "and not clicked",True)
	End If
	End With
	

	'set Account number	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
	    If .Exist(nMINWAIT) Then
		.Set Account
		Call WriteToReport(micPass,"Chartfields2_Account is present ","and set with="&Account, false)
	End If
	End  With 

	'click on dept id
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
	    If .Exist(nMINWAIT) Then
		.Set Dept
		Call WriteToReport(micPass,"IChartfields2_DeptID is present ","and set with="&Dept, false)
	End If
	End  With 
	
	
	'click on save for later button
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save for Later")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Save for Later button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Save for Later button is not displayed", "and not clicked",True)
	End If
	End With
	

	'verify alert message	
	 With Browser("PeopleSoft Browser").Page("Requisition")
      If .WebElement("Message").Exist(nminwait) Then
          WriteToReport micPass,"alertMsg is present and displayed as "," please refer ChartField Combination Data"&.WebElement("Message").GetROProperty("innertext"),false
      End If
      If .WebButton("OK").Exist(nminwait) Then
         .WebButton("OK").Click
      End If
      End With

	'set Account number	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
	    If .Exist(nMINWAIT) Then
		.Set Account1
		Call WriteToReport(micPass,"Chartfields2_Account is present ","and set with="&Account1, false)
	End If
	End  With 
	
	'set dept id
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
	    If .Exist(nMINWAIT) Then
		.Set Dept1
		Call WriteToReport(micPass,"IChartfields2_DeptID is present ","and set with="&Dept1, false)
	End If
	End  With 
	
	'set comment
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Req_Comment")
	If .Exist(nMINWAIT) Then
		.Set comment
		Call WriteToReport(micPass,"Req_Comment","is present and set with="&comment,False)
		End If
	End With
	
		'click on save for later tab
		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save for Later")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Save for Later button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Save for Later button is not displayed", "and not clicked",True)
	End If
	End With

'	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("PreviewApprovals")
'	If .Exist(nMINWAIT) Then
'		.Click
'		Call WriteToReport(micPass,"PreviewApprovals link is displayed", "and clicked",False)
'		Else
'		Call WriteToReport(micFail,"PreviewApprovals link is not displayed", "and not clicked",True)
'	End If
'	End With
	
'Wait for the application to sync
 app_SearchSync()
	
	
End Function




'************************************************************************************************************
Public Function VerifyCategoryApproval()

'Navigate to below path to create the requisition
Category=GlobalDictionary("Category")
Qty=GlobalDictionary("Qty")
UOM=GlobalDictionary("UOM")
SupplierID=GlobalDictionary("SupplierID")
price=GlobalDictionary("price")
dtChartfeild=GlobalDictionary("Account") 
dtDept=GlobalDictionary("Dept")

'Navigate to below navigation
'eProcurement > Requisition > Create Requisition
SelectMainMenu1(GlobalDictionary("CreateRequisition"))

'wait for the ojects to get loaded
app_SearchSync()

'Click on Special request
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micDone,"The special request","is present and clicked"
End If
End  With 

'Crteate the rewquisition
Call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)

'wait for the ojects to get loaded
app_SearchSync()

'Crteate the rewquisition
Call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)

'wait for the ojects to get loaded
app_SearchSync()

'Submit th ereuisitoin adn check for the approver names
Call EditandSubmitRequitision()

End Function

'**********************************************************************************************

Public Function AccountApproval

'Navigate to Below page
'eProcurement>Requisition
SignInUser=GlobalDictionary("SignInUser")
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
businessunit=(GlobalDictionary("businessunit"))

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Requisition Settings link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Requisition Settings link is not displayed", "and not clicked",True)
	End If
	End With
	
	With Browser("PeopleSoft Browser").Page("Requisition")
	If Not(IsEmpty(businessunit))Then
		If .PSFrame("Requisition Settings").WebButton("Business Unit Icon").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebButton("Business Unit Icon").Click
			Reporter.ReportEvent micPass,"Business Unit Icon "," Business Unit icon is present and Clicked"
		End If
		
		'Wait for the application to sync
 		app_SearchSync()
		
		'Set the Business Unit
		If .PSFrame("Requisition Business Unit").WebEdit("Business Unit").Exist(nminwait) Then
			.PSFrame("Requisition Business Unit").WebEdit("Business Unit").Set  businessunit
		  	Reporter.ReportEvent micPass,"Business Unit  "," Business Unit field is present and entered as"&businessunit
		End If
		end if
					
		If .PSFrame("Requisition Business Unit").WebButton("Ok").Exist(nminwait) Then
		  	.PSFrame("Requisition Business Unit").WebButton("Ok").Click
		  	Reporter.ReportEvent micPass,"Business Unit Ok button "," Business Unit Ok button is present and clicked"
		End If
			
		'Wait for the application to sync
 		app_SearchSync()
 		If .PSFrame("ePro Requisitions").Link("Requisition Settings").Exist(nminwait) Then
 			.PSFrame("ePro Requisitions").Link("Requisition Settings").Click
			Reporter.ReportEvent micPass,"Requisition Settings Page "," Requisition Settings Page displayed successfully"
		End If
	    end with		
	
	
End Function


'*********************************************************************************************************************************
''' <summary>  
''' EPreqWithMultipleLines()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Keerthana M</author>
''' <datecreated>3/6/2019</datecreated>
''' <startstate>The Requistion product should be added to the cart page</startstate>
''' <endstate>Have routing do through the CATEGORY and also the DEPT approval processes.</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'1.13

Public Function EPreqWithMultipleLines()

'Navigate to below page to get the user id
'UserProfileSelection=" eProcurement > Requisition "
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'wait for the ojects to get loaded
app_SearchSync()

bUnit=GlobalDictionary("Businessunit")
dept=GlobalDictionary("Dept")
Category1=GlobalDictionary("Category1")
Qty1=GlobalDictionary("Qty1")
UOM=GlobalDictionary("UOM1")
SupplierID=GlobalDictionary("SupplierID1")
price1=GlobalDictionary("price1")
Qty2=GlobalDictionary("Qty2")
Category2=GlobalDictionary("Category2")
Qty2=GlobalDictionary("Qty2")
price2=GlobalDictionary("price2")
dept1=GlobalDictionary("Dept1")
dtAcc1=GlobalDictionary("Acc1")
comments=GlobalDictionary("comments")

'Select the Requisition settings
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("link_Requisition Settings")
If .Exist(nMINWAIT) Then
	.Click
	 Call WriteToReport(micPass,"Requistion settings link","is clicked",false)
End If
End  With 

'Click on BU
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebButton("search_bUnit")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With
 
'Set BU
 With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition").WebEdit("txt_bUnit")
If .Exist(nMINWAIT) Then
	.set bUnit
	Call WriteToReport(micPass,"Business Unit=" &bUnit,"is set",false)
End If
End  With

'Click on OK
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition").WebButton("btn_OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Click on Requistion settings
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("link_Requisition Settings")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Click on Chartfield2
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebElement("Chartfields2")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Chartfiled2 tab","is clicked",false)
End If
End  With 

'Set dept
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebEdit("txt_dept")
If .Exist(nMINWAIT) Then
	.Set dept
	Call WriteToReport(micPass,"Department field="&dept,"is set",false)
End If
End  With 

'click on OK
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebButton("btn_OK")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Ok button","is clicked",false)
End If
End  With 

'click on Special requests link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Special requests link","is clicked",false)
End If
End  With

call addSpecialRequisition(Category1,Qty1,UOM,SupplierID,price1)
call addSpecialRequisition(Category2,Qty2,UOM,SupplierID,price2)


'click on Check out button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Check out button","is clicked",false)
End If
End  With

 app_SearchSync()
 
'To expand item
Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section").SetTOProperty "Index",0
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End  With

'To expand accounting lines
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand section Accounting")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End  With


With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields2_Tab")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"ChartFields2 tab of Item1","is clicked",false)
	End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
If .Exist(nMINWAIT) Then
	.Set dtAcc1
	Reporter.ReportEvent micPass,"The Chartfied Account" &dtAcc1,"is set"
End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
	If .Exist(nMINWAIT) Then
		.Set dept1
		Call WriteToReport(micPass,"Department ID of Item1=" &dept1,"is set",false)
	End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Collapse Section")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End  With

'Item 2
Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section").SetTOProperty "Index",1
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand section Accounting")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields2_Tab")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"ChartFields2 tab of Item2","is clicked",false)
	End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
If .Exist(nMINWAIT) Then
	.Set dtAcc1
	Reporter.ReportEvent micPass,"The Chartfied Account of Item2=" &dtAcc1,"is set"
End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
	If .Exist(nMINWAIT) Then
		.Set dept1
		Call WriteToReport(micPass,"Department ID of Item2=" &dept1,"is set",false)
	End If
End  With
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Collapse Section")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("ReviewSubmit_RequisitionComments")
	If .Exist(nMINWAIT) Then
		.Set comments
		Call WriteToReport(micPass,"Comments","is set",false)
	End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save for Later")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Save for Later button","is clicked",false)
	End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("PreviewApprovals")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Preview Approvals link","is clicked",false)
	End If
End  With


With Browser("PeopleSoft Browser").Page("Requisition")
If .Exist(nMINWAIT) Then
                Set oObj=Description.Create
                oObj("MicClass").value="WebElement"
                oObj("class").value="awPathHeader"
                oObj("html tag").value="TD"
                Set oApproved=.ChildObjects(oObj)
                For i=0 to oApproved.count-1
                                appApprovalFlow=oApproved(i).getRoProperty("innertext")
                                Reporter.ReportEvent micDone,"The name of the approval flow","is="&appApprovalFlow
                                Wait(2)
                Next
End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals").WebTable("previewApprover")
	If .Exist(nMINWAIT) Then
		Call WriteToReport(micPass,"Approver page","is displayed successfully",false)
		Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals").WebButton("Return").Click
	End If
End  With
End Function


'*********************************************************************************************************************************
''' <summary>  
''' EPAmountOnlyRequisition()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Keerthana M</author>
''' <datecreated>3/11/2019</datecreated>
''' <startstate>The Requistion product should be added to the cart page</startstate>
''' <endstate>Select Amount Only Requisition and verify the Warning Message</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'1.17
Public Function EPAmountOnlyRequisition()

'Navigate to below page to get the user id
'UserProfileSelection=" eProcurement > Requisition "
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'wait for the ojects to get loaded
app_SearchSync()

bUnit=GlobalDictionary("Businessunit")
dept=GlobalDictionary("Dept")
Category=GlobalDictionary("Category1")
Qty=GlobalDictionary("Qty1")
UOM=GlobalDictionary("UOM1")
SupplierID=GlobalDictionary("SupplierID1")
price=GlobalDictionary("price1")
Qty2=GlobalDictionary("Qty2")
price2=GlobalDictionary("price2")
dept1=GlobalDictionary("Dept1")
act1=GlobalDictionary("Act1")
comments=GlobalDictionary("comments")

projId=GlobalDictionary("projId")
pcBusUnit=GlobalDictionary("pcBusUnit")
activityId=GlobalDictionary("activityId")

'Select the Requisition settings
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("link_Requisition Settings")
If .Exist(nMINWAIT) Then
	.Click
	 Call WriteToReport(micPass,"Requistion settings link","is clicked",false)
End If
End  With 

'Click on BU
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebButton("search_bUnit")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With
 
'Set BU
 With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition").WebEdit("txt_bUnit")
If .Exist(nMINWAIT) Then
	.set bUnit
	Call WriteToReport(micPass,"Business Unit=" &bUnit,"is set",false)
End If
End  With

'Click on OK
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition").WebButton("btn_OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Click on Requistion settings
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("link_Requisition Settings")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Click on Chartfield2
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebElement("Chartfields2")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Chartfiled2 tab","is clicked",false)
End If
End  With 

'Set dept
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebEdit("txt_dept")
If .Exist(nMINWAIT) Then
	.Set dept
	Call WriteToReport(micPass,"Department field="&dept,"is set",false)
End If
End  With 

'click on OK
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebButton("btn_OK")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Ok button","is clicked",false)
End If
End  With 

'click on Special requests link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Special requests link","is clicked",false)
End If
End  With

call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)

'click on Check out button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Check out button","is clicked",false)
End If
End  With

 app_SearchSync()
  
'To expand
Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section").SetTOProperty "Index",0
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End  With

'To expand accounting lines
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand section Accounting")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End  With

'To get the value of quantity before checking amount only check box
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("txt_Quantity")
	If .Exist(nMINWAIT) Then
		qtyval=.GetROProperty("value")
		Call WriteToReport(micPass,"The Quantity value before selecting amount only is="&qtyval,"is displayed successfully",false)
	End If
End  With

'To select chartfields2
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields2_Tab")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"ChartFields2 tab of Item1","is clicked",false)
	End If
End  With

'To enter Dept id
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
	If .Exist(nMINWAIT) Then
		.Set dept1
		Call WriteToReport(micPass,"Department ID of Item1=" &dept1,"is set",false)
	End If
End  With

'To enter Account ID
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
	If .Exist(nMINWAIT) Then
		.Set act1
		Call WriteToReport(micPass,"Account ID of Item1=" &act1,"is set",false)
	End If
End  With

'To select chartfields3
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields3")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Chartfields3 tab","is selected",false)
	End If
End  With

'To set PC Bus unit
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("PC BusUnit")
	If .Exist(nMINWAIT) Then
		.Set pcBusUnit
		Call WriteToReport(micPass,"PC Bus unit="&pcBusUnit,"is set",false)
	End If
End  With

'To set project id
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("PROJECT_ID")
	If .Exist(nMINWAIT) Then
		.Set projId
		Call WriteToReport(micPass,"Project ID="&projId,"is set",false)
	End If
End  With


'To set Activity ID
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("ACTIVITY_ID")
	If .Exist(nMINWAIT) Then
		.Set activityId
		Call WriteToReport(micPass,"Activity ID="&activityId,"is set",false)
	End If
End  With

'To click on Line Details
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Line Details")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Line details","is selected",false)
	End If
End  With

app_SearchSync()

'To select amount only check box
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Line Details").WebCheckBox("LineDetails_AmountOnly")
	If .Exist(nMINWAIT) Then
		.Set "ON"
		Call WriteToReport(micPass,"Amount only check box","is checked",false)
	End If
End  With

'To click ok 
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Line Details").WebButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End  With

'To verify the warning message
With Browser("PeopleSoft Browser").Page("Requisition").WebElement("txt_alertmsg")
	If .Exist(nMINWAIT) Then
		msg=.GetROProperty("innertext")
		Call WriteToReport(micPass,"The warning message="&msg,"is displayed successfully",false)
	End If
End  With

'To click yes for the warning message
With Browser("PeopleSoft Browser").Page("Requisition").WebButton("Yes")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End  With

app_SearchSync()

'To add the code to check quantity change to 1
'To get the value of quantity before checking amount only check box
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("txt_Quantity")
	If .Exist(nMINWAIT) Then
		qtyval=.GetROProperty("value")
		Call WriteToReport(micPass,"The Quantity value after selecting amount only is="&qtyval,"is displayed successfully",false)
	End If
End  With

'To collapse the image icon for item
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Collapse Section")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End  With

'To enter requisition comments
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("ReviewSubmit_RequisitionComments")
	If .Exist(nMINWAIT) Then
		.Set comments
		Call WriteToReport(micPass,"Comments","is set",false)
	End If
End  With

'To click Save for later button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save for Later")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Save for Later button","is clicked",false)
	End If
End  With

'To click preview approvals link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("PreviewApprovals")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Preview Approvals link","is clicked",false)
	End If
End  With

app_SearchSync()

'To check for approvers
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals").WebTable("previewApprover")
	If .Exist(nMINWAIT) Then
		Call WriteToReport(micPass,"Approver page","is displayed successfully",false)
		Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals").WebButton("Return").Click
	End If
End  With

End  Function

'*********************************************************************************************************************************
''' <summary>  
''' ep_captureApproverNames()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Vijay anandan</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'*********************************************************************************************************************************
'1.21

Public Function AccountApprOnBehalf

'Navigate to Below page
'eProcurement>Requisition
SignInUser=GlobalDictionary("SignInUser")
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
businessunit=(GlobalDictionary("businessunit"))
Requestor=(GlobalDictionary("Requestor"))
price=(GlobalDictionary("price"))
qty=(GlobalDictionary("qty"))
UOM=(GlobalDictionary("UOM"))
Category=(GlobalDictionary("Category"))
SupplierID=(GlobalDictionary("SupplierID"))
Account=(GlobalDictionary("Account"))
Dept=(GlobalDictionary("Dept"))
Account1=(GlobalDictionary("Account1"))
Dept1=(GlobalDictionary("Dept1"))
comment=(GlobalDictionary("comment"))

'click on requisition setting link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Requisition Settings link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Requisition Settings link is not displayed", "and not clicked",True)
	End If
	End With
	
	'Click on business unit icon	
	With Browser("PeopleSoft Browser").Page("Requisition")
	If Not(IsEmpty(businessunit))Then
		If .PSFrame("Requisition Settings").WebButton("Business Unit Icon").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebButton("Business Unit Icon").Click
			Reporter.ReportEvent micPass,"Business Unit Icon "," Business Unit icon is present and Clicked"
		End If
		
		'Wait for the application to sync
 		app_SearchSync()
		
		'Set the Business Unit
		If .PSFrame("Requisition Business Unit").WebEdit("Business Unit").Exist(nminwait) Then
			.PSFrame("Requisition Business Unit").WebEdit("Business Unit").Set  businessunit
		  	Reporter.ReportEvent micPass,"Business Unit  "," Business Unit field is present and entered as"&businessunit
		End If
		end if
		
		'Click on OK button			
		If .PSFrame("Requisition Business Unit").WebButton("Ok").Exist(nminwait) Then
		  	.PSFrame("Requisition Business Unit").WebButton("Ok").Click
		  	Reporter.ReportEvent micPass,"Business Unit Ok button "," Business Unit Ok button is present and clicked"
		End If
			
		'Wait for the application to sync
 		app_SearchSync()
 		If .PSFrame("ePro Requisitions").Link("Requisition Settings").Exist(nminwait) Then
 			.PSFrame("ePro Requisitions").Link("Requisition Settings").Click
			Reporter.ReportEvent micPass,"Requisition Settings Page "," Requisition Settings Page displayed successfully"
		End If
	   	
	    
	    'Set  Requestor
 	If Not(IsEmpty(Requestor))Then
 		If .PSFrame("Requisition Settings").WebEdit("Requestor").Exist(nminwait) Then
			.PSFrame("Requisition Settings").WebEdit("Requestor").Set Requestor
			Reporter.ReportEvent micPass,"Requestor "," Requestor is present and entered as"&Requestor
		End If
	End If
	End with

	'click on OK button
	 With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"OK button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"OK button is not displayed", "and not clicked",True)
	End If
    End with
    
	'Alert message
 	  With Browser("PeopleSoft Browser").Page("Requisition")
      If .WebElement("Message").Exist(nminwait) Then
          WriteToReport micPass,"alertMsg is present and displayed as "," These two Business Units must match before adding items to the requisition. "&.WebElement("Message").GetROProperty("innertext"),false
      End If
      If .WebButton("Yes").Exist(nminwait) Then
         .WebButton("Yes").Click
      End If
      End With


	'Click on special request link      
       With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Special Requests link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Special Requests link is not displayed", "and not clicked",True)
	End If
	End With

	



Call  addSpecialRequisition(Category,Qty,UOM,SupplierID,price)

' With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Addtocart_close")
'	If .Exist(nMINWAIT) Then
'		.Click
'		Call WriteToReport(micPass,"Addtocart_close button is displayed", "and clicked",False)
'		Else
'		Call WriteToReport(micFail,"Addtocart_close button is not displayed", "and not clicked",True)
'	End If
'	End With
	
	'click on checkout button
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Checkout button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Checkout button is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on Expand section
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Expand Section is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Expand Section is not displayed", "and not clicked",True)
	End If
	End With

'Wait for the application to sync
 app_SearchSync()
 
 	'click on expand section accounting
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand section Accounting")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Expand Section Accounting is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Expand Section  Accounting is not displayed", "and not clicked",True)
	End If
	End With

	'click on chartfield2 tab
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields2_Tab")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Chartfields2_Tabis displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Chartfields2_Tab is not displayed", "and not clicked",True)
	End If
	End With
	
	'validate Account number
	WIth  Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
	If .Exist(nMINWAIT) Then
		appAccount=.GetROProperty("value")
		If instr(1,cdbl(appAccount),GlobalDictionary("Account"))>0 Then
			WriteToReport micPass, "THe Account value is matching", "with application account value is "&appAccount, false
		End If
	End If
	End  WIth
	
	'click on save for later button
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save for Later")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Save for Later button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Save for Later button is not displayed", "and not clicked",True)
	End If
	End With
	
	'validate alert message	
	 With Browser("PeopleSoft Browser").Page("Requisition")
      If .WebElement("Message").Exist(nminwait) Then
          WriteToReport micPass,"alertMsg is present and displayed as "," please refer ChartField Combination Data"&.WebElement("Message").GetROProperty("innertext"),false
      End If
      If .WebButton("OK").Exist(nminwait) Then
         .WebButton("OK").Click
      End If
      End With
      
      'set Account number
      With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
	    If .Exist(nMINWAIT) Then
		.Set Account1
		Call WriteToReport(micPass,"Chartfields2_Account is present ","and set with="&Account1, false)
	End If
	End  With 

	'SET Dept id
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
	    If .Exist(nMINWAIT) Then
		.Set Dept1
		Call WriteToReport(micPass,"Chartfields2_DeptID is present ","and set with="&Dept1, false)
	End If
	End  With 
	
	'set comment
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Req_Comment")
	If .Exist(nMINWAIT) Then
		.Set comment
		Call WriteToReport(micPass,"Req_Comment","is present and set with="&comment,False)
		End If
	End With
	
	''click on save for later
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save for Later")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Save for Later button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Save for Later button is not displayed", "and not clicked",True)
	End If
	End With

	'click on preview approval link
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("PreviewApprovals")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"PreviewApprovals link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"PreviewApprovals link is not displayed", "and not clicked",True)
	End If
	End With
	
	app_SearchSync()

 Dim ApproverList,RequesitionID
		ApproverList=ep_captureApproverNames(Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals"))
		
		If IsArray(ApproverList) Then
			For k = 0 To Ubound(ApproverList) Step 1
				GlobalDictionary("user"&k+1)=ApproverList(k)
			Next
			GlobalDictionary("TotalUsers")=UBound(ApproverList)+2
		End If
		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")
			If .WebElement("Preview_Status").Exist(nminwait) Then
				WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("Preview_Status").GetROProperty("innertext") ,false
			End If
			If .WebButton("Return").Exist(nminwait) Then
				.WebButton("Return").Click
			End If
		End With
				
		app_searchsync()
		
		

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
			RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
			WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
		End If
		If .WebButton("Save & submit").Exist(nminwait) Then
			.WebButton("Save & submit").Click
			WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
		End If
End With
	
	With Browser("PeopleSoft Browser").Page("Requisition")
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
	If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
		WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
	End If
	If .WebElement("Confirmation_status").Exist(nminwait) Then
		WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
	End If
End With
	
	'Navigate to below page
	'CDW ePro > WF Routing by Account
	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	setid=(GlobalDictionary("setid"))
	SearchString=(GlobalDictionary("SearchString"))
	
	'set SETID
    With Browser("PeopleSoft Browser").Page("WF Routing by Account").PSFrame("TargetContent").WebEdit("Routing_SETID")
	If .Exist(nMINWAIT) Then
		.Set setid
		Call WriteToReport(micPass,"Routing_SETID","is present and set with="&setid,False)
		End If
	End With
	
	'Click on search button
	With Browser("PeopleSoft Browser").Page("WF Routing by Account").PSFrame("TargetContent").WebButton("Search")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Search button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Search button is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on find link	
	With Browser("PeopleSoft Browser").Page("WF Routing by Account").PSFrame("TargetContent").Link("Find")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Find link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Find link is not displayed", "and not clicked",True)
	End If
	End With
	
	'set Account Number in search string
	With Browser("PeopleSoft Browser").Dialog("cdw.com needs some information").WinEdit("Enter search string")
	If .Exist(nMINWAIT) Then
		.Set SearchString
		Call WriteToReport(micPass,"Routing_SETID","is present and set with="&SearchString,False)
		End If
	End With
	
	'click OK
	With Browser("PeopleSoft Browser").Dialog("cdw.com needs some information").WinButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"OK button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"OK button is not displayed", "and not clicked",True)
	End If
	End With
	
	'Get Rolename
	with Browser("PeopleSoft Browser").Page("WF Routing by Account").PSFrame("TargetContent").WebTable("From Account")
	If .Exist(nMINWAIT) Then
		For i=2 to .RowCount
			Role=Trim(.Childitem(i,5,"WebEdit",0).getroproperty("value"))'.GetCellData(i,5)
				If instr(1,Role,GlobalDictionary("Rolename"),1) Then
			GlobalDictionary("Role")=trim(.Childitem(i,5,"WebEdit",0).getroproperty("value")	)
		 	GlobalDictionary("Role")=Role
				
				End If
				Next
		
	End If
	End with 
	
'    Dim Role	
'	with Browser("PeopleSoft Browser").Page("WF Routing by Account").PSFrame("TargetContent").WebTable("From Account")
'	If .Exist(nminwait) Then
'	 	Role=.Childitem(2,5,"WebEdit",0).getroproperty("value")	
'	 	GlobalDictionary("Role")=Role
'	End If
'	end with 
	
		

'Navigate to below page
'PeopleTools > Security > Common Queries

SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))

	'Validating review security info page
  With Browser("PeopleSoft Browser").Page("Common Queries").PSFrame("Security Queries").WebTable("Review Security Information")
    If.Exist(nMINWAIT) Then
		Call WriteToReport(micPass,"Review Security Information Detail is present", "and displayed",False)
		Else
		Call WriteToReport(micFail,"Review Security Informationis Detail  not present", "and not displayed",True)
	End If
	End With

	'
'Navigate to below page
'PeopleTools > Security > Permission & Roles >Roles


SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))
Rolename=(GlobalDictionary("Rolename"))

	'Set Role which is got from WF Routing Account
	With Browser("PeopleSoft Browser").Page("Roles").PSFrame("TargetContent").WebEdit("Search_Rolename")
	If .Exist(nMINWAIT) Then
		.Set Trim(GlobalDictionary("Role"))
		Call WriteToReport(micPass,"Search_Rolename","is present and set with="&Role,False)
		End If
	End With

	'click on search button
	With Browser("PeopleSoft Browser").Page("Roles").PSFrame("TargetContent").WebButton("Search")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Search button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Search button is not displayed", "and not clicked",True)
	End If
	End With
	
	
	'click on members tab
    With Browser("PeopleSoft Browser").Page("Roles").PSFrame("TargetContent").WebElement("Members")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Members tab is cdisplayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Members tab is not displayed", "and not clicked",True)
	End If
	End With
				
    'validate user id table exist or not
    With Browser("PeopleSoft Browser").Page("Roles").PSFrame("TargetContent").WebTable("User ID")
    If.Exist(nMINWAIT) Then
		Call WriteToReport(micPass,"User ID table is present", "and displayed",False)
		Else
		Call WriteToReport(micFail,"User ID table is not present", "and not displayed",True)
	End If
	End With
	
	'validate Roleuser		
    with Browser("PeopleSoft Browser").Page("Roles").PSFrame("TargetContent")
       If.WebElement("RoleUser").Exist(nMINWAIT) Then
	      Call WriteToReport(micPass,"Role user is present","and displayed "&.WebElement("RoleUser").GetROProperty("innertext"),false)
	   End If
	End With
		

		End Function

'*************************************************************************************************************************
''' <summary>  
''' ep_captureApproverNames()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Vijay anandan</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'*********************************************************************************************************************************
'4.01
Public Function DropShip

'Navigate to Below page
'eProcurement > Buyer Center > Manage Purchase Orders

SignInUser=GlobalDictionary("SignInUser")
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
businessunit=(GlobalDictionary("businessunit"))

'click on search button
With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebButton("Clear")
If .Exist(nMainWait) Then
	.Click
		Call WriteToReport(micPass,"Clear button is present", "and displayed",False)
		Else
		Call WriteToReport(micFail,"Clear button is not present", "and not displayed",True)
End If
End WIth

'click on search button
WIth Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Search button is present", "and displayed",False)
		Else
		Call WriteToReport(micFail,"Search button is not present", "and not displayed",True)
End If
End With 

'validate searchresult table is present or not
WIth Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebTable("Searchresults")
     If.Exist(nMINWAIT) Then
		Call WriteToReport(micPass,"Searchresults table is present", "and displayed",False)
		Else
		Call WriteToReport(micFail,"Searchresults table is not present", "and not displayed",True)
	End If
	End With
	
'click on PO Link
	Set oLink=Description.Create
	oLink("MicClass").value="Link"
	oLink("class").value="PSHYPERLINK"
	oLink("html id").value="PO_ID_FLG.*"
	
	Set oObj=Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").ChildObjects(oLink)
	oObj(0).click
	Call WriteToReport(micPass,"POID link is displayed", "and clicked",False)
	
'	With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("Browsing PO").Link("POID Link")
'	If .Exist(nMINWAIT) Then
'		.Click
'		Call WriteToReport(micPass,"POID link is displayed", "and clicked",False)
'		Else
'		Call WriteToReport(micFail,"POID link is not displayed", "and not clicked",True)
'	End If
'	End With
	
'Validate PO Status
	WIth Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("Purchase Order").WebTable("PO Status")
     If.Exist(nMINWAIT) Then
		Call WriteToReport(micPass,"PO Status  is present", "and displayed",False)
		Else
		Call WriteToReport(micFail,"PO Status  is not present", "and not displayed",True)
	End If
	End With

'verify Dropshipflag	
	With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("Purchase Order").WebElement("DropShipFlag")
	If.Exist(nMINWAIT) Then
	If StrComp(.GetROProperty("innertext"),"No",1)=0 Then
		Call WriteToReport(micPass,"DropShipFlag is displayed", "and status is "&.GetROProperty("innertext") ,False)
		Else
		Call WriteToReport(micFail,"DropShipFlag isn't displayed", "as No , Actual is "&.GetROProperty("innertext")  ,True)
	End If
	End If
	End with
	
	
End Function

'*************************************************************************************************************************
''' <summary>  
''' ep_captureApproverNames()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Vijay anandan</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'*********************************************************************************************************************************
'1.04 : EPro CAN  

Public Function AmntOnlyFlag
	
	'Navigate to eProcurement > Requisitions

	SignInUser=GlobalDictionary("SignInUser")
    SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	businessunit=(GlobalDictionary("businessunit"))
	Dept=(GlobalDictionary("Dept"))
	price=(GlobalDictionary("price"))
	qty=(GlobalDictionary("qty"))
	UOM=(GlobalDictionary("UOM"))
	Category=(GlobalDictionary("Category"))
	SupplierID=(GlobalDictionary("SupplierID"))
	comments=(GlobalDictionary("comments"))
	
		'set bu
		
		WITH Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebEdit("ECAN_BusinessUnit")
		if .Exist(nminwait) Then
		    .Set  businessunit
		  	Reporter.ReportEvent micPass,"Business Unit  "," Business Unit field is present and entered as"&businessunit
		End If
		End with
		
		'click on search button
	WIth Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Add")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Add button is present", "and displayed",False)
		Else
		Call WriteToReport(micFail,"Add button is not present", "and not displayed",True)
	End If
	End With 
	
	
	'click on requisition setting link
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("Requisition Settings")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Requisition Settings link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Requisition Settings link is not displayed", "and not clicked",True)
	End If
	End With
	
	'select override radio button	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebRadioGroup("Override_radbutton")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Override option is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Override option is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on chartfield2 Tab
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebElement("ChartField2")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Chartfields2_Tabis displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Chartfields2_Tab is not displayed", "and not clicked",True)
	End If
	End With
	
	
	'set Dept ID
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebEdit("Dept")
	    If .Exist(nMINWAIT) Then
		.Set Dept
		Call WriteToReport(micPass,"IChartfields2_DeptID is present ","and set with="&Dept, false)
	End If
	End  With
	
	'click  on OK button
      With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"OK button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"OK button is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on special request link
  With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("Special Requests")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Special Requests link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Special Requests link is not displayed", "and not clicked",True)
	End If
	End With

Call  EProCANaddSpecialRequisition(Category,Qty,UOM,SupplierID,price)


	'click on checkout button
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Checkout")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Checkout button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Checkout button is not displayed", "and not clicked",True)
	End If
	End With

	'click on Expand section
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Image("Expand Section")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Expand Section is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Expand Section is not displayed", "and not clicked",True)
	End If
	End With

'Wait for the application to sync
 app_SearchSync()
 
 	'click on expand section accounting
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Image("Expand section Accounting")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Expand Section Accounting is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Expand Section  Accounting is not displayed", "and not clicked",True)
	End If
	End With
	
	
	'To click on Line Details
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Image("Line Details")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Line details","is present and clicked",false)
	End If
End  With

app_SearchSync()

'To select amount only check box
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Line Details").WebCheckBox("LineDetails_AmountOnly")
	If .Exist(nMINWAIT) Then
		.Set "ON"
		Call WriteToReport(micPass,"Amount only check box","is checked",false)
	End If
End  With


'To click ok 
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Line Details").WebButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"OK button is present","and clicked",false)
	End If
End  With

'validate alert message	
	 With Browser("PeopleSoft Browser").Page("Requisition")
      If .WebElement("Message").Exist(nminwait) Then
          WriteToReport micPass,"alertMsg is present","and displayed as"&.WebElement("Message").GetROProperty("innertext"),false
      End If
      If .WebButton("Yes").Exist(nminwait) Then
         .WebButton("Yes").Click
      End If
      End With

app_SearchSync()
	
	
	'To add the code to check quantity change to 1
'To get the value of quantity before checking amount only check box
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebEdit("txt_Quantity")
	If .Exist(nMINWAIT) Then
		qtyval=.GetROProperty("value")
		Call WriteToReport(micPass,"The Quantity value after selecting amount only is="&qtyval,"is displayed successfully",false)
	End If
End  With

'To collapse the image icon for item
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Image("Collapse Section")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End  With

'To enter requisition comments
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebEdit("ReviewSubmit_RequisitionComments")
	If .Exist(nMINWAIT) Then
		.Set comments
		Call WriteToReport(micPass,"Comments","is set",false)
	End If
End  With

'To click Save for later button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Save for Later")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Save for Later button","is clicked",false)
	End If
End  With

'To click preview approvals link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("PreviewApprovals")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Preview Approvals link","is clicked",false)
	End If
End  With

app_SearchSync()

 Dim ApproverList,RequesitionID
		ApproverList=ep_captureApproverNames(Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals"))
		
		If IsArray(ApproverList) Then
			For k = 0 To Ubound(ApproverList) Step 1
				GlobalDictionary("user"&k+1)=ApproverList(k)
			Next
			GlobalDictionary("TotalUsers")=UBound(ApproverList)+2
		End If
		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")
			If .WebElement("Preview_Status").Exist(nminwait) Then
				WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("Preview_Status").GetROProperty("innertext") ,false
			End If
			If .WebButton("Return").Exist(nminwait) Then
				.WebButton("Return").Click
			End If
		End With
				
		app_searchsync()
		
		

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
			RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
			WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
		End If
		If .WebButton("Save & submit").Exist(nminwait) Then
			.WebButton("Save & submit").Click
			WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
		End If
End With
	
	With Browser("PeopleSoft Browser").Page("Requisition")
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
	If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
		WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
	End If
	If .WebElement("Confirmation_status").Exist(nminwait) Then
		WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
	End If
End With
	

End Function

	'*************************************************************************************************************************
''' <summary>  
''' ep_captureApproverNames()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Vijay anandan</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'*********************************************************************************************************************************
'1.02 : EPro CAN 

Public Function TwolineQtyPrice

'Navigate to eProcurement > Requisitions

	SignInUser=GlobalDictionary("SignInUser")
    SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	businessunit=(GlobalDictionary("businessunit"))
	Dept=(GlobalDictionary("Dept"))
	price=(GlobalDictionary("price"))
	qty=(GlobalDictionary("qty"))
	UOM=(GlobalDictionary("UOM"))
	Category=(GlobalDictionary("Category"))
	SupplierID=(GlobalDictionary("SupplierID"))
	comments=(GlobalDictionary("comments"))
	price1=(GlobalDictionary("price1"))
	qty1=(GlobalDictionary("qty1"))
	UOM1=(GlobalDictionary("UOM1"))
	Category1=(GlobalDictionary("Category1"))
	SupplierID1=(GlobalDictionary("SupplierID1"))
	
	'enter bu
	WITH Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebEdit("ECAN_BusinessUnit")
		if .Exist(nminwait) Then
		    .Set  businessunit
		  	Reporter.ReportEvent micPass,"Business Unit  "," Business Unit field is present and entered as"&businessunit
		End If
		End with
		
		'click on search button
	WIth Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Add")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Add button is present", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Add button is not present", "and not clicked",True)
	End If
	End With 
	
	
	'click on requsitioon settings link
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("Requisition Settings")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Requisition Settings link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Requisition Settings link is not displayed", "and not clicked",True)
	End If
	End With
	
	'select override radio button	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebRadioGroup("Override_radbutton")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Override option is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Override option is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on chartfield2 Tab
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebElement("ChartField2")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Chartfields2_Tabis displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Chartfields2_Tab is not displayed", "and not clicked",True)
	End If
	End With
	
	
	'set Dept ID
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebEdit("Dept")
	    If .Exist(nMINWAIT) Then
		.Set Dept
		Call WriteToReport(micPass,"IChartfields2_DeptID is present ","and set with="&Dept, false)
	End If
	End  With
	
	'click  on OK button
      With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"OK button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"OK button is not displayed", "and not clicked",True)
	End If
	End With
	
	'Click on special request link	
  With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("Special Requests")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Special Requests link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Special Requests link is not displayed", "and not clicked",True)
	End If
	End With

Call  EProCANaddSpecialRequisition(Category,Qty,UOM,SupplierID,price)
WriteToReport micPass,"Requsistion 1"," Requesition 1 added to the cart successfully",false


Call  EProCANaddSpecialRequisition(Category1,Qty1,UOM1,SupplierID1,price1)
WriteToReport micPass,"Requsistion 2"," Requesition 2 added to the cart successfully",false

'click on checkout button
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Checkout")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Checkout button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Checkout button is not displayed", "and not clicked",True)
	End If
	End With

'Wait for the application to sync
 app_SearchSync()
 
 
	
	'To enter requisition comments
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebEdit("ReviewSubmit_RequisitionComments")
	If .Exist(nMINWAIT) Then
		.Set comments
		Call WriteToReport(micPass,"Comments is present ","and set with="&comments, false)
	End If
End  With

'To click Save for later button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Save for Later")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Save for Later button","is clicked",false)
	End If
End  With

'To click preview approvals link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("PreviewApprovals")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Preview Approvals link","is clicked",false)
	End If
End  With

app_SearchSync()

 Dim ApproverList,RequesitionID
		ApproverList=ep_captureApproverNames(Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals"))
		
		If IsArray(ApproverList) Then
			For k = 0 To Ubound(ApproverList) Step 1
				GlobalDictionary("user"&k+1)=ApproverList(k)
			Next
			GlobalDictionary("TotalUsers")=UBound(ApproverList)+2
		End If
		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")
			If .WebElement("Preview_Status").Exist(nminwait) Then
				WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("Preview_Status").GetROProperty("innertext") ,false
			End If
			If .WebButton("Return").Exist(nminwait) Then
				.WebButton("Return").Click
			End If
		End With
				
		app_searchsync()
		
			With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
			RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
			WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
		End If
		If .WebButton("Save & submit").Exist(nminwait) Then
			.WebButton("Save & submit").Click
			WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
		End If
End With
	
	With Browser("PeopleSoft Browser").Page("Requisition")
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
	If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
		WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
	End If
	If .WebElement("Confirmation_status").Exist(nminwait) Then
		WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
	End If
End With

 End Function



'*********************************************************************************************************************************
''' <summary>  
''' CreateMassApprovalRequistion 
'''Parameter1:	None.
''' <para>
''' <note></note> 
''' </para>
''' </summary>
''' <author>Vijayakumar N</author>
''' <datecreated>3/6/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'CreateMassApprovalRequistion
Public Function CreateMassApprovalRequistion
'Navigate to below path to create the requisition
For k1 = 0 To 1 Step 1

'wait for the ojects to get loaded
app_SearchSync()

Call CreateSpecialReq()

app_SearchSync()
Next

'Call ManageRequisitionAprroverSearch()
app_SearchSync()

End Function

Public Function MassApproval
'
SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
app_SearchSync()
Call ManageRequisitionAprroverSearch()
app_SearchSync()
With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("ManageRequisition")
if .Link("Mass Approve Link").Exist(nMINWAIT) Then
	.Link("Mass Approve Link").Click
End  If

if .WebButton("ManReqAppr_Submit").Exist(nMINWAIT) Then
	.WebButton("ManReqAppr_Submit").Click
End  If



End  With
app_SearchSync()
With Browser("PeopleSoft Browser").Page("ManageReqApprovals").PSFrame("SubmitConfirmation")

if .WebButton("SubConf_Ok").Exist(nMINWAIT) Then
End  If
End  With
app_SearchSync()

GLobalDictionary("Status") ="Approved"
Call ManageRequisitionAprroverSearch()



End Function


Function ApproveWithAttachment

	'Create New special Requisition with Attachment
	Call CreateSpecialReq()
	
	'signin as admin to get userids
	GlobalDictionary("SignInUser")=GlobalDictionary("Admin")
	UserSignIn
	
	'Retrieve User ID's
	retrieveUserID()
	
	'signin as fist level approver to approve the requisition using Manage Requisition Approval
	GlobalDictionary("SignInUser")=GlobalDictionary("userID1")
	UserSignIn
		
	'SelectMainMenu1(GlobalDictionary("MainMenuSelectionManageRequisitionApproval"))	
	Call ManageRequisitionbyApproval()
		
	'signin as second level approvar and approve the requisition by Worklist
	GlobalDictionary("SignInUser")=GlobalDictionary("userID2")
	UserSignIn
	
	'Call ManageRequisitionbyApproval()
	
	'WorkList>WorkList
	SelectMainMenu1(GlobalDictionary("MainMenuSelectionWorklist"))
		RequesitionID=GlobalDictionary("RequisitionID")
	If Not ep_approveRequisitionWorklist(Trim(RequesitionID)) Then
		WriteToReport micfail,"Requsition doesn't get approved","Requsition does't approved by approver "&GlobalDictionary("userID" & l),false
	End If
	
	'signin as fist level approver to approve the requisition using Manage Requisition Approval
	GlobalDictionary("SignInUser")=GlobalDictionary("userID3")
	UserSignIn
	
	Call ManageRequisitionbyApproval()
	

	GlobalDictionary("SignInUser")=GlobalDictionary("Admin")
		
	'signin as admin to get userids
	UserSignIn
		
	'eProcurement > Buyer Center > Expedite Requisitions
	SelectMainMenu1(GlobalDictionary("MainMenuSelectionExpenditeRequisition"))
	
	Call ExpenditeRequisitionsSearch()
	
	
	GlobalDictionary("SignInUser")=GlobalDictionary("RequestorName")

	UserSignIn
	
	'eProcurement > Buyer Center > Expedite Requisitions
	SelectMainMenu1(GlobalDictionary("MainMenuSelectionManageRequisition"))
	
	BusinessUnit=GlobalDictionary("businessunit")
	RequisitionId=GlobalDictionary("RequisitionID")
	Call ManageRequisitionSearch(BusinessUnit,RequisitionId)
	
	app_SearchSync()
	'Expand Line Details
	With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebTable("ManReq_RequistionList") 

	If .Image("Expand Image").Exist(wMinWait) Then
		.Image("Expand Image").Click
		Reporter.ReportEvent micPass,"Expand icon","Expand icon is displayed and clicked" 
	End If
	
	app_SearchSync()
	
	'Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebTable("ManReq_RequistionList").Link("Purchase order Icon").Click

	If Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebTable("ManReq_RequistionList").Link("Purchase order Icon").Exist(wMinWait) Then
	Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebTable("ManReq_RequistionList").Link("Purchase order Icon").Click
	End If
	app_SearchSync()

	End  With
	
	'Verify the Requisition status
	Dim Status
	With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("PO Line Inquiry").WebElement("Status")
	If .Exist(WMinWait) Then
		Status=.GetROProperty("innertext")
	End If
	
	If (Status="Approved") Then
		Reporter.ReportEvent micPass,"Requisition status","Requisition status = "&Status
	Else
		Reporter.ReportEvent micFail,"Requisition status","Requisition status = "&Status
	End If
	
	End  With
	
	End  Function

Function ExpenditeRequisitionsSearch
BusinessUnit=GlobalDictionary("businessunit")
RequisitionId=GlobalDictionary("RequisitionID")
'RequisitionId="0000051202"


Requestor=GlobalDictionary("RequestorName")

With Browser("PeopleSoft Browser").Page("Expendite Requisitions").PSFrame("Expendite Requisition Frame")
	If .WebElement("Expendite Requisition Header").Exist(wMinWait) Then
		Reporter.ReportEvent micPass,"Expendite Requisition Page","Expendite Requisition Page is displayed successfully"
	End If
	
	If .WebEdit("Business Unit").Exist(wMinWait) Then
		.WebEdit("Business Unit").Set BusinessUnit
		Reporter.ReportEvent micPass,"Business unit","Business unit edit field is displayed and set "&BusinessUnit 
	End If
	
	If .WebEdit("Requisition Id").Exist(wMinWait) Then
		.WebEdit("Requisition Id").Set RequisitionId
		Reporter.ReportEvent micPass,"Requisition Id","Requisition Id edit field is displayed and set "&RequisitionId
	End If
	
	If .WebEdit("Requestor").Exist(wMinWait) Then
		.WebEdit("Requestor").Set Requestor
		Reporter.ReportEvent micPassl,"Requestor","Requestor edit field is displayed and set "&Requestor
	End If
	
	If .WebButton("Search").Exist(wMinWait) Then
		 .WebButton("Search").Click
		Reporter.ReportEvent micPass,"Search button","Search button is displayed and clicked"
	End If
	
	app_SearchSync()
	
	If .WebCheckBox("Include checkbox").Exist(wMinWait) Then
		 .WebCheckBox("Include checkbox").Set "ON"
		Reporter.ReportEvent micPass,"Inclue checkbox","Inclue checkbox is present and set On" 
	End If
	
	app_SearchSync()
	
	If .WebButton("Submit").Exist(wMinWait) Then
		 .WebButton("Submit").Click
		Reporter.ReportEvent micPass,"Submit button","Submit button is displayed and clicked" 
	End If

app_SearchSync()

	If .Link("Go To Process Monitor").Exist(wMinWait) Then
		 .Link("Go To Process Monitor").Click
		Reporter.ReportEvent micPass,"Go To Process Monitor","Go To Process Monitor Link is displayed and clicked" 
	End If
	
	End With

	GlobalDictionary("instanceNumber")=Browser("creationtime:=0").Page("index:=1").WebTable("class:=PSLEVEL1GRID","html tag:=TABLE","name:=Select").GetCellData(2,2)

	Call CheckProcessMontiorStatus_PCARD()
	
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Save").Exist(wMinWait) Then
	
		Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Save").Click
	End If

	app_SearchSync()
	
End Function

'**********************************************************************************************************************************
Public Function EditandSubmitRequitision()
Dim AcctNumber,DeptName,appNO,TotalLines,LInes
AcctNumber=GlobalDictionary("AcctNo")
DeptName=GlobalDictionary("DeptName")

'Gettign the line count
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("eProReq_TotalLines")
If .Exist Then
	appNO=.GetROProperty("innertext")
	TotalLines=split(appNO," ")
	LInes=TotalLines(0)
	'Reporter.ReportEvent micPass,"The Total Requisisiton lines","is"&LInes
End If
End  With

'Click on Check out button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"THe check out button","is present and clicekd"
	Else
	Reporter.ReportEvent micFail,"The check out button","is not present and clicked"
End If
End  With 

'wait for the ojects to get loaded
For i=0 to 2
	app_SearchSync()
Next

If LInes<2 Then
	
'Clickon Expand section
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Expand section is","present and clicekd"
	Else
	Reporter.ReportEvent micFail,"The expand section","is not present and clicked"
End If
End  With 

'Expand the Account section if not
WIth Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand section Accounting")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The accounting section","is expanded"
	Else
	Reporter.ReportEvent micPass,"The Accounting section is","already expanded"
End If
End  With 

'Click on Chartfiedl line 2
WIth Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields2_Tab")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Chartfield tab","is presetna nd clicekd"
End If
End  With 

'Enter th edetails oint eh Chartfield section
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
If .Exist(nMINWAIT) Then
	.Set AcctNumber
	Reporter.ReportEvent micPass,"The Chartfeild tab","is present and clicekd"
End If
End  With 

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
If .Exist(nMINWAIT) Then
	.Set DeptName
End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Collapse Section")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 
End  If

If LInes>1 Then
For i=0 to LInes-1
appAcctNos=Split(GlobalDictionary("AcctNo"),";")
appDeptName=Split(GlobalDictionary("DeptName"),";")
'Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section").SetTOProperty "Index",i+1
'Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section").Click
Set oImg=Description.Create
oImg("alt").value="Expand Section"
oImg("html tag").value="IMG"
oImg("name").value="PV_REQ_LINE_WRK_PV_EXPAND_SECT.*"
Set oExpand=Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").ChildObjects(oImg)
oExpand(i).click

'If i>0 Then
'Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Collapse Section").SetTOProperty "Index",i
'Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Collapse Section").Click
'End If

'Expand the Account section if not
WIth Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand section Accounting")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The accounting section","is expanded"
	Else
	Reporter.ReportEvent micPass,"The Accounting section is","already expanded"
End If
End  With 

'Click on Chartfiedl line 2
WIth Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields2_Tab")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Chartfield tab","is presetna nd clicekd"
End If
End  With 

'Enter th edetails oint eh Chartfield section
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
If .Exist(nMINWAIT) Then
	.Set appAcctNos(i)
	Reporter.ReportEvent micPass,"The Chartfeild tab","is present and clicekd"
End If
End  With 

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
If .Exist(nMINWAIT) Then
	.Set appDeptName(i)
End If
End  With

Set oCollapse=Description.Create
oCollapse("alt").value="Collapse Section"
oCollapse("html tag").value="IMG"
oCollapse("name").value="PV_REQ_LINE_WRK_PV_COLLAPSE_SECT.*"

Set CollapseSection=Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").ChildObjects(oCollapse)
CollapseSection(0).click

Next
End If

'Click on save for later
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save for Later")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Save for later","butto is present and clicked"
End If
End  With 

'wait for the ojects to get loaded
For i=0 to 2
	app_SearchSync()
Next

'CLick on Preview approvals page

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("PreviewApprovals")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micDone,"The Preview approval link","isd present and clicked"
End If
End with 

'wait for the ojects to get loaded
For i=0 to 2
	app_SearchSync()
Next

'Capture the Approver names
Set oPreviewApproverFrame=Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")

ApproverNames=ep_captureApproverNames(oPreviewApproverFrame)
GlobalDIctionary("ApproverNames")=ApproverNames

'CLick on Return button in the preview approval form
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals").WebButton("PreAppr_Return")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The return button is","presetna nd clicked"
End If
End  With 

'Click on Submit button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save & submit")
	If .Exist(nMINWAIT) Then
		.Click
		Reporter.ReportEvent micPass,"Submit button","is present and clicked"
	End If
End With

'wait for pplitio load
For i=0 to 2 
	app_SearchSync()
Next

'Validate teh error message
With Browser("PeopleSoft Browser").Page("Requisition").WebElement("Message")
If .Exist(nMINWAIT) Then
	appMessage=.GetROProperty("innertext")
	Reporter.ReportEvent micDone,"Following pop up message","is gettign displayed"&appMessage
End If	
End With

'CLick on Ok butyton
With Browser("PeopleSoft Browser").Page("Requisition").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth

'Get the requisition ID
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Specialrequest_RequesitionID")
If .Exist(nMINWAIT) Then
	appRequisitionID=.GetROProperty("innertext")
	GlobalDictionary("RequisitionID")=appRequisitionID
End If
End  With

With Browser("PeopleSoft Browser").Page("index:=1")
If .Exist(nMINWAIT) Then
	Set oObj=Description.Create
	oObj("MicClass").value="WebElement"
	oObj("class").value="awStageLabel"
	oObj("html tag").value="TD"
	Set oApproved=.ChildObjects(oObj)
	For i=0 to oApproved.count-1
		appApprovalFlow=oApproved(i).getRoProperty("innertext")
		Reporter.ReportEvent micDone,"The name of the approval flow","is"&appApprovalFlow
		Wait(2)
	Next
End If
End  With

With Browser("PeopleSoft Browser").Page("index:=1")
If .Exist(nMINWAIT) Then
	Set oObj=Description.Create
	oObj("MicClass").value="WebElement"
	oObj("class").value="awPathHeader"
	oObj("html tag").value="TD"
	Set oApproved=.ChildObjects(oObj)
	For i=0 to oApproved.count-1
		appApprovalFlow=oApproved(i).getRoProperty("innertext")
		Reporter.ReportEvent micDone,"The name of the approval flow","is"&appApprovalFlow
		Wait(2)
	Next
End If
End  With

GlobalDictionary("RequestorName")=GlobalDictionary("SignInUser")

End  Function
'*************************************************************************************************************************
Public Function CreateReqAcctDeptRouting()
'Navigate to below navigation to create the requisition
'Navigate to NavBar and select  eProcurement > Requisition > Create Requisition
'Navigate to below path to create the requisition
Category=GlobalDictionary("Category")
Qty=GlobalDictionary("Qty")
UOM=GlobalDictionary("UOM")
SupplierID=GlobalDictionary("SupplierID")
price=GlobalDictionary("price")
dtChartfeild=GlobalDictionary("Account") 
dtDept=GlobalDictionary("Dept")

'Navigate to below navigation
'eProcurement > Requisition > Create Requisition
SelectMainMenu1(GlobalDictionary("CreateRequisition"))

'Click on Requisiion setting link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings")
If .Exist(nMINWAIT) Then
	.Click
	'ENter the details in the REquisiton setting page
	Call RequisitionSettings()
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Special request link","is present and clicked"
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

'Create the Requuistion
Call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)

'wait for the ojects to get loaded
app_SearchSync()

'CLick on Check out button and enter all the details
Call EditandSubmitRequitision()

'wait for the ojects to get loaded
app_SearchSync()
'wait for the ojects to get loaded
app_SearchSync()

'Assign the user to KATHOW to chedck whether he is having asseccto proc3ess montir
GlobalDictionary("SignInUser")=GlobalDictionary("UserSecurityProfile")

'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'wait for the ojects to get loaded
app_SearchSync()

'Function to get the user ID's
Call FindTheUsersList()

'Assign the user to KATHOW to chedck whether he is having asseccto proc3ess montir
GlobalDictionary("SignInUser")=GlobalDictionary("EProNonAdmin")

'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'wait for the ojects to get loaded
app_SearchSync()

'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("CheckMonitorApproval"))

'wait for the ojects to get loaded
app_SearchSync()

'Verify whether Process approval i snot present in the link
iconName="Monitor Approvals"
If Not(Browser("creationtime:=0").page("index:=1").Link("name:=iconName").exist(nMINWAIT)) Then
	Reporter.ReportEvent micPass,"The Monitor Approval","Button is not Presetn for"&GlobalDictionary("SIgnInUser")
End  If

'Assign the USer id to Admin to perform montir approvas
GlobalDictionary("SignInUser")=GlobalDictionary("Admin")

'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'wait for the ojects to get loaded
app_SearchSync()

'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("MonitorApproval"))

ApproverNames=GlobalDIctionary("ApproverNames")
reasignTo=GlobalDictionary("ReassignTo")
reqID=GlobalDictionary("RequisitionID")
ApprovalProcess=GlobalDictionary("ApprovalProcess") 'Requisition
DefinitionID=GlobalDictionary("DefinitionID")   'Share
HeaderStatus=GlobalDictionary("HeaderStatus")
Requestior=GlobalDictionary("RequestorName")

'cHECK THE MONITOR PROCESS APPROVALS
Call ep_ApproveinMonitorApprovals(reqID,ApprovalProcess,DefinitionID,HeaderStatus,Requestior,reasignTo)

'wait for the ojects to get loaded
app_SearchSync()

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("MonitorApprovals").PSFrame("MonitorApprovals").Image("MonApp_Expand")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").page("index:=1")
 Set OoBJ=Description.Create
 
OoBJ("MicClass").value="Link"
OoBJ("title").value="View approver/reviewer information"
Set child=.ChildObjects(OoBJ)
count=child.count
For i=0 to  count-1
	appName=child(i).getRoProperty("innertext")
	Reporter.ReportEvent micDone,"The Approver change name after","admin apprver is"&appName
Next

End With

End Function

'**********************************************************************************************
Public Function AmountOnlyRequisitionAndReceipts()
'Navigate to below navigation to create the requisition
'Navigate to NavBar and select  eProcurement > Requisition > Create Requisition
'Navigate to below path to create the requisition
Category=GlobalDictionary("Category")
Qty=GlobalDictionary("Qty")
UOM=GlobalDictionary("UOM")
SupplierID=GlobalDictionary("SupplierID")
price=GlobalDictionary("price")
dtChartfeild=GlobalDictionary("Account") 
dtDept=GlobalDictionary("Dept")

'Navigate to below navigation
'eProcurement > Requisition > Create Requisition
SelectMainMenu1(GlobalDictionary("CreateRequisition"))

'Click on Requisiion setting link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings")
If .Exist(nMINWAIT) Then
	.Click
	'ENter the details in the REquisiton setting page
	Call RequisitionSettings()
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Special request link","is present and clicked"
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

'Create the Requuistion
Call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)

'wait for the ojects to get loaded
app_SearchSync()

'Click on Check out button

'Click on Check out button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"THe check out button","is present and clicekd"
End If
End  With 

'wait for the ojects to get loaded
For i=0 to 2
	app_SearchSync()
Next

'Clickon Expand section
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Expand section is","present and clicekd"
End If
End  With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Req_Quantity")
If .Exist(nMINWAIT) Then
	Reporter.ReportEvent micDone,"The qutntity before clicking on","Amount only checkbox is"&.GetROProperty("value")
End If
End  With

'CLick on Details link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Requisition_DetailsLink")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The details link","is present and clicked"
End If
End  With 

'Wait for the apoplication to be sync
For i=0 to 2
	app_SearchSync()
Next

'Click on AMount only check box
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Details_LineDetails").WebCheckBox("Details_AmountOnly")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The amount only checkbox","is present and set to On"
End If
End  WIth 

'click on oK button
With Browser("PeopleSoft Browser").Page("Requisition").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Wait for error message to be displayed
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Requisition").WebElement("Message")
If .Exist(nMINWAIT) Then
	Reporter.ReportEvent micPass,"The warning message is","displayed"&.GetROProperty("innertext")
End If
End  WIth 

'CLick on Yes button
With Browser("PeopleSoft Browser").Page("Requisition").WebButton("Yes")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

''Wait for the apoplication to be sync
For i=0 to 1
	app_SearchSync()
Next

'Check whether the quantity is set to 1
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Req_Quantity")
If .Exist(nMINWAIT) Then
	If Cint(.GetROProperty("value"))="1" Then
		Reporter.ReportEvent micPass,"The Quantity is set to","1 after clicking on Amount only checkbox"
	End If
End If
End  With 

'Click on save for later
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save for Later")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Save for later","butto is present and clicked"
End If
End  With 

'wait for the ojects to get loaded
For i=0 to 2
	app_SearchSync()
Next

'CLick on Preview approvals page

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("PreviewApprovals")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micDone,"The Preview approval link","isd present and clicked"
End If
End with 

'wait for the ojects to get loaded
For i=0 to 2
	app_SearchSync()
Next

'Capture the Approver names
Set oPreviewApproverFrame=Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")

ApproverNames=ep_captureApproverNames(oPreviewApproverFrame)
GlobalDIctionary("ApproverNames")=ApproverNames

'CLick on Return button in the preview approval form
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals").WebButton("PreAppr_Return")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The return button is","presetna nd clicked"
End If
End  With 

app_SearchSync()

'Click on Submit button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save & submit")
	If .Exist(nMINWAIT) Then
		.Click
		Reporter.ReportEvent micPass,"Submit button","is present and clicked"
	End If
End With

'wait for pplitio load
For i=0 to 2 
	app_SearchSync()
Next

'Validate teh error message
With Browser("PeopleSoft Browser").Page("Requisition").WebElement("Message")
If .Exist(nMINWAIT) Then
	appMessage=.GetROProperty("innertext")
	Reporter.ReportEvent micDone,"Following pop up message","is gettign displayed"&appMessage
End If	
End With

'CLick on Ok butyton
With Browser("PeopleSoft Browser").Page("Requisition").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth

'Get the requisition ID
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Specialrequest_RequesitionID")
If .Exist(nMINWAIT) Then
	appRequisitionID=.GetROProperty("innertext")
	GlobalDictionary("RequisitionID")=appRequisitionID
End If
End  With

With Browser("PeopleSoft Browser").Page("index:=1")
If .Exist(nMINWAIT) Then
	Set oObj=Description.Create
	oObj("MicClass").value="WebElement"
	oObj("class").value="awStageLabel"
	oObj("html tag").value="TD"
	Set oApproved=.ChildObjects(oObj)
	For i=0 to oApproved.count-1
		appApprovalFlow=oApproved(i).getRoProperty("innertext")
		Reporter.ReportEvent micDone,"The name of the approval flow","is"&appApprovalFlow
		Wait(2)
	Next
End If
End  With

With Browser("PeopleSoft Browser").Page("index:=1")
If .Exist(nMINWAIT) Then
	Set oObj=Description.Create
	oObj("MicClass").value="WebElement"
	oObj("class").value="awPathHeader"
	oObj("html tag").value="TD"
	Set oApproved=.ChildObjects(oObj)
	For i=0 to oApproved.count-1
		appApprovalFlow=oApproved(i).getRoProperty("innertext")
		Reporter.ReportEvent micDone,"The name of the approval flow","is"&appApprovalFlow
		Wait(2)
	Next
End If
End  With

GlobalDictionary("RequestorName")=GlobalDictionary("SignInUser")

'Assign the USer id to Admin to perform montir approvas
GlobalDictionary("SignInUser")=GlobalDictionary("Admin")


'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("MonitorApproval"))

reasignTo=GlobalDictionary("userID1")
reqID=GlobalDictionary("RequisitionID")
ApprovalProcess=GlobalDictionary("ApprovalProcess") 'Requisition
DefinitionID=GlobalDictionary("DefinitionID")   'Share
HeaderStatus=GlobalDictionary("HeaderStatus")
Requestior=GlobalDictionary("RequestorName")

'cHECK THE MONITOR PROCESS APPROVALS
Call ep_ApproveinMonitorApprovals(reqID,ApprovalProcess,DefinitionID,HeaderStatus,Requestior,reasignTo)


'eXPAND THE SECTION
WIth Browser("PeopleSoft Browser").Page("MonitorApprovals").PSFrame("MonitorApprovals").Image("MonApp_Expand")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

With Browser("PeopleSoft Browser").page("index:=1")
 Set OoBJ=Description.Create
 
OoBJ("MicClass").value="Link"
OoBJ("title").value="View approver/reviewer information"
Set child=.ChildObjects(OoBJ)

appName=child(0).getRoProperty("innertext")

Reporter.ReportEvent micDone,"The Approver change name after","admin apprver is"&appName
End With

'GlobalDictionary("RequestorName")=GlobalDictionary("SignInUser")
'wait for the ojects to get loaded
app_SearchSync()

'Navigate to below pagfe
'eProcurement > Buyer Center > Expedite Requisitions
'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("ExpediteRequisition"))

'Enter the details and perform the requisition 
Call ExpediteRequisitions()

'Navigate to belwo navigate to perform manag=e requisisiont
'Navigate to belwo page
'Navigate to eProcurement > Buyer Center > Dispatch Purchase Order
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'wait for the ojects to get loaded
app_SearchSync()

Call ManageRequisitionsLifeCycle()

'wait for the ojects to get loaded
app_SearchSync()

'Navigate to Purchsae order and dispatch
SelectMainMenu1(GlobalDictionary("ManagePurchaseOrder"))

'wait for the ojects to get loaded
app_SearchSync()

'Ent4er all the details and perform dispattch PO order
'Call DispatchPurchaseOrder()

Call ManagePurchaseOrder()

'wait for the ojects to get loaded
app_SearchSync()

'Navigate to belweo page to perfrom manager requisition
'eProcurement > Manage Requisition
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'wait for the ojects to get loaded
app_SearchSync()

If Not GlobalDictionary("flag")="1" Then
	
	
'ENter al the details and enter search
businessUnit=GlobalDictionary("Setting_BusinessUnit")
RequisitionID=GlobalDictionary("RequisitionID")

'Search for manage requisitions
Call ManageRequisitionSearch(businessUnit, RequisitionID)

'wait for the ojects to get loaded
For i=0 To 1
	app_SearchSync()
Next

'Select the receive button and clicko n GO button
Set oDropd=Description.Create
oDropd("MicClass").value="WebList"
oDropd("class").value="PSDROPDOWNLIST"
oDropd("html id").value="PV_REQSTAT_WRK_PV_REQ_ACTION.*"

Set oDropDown=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").ChildObjects(oDropd)
oDropDown(0).select GlobalDictionary("perform")

With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebButton("ManReq_GO")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
For i=0 to 2
	app_SearchSync()
Next

With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ReceiveItems").WebButton("CheckAll")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ReceiveItems").WebButton("ReceiveSelected")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
For i=0 to 1
	app_SearchSync()
Next

'Seelct the BU*siness unit and clickon save receipt
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("CasualReceiving").WebEdit("ReceiveItsm_BU")
If .Exist(nMINWAIT) Then
	.Set (GlobalDictionary("Setting_BusinessUnit"))
End If
End  With 

With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("CasualReceiving").WebButton("CasRec_SaveReceipt")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
For i=0 to 1
	app_SearchSync()
Next

str=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("SucessFrame").WebElement("ReceiptID").GetROProperty("innertext")
Set RegEx = CreateObject("vbscript.regexp") 
RegEx.Pattern = "[^\d]"
RegEx.IgnoreCase = True 
RegEx.Global = True 
numStr=RegEx.Replace(str, "") 
GLobalDIctionary("ReceiptNumber")=numStr
Reporter.ReportEvent micDone,"The receipt number","is"&GLobalDIctionary("ReceiptNumber")

GlobalDictionary("SignInUser")=GlobalDictionary("VoucherCreateUser")

'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'Navigate to regular entryu page to create voucher
'Navigate to Accounts Payable > Vouchers > Add/Update > Regular Entry

SelectMainMenu1(GlobalDictionary("RegularEntry"))
BusinessUnit=GlobalDictionary("Setting_BusinessUnit")
SupplierID=GlobalDictionary("SupplierID")

voucherID=ap_createVoucherWithCopyReceipt(BusinessUnit,SupplierID)

'Wait for some time
app_searchSync()

SelectMainMenu1(GlobalDictionary("Matching"))

'Perfoprm matching
result=ap_matchingVoucher(BusinessUnit,voucherID)

If result="success" Then
	Reporter.ReportEvent micPass,"The matching is done","sucessfully"
	Else
	Reporter.ReportEvent micFail,"THe matching is not done sucessfully"
End If

'Navigate to regular entryu page to create voucher
'Navigate to Accounts Payable > Vouchers > Add/Update > Regular Entry

SelectMainMenu1(GlobalDictionary("RegularEntry"))

'Wait for some time
app_searchSync()
businessunit=GlobalDictionary("Setting_BusinessUnit")
'voucherID=voucherID
Call ap_openExistingVoucher(businessunit,voucherID)

'Wait for some time
app_searchSync()

strMatchStatus="Matched"
Call ap_verifyMatchstatusofVoucher(strMatchStatus,strOption)

End If

End Function
'**********************************************************************************************************
Public Function ExpediteRequisitionsSearch(BusinessUnit,RequisitionID,Requstor)

'Set the business unit
With Browser("PeopleSoft Browser").Page("ExpediteRequisitions").PSFrame("ExpediteRequisitions").WebEdit("ExpReq_BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set BusinessUnit
	Reporter.ReportEvent micPass,"The Business unit is present","and set with"&BusinessUnit
End If
End  With 

'Enter the requisition ID
With Browser("PeopleSoft Browser").Page("ExpediteRequisitions").PSFrame("ExpediteRequisitions").WebEdit("ExpReq_RequisitionId")
If .Exist(nMINWAIT) Then
	.Set RequisitionID
	Reporter.ReportEvent micPass,"The Requisition ID is present","and set with"&RequisitionID
End If
End  With

'Enter the requestor
With Browser("PeopleSoft Browser").Page("ExpediteRequisitions").PSFrame("ExpediteRequisitions").WebEdit("ExpReq_Requestor")
If .Exist(nMINWAIT) Then
	.Set Requstor
	Reporter.ReportEvent micPass,"The Requisitor is present","and set with"&Requstor
End If
End  With

'CLick on Search buttpon
With Browser("PeopleSoft Browser").Page("ExpediteRequisitions").PSFrame("ExpediteRequisitions").WebButton("ExpReq_Search")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The search button","is present and clicked"
End If
End  With 

End Function

'*************************************************************************************************************
Public Function ExpediteRequisitions()
'Enter all the mandatory details and search for requisitions
BusinessUnit=GlobalDictionary("Setting_BusinessUnit")
RequisitionID=GlobalDictionary("RequisitionID")
Requstor=GlobalDictionary("RequestorName")

'TO search for the rwquisiotn
Call ExpediteRequisitionsSearch(BusinessUnit,RequisitionID,Requstor)


'wait for pplitio load
 app_searchSync():Count=0
 While (Not Browser("PeopleSoft Browser").Page("ExpediteRequisitions").PSFrame("ExpediteRequisitions").WebCheckBox("ExpReq_IncludeAll").Exist(nminwait)) AND count<10
  app_searchSync():count=count+1
  Wend
  
  'Click on Incluide all exclude all button
  With Browser("PeopleSoft Browser").Page("ExpediteRequisitions").PSFrame("ExpediteRequisitions").WebCheckBox("ExpReq_IncludeAll")
  	If .Exist(nMINWAIT) Then
  		.Click
  		Reporter.ReportEvent micPass,"The includeAll/ExcludeAll","button is present and clicked"
  	End If
  End With
  
  'Get the details fopr default buyer ID
With Browser("PeopleSoft Browser").Page("ExpediteRequisitions").PSFrame("ExpediteRequisitions").WebEdit("ExpReq_BuyerId")
	If .Exist(nMINWAIT) Then
		Reporter.ReportEvent micDone,"The Default value of","Buyer ID is"&.GetROProperty("value")
	End If
End With 

'Click on Submit button
With Browser("PeopleSoft Browser").Page("ExpediteRequisitions").PSFrame("ExpediteRequisitions").WebButton("ExpReq_Submit")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Submit button is","present and clicked"
End If
End  With 

'CLick on Process Monitor
With Browser("PeopleSoft Browser").Page("ExpediteRequisitions").PSFrame("ExpediteRequisitions").Link("ExpReq_ProcessMonitor")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Process monitor link","is present and clicked"
End If
End  With 

'Wait for application to laod
For i=0 to 2
	 app_searchSync()
Next

'Set this process Name
appProcessName=GlobalDictionary("ExpReqProcessName")

'Click on refresh button untill sucess and posted
CheckProcessMontiorStatus (appProcessName)

End Function

'***************************************************************************************************************
Public Function ManageRequisitionsLifeCycle()
'ENter al the details and enter search
businessUnit=GlobalDictionary("Setting_BusinessUnit")
RequisitionID=GlobalDictionary("RequisitionID")

'Search for manage requisitions
Call ManageRequisitionSearch(businessUnit, RequisitionID)

'Wait for application to laod
For i=0 to 1
	 app_searchSync()
Next

'cLICKO N eXPAND BUTTON
WIth Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").Image("ManReq_ExpandReq")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micDone,"The Expand req","is present and clicked"
End If
End  With 

'Wait for application to laod
For i=0 to 1
	 app_searchSync()
Next

'Click on Purchase order link
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").Link("ManReq_PurchaseOrders")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Purchase order was","present and clicked"
End If
End  With 

'Wait for application to laod
For i=0 to 2
	 app_searchSync()
Next


'Get the PO number and verify the status of PO
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("POLineINquiry").WebElement("PoLine_PONumber")
If .Exist(nMINWAIT) Then
	GlobalDictionary("PONUmber")=.GetROProperty("innertext")
End If
End  With 

With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("POLineINquiry").WebElement("PoLIneInquiry_PoStatus")
If .Exist(nMINWAIT) Then
	If instr(1,Trim(.GetROProperty("innertext")),"Approved") Then
		Reporter.ReportEvent micPass,"The status of the PO","is approved"
	End If
End If
End  WIth 

End Function

'********************************************************************************************************
Public Function DispatchPurchaseOrder()
dtRunControl=GlobalDictionary("PurchaseOrder") & RandomNumberGeneraion & Day(Date)
'Clickon General batch dispense
With Browser("PeopleSoft Browser").Page("DispatchPO").Link("DIspatchPO_GeneralBatchDis")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The general batch dispense","is present and clicked"
End If
End  With 

''Wait for application to laod
For i=0 to 2
	 app_searchSync()
Next

With Browser("PeopleSoft Browser").Page("DispatchPO").WebElement("DispatchPO_AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Give teh run control ID
With Browser("PeopleSoft Browser").Page("DispatchPO").WebEdit("DispatchPO_RunControlID")
If .Exist(nMINWAIT) Then
	.Set dtRunControl
	Reporter.ReportEvent micDone,"RUncontrol id","is present and set with"&dtRunControl
End If
End  With 

With Browser("PeopleSoft Browser").Page("DispatchPO").WebButton("DisptachPO_Add")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

''Wait for application to laod
For i=0 to 1
	 app_searchSync()
Next

'Enter allk the details in the PO page
With Browser("PeopleSoft Browser").Page("DispatchPO").WebEdit("DispatchPO_BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set GlobalDIctionary("Setting_BusinessUnit")
	Reporter.ReportEvent micDone,"The Business unit","is present and set with"&GlobalDIctionary("Setting_BusinessUnit")
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("DispatchPO").WebEdit("DispatchPO_POID")
If .Exist(nMINWAIT) Then
	.Set  GlobalDictionary("PONUmber")
	Reporter.ReportEvent micDone,"The PO number field","is present and set with"&GlobalDictionary("PONUmber")
End If
End  With 

With Browser("PeopleSoft Browser").Page("DispatchPO").WebButton("DispatchPO_Run")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()


'Select the check boix next tpo process
With Browser("PeopleSoft Browser").Page("DispatchPO").PSFrame("ProcessScheduler").WebTable("ProcessSch_ProcessSelection")
If .Exist(nMINWAIT) Then
For i=1 to .RowCount 
	appDesc=.GetCellData(i,2)
	If instr(1,Trim(appDesc),"PO Dispatch & Email") Then
		appProcessName=.GetCellData(i,3)
		Set oCheckbox=.ChildItem(i,1,"Link",0)
		If oCheckbox.Exist(nMINWAIT) Then
			oCheckbox.click
			Exit For
		End If
	End If
Next
End If
End  WIth 

'Clkick on Ok button
WIth Browser("PeopleSoft Browser").Page("DispatchPO").PSFrame("ProcessScheduler").WebButton("ProcessSch_Ok")
If .Exist(nMINWAIT) Then
.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

'CLick on Porcess monitr'
With Browser("PeopleSoft Browser").Page("DispatchPO").Link("DIspatchPO_ProcessMonitor")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Click on refresh button untill sucess and posted
CheckProcessMontiorStatus (appProcessName)

End Function

'***********************************************************************************************
Public Function ManagePurchaseOrder()

With Browser("PeopleSoft Browser").Page("ManagePO").PSFrame("ManagePO").WebEdit("ManPO_BusUnit")
If .Exist(nMINWAIT) Then
.Set GlobalDictionary("Setting_BusinessUnit")
End If
End  With 

With Browser("PeopleSoft Browser").Page("ManagePO").PSFrame("ManagePO").WebEdit("ManPO_POId")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("PONUmber")
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("ManagePO").PSFrame("ManagePO").WebButton("ManPO_Search")
If .Exist(nMINWAIT) Then
.Click
End If
End  With


'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("ManagePO").PSFrame("ManagePO").WebTable("ManPO_SearchResults")
If .Exist(nMINWAIT) Then
	appPO=.GetCellData(1,1)
	If appPO=GLobalDictionary("PONUmber") Then
		Set oLInk=.ChildItem(1,1,"Link",0)
		oLInk.click
	End If
End If
End  With 


'wait for the ojects to get loaded
For i=0 to 2 
	app_SearchSync()
Next

'Select the typw as print and select duispatch button
With Browser("PeopleSoft Browser").Page("ManagePO").PSFrame("MaintainPO").WebList("MaintPO_Type")
If .Exist(nMINWAIT) Then
	.Select GlobalDictionary("dispatchType")   'Print
End If
End  With 

'CLick on Dispatch
With Browser("PeopleSoft Browser").Page("ManagePO").PSFrame("MaintainPO").WebButton("MainPO_Dispatch")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
For i=0 to 1
	app_SearchSync()
Next

With Browser("PeopleSoft Browser").Page("ManagePO").PSFrame("DispatchOptions").WebButton("Disp_OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

With Browser("PeopleSoft Browser").Page("ManagePO").WebElement("PopUpMessage")
If .Exist(nMINWAIT) Then
	appMess=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The pop up message is","displaeyd"&appMess
End If
End  With 

With Browser("PeopleSoft Browser").Page("ManagePO").WebButton("PopUp_Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

count=0
While(Browser("PeopleSoft Browser").Page("ManagePO").PSFrame("MaintainPO").WebElement("MainPO_POStatus").GetROProperty("innertext")="Approved") and count<10 
app_searchSync():count=count+1
Wend

With Browser("PeopleSoft Browser").Page("ManagePO").PSFrame("MaintainPO").WebElement("MainPO_POStatus")
	If .Exist(nMINWAIT) Then
		Reporter.ReportEvent micDone,"The PO status is","is"&.GetROProperty("innertext")
	End If
End With

End Function

'*********************************************************************************************************
Public Function ap_createVoucherWithCopyReceipt(Byref businessunit,Byref supplierID)
'	Dim businessunit,supplierID
	Dim voucherID,approvalStatus,invoiceNo,Total,invoiceDate,i,CopyFrom,PayTerm,MatchStatus,Salestax,Misc,Fright,PONumberFrom
	Dim rc,nCount,temp
'	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
'	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
'	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo")&inVoiceNumberGeneration
	invoiceDate=date-2'GlobalDictionary("invoiceDate")
'	supplierID=GlobalDictionary("SupplierID")
	CopyFrom=GlobalDictionary("CopyFrom")
	PayTerm=GlobalDictionary("PayTerm")
	Salestax=GlobalDictionary("Salestax")
	Misc=GlobalDictionary("Misc")
	Fright=GlobalDictionary("Fright")
	PONumberFrom=GlobalDictionary("PONumberFrom")
	AccountNumber=GlobalDictionary("dtAccountNumber1")
	Dept=GlobalDictionary("dtDept1")
	temp=0
	'wait for the ojects to get loaded
	app_SearchSync()

'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit ","is present and entered "&businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id ","is present and entered "&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		.WebButton("Add").highlight
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()

	.WebEdit("invoiceNo").WaitProperty "visible",true,20000
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo
		Call WriteToReport(micPass,"invoiceNo ","is present and entered "&invoiceNo,false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date ","is present and entred as "&invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	If .WebEdit("PayTerms").Exist(nMINWAIT) Then
		.WebEdit("PayTerms").Set PayTerm
		Call WriteToReport(micPass,"PayTerm ","is present and entered as"&PayTerm,false)
		else
		Call WriteToReport(micFail,"PayTerm","is not present",True)
	End If
End with	
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Exist(nMINWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Click
	End If

	If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Exist(nMINWAIT) Then
'		If InStr(supplierID,"...")<>0 Then
		Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Set Replace(supplierID,"...","")
		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Click
		End If

		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").Exist(nMINWAIT) Then
			If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").RowCount))>1 Then
				Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").ChildItem(2,1,"Link",0).click
			End If
		End If
'		else
'			Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID").Set Trim(supplierID)
'		End If
		Call WriteToReport(micPass,"Supplier ID","is present and value entered"&supplierID,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
'	If (NOT IsEmpty(CopyFrom)) AND  CopyFrom<>"" Then
'		temp=1
'		with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")		
'		If .WebList("CopyFrom").Exist(nMINWAIT) Then
'			.WebList("CopyFrom").Select CopyFrom
'			Call WriteToReport(micPass,"CopyFrom","is present and selected "&CopyFrom,false)
'			else
'			Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
'		End If
'		
'		If .Link("Go").Exist(nMINWAIT) Then
''			wait(3)
'			.Link("Go").Click
'			Call WriteToReport(micPass,"go link ","is present and clicked",false)
'			else
'			Call WriteToReport(micFail,"Go link","is not present",True)
'		End If
'		
'		If .WebEdit("POBusinessUnit").Exist(nMINWAIT) Then
'			.WebEdit("POBusinessUnit").Set businessunit
'			Call WriteToReport(micPass,"POBusinessUnit ","is present and entered as"&businessunit,false)
'			else
'			Call WriteToReport(micFail,"POBusinessUnit","is not present",True)
'		End If
'		End with	
'		If NOT IsEmpty(PONumberfrom) AND PONumberfrom<>"" Then
'			If  len(PONumberfrom)>0  Then
'				If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PONumberFrom").Exist(nMINWAIT) Then
'					Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PONumberFrom").Set PONumberFrom
'					Call WriteToReport(micPass,"PONumberFrom ","is present and entered as"&PONumberFrom,false)
'					temp=2
'					else
'					Call WriteToReport(micFail,"PONumberFrom","is not present",True)
'				End If
'			End If
'		End If
'		If temp<>2 Then
'			with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
'	
'				If .WebButton("PONumberLookup").Exist(nMINWAIT) Then
'					.WebButton("PONumberLookup").Click
'				End If
'			End with	
'				
'			app_SearchSync()'wait(4)
'			
'			If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").Exist(nMINWAIT) Then
'				If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").RowCount))>1 Then
'					PONumberFrom=Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").GetCellData(2,2)
'					Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").ChildItem(2,1,"Link",0).click
'					temp=2
'					Call WriteToReport(micPass,"PO number seletced","Selecetd PO number is "&PONumberFrom,True)
'				else
'					Call WriteToReport(micFail,"invoices for "&businessunit&","&supplierID ,"is not present",True)
'				End If
'			End If
'		End If
'	
'		with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
'	
'		If .WebButton("CopyEntireDocument").Exist(nMINWAIT) Then
'			.WebButton("CopyEntireDocument").Click
'			Call WriteToReport(micPass,"CopyEntireDocument","is present and clicked",false)
'			else
'			Call WriteToReport(micFail,"CopyEntireDocument","is not present",True)
'		End If
'		end with 
'		
'		else
'		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Account")
'			.Set AccountNumber
'			Call WriteToReport(micPass,"Account number","is present=" & AccountNumber,false)
'		End With
'
'		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Dept")
'			.Set Dept
'			Call WriteToReport(micPass,"Department number","is present=" & Dept,false)
'		End  With
'	End If
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebList("CopyFrom")
If .Exist(nMINWAIT) Then
	Reporter.ReportEvent micPass,"COpy PO is","present"
	Else
	Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("ExpandCopyPODocs").Click
End If
End  With 
		
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")		
		If .WebList("CopyFrom").Exist(nMINWAIT) Then
			.WebList("CopyFrom").Select CopyFrom
			Call WriteToReport(micPass,"CopyFrom","is present and selected "&CopyFrom,false)
			else
			Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
		End If
		
		If .Link("Go").Exist(nMINWAIT) Then
'			wait(3)
			.Link("Go").Click
			Call WriteToReport(micPass,"go link ","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Go link","is not present",True)
		End If	
End  WIth 

For i=0 to 2
	app_searchSync()
Next

With Browser("PeopleSoft Browser").Page("CopyWorksheet").PSFrame("CopyWorksheet").WebEdit("POBusUnit")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("Setting_BusinessUnit")
End If
End  With 

With Browser("PeopleSoft Browser").Page("CopyWorksheet").PSFrame("CopyWorksheet").Image("PONUmberLookUp")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth 

For i=0 to 1
	app_searchSync()
Next

WIth Browser("PeopleSoft Browser").Page("CopyWorksheet").PSFrame("LoopUp").WebEdit("PO NUmber")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("PONUmber")
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("CopyWorksheet").PSFrame("LoopUp").WebButton("LookUp")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth

For i=0 to 1
	app_searchSync()
Next

With Browser("PeopleSoft Browser").Page("CopyWorksheet").PSFrame("LoopUp").WebTable("SearchResults")
If .Exist(nMINWAIT) Then
	Set oObj=.ChildItem(2,1,"Link",0)
	oObj.click
End If
End  WIth 



'With Browser("PeopleSoft Browser").Page("CopyWorksheet").PSFrame("CopyWorksheet").WebEdit("Copy_PONumber")
'If .Exist(nMINWAIT) Then
'	.Set GlobalDictionary("PONUmber")
'End If
'End  WIth 


With Browser("PeopleSoft Browser").Page("CopyWorksheet").PSFrame("CopyWorksheet").WebEdit("Copy_PONumber")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

For i=0 to 1
	app_searchSync()
Next

With Browser("PeopleSoft Browser").Page("CopyWorksheet").PSFrame("CopyWorksheet").WebButton("Copy_Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth

For i=0 to 1
	app_searchSync()
Next

With Browser("PeopleSoft Browser").Page("CopyWorksheet").PSFrame("CopyWorksheet").Link("COpy_SelectAll")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth

With Browser("PeopleSoft Browser").Page("CopyWorksheet").PSFrame("CopyWorksheet").WebButton("Copy_CopySelectedLines")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 



For i=0 to 2
	app_searchSync()
Next






	
'If temp<>1 Then
	
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
'	.WebEdit("Total").WaitProperty "visible",True,20000

	
	app_SearchSync()
'	If StrComp(GlobalDictionary("Selection"),"fright",1)=0 OR StrComp(GlobalDictionary("SelectionSelection"),"quantity",1)=0 Then
	If NOT IsEmpty(Fright) AND Fright<>""Then
		If  Fright>0  Then
			If .WebEdit("freight").Exist(nMINWAIT) Then
				.WebEdit("freight").Set Fright
				Call WriteToReport(micPass,"Fright ","is present and entered as"&Fright,false)
				else
				Call WriteToReport(micFail,"Fright","is not present",True)
			End If
		End If
	End If
	
	wait 3 
	If NOT IsEmpty(Salestax) AND Salestax<>""Then
		If Salestax>0  Then
			If .WebEdit("salesTax").Exist(nMINWAIT) Then
				.WebEdit("salesTax").Set Salestax
				Call WriteToReport(micPass,"Salestax ","is present and entered as"&Salestax,false)
				else
				Call WriteToReport(micFail,"Salestax","is not present",True)
			End If
		End If
	End If
	wait 3 
	If NOT IsEmpty(Misc) AND Misc<>"" Then
		If  Misc>0  Then
			If .WebEdit("MiscellaousAmount").Exist(nMINWAIT) Then
				.WebEdit("MiscellaousAmount").Set Misc
				Call WriteToReport(micPass,"MiscellaousAmount ","is present and entered as"&Misc,false)
				else
				Call WriteToReport(micFail,"MiscellaousAmount","is not present",True)
			End If
		End If
	End If
	
	If NOT IsEmpty(GlobalDictionary("Quantity")) AND GlobalDictionary("Quantity")<>"" Then
		If  GlobalDictionary("Quantity")>0 Then
			If .WebEdit("Quantity").Exist(nMINWAIT) Then
				If IsEmpty(.WebEdit("Quantity").GetROProperty("value")) OR GlobalDictionary("Quantity")="" OR .WebEdit("Quantity").GetROProperty("value")="" Then
					appUnitPrice=0
				else:appUnitPrice=Cdbl(.WebEdit("Quantity").GetROProperty("value"))
				End If
'				appUnitPrice=Cdbl(.WebEdit("Quantity").GetROProperty("value"))
				Call WriteToReport(micPass,"Quantity captured from application :"&appUnitPrice ,"Quantity is captured from application as "&appUnitPrice ,false)
				appUnitPrice=appUnitPrice+1
				.WebEdit("Quantity").Set(appUnitPrice)
				Call WriteToReport(micPass,"Quantity :"&appUnitPrice ,"Unit price value changed to "&appUnitPrice ,false)
				else
				Call WriteToReport(micFail,"Unitprice","is not present",True)
			End If
		End If
		
		
		If .WebButton("CalculateInvoiceLine").Exist(nMINWAIT) Then
			.WebButton("CalculateInvoiceLine").Click
			Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
		End If
	End If
	
	
	app_SearchSync()
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked for get the difference",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	
	If .WebElement("Difference").Exist(nMINWAIT) Then
		appDifference=.WebElement("Difference").GetROProperty("innertext")
		Call WriteToReport(micPass,"Deifference is captured","Captured from application as"&appDifference,false)
	End If
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		wait 5
		.WebEdit("Total").Click
		appDifference=cdbl(appDifference)+Cdbl(.WebEdit("Total").GetROProperty("value"))
		.WebEdit("Total").Set appDifference
		Call WriteToReport(micPass,"Total : "&appDifference,"is present and entered as "&appDifference,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked to get difeerence",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .WebElement("Difference").Exist(nMINWAIT) Then
		appDifference=.WebElement("Difference").GetROProperty("innertext")
		Call WriteToReport(micPass,"Deifference should be 0","Captured from application as"&appDifference,false)
	End If
	
	
	app_SearchSync()	
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
		If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
		End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	
	'wait for the ojects to get loaded
	app_SearchSync()
	'wait for the ojects to get loaded
	app_SearchSync()
'Voucher id generation validation	
	If .WebElement("voucherID").Exist(nMINWAIT) Then
		voucherID=.WebElement("voucherID").GetROProperty("innertext")
		If StrComp(voucherID,"NEXT",1)<>0 Then
			Call WriteToReport(micPass,"voucherID : "&voucherID,"is present and generated as "&voucherID,false)
			else
			Call WriteToReport(micFail,"voucherID","doesn't get generated",True)
		End If
	End If
	
	
	If .WebTabStrip("tabSelection").Exist(10) Then
		.WebTabStrip("tabSelection").Select("Voucher Attributes")
		Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
	else
		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		appinvoiceNo=.WebEdit("invoiceNo").GetROProperty("value") 
		If StrComp(Trim(appinvoiceNo),trim(invoiceNo))=0 Then
			Call WriteToReport(micPass,"Voucher Attributes ","data is present",false)
'			else
'			Call WriteToReport(micFail,"Voucher Attributes","data is not present",True)
		End If
	End If
	
'	If .WebTabStrip("tabSelection").Exist(10) Then
'		.WebTabStrip("tabSelection").Select("Invoice Information")
'		Call WriteToReport(micPass,"Invoice Information tab","is present",false)
'	else
'		Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
'	End If
	
	If .WebButton("SubmitForApproval_VoucherAttribute").Exist(nMINWAIT) Then
		.WebButton("SubmitForApproval_VoucherAttribute").Click
		Call WriteToReport(micPass,"SubmitApproval button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"SubmitApproval button in invoice information","is not present",True)
	End If
End with
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Sync
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Click
		wait(2)
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Set voucherID&" is Approved"
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Click
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
'wait for the ojects to get loaded
	app_SearchSync()	
	
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").Image("ShowPreviousTab")
If .Exist(nMINWAIT) Then
.Click
End If
End  With 
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
	If .WebTabStrip("tabSelection").Exist(nMINWAIT) Then
		.WebTabStrip("tabSelection").Select("Summary")
		Call WriteToReport(micPass,"Summary tab","is present and selected",false)
	elseIf .WebElement("Summary").Exist(nminwait) Then
		.WebElement("Summary").Click
		Call WriteToReport(micPass,"Summary tab","is present and selected",false)
	else
		Call WriteToReport(micFail,"Summary tab","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebElement("approvalStatus").Exist(nMINWAIT) Then
		approvalStatus=.WebElement("approvalStatus").GetROProperty("innertext")
		If StrComp(approvalStatus,"Approved",1)=0 Then
			Call WriteToReport(micPass,"Approval status changed to Approved status","is present",false)
			else
'			Call WriteToReport(micFail,"Approval status","doesn't chaged to Approved, Actual status is "&approvalStatus,True)
		End If
	End If
	
	If .WebElement("MatchStatus").Exist(nMINWAIT) Then
		MatchStatus=.WebElement("MatchStatus").GetROProperty("innertext")
		If StrComp(MatchStatus,"Ready",1)=0 Then
			Call WriteToReport(micPass,"MatchStatus : "&MatchStatus,"is present and generated as "&MatchStatus,false)
		End If
	End If

End with
'else
'	Call WriteToReport(micFail,"PO Number search","no results(Supllier details) available while PO lookup for BU:"&businessunit,True)
'End If

ap_createVoucherWithCopyReceipt=voucherID 
End Function

'*******************************************************************************************************************
Public Function CopyPOAndPaarovewithSourceReq()
'Navigate to below navigation to create the requisition
'Navigate to NavBar and select  eProcurement > Requisition > Create Requisition
'Navigate to below path to create the requisition
Category=GlobalDictionary("Category")
Qty=GlobalDictionary("Qty")
UOM=GlobalDictionary("UOM")
SupplierID=GlobalDictionary("SupplierID")
price=GlobalDictionary("price")
dtChartfeild=GlobalDictionary("Account") 
dtDept=GlobalDictionary("Dept")

'Navigate to below navigation
'eProcurement > Requisition > Create Requisition
SelectMainMenu1(GlobalDictionary("CreateRequisition"))

'Click on Requisiion setting link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings")
If .Exist(nMINWAIT) Then
	.Click
	'ENter the details in the REquisiton setting page
	Call RequisitionSettings()
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Special request link","is present and clicked"
End If
End  With 

'Create the Requuistion
Call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)

'wait for the ojects to get loaded
app_SearchSync()


'CLick on Check out button and enter all the details
Call EditandSubmitRequitision()

'wait for the ojects to get loaded
app_SearchSync()
'wait for the ojects to get loaded
app_SearchSync()

'Navigate to manage Requisisiont
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'wait for the ojects to get loaded
app_SearchSync()

businessUnit=GlobalDictionary("Setting_BusinessUnit")
RequisitionID=GlobalDictionary("RequisitionID")

Call ManageRequisitionSearch(businessUnit, RequisitionID)

PerformAction=GlobalDictionary("PerformAction")
Call ManageRequisitionActionGO(PerformAction)

'Enter the Details int he Req page and click on Save and submit page
'Click on save for later
name="Test"
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Checkout_ReqName")
If .Exist(nMINWAIT) Then
	.Set name
	Reporter.ReportEvent micDone,"The requisition name","is goven with"&name
End If


With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save for Later")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Save for later","butto is present and clicked"
End If
End  With 

'wait for the ojects to get loaded
For i=0 to 2
	app_SearchSync()
Next

'CLick on Preview approvals page

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("PreviewApprovals")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micDone,"The Preview approval link","isd present and clicked"
End If
End with 

'wait for the ojects to get loaded
For i=0 to 2
	app_SearchSync()
Next

'Capture the Approver names
Set oPreviewApproverFrame=Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")

ApproverNames=ep_captureApproverNames(oPreviewApproverFrame)
GlobalDIctionary("ApproverNames")=ApproverNames

'CLick on Return button in the preview approval form
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals").WebButton("PreAppr_Return")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The return button is","presetna nd clicked"
End If
End  With 

'Click on Submit button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save & submit")
	If .Exist(nMINWAIT) Then
		.Click
		Reporter.ReportEvent micPass,"Submit button","is present and clicked"
	End If
End With

'wait for pplitio load
For i=0 to 2 
	app_SearchSync()
Next

'Validate teh error message
With Browser("PeopleSoft Browser").Page("Requisition").WebElement("Message")
If .Exist(nMINWAIT) Then
	appMessage=.GetROProperty("innertext")
	Reporter.ReportEvent micDone,"Following pop up message","is gettign displayed"&appMessage
End If	
End With

'CLick on Ok butyton
With Browser("PeopleSoft Browser").Page("Requisition").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth

'Get the requisition ID
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Specialrequest_RequesitionID")
If .Exist(nMINWAIT) Then
	appRequisitionID=.GetROProperty("innertext")
	GlobalDictionary("RequisitionID")=appRequisitionID
End If
End  With

With Browser("PeopleSoft Browser").Page("index:=1")
If .Exist(nMINWAIT) Then
	Set oObj=Description.Create
	oObj("MicClass").value="WebElement"
	oObj("class").value="awStageLabel"
	oObj("html tag").value="TD"
	Set oApproved=.ChildObjects(oObj)
	For i=0 to oApproved.count-1
		appApprovalFlow=oApproved(i).getRoProperty("innertext")
		Reporter.ReportEvent micDone,"The name of the approval flow","is"&appApprovalFlow
		Wait(2)
	Next
End If
End  With

With Browser("PeopleSoft Browser").Page("index:=1")
If .Exist(nMINWAIT) Then
	Set oObj=Description.Create
	oObj("MicClass").value="WebElement"
	oObj("class").value="awPathHeader"
	oObj("html tag").value="TD"
	Set oApproved=.ChildObjects(oObj)
	For i=0 to oApproved.count-1
		appApprovalFlow=oApproved(i).getRoProperty("innertext")
		Reporter.ReportEvent micDone,"The name of the approval flow","is"&appApprovalFlow
		Wait(2)
	Next
End If
End  With

GlobalDictionary("RequestorName")=GlobalDictionary("SignInUser")

'wait for the ojects to get loaded
app_SearchSync()

'Assign the user to KATHOW to chedck whether he is having asseccto proc3ess montir
GlobalDictionary("SignInUser")=GlobalDictionary("UserSecurityProfile")

'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'wait for the ojects to get loaded
app_SearchSync()

'Function to get the user ID's
Call FindTheUsersList()

GlobalDictionary("SignInUser")=GlobalDictionary("UserSecurityProfile")
'Logging to application
Call UserSignIn()

'wait for the ojects to get loaded
app_SearchSync()

'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("MonitorApproval"))

ApproverNames=GlobalDIctionary("ApproverNames")
reasignTo=GlobalDictionary("ReassignTo")
reqID=GlobalDictionary("RequisitionID")
ApprovalProcess=GlobalDictionary("ApprovalProcess") 'Requisition
DefinitionID=GlobalDictionary("DefinitionID")   'Share
HeaderStatus=GlobalDictionary("HeaderStatus")
Requestior=GlobalDictionary("RequestorName")

'cHECK THE MONITOR PROCESS APPROVALS
Call ep_ApproveinMonitorApprovals(reqID,ApprovalProcess,DefinitionID,HeaderStatus,Requestior,reasignTo)

'wait for the ojects to get loaded
app_SearchSync()

'wait for the ojects to get loaded
app_SearchSync()
SelectMainMenu1(GlobalDictionary("QuickSourceRequisitions"))
Call QuickSourceRequisition()

'wait for the ojects to get loaded
app_SearchSync()

'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("ExpediteRequisition"))
Call ExpediteRequisitions()

'Navigate to manage Requisisiont
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'wait for the ojects to get loaded
app_SearchSync()
Call ManageRequisitionsLifeCycle()

'wait for the ojects to get loaded
app_SearchSync()

'Navigate to manage Requisisiont
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("SourcingWorkbench"))

'wait for the ojects to get loaded
app_SearchSync()

Call SourceRequisition()

End  With 
End Function

'*********************************************************************************************************
Public Function QuickSourceRequisition()
'Clickon Add new value button
With Browser("PeopleSoft Browser").Page("QuickSorceRequisition").PSFrame("QuickSorceRequisition").WebElement("QuickReq_AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

RunControlId=GlobalDictionary("RunControlIdValue") & inVoiceNumberGeneration
'Enter the Run control ID
With Browser("PeopleSoft Browser").Page("QuickSorceRequisition").PSFrame("QuickSorceRequisition").WebEdit("QuickReq_RunCOntrolId")
If .Exist(nMINWAIT) Then
	.Set RunControlId
	Reporter.ReportEvent micDone,"Ther un control ID is","present and set with"&RunControlId
End If
End  With 

'Clickon Add button'
With Browser("PeopleSoft Browser").Page("QuickSorceRequisition").PSFrame("QuickSorceRequisition").WebButton("QuickReq_Add")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Wait for the application to sync
app_SearchSync()

'ProcessName="PV_AUTO_SRC "
'FIll al the details nad run the process
'Enter From BU
With Browser("PeopleSoft Browser").Page("QuickSorceRequisition").PSFrame("QuickSorceRequisition").WebEdit("QuickReq_FromBU")
If .Exist(nMINWAIT) Then
	.Set GlobalDIctionary("Setting_BusinessUnit")
	Reporter.ReportEvent micDone,"The Business unit","is present and set with"&GlobalDIctionary("BusinessUnit")
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("QuickSorceRequisition").PSFrame("QuickSorceRequisition").WebEdit("QuickReq_FromReqID")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("RequisitionID")
	Reporter.ReportEvent micDone,"The Business unit","is present and set with"&GlobalDIctionary("RequisitionNumber")
End If
End With

'Cateory ID
With Browser("PeopleSoft Browser").Page("QuickSorceRequisition").PSFrame("QuickSorceRequisition").WebEdit("QuickReq_SetId")
If .Exist(nMINWAIT) Then
	.Set GlobalDIctionary("DefinitionID")
	Reporter.ReportEvent micDone,"The Business unit","is present and set with"&GlobalDIctionary("SetID")
End If
End With

'Clickon Run button
With Browser("PeopleSoft Browser").Page("QuickSorceRequisition").PSFrame("QuickSorceRequisition").WebButton("QuickReq_Run")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micDone,"The Run button","is present anc clicked":
End If
End With

'Wait for the application to sync
For i=0 to 2
	app_SearchSync()
Next

With Browser("PeopleSoft Browser").Page("QuickSorceRequisition").PSFrame("ProcessScheduler").WebTable("SearchResults")
If .Exist(nMINWAIT) Then
	appProcessName=.GetCellData(2,3)
	Reporter.ReportEvent micPass,"The process Name","is"&appProcessName
End If
End  With 

With Browser("PeopleSoft Browser").Page("QuickSorceRequisition").PSFrame("ProcessScheduler").WebButton("QuickReq_ProcessOK")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Wait for the application to load
app_SearchSync()

'Clickon Process monitor'
With Browser("PeopleSoft Browser").Page("QuickSorceRequisition").Link("QuickReq_ProcessMonitor")
If .Exist(nMINWAIT) Then
	.Click
End If
End with 

'Clickon refrech button unitll the job is sucess and posted
Call CheckProcessMontiorStatus (appProcessName)

End Function

'**************************************************************************************************************************
Public Function SourceRequisition()
'ENter the Business unit and Requisition ID's
With Browser("PeopleSoft Browser").Page("SourceWorkBench").PSFrame("SourceWorkbench").WebEdit("Source_FromBU")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("Setting_BusinessUnit")
	Reporter.ReportEvent micPass,"The Business unit is present","and set with"&GlobalDictionary("BusinessUnit")
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("SourceWorkBench").PSFrame("SourceWorkbench").WebEdit("Source_Requisition")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("RequisitionID")
	Reporter.ReportEvent micPass,"The Requisition ID","is present and set with"&GlobalDictionary("RequisitionID")
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("SourceWorkBench").PSFrame("SourceWorkbench").WebButton("Source_Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Wait for the application to load
app_SearchSync()

'CLickon Error message tab
With Browser("PeopleSoft Browser").Page("SourceWorkBench").PSFrame("SourceWorkbench").WebElement("Soruce_ErrorMess")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Wait for the application to load
app_SearchSync()

With Browser("PeopleSoft Browser").Page("SourceWorkBench").PSFrame("SourceWorkbench").WebElement("Source_Status")
If .Exist(nMINWAIT) Then
	Reporter.ReportEvent micPass,"The Stage status of the Requisision","is"&.GetROProperty("innertext")
End If
End  WIth 

'CLick on Details link
With Browser("PeopleSoft Browser").Page("SourceWorkBench").PSFrame("SourceWorkbench").Image("Source_Details")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Validate the PO nuber fromteh previous step
With Browser("PeopleSoft Browser").Page("SourceWorkBench").PSFrame("SourceWorkbench").Link("Source_POId")
If .Exist(nMINWAIT) Then
	appPONUmber=.GetROProperty("innertext")
	If instr(1,appPONUmber,GlobalDictionary("PONUmber"))>0 Then
		Reporter.ReportEvent micPass,"The Requisisiont ID","is same as the PO ID created"
	End If
End If
End  With 

End Function


'*********************************************************************************************************************************
''' <summary>  
''' POdispatchReceive 
'''Parameter1:	None.
''' <para>
''' <note></note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/12/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'EP_3_01
Public Function POdispatchReceive()
    
    Dim i
    'Navigate to below page "eProcurement > Requisition"
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
    
    
'    If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings").Exist(nminwait) Then
'        Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings").Click
'        WriteToReport micPass,"Requisition Settings link "," Requisition Settings field is present and clicked",false
'    else
'        WriteToReport micfail,"Requisition Settings link "," Requisition Settings field isn't present",true
'    End If
    
    'requisition settings
    RequisitionSettings
    
    If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests").Exist(nminwait) Then
        Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests").Click
        WriteToReport micPass,"Special Requests link "," Special Requests field is present and clicked",false
    else
        WriteToReport micfail,"Special Requests link "," Special Requests field isn't present",true
    End If
    app_searchsync()

    businessunit=GlobalDictionary("businessunit")
    Price=GlobalDictionary("Price")
    Qty=GlobalDictionary("Qty")
    UOM=GlobalDictionary("UOM")
    Category=GlobalDictionary("Category")
    SupplierID=GlobalDictionary("SupplierID")
    call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)
    WriteToReport micPass,"Requsistion 1"," Requesition 1 added to the cart successfully",false
    
    Price=GlobalDictionary("Price1")
    Qty=GlobalDictionary("Qty1")
    UOM=GlobalDictionary("UOM")
    Category=GlobalDictionary("Category1")
    SupplierID=GlobalDictionary("SupplierID1")
    call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)
    WriteToReport micPass,"Requsistion 1"," Requesition 1 added to the cart successfully",false
    
    If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout").Exist(nminwait) Then
        Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout").Click
        WriteToReport micPass,"Checkout button "," Checkout is present and clicked",false
    else
        WriteToReport micfail,"Checkout button "," Checkout field isn't present",true
    End If
    app_SearchSync()
    WriteToReport micDone,"chartfield2 for line 1"," adding chartfield2 details",false
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
        If .Image("Expand Section").Exist(nminwait) Then
            .Image("Expand Section").Click
        End If
        If .Image("Expand section Accounting").Exist(nminwait) Then
            .Image("Expand section Accounting").Click
        End If
        If .WebElement("Chartfields2_Tab").Exist(nminwait) Then
            .WebElement("Chartfields2_Tab").Click
            WriteToReport micPass,"Checkout button "," Checkout is present and clicked",false
            else
            WriteToReport micfail,"Checkout button "," Checkout field isn't present",true
        End If
        If .WebEdit("Chartfields2_DeptID").Exist(nminwait) Then
            .WebEdit("Chartfields2_DeptID").Set GlobalDictionary("Dept1")
            WriteToReport micPass," in chartfield2"," Dept is present and entered as"&GlobalDictionary("Dept1"),false
        else
            WriteToReport micfail,"Dept in chartfield2 "," field isn't present",true
        End If
        If .WebEdit("Chartfields2_Account").Exist(nminwait) Then
            .WebEdit("Chartfields2_Account").Set GlobalDictionary("Account1")
            WriteToReport micPass,"Account in chartfield2"," Account is present and entered as"&GlobalDictionary("Account1"),false
        else
            WriteToReport micfail,"Account in chartfield2 "," field isn't present",true
        End If
        If .Image("Collapse Section").Exist(nminwait) Then
            .Image("Collapse Section").Click
        End If
        app_SearchSync()
        Dim str
        str=.Image("Expand Section").GetROProperty("name")
        .Image("Expand Section").SetTOProperty "name",Left(str,len(str)-1)&"1"
        .Image("Collapse Section").SetTOProperty "Index",1
        WriteToReport micDone,"chartfield2 for line 2"," adding chartfield2 details",false
        If .Image("Expand Section").Exist(nminwait) Then
            .Image("Expand Section").Click
        End If
        If .Image("Expand section Accounting").Exist(nminwait) Then
            .Image("Expand section Accounting").Click
        End If
        If .WebElement("Chartfields2_Tab").Exist(nminwait) Then
            .WebElement("Chartfields2_Tab").Click
            WriteToReport micPass,"Chartfields2_Tab "," Chartfields2_Tab is present and clicked",false
        else
            WriteToReport micfail,"Chartfields2_Tab "," Chartfields2_Tab field isn't present",true
        End If
        If .WebEdit("Chartfields2_DeptID").Exist(nminwait) Then
            .WebEdit("Chartfields2_DeptID").Set GlobalDictionary("Dept2")
            WriteToReport micPass,"Dept in chartfield2"," Dept is present and entered as"&GlobalDictionary("Dept2"),false
        else
            WriteToReport micfail,"Dept in chartfield2 "," field isn't present",true
        End If
        If .WebEdit("Chartfields2_Account").Exist(nminwait) Then
            .WebEdit("Chartfields2_Account").Set GlobalDictionary("Account2")
            WriteToReport micPass,"Account in chartfield2"," Account is present and entered as"&GlobalDictionary("Account2"),false
        else
            WriteToReport micfail,"Account in chartfield2 "," field isn't present",true
        End If
        If .Image("Collapse Section").Exist(nminwait) Then
            .Image("Collapse Section").Click
        End If
        
        app_searchSync()
        
        If .WebCheckBox("ReviewSubmit_SendtoSupplier").Exist(nminwait) Then
            .WebCheckBox("ReviewSubmit_SendtoSupplier").Set"ON"
        End If
        
        If .WebCheckBox("ReviewSubmit_ShowAtReceipt").Exist(nminwait) Then
            .WebCheckBox("ReviewSubmit_ShowAtReceipt").Set "ON"
        End If
        If .WebCheckBox("ReviewSubmit_ShowatVoucher").Exist(nminwait) Then
            .WebCheckBox("ReviewSubmit_ShowatVoucher").Set "ON"
        End If
        If .WebEdit("ReviewSubmit_approvalJustification").Exist(nminwait) Then
            .WebEdit("ReviewSubmit_approvalJustification").Set SupplierID&" "&now
        End If
        If .WebEdit("ReviewSubmit_RequisitionComments").Exist(nminwait) Then
            .WebEdit("ReviewSubmit_RequisitionComments").Set SupplierID&" "&now
        End If
        If .WebButton("Save for Later").Exist(nminwait) Then
            .WebButton("Save for Later").Click
            WriteToReport micPass,"Save for Later "," Save for Later is present and clicked",false
            else:WriteToReport micfail,"Save for Later "," Save for Later isn't present ",true
        End If
        
        app_searchSync()
        
        If .Link("PreviewApprovals").Exist(nminwait) Then
            .Link("PreviewApprovals").Click
            WriteToReport micPass,"PreviewApprovals "," PreviewApprovals is present and clicked",false
            else:WriteToReport micfail,"PreviewApprovals"," PreviewApprovals isn't present ",true
        End If
        
    End With
        wait(3):app_searchSync()
        wait(3):app_searchSync()
        
Dim ApproverList,RequesitionID
        ApproverList=ep_captureApproverNames(Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals"))
        
        If IsArray(ApproverList) Then
            For k = 0 To Ubound(ApproverList) Step 1
                GlobalDictionary("user"&k+1)=ApproverList(k)
            Next
            GlobalDictionary("TotalUsers")=UBound(ApproverList)+2
        End If
        With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")
            If .WebElement("Preview_Status").Exist(nminwait) Then
                WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("Preview_Status").GetROProperty("innertext") ,false
            End If
            If .WebElement("eProApproval_CATapproval").Exist(nminwait) Then
                WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("eProApproval_CATapproval").GetROProperty("innertext") ,false
            End If
            If .WebElement("eProApproval_ACCTapproval").Exist(nminwait) Then
                WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("eProApproval_ACCTapproval").GetROProperty("innertext") ,false
            End If
            If .WebButton("Return").Exist(nminwait) Then
                .WebButton("Return").Click
                WriteToReport micPass,"Return "," Return is present and clicked",false
            else:WriteToReport micfail,"Return"," Return isn't present ",true
            End If
        End With
                
        app_searchsync()
        
        

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
        If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
            RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
            WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
        End If
        If .WebButton("Save & submit").Exist(nminwait) Then
            .WebButton("Save & submit").Click
            WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
        End If
End With
    
    With Browser("PeopleSoft Browser").Page("Requisition")
        If .WebElement("Message").Exist(nminwait) Then
            WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
        End If
        If .WebButton("OK").Exist(nminwait) Then
            .WebButton("OK").Click
        End If
    End With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
    If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
        WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
    End If
    If .WebElement("Confirmation_status").Exist(nminwait) Then
        WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
    End If
    If .WebTable("eProApproval").Exist(nminwait) Then
        WriteToReport micPass,"Satus of eProcurement Approval "," Status is "&Replace(Replace(Replace(Replace(Trim(.WebTable("eProApproval").GetROProperty("innertext")),"View/Hide Comments",""),"Start New Path",""),"Comment History",""),"Comments","") ,false
    End If
End With

GlobalDictionary("ReqUser")=GlobalDictionary("SignInUser")
GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
    'signin as admin to get userids
    UserSignIn
    
    'PeopleTools>Security>User Profiles>User Profiles
'    SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
    
    'retrieve user id
    retrieveUserID()
    
    If IsArray(ApproverList) Then
    
        GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
        
        'signin as admin to get userids
        UserSignIn
        
        'WorkList>WorkList
        SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
        call ep_ApproveinMonitorApprovals(RequesitionID,GlobalDictionary("ApprovalProcess"),GlobalDictionary("DefinitionID"),GlobalDictionary("HeaderStatus"),GlobalDictionary("ReqUser"),"")
    End If
    
'eProcurement > Buyer Center > Expedite Requisitions
    SelectMainMenu1(GlobalDictionary("MainMenuSelection4"))

    With Browser("PeopleSoft Browser").Page("Expedite Requisitions").PSFrame("Expedite Requisitions")
        If .WebEdit("BusinessUnit").Exist(nminwait) Then
            .WebEdit("BusinessUnit").Set GlobalDictionary("businessunit")
            WriteToReport micPass,"BusinessUnit "," BusinessUnit is present and entered as "&GlobalDictionary("businessunit"),false
            else:WriteToReport micfail,"BusinessUnit"," BusinessUnit isn't present ",true
        End If
        If .WebEdit("Requisition ID").Exist(nminwait) Then
            .WebEdit("Requisition ID").Set RequesitionID
            WriteToReport micPass,"RequesitionID "," RequesitionID is present and entered as "&RequesitionID,false
            else:WriteToReport micfail,"RequesitionID"," RequesitionID isn't present ",true
        End If
        If .WebEdit("Requestor").Exist(nminwait) Then
            .WebEdit("Requestor").Set GlobalDictionary("ReqUser")
            WriteToReport micPass,"Requestor "," Requestor is present and entered as "&GlobalDictionary("ReqUser"),false
            else:WriteToReport micfail,"Requestor"," Requestor isn't present ",true
        End If
        If .WebButton("Search").Exist(nminwait) Then
            .WebButton("Search").Click
            WriteToReport micPass,"Search "," Search is present and clicked",false
            else:WriteToReport micfail,"Search"," Search isn't present ",true
        End If
Dim count2:count2=0    
        While  NOT (.Link("RSL_IncludeAllExcludeAll").Exist(nminwait)) AND Count2<10
            app_SearchSync():count2=count2+1
        Wend
        If .Link("RSL_IncludeAllExcludeAll").Exist(nminwait) Then
            .Link("RSL_IncludeAllExcludeAll").Click
            WriteToReport micPass,"IncludeAll/ExcludeAll "," IncludeAll/ExcludeAll is present and clicked",false
            else:WriteToReport micfail,"IncludeAll/ExcludeAll"," IncludeAll/ExcludeAll isn't present ",true
        End If
        If .WebButton("BPO_Submit").Exist(nminwait) Then
            .WebButton("BPO_Submit").Click
            WriteToReport micPass,"Submit "," Submit is present and clicked",false
            else:WriteToReport micfail,"Submit"," Submit isn't present ",true
        End If
        app_searchsync()
        If .WebButton("Search").Exist(nminwait) Then
            .WebButton("Search").Click
            WriteToReport micPass,"Search "," Search is present and clicked",false
            else:WriteToReport micfail,"Search"," Search isn't present ",true
        End If
        app_searchsync()
        If .WebElement("Message").Exist(nminwait) Then
            WriteToReport micPass,"Requisistion submitted successfully "," Requisistion submitted successfully",false
        End If
    End With
    'PeopleTools>Process Scheduler>Process Monitor
    SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))
    
    app_Searchsync()
    Dim Count1
    With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor")
        If .WebTable("ProcessTable_ProcessMonitor").Exist(nminwait) Then
            Count1=0
            do while StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)<>0 AND count1<100
                If .WebButton("Refresh").Exist(nminwait) Then
                    .WebButton("Refresh").Click: count1=count1+1
                    WriteToReport micPass,"Refresh "," Refresh is present and clicked",false
                End If
                app_Searchsync()
            loop
            If StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)=0 Then
                WriteToReport micPass,"Instace get processed successfully "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" is processed successfully",false
                else
                WriteToReport micfail,"Instace doesn't get processed "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" isn't processed",false
            End If
            
        End If
    End With
    
    'eProcurement>Manage Requisitions
    SelectMainMenu1(GlobalDictionary("MainMenuSelection5"))
    

    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition")
        If .WebEdit("ManReq_BusinessUnit").Exist(NMINWAIT) Then
            .WebEdit("ManReq_BusinessUnit").Set GlobalDictionary("businessunit")
            WriteToReport micPass,"BusinessUnit "," BusinessUnit is present and entered as "&GlobalDictionary("businessunit"),false
            else:WriteToReport micfail,"BusinessUnit"," BusinessUnit isn't present ",true
        End If
        If .WebEdit("ManReq_RequisitionID").Exist(nminwait) Then
            .WebEdit("ManReq_RequisitionID").Set RequesitionID
            WriteToReport micPass,"RequesitionID "," RequesitionID is present and entered as "&RequesitionID,false
            else:WriteToReport micfail,"RequesitionID"," RequesitionID isn't present ",true
        End If
        If .WebEdit("ManReq_Requestor").Exist(nminwait) Then
            .WebEdit("ManReq_Requestor").Set GlobalDictionary("ReqUser")
            WriteToReport micPass,"Requestor "," Requestor is present and entered as "&GlobalDictionary("ReqUser"),false
            else:WriteToReport micfail,"Requestor"," Requestor isn't present ",true
        End If
        If .WebButton("ManReq_Search").Exist(nminwait) Then
            .WebButton("ManReq_Search").Click
            WriteToReport micPass,"Search "," Search is present and clicked",false
            else:WriteToReport micfail,"Search"," Search isn't present ",true
        End If
    End With
    app_searchsync()
Dim rowNo,cCount
    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition")
        If .Image("Expand Section").Exist(nminwait) Then
            .Image("Expand Section").Click
            WriteToReport micPass,"Expand Section "," Expand Section is present and clicked",false
'            else:WriteToReport micfail,"Expand Section"," Expand Section isn't present ",true
        End If
        If .WebTable("ManReq_RequistionList").Exist(nminwait) Then
            rowNo=.WebTable("ManReq_RequistionList").GetRowWithCellText(RequesitionID)
            cCount=.WebTable("ManReq_RequistionList").ColumnCount(rowNo)
            For i = 1 To cCount Step 1
                If isDate(Trim(.WebTable("ManReq_RequistionList").GetCellData(rowNo,i))) Then
                    WriteToReport micPass,"Request state "," Request state is "&.WebTable("ManReq_RequistionList").GetCellData(rowNo,i+1),false
                    Exit for
                End If
            Next
        End If
        If .link("PurchaseOrders").Exist(nminwait) Then
            .link("PurchaseOrders").Click
            WriteToReport micPass,"Purchase Orders link","Purchase Orders link is present and clicked",false
            else:WriteToReport micfail,"Purchase Orders link"," Purchase Orders link isn't present ",true
        End If
    end with
    
Dim PoNumber
    app_searchsync()
    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("PO Line Inquiry")
        If .Exist(nminwait) Then
            WriteToReport micPass,"PO infirmation page dispalyed"," PO infirmation page dispalyed successfully" ,false
        End If
        If .WebElement("PO Number").Exist(nminwait) Then
            PoNumber=.WebElement("PO Number").GetROProperty("innertext")
            WriteToReport micPass,"PO infirmation "," PO number generated as "&PoNumber ,false
        End If
    End With
    
    'eProcurement>Manage Requisitions
    SelectMainMenu1(GlobalDictionary("MainMenuSelection6"))
    
    app_searchSync()
    
    With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders")
        If .WebEdit("BusinessUnit").Exist(nminwait) Then
            .WebEdit("BusinessUnit").Set businessunit
            WriteToReport micPass,"BusinessUnit "," BusinessUnit is present and entered as "&GlobalDictionary("businessunit"),false
            else:WriteToReport micfail,"BusinessUnit"," BusinessUnit isn't present ",true
        End If
        If .WebEdit("POID").Exist(nminwait) Then
            .WebEdit("POID").Set PoNumber
            WriteToReport micPass,"PoNumber "," PoNumber is present and entered as "&PoNumber,false
            else:WriteToReport micfail,"PoNumber"," PoNumber isn't present ",true
        End If
        If .WebButton("Search").Exist(nminwait) Then
            .WebButton("Search").Click
            WriteToReport micPass,"Search "," Search is present and clicked",false
            else:WriteToReport micfail,"Search"," Search isn't present ",true
        End If
        app_searchSync()
        
        If .WebTable("Searchresults").Exist(nminwait) Then
            WriteToReport micPass,"Search results displayed successfully ","Po information displayed in search results successfully",false
            .WebTable("Searchresults").ChildItem(1,1,"Link",0).click
            else:WriteToReport micfail,"Search results doesn't exist"," Search results not available",true
        End If
        app_searchSync()
    End With
    app_searchSync()
        
    
    With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder")
        If .Exist(nminwait) Then
            WriteToReport micPass,"Po information page "," Po information page dispalyed successfully",false
        End If
        If .WebEdit("PO_REF").Exist(nminwait) Then
            WriteToReport micPass,"Po reference displayed "," PO reference displayed as "&.WebEdit("PO_REF").GetROProperty("value") ,false
        End If
        If .WebElement("PO_Status").Exist(nminwait) Then
            If StrComp(Trim(.WebElement("PO_Status").GetROProperty("innertext")),"Approved",1)=0 Then
                WriteToReport micPass,"PO_Status "," PO_Status is present and displayed as Approved status",false
            else:WriteToReport micPass,"PO_Status"," PO_Status is present and displayed as "&.WebElement("PO_Status").GetROProperty("innertext") ,true
            End If
        else:WriteToReport micfail,"PO_Status"," PO_Status isn't present ",true
        End If
        If .WebList("DispatchMethod").Exist(nminwait) Then
            .WebList("DispatchMethod").Select GlobalDictionary("DispatchMethod")
            WriteToReport micPass,"DispatchMethod "," DispatchMethod is present and entered as "&GlobalDictionary("DispatchMethod"),false
            else:WriteToReport micfail,"DispatchMethod"," DispatchMethod isn't present ",true
        End If
        If .WebButton("Dispatch").Exist(nminwait) Then
            .WebButton("Dispatch").Click
            WriteToReport micPass,"Dispatch "," Dispatch is present and clicked",false
            else:WriteToReport micfail,"Dispatch"," Dispatch isn't present ",true
        End If
    End With
    
    app_searchSync()
    
    count1=0
    While  NOT Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("DispatchOptions").Exist(nminwait) AND count1<10
        app_searchSync():count1=count1+1
    Wend
    With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("DispatchOptions")
        If .WebList("OD Format").Exist(nminwait) Then
            WriteToReport micPass,"Output Destinaion Type "," Output Destinaion Type is present and selected as "&.WebList("OD Format").GetROProperty("selection"),false
        End If
        If .WebList("OD Type").Exist(nminwait) Then
            WriteToReport micPass,"Output Destinaion Type "," Output Destinaion Type is present and selected as "&.WebList("OD Type").GetROProperty("selection"),false
        End If
            app_searchSync()
        If .WebButton("OK").Exist(nminwait) Then
            .WebButton("OK").Click
            WriteToReport micPass,"OK "," OK is present and clicked",false
            else:WriteToReport micfail,"OK"," OK isn't present ",true
        End If
    End With

    app_searchSync()
    With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders")
        If .WebButton("Yes").Exist(nminwait) Then
            .WebButton("Yes").Click
            WriteToReport micPass,"Yes "," Yes is present and clicked",false
            else:WriteToReport micfail,"Yes"," Yes isn't present ",true
        End If
    End With
    
    count1=0:app_searchSync()
    While  (Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebButton("Dispatch").GetROProperty("disabled")=0) AND count1<10
        app_searchSync():count1=count1+1
    Wend
    
    app_searchSync()
    With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder")
        If .WebElement("PO_Status").Exist(nminwait) Then
            If StrComp(Trim(.WebElement("PO_Status").GetROProperty("innertext")),"Dispatched",1)=0 Then
                WriteToReport micPass,"PO_Status "," PO_Status is present and changed to Dispatched status",false
            else:WriteToReport micfail,"PO_Status"," PO_Status is present and changed to Dispatched status but "&.WebElement("PO_Status").GetROProperty("innertext") ,true
            End If
        else:WriteToReport micfail,"PO_Status"," PO_Status isn't present ",true
        End If
    End With
    
    'eProcurement>Manage Requisitions
    SelectMainMenu1(GlobalDictionary("MainMenuSelection5"))
    

    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition")
        If .WebEdit("ManReq_BusinessUnit").Exist(NMINWAIT) Then
            .WebEdit("ManReq_BusinessUnit").Set GlobalDictionary("businessunit")
            WriteToReport micPass,"BusinessUnit "," BusinessUnit is present and entered as "&GlobalDictionary("businessunit"),false
            else:WriteToReport micfail,"BusinessUnit"," BusinessUnit isn't present ",true
        End If
        If .WebEdit("ManReq_RequisitionID").Exist(nminwait) Then
            .WebEdit("ManReq_RequisitionID").Set RequesitionID
            WriteToReport micPass,"RequesitionID "," RequesitionID is present and entered as "&RequesitionID,false
            else:WriteToReport micfail,"RequesitionID"," RequesitionID isn't present ",true
        End If
        If .WebEdit("ManReq_Requestor").Exist(nminwait) Then
            .WebEdit("ManReq_Requestor").Set GlobalDictionary("ReqUser")
            WriteToReport micPass,"Requestor "," Requestor is present and entered as "&GlobalDictionary("ReqUser"),false
            else:WriteToReport micfail,"Requestor"," Requestor isn't present ",true
        End If
        If .WebButton("ManReq_Search").Exist(nminwait) Then
            .WebButton("ManReq_Search").Click
            WriteToReport micPass,"Search "," Search is present and clicked",false
            else:WriteToReport micfail,"Search"," Search isn't present ",true
        End If
    End With
    app_searchsync()
'Dim rowNo,cCount
    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition")
        If .Image("Expand Section").Exist(nminwait) Then
            .Image("Expand Section").Click
            WriteToReport micPass,"Expand Section "," Expand Section is present and clicked",false
        End If

        If .WebTable("ManReq_RequistionList").Exist(nminwait) Then
            rowNo=.WebTable("ManReq_RequistionList").GetRowWithCellText(RequesitionID)
            cCount=.WebTable("ManReq_RequistionList").ColumnCount(rowNo)
            For i = 1 To cCount Step 1
                If isDate(Trim(.WebTable("ManReq_RequistionList").GetCellData(rowNo,i))) Then
                    WriteToReport micPass,"Request state "," Request state is "&.WebTable("ManReq_RequistionList").GetCellData(rowNo,i+1),false
                    Exit for
                End If
            Next
        End If
        If .WebList("Select Action").Exist(nminwait) Then
            .WebList("Select Action").Select GlobalDictionary("Select Action")
            WriteToReport micPass,"Select Action "," Select Action is present and entered as "&GlobalDictionary("Select Action"),false
            else:WriteToReport micfail,"Select Action"," Select Action isn't present ",true
        End If
        If .WebButton("Go").Exist(nminwait) Then
            .WebButton("Go").Click
            WriteToReport micPass,"Go "," Go is present and clicked",false
            else:WriteToReport micfail,"Go"," Go isn't present ",true
        End If
        app_searchsync()
        
    end with
    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("Receive Items")
        count1=0
        While Not (.WebElement("Header Message").Exist(nminwait)) AND count1<10
            app_searchsync():count1=count1+1
        Wend
        If .WebElement("Header Message").Exist(nminwait) Then
            WriteToReport micPass,"Receive items message","Receive items "&.WebElement("Header Message").GetROProperty("innertext"),false
        End If
        If .WebCheckBox("Select Req Lines").Exist(nminwait) Then
            .WebCheckBox("Select Req Lines").Set "ON"
            If .WebTable("Requisition Lines To receiveL9cols").Exist(nminwait) Then
                WriteToReport micPass,"Item received to receive","Iem selected to receive is "&.WebTable("Requisition Lines To receiveL9cols").GetCellData(1,1),false
            End If
        End If
        If .WebButton("Receive Selected").Exist(nminwait) Then
            .WebButton("Receive Selected").Click
            WriteToReport micPass,"Receive Selected "," Receive Selected is present and clicked",false
            else:WriteToReport micfail,"Receive Selected"," Receive Selected isn't present ",true
        End If
    End With
    
    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("Receiving Receipt Items")
        count1=0
        While Not(.WebElement("Receipt Status").Exist(nminwait)) AND count1<10
            app_searchsync():count1=count1+1
        Wend
        If .WebElement("Receipt Status").Exist(nminwait) Then
            WriteToReport micPass,"Receipt status","Receipt status is displayed as "&.WebElement("Receipt Status").GetROProperty("innertext"),false
        End If
        If .WebEdit("BusinessUnit").Exist(nminwait) Then
            .WebEdit("BusinessUnit").Set GlobalDictionary("businessunit")
            WriteToReport micPass,"BusinessUnit "," BusinessUnit is present and entered as "&GlobalDictionary("businessunit"),false
            else:WriteToReport micfail,"BusinessUnit"," BusinessUnit isn't present ",true
        End If
        If .WebTable("Receipts Lines").Exist(nminwait) Then
            .WebTable("Receipts Lines").ChildItem(2,4,"WebEdit",0).set GlobalDictionary("ReceiptQty1")
            WriteToReport micPass,"Receipt qty  "," Receipt qty is present and entered as "&GlobalDictionary("ReceiptQty1"),false
        End If
        If .WebButton("Save Receipt").Exist(nminwait) Then
            .WebButton("Save Receipt").Click
            WriteToReport micPass,"Save Receipt"," Save Receipt is present and clicked",false
            else:WriteToReport micfail,"Save Receipt"," Save Receipt isn't present ",true
        End If
    End With

    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("Saved Receipts")
        count1=0
        While Not(.WebElement("Saved success").Exist(nminwait)) AND count1<10
            app_searchsync():Count1=count1+1
        Wend
        If .WebElement("Saved success").Exist(nminwait) Then
            WriteToReport micPass,"Receipt Saved Successfully","Receipt : "&.WebElement("Saved success").GetROProperty("innertext"),false
        End If
        If .WebElement("Receipt message").Exist(nminwait) Then
            WriteToReport micPass,"Receipt number generated Successfully","- "&.WebElement("Receipt message").GetROProperty("innertext"),false
        End If
        If .WebTable("Receipt Lines").Exist(nminwait) Then
            WriteToReport micPass,"Requisition details of Receipt","Item description - "&.WebTable("Receipt Lines").GetCellData(1,2) &", Received Quantity - "&.WebTable("Receipt Lines").GetCellData(1,3) & ", Accepted Quantity - "&.WebTable("Receipt Lines").GetCellData(1,2),false
        End If
        If .Link("Return to Manage Req").Exist(nminwait) Then
            .Link("Return to Manage Req").Click
            WriteToReport micPass,"Return to Manage Requisition"," Return to Manage Requisition is present and clicked",false
            else:WriteToReport micfail,"Return to Manage Requisition"," Return to Manage Requisition isn't present ",true
        End If
    End With
    wait(3):app_searchsync()
    
'save the receipt for line 2
    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition")
        If .WebEdit("ManReq_BusinessUnit").Exist(NMINWAIT) Then
            .WebEdit("ManReq_BusinessUnit").Set GlobalDictionary("businessunit")
            WriteToReport micPass,"BusinessUnit "," BusinessUnit is present and entered as "&GlobalDictionary("businessunit"),false
            else:WriteToReport micfail,"BusinessUnit"," BusinessUnit isn't present ",true
        End If
        If .WebEdit("ManReq_RequisitionID").Exist(nminwait) Then
            .WebEdit("ManReq_RequisitionID").Set RequesitionID
            WriteToReport micPass,"RequesitionID "," RequesitionID is present and entered as "&RequesitionID,false
            else:WriteToReport micfail,"RequesitionID"," RequesitionID isn't present ",true
        End If
        If .WebEdit("ManReq_Requestor").Exist(nminwait) Then
            .WebEdit("ManReq_Requestor").Set GlobalDictionary("ReqUser")
            WriteToReport micPass,"Requestor "," Requestor is present and entered as "&GlobalDictionary("ReqUser"),false
            else:WriteToReport micfail,"Requestor"," Requestor isn't present ",true
        End If
        If .WebButton("ManReq_Search").Exist(nminwait) Then
            .WebButton("ManReq_Search").Click
            WriteToReport micPass,"Search "," Search is present and clicked",false
            else:WriteToReport micfail,"Search"," Search isn't present ",true
        End If
    End With
    app_searchsync()
'Dim rowNo,cCount
    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition")
        If .Image("Expand Section").Exist(nminwait) Then
            .Image("Expand Section").Click
            WriteToReport micPass,"Expand Section "," Expand Section is present and clicked",false
        End If

        If .WebTable("ManReq_RequistionList").Exist(nminwait) Then
            rowNo=.WebTable("ManReq_RequistionList").GetRowWithCellText(RequesitionID)
            cCount=.WebTable("ManReq_RequistionList").ColumnCount(rowNo)
            For i = 1 To cCount Step 1
                If isDate(Trim(.WebTable("ManReq_RequistionList").GetCellData(rowNo,i))) Then
                    WriteToReport micPass,"Request state "," Request state is "&.WebTable("ManReq_RequistionList").GetCellData(rowNo,i+1),false
                    Exit for
                End If
            Next
        End If
        If .WebList("Select Action").Exist(nminwait) Then
            .WebList("Select Action").Select GlobalDictionary("Select Action")
            WriteToReport micPass,"Select Action "," Select Action is present and entered as "&GlobalDictionary("Select Action"),false
            else:WriteToReport micfail,"Select Action"," Select Action isn't present ",true
        End If
        If .WebButton("Go").Exist(nminwait) Then
            .WebButton("Go").Click
            WriteToReport micPass,"Go "," Go is present and clicked",false
            else:WriteToReport micfail,"Go"," Go isn't present ",true
        End If
        app_searchsync()
        
    end with
    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("Receive Items")
        count1=0
        While Not (.WebElement("Header Message").Exist(nminwait)) AND count1<10
            app_searchsync():count1=count1+1
        Wend
        If .WebElement("Header Message").Exist(nminwait) Then
            WriteToReport micPass,"Receive items message","Receive items "&.WebElement("Header Message").GetROProperty("innertext"),false
        End If
        If .WebCheckBox("Select Req Lines").Exist(nminwait) Then
            .WebCheckBox("Select Req Lines").Set "ON"
            If .WebTable("Requisition Lines To receiveL9cols").Exist(nminwait) Then
                WriteToReport micPass,"Item received to receive","Iem selected to receive is "&.WebTable("Requisition Lines To receiveL9cols").GetCellData(1,1),false
            End If
        End If
        If .WebButton("Receive Selected").Exist(nminwait) Then
            .WebButton("Receive Selected").Click
            WriteToReport micPass,"Receive Selected "," Receive Selected is present and clicked",false
            else:WriteToReport micfail,"Receive Selected"," Receive Selected isn't present ",true
        End If
    End With
    
    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("Receiving Receipt Items")
        count1=0
        While Not(.WebElement("Receipt Status").Exist(nminwait)) AND count1<10
            app_searchsync():count1=count1+1
        Wend
        If .WebElement("Receipt Status").Exist(nminwait) Then
            WriteToReport micPass,"Receipt status","Receipt status is displayed as "&.WebElement("Receipt Status").GetROProperty("innertext"),false
        End If
        If .WebEdit("BusinessUnit").Exist(nminwait) Then
            .WebEdit("BusinessUnit").Set GlobalDictionary("businessunit")
            WriteToReport micPass,"BusinessUnit "," BusinessUnit is present and entered as "&GlobalDictionary("businessunit"),false
            else:WriteToReport micfail,"BusinessUnit"," BusinessUnit isn't present ",true
        End If
        If .WebTable("Receipts Lines").Exist(nminwait) Then
            .WebTable("Receipts Lines").ChildItem(2,4,"WebEdit",0).set GlobalDictionary("ReceiptQty2")
            WriteToReport micPass,"Receipt qty  "," Receipt qty is present and entered as "&GlobalDictionary("ReceiptQty2"),false
        End If
        If .WebButton("Save Receipt").Exist(nminwait) Then
            .WebButton("Save Receipt").Click
            WriteToReport micPass,"Save Receipt"," Save Receipt is present and clicked",false
            else:WriteToReport micfail,"Save Receipt"," Save Receipt isn't present ",true
        End If
    End With

    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("Saved Receipts")
        count1=0
        While Not(.WebElement("Saved success").Exist(nminwait)) AND count1<10
            app_searchsync():count1=count1+1
        Wend
        If .WebElement("Saved success").Exist(nminwait) Then
            WriteToReport micPass,"Receipt Saved Successfully","Receipt : "&.WebElement("Saved success").GetROProperty("innertext"),false
        End If
        If .WebElement("Receipt message").Exist(nminwait) Then
            WriteToReport micPass,"Receipt number generated Successfully","- "&.WebElement("Receipt message").GetROProperty("innertext"),false
        End If
        If .WebTable("Receipt Lines").Exist(nminwait) Then
            WriteToReport micPass,"Requisition details of Receipt","Item description - "&.WebTable("Receipt Lines").GetCellData(1,2) &", Received Quantity - "&.WebTable("Receipt Lines").GetCellData(1,3) & ", Accepted Quantity - "&.WebTable("Receipt Lines").GetCellData(1,2),false
        End If
        If .Link("Return to Manage Req").Exist(nminwait) Then
            .Link("Return to Manage Req").Click
            WriteToReport micPass,"Return to Manage Requisition"," Return to Manage Requisition is present and clicked",false
            else:WriteToReport micfail,"Return to Manage Requisition"," Return to Manage Requisition isn't present ",true
        End If
    End With
    wait(3):app_searchsync()
    
'save the receipt for line 2
    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition")
        If .WebEdit("ManReq_BusinessUnit").Exist(NMINWAIT) Then
            .WebEdit("ManReq_BusinessUnit").Set GlobalDictionary("businessunit")
            WriteToReport micPass,"BusinessUnit "," BusinessUnit is present and entered as "&GlobalDictionary("businessunit"),false
            else:WriteToReport micfail,"BusinessUnit"," BusinessUnit isn't present ",true
        End If
        If .WebEdit("ManReq_RequisitionID").Exist(nminwait) Then
            .WebEdit("ManReq_RequisitionID").Set RequesitionID
            WriteToReport micPass,"RequesitionID "," RequesitionID is present and entered as "&RequesitionID,false
            else:WriteToReport micfail,"RequesitionID"," RequesitionID isn't present ",true
        End If
        If .WebEdit("ManReq_Requestor").Exist(nminwait) Then
            .WebEdit("ManReq_Requestor").Set GlobalDictionary("ReqUser")
            WriteToReport micPass,"Requestor "," Requestor is present and entered as "&GlobalDictionary("ReqUser"),false
            else:WriteToReport micfail,"Requestor"," Requestor isn't present ",true
        End If
        If .WebButton("ManReq_Search").Exist(nminwait) Then
            .WebButton("ManReq_Search").Click
            WriteToReport micPass,"Search "," Search is present and clicked",false
            else:WriteToReport micfail,"Search"," Search isn't present ",true
        End If
    End With
    app_searchsync()
'Dim rowNo,cCount
    With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition")
        If .Image("Expand Section").Exist(nminwait) Then
            .Image("Expand Section").Click
            WriteToReport micPass,"Expand Section "," Expand Section is present and clicked",false
        End If

        If .WebTable("ManReq_RequistionList").Exist(nminwait) Then
            rowNo=.WebTable("ManReq_RequistionList").GetRowWithCellText(RequesitionID)
            cCount=.WebTable("ManReq_RequistionList").ColumnCount(rowNo)
            For i = 1 To cCount Step 1
                If isDate(Trim(.WebTable("ManReq_RequistionList").GetCellData(rowNo,i))) Then
                    WriteToReport micPass,"Request state "," Request state is "&.WebTable("ManReq_RequistionList").GetCellData(rowNo,i+1),false
                    Exit for
                End If
            Next
        End If
    End With
    
End Function

'*********************************************************************************************************************************
''' <summary>  
''' DynamicSecurityRole 
'''Parameter1:	None.
''' <para>
''' <note></note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/12/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'EP_4_06
Public Function DynamicSecurityRole()
	'eProcurement > Administer Procurement
	SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
Dim Count	
	If Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Administer Procurement main").Link("Maintain Procurement Users").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Administer Procurement main").Link("Maintain Procurement Users").Click
		WriteToReport micPass,"Maintain Procurement Users link ","Maintain Procurement Users is present and clicked",false
		else:WriteToReport micfail,"Maintain Procurement Users link ","Maintain Procurement Users isn't present",true
	End If
	If Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Maintain Procurement Users").Link("Buyers").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Maintain Procurement Users").Link("Buyers").Click
		WriteToReport micPass,"Buyers link "," Buyers link is present and clicked",false
		else:WriteToReport micfail,"Buyers link "," Buyers link isn't present",true
	End If
	
	With Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Buyer setup")
		count=0
		While NOT(.WebElement("Add a New Value").Exist(nminwait)) AND count<10
			app_searchsync():count=count<10
		Wend
		If .WebElement("Add a New Value").Exist(nminwait) Then
			.WebElement("Add a New Value").Click
			WriteToReport micPass,"Add a New Value Tab"," Add a New Value tab is present and clicked",false
		else:WriteToReport micfail,"Add a New Value tab"," Add a New Value Tab isn't present",true
		End If
		If .WebEdit("Buyer").Exist(nminwait) Then
			.WebEdit("Buyer").Set GlobalDictionary("Buyer")
			WriteToReport micPass,"Buyer field","Buyer field is present and entered as "& GlobalDictionary("Buyer") ,false
		else:WriteToReport micfail,"Buyer field","Buyer field isn't present",true
		End If
		If .WebButton("Add").Exist(nminwait) Then
			.WebButton("Add").Click
			WriteToReport micPass,"Add field","Add field is present and clicked",false
		else:WriteToReport micfail,"Add field","Add field isn't present",true
		End If
		
		app_searchsync()
		If .Link("Searchresults Buyer").Exist(nminwait) Then
			.Link("Searchresults Buyer").Click
		End If
		app_searchsync()
		
		If .WebEdit("Department SetID").Exist(nminwait) Then
			WriteToReport micPass,"Department SetID field","Department SetID field is present and entered as "&.WebEdit("Department SetID").GetROProperty("Value"),false
		End If
		If .WebEdit("Location SetID").Exist(nminwait) Then
			WriteToReport micPass,"Location SetID field","Location SetID field is present and entered as "&.WebEdit("Location SetID").GetROProperty("Value"),false
		End If
		If .WebEdit("ShipTo SetID").Exist(nminwait) Then
			WriteToReport micPass,"ShipTo SetID field","ShipTo SetID field is present and entered as "&.WebEdit("ShipTo SetID").GetROProperty("Value"),false
		End If
		If .WebEdit("PO Orgin SetID").Exist(nminwait) Then
			WriteToReport micPass,"PO Orgin SetID field","PO Orgin SetID field is present and entered as "&.WebEdit("PO Orgin SetID").GetROProperty("Value"),false
		End If
		If .WebList("Status").Exist(nminwait) Then
			WriteToReport micPass,"Status field","Status field is present and entered as "&.WebList("Status").GetROProperty("Selection"),false
		End If
		If .WebButton("Save").Exist(nminwait) Then
			.WebButton("Save").Click
			WriteToReport micPass,"Save field","Save field is present and clicked",false
		else:WriteToReport micfail,"Save field","Save field isn't present",true
		End If
		app_searchsync()
		If .WebButton("Add").Exist(nminwait) Then
			.WebButton("Add").Click
			WriteToReport micPass,"Add field","Add field is present and clicked",false
		else:WriteToReport micfail,"Add field","Add field isn't present",true
		End If
		app_searchsync()
		If .WebElement("Add a New Value").Exist(nminwait) Then
			WriteToReport micPass,"Buyer added successfully"," Buyer added successfully",false
		else:WriteToReport micfail,"Buyer doesn't added "," Buyer doesn't added ",true
		End If
	End With
	

'validate the roles added to the user
	Dim rc,roleName,Desc,Dynamic
	
	' PeopleTools > Security > User Profiles > User Profiles
	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	
	With Browser("PeopleSoft Browser").Page("UserProfiles_Security").PSFrame("UserProfile")
		If .WebList("SearchBy").Exist(nminwait) Then
			.WebList("SearchBy").Select "User ID"
		End If
		If .WebEdit("SearchText").Exist(nminwait) Then
			.WebEdit("SearchText").Set GlobalDictionary("Buyer")
		End If
		If .WebButton("Search").Exist(nminwait) Then
			.WebButton("Search").Click
			WriteToReport micPass,"Search field","Search field is present and clicked",false
		else:WriteToReport micfail,"Search field","Search field isn't present",true
		End If
		count=0
		While NOT(.WebElement("RolesTab").Exist(nminwait)) AND count<10
			app_searchSync():count=count+1
		Wend
		If .WebElement("RolesTab").Exist(nminwait) Then
			.WebElement("RolesTab").Click
			WriteToReport micPass,"RolesTab field","RolesTab field is present and clicked",false
		else:WriteToReport micfail,"RolesTab field","RolesTab field isn't present",true
		End If
		If .WebTable("User Roles").Exist(nminwait) Then
			rc=.WebTable("User Roles").RowCount
			For i = 2 To rc Step 1
				rolename=.WebTable("User Roles").GetCellData(i,1)
				desc=.WebTable("User Roles").GetCellData(i,2)
				If .WebTable("User Roles").ChildItem(i,3,"WebCheckBox",0).getRoproperty("checked") Then
					Dynamic="Dynamic Role"
					else:Dynamic="Non Dynamic Role"
				End If
				WriteToReport micPass,"Roles details","Role name :"&rolename&", Description: "&desc&" - "&dynamic&" is displayed"  ,false
			Next
		End If
	End With


	'run dynamic role
'CDW ePro > Run Dynamic Role
	SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))	
	
	'add buyer
	ep_RunDynamicRolebyRoleName(GlobalDictionary("BuyerID"))

	
'PeopleTools>Process Scheduler>Process Monitor	
	SelectMainMenu1(GlobalDictionary("MainMenuSelection4"))	
	app_Searchsync()
	
	With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor")
		If .WebTable("ProcessTable_ProcessMonitor").Exist(nminwait) Then
			Count=0
			do while StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)<>0 AND Count<100
				If .WebButton("Refresh").Exist(nminwait) Then
					.WebButton("Refresh").Click: Count=Count+1
'					WriteToReport micPass,"Refresh "," Refresh is present and clicked",false
				End If
				app_Searchsync()
			loop
			If StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)=0 Then
				WriteToReport micPass,"Instace get processed successfully "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" is processed successfully",false
				else
				WriteToReport micfail,"Instace doesn't get processed "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" isn't processed",false
			End If
			
		End If
	End With
	
' PeopleTools > Security > User Profiles > User Profiles
	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	
Dim flag	
	With Browser("PeopleSoft Browser").Page("UserProfiles_Security").PSFrame("UserProfile")
		If .WebList("SearchBy").Exist(nminwait) Then
			.WebList("SearchBy").Select "User ID"
		End If
		If .WebEdit("SearchText").Exist(nminwait) Then
			.WebEdit("SearchText").Set GlobalDictionary("Buyer")
		End If
		If .WebButton("Search").Exist(nminwait) Then
			.WebButton("Search").Click
			WriteToReport micPass,"Search field","Search field is present and clicked",false
		else:WriteToReport micfail,"Search field","Search field isn't present",true
		End If
		count=0
		While NOT(.WebElement("RolesTab").Exist(nminwait)) AND count<10
			app_searchSync():count=count+1
		Wend
		If .WebElement("RolesTab").Exist(nminwait) Then
			.WebElement("RolesTab").Click
			WriteToReport micPass,"RolesTab field","RolesTab field is present and clicked",false
		else:WriteToReport micfail,"RolesTab field","RolesTab field isn't present",true
		End If
		flag=true
		If .WebTable("User Roles").Exist(nminwait) Then
			rc=.WebTable("User Roles").RowCount
			For i = 2 To rc Step 1
				rolename=.WebTable("User Roles").GetCellData(i,1)
				desc=.WebTable("User Roles").GetCellData(i,2)
				If .WebTable("User Roles").ChildItem(i,3,"WebCheckBox",0).getRoproperty("checked") Then
					Dynamic="Dynamic Role"
					else:Dynamic="Non Dynamic Role"
				End If
				If StrComp(Trim(rolename),Trim(GlobalDictionary("BuyerID")),1)=0 Then
					WriteToReport micPass,"Roles added successfully","Role name :"&rolename&", Description: "&desc&" - "&dynamic&" is displayed"  ,false
					flag=false:Exit for
				End If
			Next
		End If
		If flag Then
			WriteToReport micFail,"Roles desn't added ","Role name :"&GlobalDictionary("BuyerID")&" isn't displayed"  ,false
		End If
	End With

	'Add a requesters
	'eProcurement > Administer Procurement
	SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
	
	If Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Administer Procurement main").Link("Maintain Procurement Users").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Administer Procurement main").Link("Maintain Procurement Users").Click
		WriteToReport micPass,"Maintain Procurement Users link ","Maintain Procurement Users is present and clicked",false
		else:WriteToReport micfail,"Maintain Procurement Users link ","Maintain Procurement Users isn't present",true
	End If
	If Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Maintain Procurement Users").Link("Requesters").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Maintain Procurement Users").Link("Requesters").Click
		WriteToReport micPass,"Requesters link "," Requesters link is present and clicked",false
		else:WriteToReport micfail,"Requesters link "," Requesters link isn't present",true
	End If
	
	With Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Requesters setup")
		count=0
		While NOT(.WebElement("Add a New Value").Exist(nminwait)) AND count<10
			app_searchsync():count=count+1
		Wend
		If .WebElement("Add a New Value").Exist(nminwait) Then
			.WebElement("Add a New Value").Click
			WriteToReport micPass,"Add a New Value Tab"," Add a New Value tab is present and clicked",false
		else:WriteToReport micfail,"Add a New Value tab"," Add a New Value Tab isn't present",true
		End If
		If .WebEdit("Requester").Exist(nminwait) Then
			.WebEdit("Requester").Set GlobalDictionary("Requester")
			WriteToReport micPass,"Requester field","Requester field is present and entered as "& GlobalDictionary("Requester") ,false
		else:WriteToReport micfail,"Requester field","Requester field isn't present",true
		End If
		If .WebButton("Add").Exist(nminwait) Then
			.WebButton("Add").Click
			WriteToReport micPass,"Add field","Add field is present and clicked",false
		else:WriteToReport micfail,"Add field","Add field isn't present",true
		End If
		
		app_searchsync()
		If .Link("Searchresults Requesters").Exist(nminwait) Then
			.Link("Searchresults Requesters").Click
		End If
		app_searchsync()
		
		If .WebEdit("Location").Exist(nminwait) Then
			WriteToReport micPass,"Location field","Location field is present and entered as "&.WebEdit("Location").GetROProperty("Value"),false
		End If
		If .WebEdit("Location SetID").Exist(nminwait) Then
			WriteToReport micPass,"Location SetID field","Location SetID field is present and entered as "&.WebEdit("Location SetID").GetROProperty("Value"),false
		End If
		If .WebEdit("ShipTo SetID").Exist(nminwait) Then
			WriteToReport micPass,"ShipTo SetID field","ShipTo SetID field is present and entered as "&.WebEdit("ShipTo SetID").GetROProperty("Value"),false
		End If
		If .WebEdit("PO Orgin SetID").Exist(nminwait) Then
			WriteToReport micPass,"PO Orgin SetID field","PO Orgin SetID field is present and entered as "&.WebEdit("PO Orgin SetID").GetROProperty("Value"),false
		End If
		If .WebList("Status").Exist(nminwait) Then
			WriteToReport micPass,"Status field","PStatusfield is present and entered as "&.WebList("Status").GetROProperty("Selection"),false
		End If
		If .WebButton("Save").Exist(nminwait) Then
			.WebButton("Save").Click
			WriteToReport micPass,"Save field","Save field is present and clicked",false
		else:WriteToReport micfail,"Save field","Save field isn't present",true
		End If
		app_searchsync()
		If .WebButton("Add").Exist(nminwait) Then
			.WebButton("Add").Click
			WriteToReport micPass,"Add field","Add field is present and clicked",false
		else:WriteToReport micfail,"Add field","Add field isn't present",true
		End If
		app_searchsync()
		If .WebElement("Add a New Value").Exist(nminwait) Then
			WriteToReport micPass,"Requesters added successfully"," Requesters added successfully",false
		else:WriteToReport micfail,"Requesters doesn't added "," Requesters doesn't added ",true
		End If
	End With
	
	
	'run dynamic role
'CDW ePro > Run Dynamic Role
	SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))	
	
	'add Requester
	ep_RunDynamicRolebyRoleName(GlobalDictionary("RequesterID"))

	
'PeopleTools>Process Scheduler>Process Monitor	
	SelectMainMenu1(GlobalDictionary("MainMenuSelection4"))	
	app_Searchsync()
	
	With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor")
		If .WebTable("ProcessTable_ProcessMonitor").Exist(nminwait) Then
			Count=0
			do while StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)<>0 AND Count<100
				If .WebButton("Refresh").Exist(nminwait) Then
					.WebButton("Refresh").Click: Count=Count+1
'					WriteToReport micPass,"Refresh "," Refresh is present and clicked",false
				End If
				app_Searchsync()
			loop
			If StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)=0 Then
				WriteToReport micPass,"Instace get processed successfully "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" is processed successfully",false
				else
				WriteToReport micfail,"Instace doesn't get processed "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" isn't processed",false
			End If
			
		End If
	End With
	

	
	' PeopleTools > Security > User Profiles > User Profiles
	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	

	With Browser("PeopleSoft Browser").Page("UserProfiles_Security").PSFrame("UserProfile")
		If .WebList("SearchBy").Exist(nminwait) Then
			.WebList("SearchBy").Select "User ID"
		End If
		If .WebEdit("SearchText").Exist(nminwait) Then
			.WebEdit("SearchText").Set GlobalDictionary("Buyer")
		End If
		If .WebButton("Search").Exist(nminwait) Then
			.WebButton("Search").Click
			WriteToReport micPass,"Search field","Search field is present and clicked",false
		else:WriteToReport micfail,"Search field","Search field isn't present",true
		End If
		count=0
		While NOT(.WebElement("RolesTab").Exist(nminwait)) AND count<10
			app_searchSync():count=count+1
		Wend
		If .WebElement("RolesTab").Exist(nminwait) Then
			.WebElement("RolesTab").Click
			WriteToReport micPass,"RolesTab field","RolesTab field is present and clicked",false
		else:WriteToReport micfail,"RolesTab field","RolesTab field isn't present",true
		End If
		flag=true
		If .WebTable("User Roles").Exist(nminwait) Then
			rc=.WebTable("User Roles").RowCount
			For i = 2 To rc Step 1
				rolename=.WebTable("User Roles").GetCellData(i,1)
				desc=.WebTable("User Roles").GetCellData(i,2)
				If .WebTable("User Roles").ChildItem(i,3,"WebCheckBox",0).getRoproperty("checked") Then
					Dynamic="Dynamic Role"
					else:Dynamic="Non Dynamic Role"
				End If
				If StrComp(Trim(rolename),Trim(GlobalDictionary("RequesterID")),1)=0 Then
					WriteToReport micPass,"Roles added successfully","Role name :"&rolename&", Description: "&desc&" - "&dynamic&" is displayed"  ,false
					flag=false:Exit for
				End If
			Next
		End If
		If flag Then
			WriteToReport micFail,"Roles desn't added ","Role name :"&GlobalDictionary("RequesterID")&" isn't displayed"  ,false
		End If
	End With
	
	
	'Add a approver
	'eProcurement > Administer Procurement
	SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
	
	If Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Administer Procurement main").Link("Maintain Procurement Users").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Administer Procurement main").Link("Maintain Procurement Users").Click
		WriteToReport micPass,"Maintain Procurement Users link ","Maintain Procurement Users is present and clicked",false
		else:WriteToReport micfail,"Maintain Procurement Users link ","Maintain Procurement Users isn't present",true
	End If
	If Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Maintain Procurement Users").Link("User Preferrence").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Maintain Procurement Users").Link("User Preferrence").Click
		WriteToReport micPass,"User Preferrence link "," User Preferrence link is present and clicked",false
		else:WriteToReport micfail,"User Preferrence link "," User Preferrence link isn't present",true
	End If
	With Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Maintain User Preferences")
		count=0
		While NOT(.WebElement("Find a Existing Value").Exist(nminwait)) AND count<10
			App_searchsync():count=count+1
		Wend
		If .WebElement("Find a Existing Value").Exist(nminwait) Then
			.WebElement("Find a Existing Value").Click
		End If
		If .WebEdit("SearchText").Exist(nminwait) Then
			.WebEdit("SearchText").Set GlobalDictionary("Buyer")
			WriteToReport micPass,"Search critiria"," Search critiria is present and entered as "&GlobalDictionary("Buyer"),false
		else:WriteToReport micfail,"Search critiria "," Search critiria isn't present",true
		End If
		If .WebButton("Search").Exist(nminwait) Then
			.WebButton("Search").Click
			WriteToReport micPass,"Search link "," Search link is present and clicked",false
		else:WriteToReport micfail,"Search link "," Search link isn't present",true
		End If
		count=0
		While NOT(.Link("Procurement").Exist(nminwait)) AND count<10
			App_searchsync():count=count+1
		Wend
		If .Link("Procurement").Exist(nminwait) Then
			.Link("Procurement").Click
			WriteToReport micPass,"Procurement link "," Procurement link is present and clicked",false
		else:WriteToReport micfail,"Procurement link "," Procurement link isn't present",true
		End If
		count=0
		While NOT(.Link("Requisition Authorizations").Exist(nminwait)) AND count<10
			App_searchsync():count=count+1
		Wend
		If .Link("Requisition Authorizations").Exist(nminwait) Then
			.Link("Requisition Authorizations").Click
			WriteToReport micPass,"Requisition Authorizations link "," Requisition Authorizations link is present and clicked",false
		else:WriteToReport micfail,"Requisition Authorizations link "," Requisition Authorizations link isn't present",true
		End If
	End With	
	With Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Requisition Authorizations")
		count=0
		While NOT(.WebCheckBox("Approval").Exist(nminwait)) AND count<10
			App_searchsync():count=count+1
		Wend
		If .WebCheckBox("Approval").Exist(nminwait) Then
			.WebCheckBox("Approval").Set "ON"
			WriteToReport micPass,"Approval checkbox "," Approval checkbox is present and clicked",false
		else:WriteToReport micfail,"Approval checkbox "," Approval checkbox isn't present",true
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
			WriteToReport micPass,"Ok button "," Ok button is present and clicked",false
		else:WriteToReport micfail,"Ok button "," Ok button isn't present",true
		End If
	End With

	
	If Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Maintain User Preferences").WebButton("Save").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Administer Procurement").PSFrame("Maintain User Preferences").WebButton("Save").Click
		WriteToReport micPass,"Save button "," Save button is present and clicked",false
		else:WriteToReport micfail,"Save button"," Save button isn't present",true
	End If

'run dynamic role
'CDW ePro > Run Dynamic Role
	SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))	
	
	'add Requester
	ep_RunDynamicRolebyRoleName(GlobalDictionary("ApproverID"))

	
'PeopleTools>Process Scheduler>Process Monitor	
	SelectMainMenu1(GlobalDictionary("MainMenuSelection4"))	
	app_Searchsync()
	
	With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor")
		If .WebTable("ProcessTable_ProcessMonitor").Exist(nminwait) Then
			Count=0
			do while StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)<>0 AND Count<100
				If .WebButton("Refresh").Exist(nminwait) Then
					.WebButton("Refresh").Click: Count=Count+1
'					WriteToReport micPass,"Refresh "," Refresh is present and clicked",false
				End If
				app_Searchsync()
			loop
			If StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)=0 Then
				WriteToReport micPass,"Instace get processed successfully "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" is processed successfully",false
				else
				WriteToReport micfail,"Instace doesn't get processed "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" isn't processed",false
			End If
			
		End If
	End With

	
	' PeopleTools > Security > User Profiles > User Profiles
	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	

	With Browser("PeopleSoft Browser").Page("UserProfiles_Security").PSFrame("UserProfile")
		If .WebList("SearchBy").Exist(nminwait) Then
			.WebList("SearchBy").Select "User ID"
		End If
		If .WebEdit("SearchText").Exist(nminwait) Then
			.WebEdit("SearchText").Set GlobalDictionary("Buyer")
		End If
		If .WebButton("Search").Exist(nminwait) Then
			.WebButton("Search").Click
			WriteToReport micPass,"Search field","Search field is present and clicked",false
		else:WriteToReport micfail,"Search field","Search field isn't present",true
		End If
		count=0
		While NOT(.WebElement("RolesTab").Exist(nminwait)) AND count<10
			app_searchSync():count=count+1
		Wend
		If .WebElement("RolesTab").Exist(nminwait) Then
			.WebElement("RolesTab").Click
			WriteToReport micPass,"RolesTab field","RolesTab field is present and clicked",false
		else:WriteToReport micfail,"RolesTab field","RolesTab field isn't present",true
		End If
		flag=true
		If .WebTable("User Roles").Exist(nminwait) Then
			rc=.WebTable("User Roles").RowCount
			For i = 2 To rc Step 1
				rolename=.WebTable("User Roles").GetCellData(i,1)
				desc=.WebTable("User Roles").GetCellData(i,2)
				If .WebTable("User Roles").ChildItem(i,3,"WebCheckBox",0).getRoproperty("checked") Then
					Dynamic="Dynamic Role"
					else:Dynamic="Non Dynamic Role"
				End If
				If StrComp(Trim(rolename),Trim(GlobalDictionary("ApproverID")),1)=0 Then
					WriteToReport micPass,"Roles added successfully","Role name :"&rolename&", Description: "&desc&" - "&dynamic&" is displayed"  ,false
					flag=false:Exit for
				End If
			Next
		End If
		If flag Then
			WriteToReport micFail,"Roles desn't added ","Role name :"&GlobalDictionary("ApproverID")&" isn't displayed"  ,false
		End If
	End With
	
End Function
'*********************************************************************************************************************************
''' <summary>  
''' ep_RunDynamicRolebyRoleName 
'''Parameter1:	None.
''' <para>
''' <note></note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/12/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
Public Function ep_RunDynamicRolebyRoleName(Rolename)
Dim count	
	With Browser("PeopleSoft Browser").Page("Run Dynamic Roles").PSFrame("Run Dynamic Roles")
		If .WebList("Search By").Exist(nminwait) Then
			.WebList("Search By").Select "Role Name"
		End If
		If .WebEdit("Role Name").Exist(nminwait) Then
			.WebEdit("Role Name").Set Rolename
			WriteToReport micPass,"Role Name field","Role Name field is present and entered as "& Rolename ,false
		else:WriteToReport micfail,"Role Name field","Role Name field isn't present",true
		End If
		
		If .WebButton("Search").Exist(nminwait) Then
			.WebButton("Search").Click
			WriteToReport micPass,"Search field","Search field is present and clicked",false
		else:WriteToReport micfail,"Search field","Search field isn't present",true
		End If
		count=0
		While NOT(.WebElement("Role description").Exist(nminwait)) AND count<10
			app_Searchsync():count=count+1
		Wend
		If .WebElement("Role description").Exist(nminwait) Then
			WriteToReport micPass,"Role description","Role description is displayed as"&.WebElement("Role description").GetROProperty("innertext"),false
		End If
		If .WebButton("Execute Dynamic Role Rule").Exist(nminwait) Then
			.WebButton("Execute Dynamic Role Rule").Click
			WriteToReport micPass,"Execute Dynamic Role Rule field","Execute Dynamic Role Rule field is present and clicked",false
		else:WriteToReport micfail,"Execute Dynamic Role Rule field","Execute Dynamic Role Rule field isn't present",true
		End If
	End With
	app_Searchsync()
End Function
'*********************************************************************************************************************************
''' <summary>  
''' Purchasequery 
'''Parameter1:	None.
''' <para>
''' <note></note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/12/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'EP_5_03
Public Function Purchasequery()
	' Accounts Payable > Accounts Payable Workcenter
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
Dim count,i,rc
	count=0
	While NOT(Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").Link("Reports Queries").Exist(nminwait)) AND Count<10
		app_SearchSync():Count=count+1
	Wend
	
	If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").Link("Reports Queries").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").Link("Reports Queries").Click
		WriteToReport micPass,"Reports Queries field","Reports Queries field is present and clicked",false
		else:WriteToReport micfail,"Reports Queries field","Reports Queries field isn't present",true
	End If

'AP Invoice w Comments	
	count=0
	While NOT(Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("AP Invoice w Comments").Exist(nminwait)) AND Count<10
		app_SearchSync():Count=count+1
	Wend
	If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("AP Invoice w Comments").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("AP Invoice w Comments").Click
		wait(3):Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("AP Invoice w Comments").Click
		WriteToReport micPass,"AP Invoice w Comments field","AP Invoice w Comments field is present  and clicked",false
		else:WriteToReport micfail,"AP Invoice w Comments field","AP Invoice w Comments field isn't present",true
	End If
	
	With Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Query")
		count=0
		While NOT(.WebElement("Ap invoices with comments").Exist(nminwait)) AND Count<10
			app_SearchSync():Count=count+1
			Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("AP Invoice w Comments").Click
		Wend
		If .WebElement("Ap invoices with comments").Exist(nminwait) Then
			WriteToReport micPass,"AP Invoice w Comments field","AP Invoice w Comments field is present and displayed as "&.WebElement("Ap invoices with comments").GetROProperty("innertext"),false
		else:WriteToReport micfail,"AP Invoice w Comments field","AP Invoice w Comments field isn't present",true
		End If
		If .WebEdit("Date From").Exist(nminwait) Then
			.WebEdit("Date From").Set GlobalDictionary("Date From")
			WriteToReport micPass,"Date From field","Date From field is present and enter as "&GlobalDictionary("Date From"),false
		else:WriteToReport micfail,"Date From field","Date From field isn't present",true
		End If
		If .WebEdit("Date To").Exist(nminwait) Then
			.WebEdit("Date To").Set GlobalDictionary("Date To")
			WriteToReport micPass,"Date To field","Date To field is present and enter as "&GlobalDictionary("Date To"),false
		else:WriteToReport micfail,"Date To field","Date To field isn't present",true
		End If
		If .WebEdit("business Unit").Exist(nminwait) Then
			.WebEdit("business Unit").Set GlobalDictionary("Business Unit")
			WriteToReport micPass,"Business Unit field","Business Unit field is present and enter as "&GlobalDictionary("Business Unit"),false
		else:WriteToReport micfail,"Business Unit field","Business Unit field isn't present",true
		End If
		If NOT IsEmpty(GlobalDictionary("VENDOR ID")) Then
			If GlobalDictionary("VENDOR ID")<>"" Then
				If .WebEdit("VENDOR_ID").Exist(nminwait) Then
					.WebEdit("VENDOR_ID").Set GlobalDictionary("VENDOR ID")
				End If
			End If
		End If
		If .WebButton("View Results").Exist(nminwait) Then
'			.WebButton("View Results").Click
			WriteToReport micPass,"View Results field","View Results field is present and clicked",false
		else:WriteToReport micfail,"View Results field","View Results field isn't present",true
		End If
	End With
	
'Price Descripencies grt 10	
	If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("Price Descripencies grt 10").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("Price Descripencies grt 10").Click
		WriteToReport micPass,"Price Descripencies grt 10 field","Price Descripencies grt 10 field is present and clicked",false
		else:WriteToReport micfail,"Price Descripencies grt 10 field","Price Descripencies grt 10 field isn't present",true
	End If
	With Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Query")
		count=0
		While NOT(.WebElement("Price Discrepencies").Exist(nminwait)) AND Count<10
			app_SearchSync():Count=count+1
		Wend
		If .WebElement("Price Discrepencies").Exist(nminwait) Then
			WriteToReport micPass,"Price Discrepencies field","Price Discrepencies field is present and displayed as "&.WebElement("Price Discrepencies").GetROProperty("innertext"),false
		else:WriteToReport micfail,"Price Discrepencies field","Price Discrepencies field isn't present",true
		End If
		If .WebEdit("Accounting Date From").Exist(nminwait) Then
			.WebEdit("Accounting Date From").Set GlobalDictionary("Accounting Date from")
			WriteToReport micPass,"Accounting Date From field","Accounting Date From field is present and enter as "&GlobalDictionary("Accounting Date from"),false
		else:WriteToReport micfail,"Accounting Date From field","Accounting Date From field isn't present",true
		End If
		If .WebEdit("Accounting Date To").Exist(nminwait) Then
			.WebEdit("Accounting Date To").Set GlobalDictionary("Accounting Date To")
			WriteToReport micPass,"Accounting Date To field","Accounting Date To field is present and enter as "&GlobalDictionary("Date To"),false
		else:WriteToReport micfail,"Accounting Date To field","Accounting Date To field isn't present",true
		End If
		If .WebButton("View Results").Exist(nminwait) Then
			.WebButton("View Results").Click
			WriteToReport micPass,"View Results field","View Results field is present and clicked",false
		else:WriteToReport micfail,"View Results field","View Results field isn't present",true
		End If
		count=0
		While NOT(.WebElement("Download results").Exist(nminwait)) AND Count<10
			app_SearchSync():Count=count+1
		Wend
		If .WebTable("Price Discrepencies").Exist(nminwait) Then
			WriteToReport micPass,"Price Discrepencies table","Price Discrepencies table is present and displayed",false
		End If
	End With

'List of All Active Vendors
	For i = 0 To 4 Step 1
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").WebElement("Refresh Queries").Click
		id=Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").WebButton("Expand section").GetROProperty("html id")
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").WebButton("Expand section").SetTOProperty "html id",split(id,"$")(0)&"$"&i
		wait(3)
		If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").WebButton("Expand section").Exist(nminwait) Then
			If InStr(1,Trim(Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").WebButton("Expand section").GetROProperty("innerhtml")),"Group - Vendor Master",1) Then
				Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").WebButton("Expand section").Click
				Exit for
			End If
		End If
		wait(3)
	next
	If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("List of All Active Vendors").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("List of All Active Vendors").Click
		WriteToReport micPass,"List of All Active Vendors field","List of All Active Vendors is present and clicked",false
		else:WriteToReport micfail,"List of All Active Vendors field","List of All Active Vendors field isn't present",true
	End If
	With Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Query")
		count=0
		While NOT(.WebElement("Download results").Exist(nminwait)) AND count<10
			app_searchsync():count=count+1
		Wend
		If .WebElement("List of all Active Vendors").Exist(nminwait) Then
			WriteToReport micPass,"List of all Active Vendors field","List of all Active Vendors field is present and displayed as "&.WebElement("List of all Active Vendors").GetROProperty("innertext"),false
		else:WriteToReport micfail,"List of all Active Vendors field","List of all Active Vendors field isn't present",true
		End If
		If .WebTable("List of all Active Vendors").Exist(nminwait) Then
			WriteToReport micPass,"List of all Active Vendors table","List of all Active Vendors table is present and displayed",false
		End If
	End With
	
'Lookup Valid Compos
	For i = 0 To 4 Step 1
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").WebElement("Refresh Queries").Click
		id=Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").WebButton("Expand section").GetROProperty("html id")
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").WebButton("Expand section").SetTOProperty "html id",split(id,"$")(0)&"$"&i
		wait(3)
		If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").WebButton("Expand section").Exist(nminwait) Then
			If InStr(1,Trim(Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").WebButton("Expand section").GetROProperty("innerhtml")),"Group - Non-inventory",1) Then
				Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").WebButton("Expand section").Click
				Exit for
			End If
		End If
		wait(3)
	next
	If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("Lookup Valid Compos").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("Lookup Valid Compos").Click
		WriteToReport micPass,"View Results field","View Results field is present and clicked",false
		else:WriteToReport micfail,"View Results field","View Results field isn't present",true
	End If
	
	With Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Query")
		count=0
		While NOT(.WebElement("Lookup Valid Combos").Exist(nminwait)) AND count<10
			app_searchsync():count=count+1
		Wend
		If .WebElement("Lookup Valid Combos").Exist(nminwait) Then
			WriteToReport micPass,"Lookup Valid Combos field","Lookup Valid Combos field is present and displayed as "&.WebElement("Lookup Valid Combos").GetROProperty("innertext"),false
		else:WriteToReport micfail,"Lookup Valid Combos field","Lookup Valid Combos field isn't present",true
		End If
		If .WebEdit("Enter BU").Exist(nminwait) Then
			.WebEdit("Enter BU").Set GlobalDictionary("Enter BU")
			WriteToReport micPass,"Enter BU field","Enter BU field is present and displayed as "&GlobalDictionary("Enter BU"),false
		else:WriteToReport micfail,"Enter BU field","Enter BU field isn't present",true
		End If
		If .WebEdit("Enter Account").Exist(nminwait) Then
			.WebEdit("Enter Account").Set GlobalDictionary("Enter Account")
			WriteToReport micPass,"Enter Account field","Enter Account field is present and displayed as "&GlobalDictionary("Enter Account"),false
		else:WriteToReport micfail,"Enter Account field","Enter Account field isn't present",true
		End If
		If .WebButton("View Results").Exist(nminwait) Then
			.WebButton("View Results").Click
			WriteToReport micPass,"View Results field","View Results field is present and clicked",false
		else:WriteToReport micfail,"View Results field","View Results field isn't present",true
		End If
		count=0
		While NOT(.WebElement("Download results").Exist(nminwait)) AND count<10
			app_searchsync():count=count+1
		Wend
		If .WebTable("Lookup Valid Combos").Exist(nminwait) Then
			WriteToReport micPass,"Lookup Valid Combos table","Lookup Valid Combos table is present and displayed",false
		End If
	End With

'Aged Creditors Report
	If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("Aged Creditors Report").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("Aged Creditors Report").Click
	End If
	With Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Aged Creditors Report")
		count=0
		While NOT(.WebElement("Add a New Value").Exist(nminwait)) AND count<10
			app_searchsync():count=count+1
		Wend
		If .WebElement("Add a New Value").Exist(nminwait) Then
			.WebElement("Add a New Value").Click
			WriteToReport micPass,"Add a New Value field","Add a New Value field is present and clicked",false
		else:WriteToReport micfail,"Add a New Value field","Add a New Value field isn't present",true
		End If
		If .WebEdit("Run Control ID").Exist(nminwait) Then
			GlobalDictionary("Run Control ID")=GlobalDictionary("Run Control ID")&replace(replace(replace(now,"/",""),":","")," ","")
			.WebEdit("Run Control ID").Set GlobalDictionary("Run Control ID")
			WriteToReport micPass,"Run Control ID field","Run Control ID field is present and displayed as "&GlobalDictionary("Run Control ID"),false
		else:WriteToReport micfail,"Run Control ID field","Run Control ID field isn't present",true
		End If
		If .WebButton("Add").Exist(nminwait) Then
			.WebButton("Add").Click
			WriteToReport micPass,"add field","Add field is present and clicked",false
		else:WriteToReport micfail,"Add field","Add field isn't present",true
		End If
		count=0
		While NOT(.WebEdit("Business Unit").Exist(nminwait)) AND count<10
			app_searchsync():count=count+1
		Wend
		If .WebEdit("Business Unit").Exist(nminwait) Then
			.WebEdit("Business Unit").Set GlobalDictionary("Business Unit")
			WriteToReport micPass,"Business Unit field","Business Unit field is present and displayed as "&GlobalDictionary("Business Unit"),false
		else:WriteToReport micfail,"Business Unit field","Business Unit field isn't present",true
		End If
		If .WebButton("Run").Exist(nminwait) Then
			.WebButton("Run").Click
			WriteToReport micPass,"Run field"," Run field is present and clicked",false
		else:WriteToReport micfail," Run field","Run field isn't present",true
		End If
	End With
	With Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Process Sheduler request")
		If .WebTable("Process List").Exist(nminwait) Then
			rc=.WebTable("Process List").RowCount
			For i = 3 To rc Step 1
				.WebTable("Process List").ChildItem(i,1,"WebCheckBox",0).Set "ON"
				.WebTable("Process List").ChildItem(i,5,"WebList",0).Select GlobalDictionary("ACR_Type")'"Web"
				.WebTable("Process List").ChildItem(i,6,"WebList",0).Select GlobalDictionary("ACR_Format")'"XLS"
				WriteToReport micPass,"Process selected"," Selected process is "&.WebTable("Process List").GetCellData(i,3) &" - "&.WebTable("Process List").GetCellData(i,2) ,false
			Next
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
			WriteToReport micPass,"OK field"," OK field is present and clicked",false
		else:WriteToReport micfail," OK field","OK field isn't present",true
		End If
	End With
Dim PI,Instances
	Instances=Trim(Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Aged Creditors Report").WebElement("Process Instance").GetROProperty("innertext"))
	PI=Split(Split(Instances,":")(1),",")
	If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Aged Creditors Report").Link("Process Monitor").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Aged Creditors Report").Link("Process Monitor").Click
		WriteToReport micPass,"Process Monitor field"," Process Monitor field is present and clicked",false
		else:WriteToReport micfail," Process Monitor field","Process Monitor field isn't present",true
	End If
	
	For i = 0 To Ubound(PI) Step 1
		With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor")
			If .WebEdit("InstanceFrom").Exist(nminwait) Then
				.WebEdit("InstanceFrom").Set PI(i)
			End If
			If .WebButton("Refresh").Exist(nminwait) Then
				.WebButton("Refresh").Click: Count=Count+1
			End If
			If .WebTable("ProcessTable_ProcessMonitor").Exist(nminwait) Then
				Count=0
				do while StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)<>0 AND Count<100
					If .WebButton("Refresh").Exist(nminwait) Then
						.WebButton("Refresh").Click: Count=Count+1
	'					WriteToReport micPass,"Refresh "," Refresh is present and clicked",false
					End If
					app_Searchsync()
				loop
				If StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)=0 Then
					WriteToReport micPass,"Instace get processed successfully "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" is processed successfully",false
					else
					WriteToReport micfail,"Instace doesn't get processed "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" isn't processed",false
				End If
				
			End If
		End With
	Next
	If Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Save").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Save").Click
		WriteToReport micPass,"Save field"," Save field is present and clicked",false
		else:WriteToReport micfail," Save field","Save field isn't present",true
	End If
	If Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").Link("Go back").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").Link("Go back").Click
		WriteToReport micPass,"Go Back field"," Go Back field is present and clicked",false
		else:WriteToReport micfail," Go Back field","Go Back field isn't present",true
	End If
	
	If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Aged Creditors Report").Link("Report Manager").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Aged Creditors Report").Link("Report Manager").Click
		WriteToReport micPass,"Report Manager field"," Report Manager field is present and clicked",false
		else:WriteToReport micfail," Report Manager field","Report Manager field isn't present",true
	End If

	With Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Distribution Mgr")
		If .WebTable("RM_ReportTable").Exist(nminwait) Then
			rc=.WebTable("RM_ReportTable").RowCount
			For i = 1 To rc Step 1
				If InStr(1,Trim(.WebTable("RM_ReportTable").GetCellData(i,2)),GlobalDictionary("ACR Report"),1) Then
					.WebTable("RM_ReportTable").ChildItem(i,2,"Link",0).click
					Exit for
				End If
			Next
		End If
	End With
Dim fileUrl
	If Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Index").Link("ReprintPDF").Exist(nminwait) Then
		fileUrl=Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Index").Link("ReprintPDF").GetROProperty("href")
	End If
	call downloadAfilefromURL(fileUrl,GlobalDictionary("ACRReportFilePath"))

'AP Transaction Report
	If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("AP Transaction Report").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Queries Pagelet").Link("AP Transaction Report").Click
		WriteToReport micPass,"P Transaction Report field"," P Transaction Report field is present and clicked",false
		else:WriteToReport micfail," P Transaction Report field","P Transaction Report field isn't present",true
	End If
	With Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("AP Transaction Report")
		If .WebElement("Add a New Value").Exist(nminwait) Then
			.WebElement("Add a New Value").Click
			WriteToReport micPass,"Add a New Value field"," Add a New Value field is present and clicked",false
		else:WriteToReport micfail," Add a New Value field","Add a New Value field isn't present",true
		End If
		If .WebEdit("Run Control ID").Exist(nminwait) Then
			GlobalDictionary("Run Control ID")="APTR"&Replace(replace(replace(now,":",""),"/","")," ","")
			.WebEdit("Run Control ID").Set GlobalDictionary("Run Control ID")
			WriteToReport micPass,"Run Control ID field","Run Control ID field is present and displayed as "&GlobalDictionary("Run Control ID"),false
		else:WriteToReport micfail,"Run Control ID field","Run Control ID field isn't present",true
		End If
		If .WebButton("Add").Exist(nminwait) Then
			.WebButton("Add").Click
			WriteToReport micPass,"Add field"," Add field is present and clicked",false
		else:WriteToReport micfail," Add field","Add field isn't present",true
		End If
		If .WebCheckBox("All Business Unit").Exist(nminwait) Then
			.WebCheckBox("All Business Unit").Set "OFF"
		End If
		If .WebEdit("Business Unit From").Exist(nminwait) Then
			.WebEdit("Business Unit From").Set GlobalDictionary("Business Unit From")
			WriteToReport micPass,"Business Unit From field","Business Unit From field is present and displayed as "&GlobalDictionary("Business Unit From"),false
		else:WriteToReport micfail,"Business Unit From field","Business Unit From field isn't present",true
		End If
		If .WebEdit("Business Unit To").Exist(nminwait) Then
			.WebEdit("Business Unit To").Set GlobalDictionary("Business Unit To")
			WriteToReport micPass,"Business Unit To field","Business Unit To field is present and displayed as "&GlobalDictionary("Business Unit To"),false
		else:WriteToReport micfail,"Business Unit To field","Business Unit To field isn't present",true
		End If
		If .WebEdit("Entered Date From").Exist(nminwait) Then
			.WebEdit("Entered Date From").Set GlobalDictionary("Entered Date From")
			WriteToReport micPass,"Entered Date From field","Entered Date From field is present and displayed as "&GlobalDictionary("Entered Date From"),false
		else:WriteToReport micfail,"Entered Date From field","Entered Date From field isn't present",true
		End If
		If .WebEdit("Entered date To").Exist(nminwait) Then
			.WebEdit("Entered date To").Set  GlobalDictionary("Entered date To")
			WriteToReport micPass,"Entered date To field","Entered date To field is present and displayed as "&GlobalDictionary("Entered date To"),false
		else:WriteToReport micfail,"Entered date To field","Entered date To field isn't present",true
		End If
		If .WebButton("Run").Exist(nminwait) Then
			.WebButton("Run").Click
			WriteToReport micPass,"Run button"," Run field is present and clicked",false
		else:WriteToReport micfail," Run field","Run field isn't present",true
		End If
	End With
	With Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("Process Sheduler request")
		If .WebTable("Process List").Exist(nminwait) Then
			rc=.WebTable("Process List").RowCount
			For i = 3 To rc Step 1
				.WebTable("Process List").ChildItem(i,1,"WebCheckBox",0).Set "ON"
				.WebTable("Process List").ChildItem(i,5,"WebList",0).Select  GlobalDictionary("APTR_Type")'"Web"
				.WebTable("Process List").ChildItem(i,6,"WebList",0).Select  GlobalDictionary("APTR_Format")'"PDF"
				WriteToReport micPass,"Process selected"," Selected process is "&.WebTable("Process List").GetCellData(i,3) &" - "&.WebTable("Process List").GetCellData(i,2) ,false
			Next
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
			WriteToReport micPass,"OK button"," OK field is present and clicked",false
		else:WriteToReport micfail," OK field","OK field isn't present",true
		End If
	End With
	Instances=Trim(Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("AP Transaction Report").WebElement("Process Instance").GetROProperty("innertext"))
	PI=Split(Split(Instances,":")(1),",")
	If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("AP Transaction Report").Link("Process Monitor").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("AP Transaction Report").Link("Process Monitor").Click
		WriteToReport micPass,"Process Monitor link"," Process Monitor field is present and clicked",false
		else:WriteToReport micfail," Process Monitor field","Process Monitor field isn't present",true
	End If
	
	For i = 0 To Ubound(PI) Step 1
		With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor")
			If .WebEdit("InstanceFrom").Exist(nminwait) Then
				.WebEdit("InstanceFrom").Set PI(i)
			End If
			If .WebButton("Refresh").Exist(nminwait) Then
				.WebButton("Refresh").Click: Count=Count+1
			End If
			If .WebTable("ProcessTable_ProcessMonitor").Exist(nminwait) Then
				Count=0
				do while StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)<>0 AND Count<100
					If .WebButton("Refresh").Exist(nminwait) Then
						.WebButton("Refresh").Click: Count=Count+1
	'					WriteToReport micPass,"Refresh "," Refresh is present and clicked",false
					End If
					app_Searchsync()
				loop
				If StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)=0 Then
					WriteToReport micPass,"Instace get processed successfully "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" is processed successfully",false
					else
					WriteToReport micfail,"Instace doesn't get processed "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" isn't processed",false
				End If
				
			End If
		End With
	Next
	If Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Save").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Save").Click
		WriteToReport micPass,"Save field"," Save field is present and clicked",false
		else:WriteToReport micfail," Save field","Save field isn't present",true
	End If
	If Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").Link("Go back").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").Link("Go back").Click
		WriteToReport micPass,"Go Back field"," Go Back field is present and clicked",false
		else:WriteToReport micfail," Go Back field","Go Back field isn't present",true
	End If
	
	If Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("AP Transaction Report").Link("Report Manager").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Accounts Payable WorkCenter").PSFrame("AP Transaction Report").Link("Report Manager").Click
		WriteToReport micPass,"Report Manager field"," Report Manager field is present and clicked",false
		else:WriteToReport micfail," Report Manager field","Report Manager field isn't present",true
	End If

	With Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Distribution Mgr")
		If .WebTable("RM_ReportTable").Exist(nminwait) Then
			rc=.WebTable("RM_ReportTable").RowCount
			For i = 1 To rc Step 1
				If InStr(1,Trim(.WebTable("RM_ReportTable").GetCellData(i,2)),GlobalDictionary("APTR Report"),1) Then
					.WebTable("RM_ReportTable").ChildItem(i,2,"Link",0).click
					Exit for
				End If
			Next
		End If
	End With
Dim strLinks,strName
	If Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Index").Link("ReprintPDF").Exist(nminwait) Then
		strLinks=Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Index").Link("ReprintPDF").GetROProperty("html id")
		For i = 0 To 2 Step 1
			Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Index").Link("ReprintPDF").SetTOProperty "html id",Split(strLinks,"$")(0)&"$"&i
			strName=Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Index").Link("ReprintPDF").GetROProperty("innertext")
			If InStr(1,strName,".csv",1) Then
				fileUrl=Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Index").Link("ReprintPDF").GetROProperty("href")
				
				Exit for
			End If
		Next
		fileUrl=Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Index").Link("ReprintPDF").GetROProperty("href")
	End If
	call downloadAfilefromURL(fileUrl,GlobalDictionary("ACRReportFilePath"))

End Function

'*************************************************************************************************************************
''' <summary>  
''' ep_captureApproverNames()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Vijay anandan</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'*********************************************************************************************************************************
'2.03 : EPro CAN 

Public Function ReqComboEditErr

'Navigate to Below page
'eProcurement>Requisition
SignInUser=GlobalDictionary("SignInUser")
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
businessunit=(GlobalDictionary("businessunit"))
price=(GlobalDictionary("price"))
qty=(GlobalDictionary("qty"))
UOM=(GlobalDictionary("UOM"))
Category=(GlobalDictionary("Category"))
SupplierID=(GlobalDictionary("SupplierID"))
Account=(GlobalDictionary("Account"))
Dept=(GlobalDictionary("Dept"))
Account1=(GlobalDictionary("Account1"))
Dept1=(GlobalDictionary("Dept1"))

	'enter bu
	WITH Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebEdit("ECAN_BusinessUnit")
		if .Exist(nminwait) Then
		    .Set  businessunit
		  	Reporter.ReportEvent micPass,"Business Unit  "," Business Unit field is present and entered as"&businessunit
		End If
		End with
		
		'click on search button
	WIth Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Add")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Add button is present", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Add button is not present", "and not clicked",True)
	End If
	End With 
	
	'click on requisition setting link
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("Requisition Settings")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Requisition Settings link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Requisition Settings link is not displayed", "and not clicked",True)
	End If
	End With
	
	'select override radio button	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebRadioGroup("Override_radbutton")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Override option is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Override option is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on chartfield2 Tab
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebElement("ChartField2")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Chartfields2_Tabis displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Chartfields2_Tab is not displayed", "and not clicked",True)
	End If
	End With
	
	
	'set Dept ID
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebEdit("Dept")
	    If .Exist(nMINWAIT) Then
		.Set Dept
		Call WriteToReport(micPass,"IChartfields2_DeptID is present ","and set with="&Dept, false)
	End If
	End  With
	
	'click  on OK button
      With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"OK button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"OK button is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on special request link
  With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("Special Requests")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Special Requests link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Special Requests link is not displayed", "and not clicked",True)
	End If
	End With

Call  EProCANaddSpecialRequisition(Category,Qty,UOM,SupplierID,price)


	'click on checkout button
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Checkout")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Checkout button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Checkout button is not displayed", "and not clicked",True)
	End If
	End With

	'click on Expand section
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Image("Expand Section")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Expand Section is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Expand Section is not displayed", "and not clicked",True)
	End If
	End With
	
	'Wait for the application to sync
 app_SearchSync()
 

 	'click on expand section accounting
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Image("Expand section Accounting")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Expand Section Accounting is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Expand Section  Accounting is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on chartfield2 tab
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields2_Tab")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Chartfields2_Tab is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Chartfields2_Tab is not displayed", "and not clicked",True)
	End If
	End With
	

	'set Account number	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
	    If .Exist(nMINWAIT) Then
		.Set Account
		Call WriteToReport(micPass,"Chartfields2_Account is present ","and set with="&Account, false)
	End If
	End  With 

	'click on dept id
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
	    If .Exist(nMINWAIT) Then
		.Set Dept
		Call WriteToReport(micPass,"IChartfields2_DeptID is present ","and set with="&Dept, false)
	End If
	End  With 
	
	
	'To click Save for later button
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Save for Later")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Save for Later button","is clicked",false)
	End If
    End  With
	

	'verify alert message	
	 With Browser("PeopleSoft Browser").Page("Requisition")
      If .WebElement("Message").Exist(nminwait) Then
          WriteToReport micPass,"alertMsg is present and displayed as "," please refer ChartField Combination Data"&.WebElement("Message").GetROProperty("innertext"),false
      End If
      If .WebButton("OK").Exist(nminwait) Then
         .WebButton("OK").Click
      End If
      End With

	'set Account number	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
	    If .Exist(nMINWAIT) Then
		.Set Account1
		Call WriteToReport(micPass,"Chartfields2_Account is present ","and set with="&Account1, false)
	End If
	End  With 
	
	'set dept id
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
	    If .Exist(nMINWAIT) Then
		.Set Dept1
		Call WriteToReport(micPass,"IChartfields2_DeptID is present ","and set with="&Dept1, false)
	End If
	End  With 
	
	'To enter requisition comments
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebEdit("ReviewSubmit_RequisitionComments")
	If .Exist(nMINWAIT) Then
		.Set comments
		Call WriteToReport(micPass,"Comments is present ","and set with="&comments, false)
	End If
End  With

'To click Save for later button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Save for Later")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Save for Later button","is clicked",false)
	End If
End  With


'To click preview approvals link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("PreviewApprovals")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Preview Approvals link","is clicked",false)
	End If
End  With

app_SearchSync()

 Dim ApproverList,RequesitionID
		ApproverList=ep_captureApproverNames(Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals"))
		
		If IsArray(ApproverList) Then
			For k = 0 To Ubound(ApproverList) Step 1
				GlobalDictionary("user"&k+1)=ApproverList(k)
			Next
			GlobalDictionary("TotalUsers")=UBound(ApproverList)+2
		End If
		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")
			If .WebElement("Preview_Status").Exist(nminwait) Then
				WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("Preview_Status").GetROProperty("innertext") ,false
			End If
			If .WebButton("Return").Exist(nminwait) Then
				.WebButton("Return").Click
			End If
		End With
				
		app_searchsync()
		
			With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
			RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
			WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
		End If
		If .WebButton("Save & submit").Exist(nminwait) Then
			.WebButton("Save & submit").Click
			WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
		End If
		End With
	
	With Browser("PeopleSoft Browser").Page("Requisition")
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
	If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
		WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
	End If
	If .WebElement("Confirmation_status").Exist(nminwait) Then
		WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
	End If
End With
			
End Function

'*************************************************************************************************************************
''' <summary>  
''' ep_captureApproverNames()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Vijay anandan</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'*********************************************************************************************************************************
'4.01 : EPro CAN 
Public Function DropShipCan

'Navigate to Below page
'eProcurement > Buyer Center > Manage Purchase Orders

SignInUser=GlobalDictionary("SignInUser")
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
businessunit=(GlobalDictionary("businessunit"))

'click on search button
With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebButton("Clear")
If .Exist(nMainWait) Then
	.Click
		Call WriteToReport(micPass,"Clear button is present", "and displayed",False)
		Else
		Call WriteToReport(micFail,"Clear button is not present", "and not displayed",True)
End If
End WIth

		'enter bu
		WITH Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("Browsing PO").WebEdit("Bussiness Unit")
		if .Exist(nminwait) Then
		    .Set  businessunit
		  	Reporter.ReportEvent micPass,"Business Unit  "," Business Unit field is present and entered as"&businessunit
		End If
		End with


'click on search button
WIth Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Search button is present", "and displayed",False)
		Else
		Call WriteToReport(micFail,"Search button is not present", "and not displayed",True)
End If
End With 

'validate searchresult table is present or not
WIth Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebTable("Searchresults")
     If.Exist(nMINWAIT) Then
		Call WriteToReport(micPass,"Searchresults table is present", "and displayed",False)
		Else
		Call WriteToReport(micFail,"Searchresults table is not present", "and not displayed",True)
	End If
	End With
	
'click on PO Link
	Set oLink=Description.Create
	oLink("MicClass").value="Link"
	oLink("class").value="PSHYPERLINK"
	oLink("html id").value="PO_ID_FLG.*"
	
	Set oObj=Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").ChildObjects(oLink)
	oObj(0).click
	Call WriteToReport(micPass,"POID link is displayed", "and clicked",False)
	
'	With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("Browsing PO").Link("POID Link")
'	If .Exist(nMINWAIT) Then
'		.Click
'		Call WriteToReport(micPass,"POID link is displayed", "and clicked",False)
'		Else
'		Call WriteToReport(micFail,"POID link is not displayed", "and not clicked",True)
'	End If
'	End With
	
'Validate PO Status
	WIth Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("Purchase Order").WebTable("PO Status")
     If.Exist(nMINWAIT) Then
		Call WriteToReport(micPass,"PO Status  is present", "and displayed",False)
		Else
		Call WriteToReport(micFail,"PO Status  is not present", "and not displayed",True)
	End If
	End With

'verify Dropshipflag	
	With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("Purchase Order").WebElement("DropShipFlag")
	If.Exist(nMINWAIT) Then
	If StrComp(.GetROProperty("innertext"),"No",1)=0 Then
		Call WriteToReport(micPass,"DropShipFlag is displayed", "and status is "&.GetROProperty("innertext") ,False)
		Else
		Call WriteToReport(micFail,"DropShipFlag isn't displayed", "as No , Actual is "&.GetROProperty("innertext")  ,True)
	End If
	End If
	End with
	
	
End Function
'*************************************************************************************************************************
''' <summary>  
''' ep_captureApproverNames()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Vijay anandan</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'*********************************************************************************************************************************
'2.02 : EPro CAN 

Public Function selfapprCan
	
'Navigate to Below page
'eProcurement>Requisition
SignInUser=GlobalDictionary("SignInUser")
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
businessunit=(GlobalDictionary("businessunit"))
price=(GlobalDictionary("price"))
qty=(GlobalDictionary("qty"))
UOM=(GlobalDictionary("UOM"))
Category=(GlobalDictionary("Category"))
SupplierID=(GlobalDictionary("SupplierID"))
Account=(GlobalDictionary("Account"))
Dept=(GlobalDictionary("Dept"))
Account1=(GlobalDictionary("Account1"))
Dept1=(GlobalDictionary("Dept1"))

		
	'click on requisition setting link
		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Requisition Settings link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Requisition Settings link is not displayed", "and not clicked",True)
	End If
	End With
	
	'select override radio button	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebRadioGroup("Override_radbutton")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Override option is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Override option is not displayed", "and not clicked",True)
	End If
	End With
	
		'click  on OK button
      With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Requisition Settings").WebButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"OK button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"OK button is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on special request link
  With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Special Requests link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Special Requests link is not displayed", "and not clicked",True)
	End If
	End With

Call  addSpecialRequisition(Category,Qty,UOM,SupplierID,price)


	'click on checkout button
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Checkout button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Checkout button is not displayed", "and not clicked",True)
	End If
	End With

	'click on Expand section
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand Section")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Expand Section is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Expand Section is not displayed", "and not clicked",True)
	End If
	End With
	
	'Wait for the application to sync
 app_SearchSync()
 

 	'click on expand section accounting
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Image("Expand section Accounting")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Expand Section Accounting is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Expand Section  Accounting is not displayed", "and not clicked",True)
	End If
	End With
	
	'click on chartfield2 tab
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebElement("Chartfields2_Tab")
	If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Chartfields2_Tab is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Chartfields2_Tab is not displayed", "and not clicked",True)
	End If
	End With
	

	'set Account number	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
	    If .Exist(nMINWAIT) Then
		.Set Account
		Call WriteToReport(micPass,"Chartfields2_Account is present ","and set with="&Account, false)
	End If
	End  With 

	'click on dept id
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
	    If .Exist(nMINWAIT) Then
		.Set Dept
		Call WriteToReport(micPass,"IChartfields2_DeptID is present ","and set with="&Dept, false)
	End If
	End  With 
	
	
	'To click Save for later button
    With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save for Later")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Save for Later button","is clicked",false)
	End If
    End  With
	

	'verify alert message	
	 With Browser("PeopleSoft Browser").Page("Requisition")
      If .WebElement("Message").Exist(nminwait) Then
          WriteToReport micPass,"alertMsg is present and displayed as "," please refer ChartField Combination Data"&.WebElement("Message").GetROProperty("innertext"),false
      End If
      If .WebButton("OK").Exist(nminwait) Then
         .WebButton("OK").Click
      End If
      End With

	'set Account number	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_Account")
	    If .Exist(nMINWAIT) Then
		.Set Account1
		Call WriteToReport(micPass,"Chartfields2_Account is present ","and set with="&Account1, false)
	End If
	End  With 
	
	'set dept id
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebEdit("Chartfields2_DeptID")
	    If .Exist(nMINWAIT) Then
		.Set Dept1
		Call WriteToReport(micPass,"IChartfields2_DeptID is present ","and set with="&Dept1, false)
	End If
	End  With 
	

'Click on Submit button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Save & submit")
	If .Exist(nMINWAIT) Then
		.Click
		Reporter.ReportEvent micPass,"Submit button","is present and clicked"
	End If
End With
	
'validating conformation page	
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
	If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
		WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
	End If
	If .WebElement("Confirmation_status").Exist(nminwait) Then
		WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
	End If
End With

	
	'Wait for the application to sync
 app_SearchSync()
		
End Function

'*************************************************************************************************************************
''' <summary>  
''' ChangeRequisitionProcessChangeonPO()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "objFrame"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/21/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'*********************************************************************************************************************************
'EC_2_04
Public Function ChangeRequisitionProcessChangeonPO()
	
	Dim i
	'Navigate to below page "eProcurement > Requisition"
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent")
		If .WebElement("Add a New Value Tab").Exist(nminwait) Then
			.WebElement("Add a New Value Tab").Click
			WriteToReport micPass,"Add a New Value Tab "," Add a New Value Tab is present and clicked",false
		else:	WriteToReport micfail,"Add a New Value Tab"," Add a New Value Tab isn't present",true
		End If
		If .WebEdit("ECAN_BusinessUnit").Exist(nminwait) Then
			.WebEdit("ECAN_BusinessUnit").Set GlobalDictionary("businessunit")
			WriteToReport micPass," BusinessUnit text box"," BusinessUnit is present and entered as"&GlobalDictionary("businessunit"),false
		else
			WriteToReport micfail,"BusinessUnit text box "," businessunit field isn't present",true
		End If
		If .WebButton("Add").Exist(nminwait) Then
			.WebButton("Add").Click
			WriteToReport micPass,"Add Button "," Add Button field is present and clicked",false
		else:	WriteToReport micfail,"Add Button "," Add Button isn't present",true
		End If
	End With

	
	
	If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings").Click
		WriteToReport micPass,"Requisition Settings link "," Requisition Settings field is present and clicked",false
	else
		WriteToReport micfail,"Requisition Settings link "," Requisition Settings field isn't present",true
	End If
	
	'requisition settings
	RequisitionSettings
	
	If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests").Click
		WriteToReport micPass,"Special Requests link "," Special Requests field is present and clicked",false
	else
		WriteToReport micfail,"Special Requests link "," Special Requests field isn't present",true
	End If
	app_searchsync()

	businessunit=GlobalDictionary("businessunit")
	Price=GlobalDictionary("Price")
	Qty=GlobalDictionary("Qty")
	UOM=GlobalDictionary("UOM")
	Category=GlobalDictionary("Category")
	SupplierID=GlobalDictionary("SupplierID")
	call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)
	WriteToReport micPass,"Requsistion 1"," Requesition 1 added to the cart successfully",false
	
	
	
	If Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").WebButton("Checkout").Click
		WriteToReport micPass,"Checkout button "," Checkout is present and clicked",false
	else
		WriteToReport micfail,"Checkout button "," Checkout field isn't present",true
	End If
	app_SearchSync()
	WriteToReport micDone,"chartfield2 for line 1"," adding chartfield2 details",false
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .Image("Expand Section").Exist(nminwait) Then
			.Image("Expand Section").Click
		End If
		If .Image("Expand section Accounting").Exist(nminwait) Then
			.Image("Expand section Accounting").Click
		End If
		If .WebElement("Chartfields2_Tab").Exist(nminwait) Then
			.WebElement("Chartfields2_Tab").Click
			WriteToReport micPass,"Checkout button "," Checkout is present and clicked",false
			else
			WriteToReport micfail,"Checkout button "," Checkout field isn't present",true
		End If
		If .WebEdit("Chartfields2_DeptID").Exist(nminwait) Then
			.WebEdit("Chartfields2_DeptID").Set GlobalDictionary("Dept1")
			WriteToReport micPass," in chartfield2"," Dept is present and entered as"&GlobalDictionary("Dept1"),false
		else
			WriteToReport micfail,"Dept in chartfield2 "," field isn't present",true
		End If
		If .WebEdit("Chartfields2_Account").Exist(nminwait) Then
			.WebEdit("Chartfields2_Account").Set GlobalDictionary("Account1")
			WriteToReport micPass,"Account in chartfield2"," Account is present and entered as"&GlobalDictionary("Account1"),false
		else
			WriteToReport micfail,"Account in chartfield2 "," field isn't present",true
		End If
		If .Image("Collapse Section").Exist(nminwait) Then
			.Image("Collapse Section").Click
		End If
		app_SearchSync()
		
		If .WebCheckBox("ReviewSubmit_SendtoSupplier").Exist(nminwait) Then
			.WebCheckBox("ReviewSubmit_SendtoSupplier").Set"ON"
		End If
		
		If .WebCheckBox("ReviewSubmit_ShowAtReceipt").Exist(nminwait) Then
			.WebCheckBox("ReviewSubmit_ShowAtReceipt").Set "ON"
		End If
		If .WebCheckBox("ReviewSubmit_ShowatVoucher").Exist(nminwait) Then
			.WebCheckBox("ReviewSubmit_ShowatVoucher").Set "ON"
		End If
		If .WebEdit("ReviewSubmit_approvalJustification").Exist(nminwait) Then
			.WebEdit("ReviewSubmit_approvalJustification").Set SupplierID&" "&now
		End If
		If .WebEdit("ReviewSubmit_RequisitionComments").Exist(nminwait) Then
			.WebEdit("ReviewSubmit_RequisitionComments").Set SupplierID&" "&now
		End If
		If .WebButton("Save for Later").Exist(nminwait) Then
			.WebButton("Save for Later").Click
			WriteToReport micPass,"Save for Later "," Save for Later is present and clicked",false
			else:WriteToReport micfail,"Save for Later "," Save for Later isn't present ",true
		End If
		
		app_searchSync()
		
		If .Link("PreviewApprovals").Exist(nminwait) Then
			.Link("PreviewApprovals").Click
			WriteToReport micPass,"PreviewApprovals "," PreviewApprovals is present and clicked",false
			else:WriteToReport micfail,"PreviewApprovals"," PreviewApprovals isn't present ",true
		End If
		
	End With
		wait(3):app_searchSync()
		wait(3):app_searchSync()
		
Dim ApproverList,RequesitionID
		ApproverList=ep_captureApproverNames(Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals"))
		
		If IsArray(ApproverList) Then
			For k = 0 To Ubound(ApproverList) Step 1
				GlobalDictionary("user"&k+1)=ApproverList(k)
			Next
			GlobalDictionary("TotalUsers")=UBound(ApproverList)+2
		End If
		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")
			If .WebElement("Preview_Status").Exist(nminwait) Then
				WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("Preview_Status").GetROProperty("innertext") ,false
			End If
			If .WebElement("eProApproval_CATapproval").Exist(nminwait) Then
				WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("eProApproval_CATapproval").GetROProperty("innertext") ,false
			End If
			If .WebElement("eProApproval_ACCTapproval").Exist(nminwait) Then
				WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("eProApproval_ACCTapproval").GetROProperty("innertext") ,false
			End If
			If .WebButton("Return").Exist(nminwait) Then
				.WebButton("Return").Click
				WriteToReport micPass,"Return "," Return is present and clicked",false
			else:WriteToReport micfail,"Return"," Return isn't present ",true
			End If
		End With
				
		app_searchsync()
		
		

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
			RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
			WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
		End If
		If .WebButton("Save & submit").Exist(nminwait) Then
			.WebButton("Save & submit").Click
			WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
		End If
End With
	
	With Browser("PeopleSoft Browser").Page("Requisition")
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
	If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
		WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
	End If
	If .WebElement("Confirmation_status").Exist(nminwait) Then
		WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
	End If
	If .WebTable("eProApproval").Exist(nminwait) Then
		WriteToReport micPass,"Satus of eProcurement Approval "," Status is "&Replace(Replace(Replace(Replace(Trim(.WebTable("eProApproval").GetROProperty("innertext")),"View/Hide Comments",""),"Start New Path",""),"Comment History",""),"Comments","") ,false
	End If
End With

GlobalDictionary("ReqUser")=GlobalDictionary("SignInUser")
GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
	'signin as admin to get userids
	UserSignIn
	
	'PeopleTools>Security>User Profiles>User Profiles
'	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	
	'retrieve user id
	retrieveUserID()
	
	If IsArray(ApproverList) Then
	
		GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
		
		'signin as admin to get userids
		UserSignIn
		
		'WorkList>WorkList
		SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
		call ep_ApproveinMonitorApprovals(RequesitionID,GlobalDictionary("ApprovalProcess"),"",GlobalDictionary("HeaderStatus"),GlobalDictionary("ReqUser"),"")
'		call ep_ApproveinMonitorApprovals(RequesitionID,GlobalDictionary("ApprovalProcess"),GlobalDictionary("DefinitionID"),GlobalDictionary("HeaderStatus"),GlobalDictionary("ReqUser"),"")
	End If
	
'eProcurement > Buyer Center > Expedite Requisitions
	SelectMainMenu1(GlobalDictionary("MainMenuSelection4"))

	With Browser("PeopleSoft Browser").Page("Expedite Requisitions").PSFrame("Expedite Requisitions")
		If .WebEdit("BusinessUnit").Exist(nminwait) Then
			.WebEdit("BusinessUnit").Set GlobalDictionary("businessunit")
			WriteToReport micPass,"BusinessUnit "," BusinessUnit is present and entered as "&GlobalDictionary("businessunit"),false
			else:WriteToReport micfail,"BusinessUnit"," BusinessUnit isn't present ",true
		End If
		If .WebEdit("Requisition ID").Exist(nminwait) Then
			.WebEdit("Requisition ID").Set RequesitionID
			WriteToReport micPass,"RequesitionID "," RequesitionID is present and entered as "&RequesitionID,false
			else:WriteToReport micfail,"RequesitionID"," RequesitionID isn't present ",true
		End If
		If .WebEdit("Requestor").Exist(nminwait) Then
			.WebEdit("Requestor").Set GlobalDictionary("ReqUser")
			WriteToReport micPass,"Requestor "," Requestor is present and entered as "&GlobalDictionary("ReqUser"),false
			else:WriteToReport micfail,"Requestor"," Requestor isn't present ",true
		End If
		If .WebButton("Search").Exist(nminwait) Then
			.WebButton("Search").Click
			WriteToReport micPass,"Search "," Search is present and clicked",false
			else:WriteToReport micfail,"Search"," Search isn't present ",true
		End If
Dim count2:count2=0	
		While  NOT (.Link("RSL_IncludeAllExcludeAll").Exist(nminwait)) AND Count2<10
			app_SearchSync():count2=count2+1
		Wend
		If .Link("RSL_IncludeAllExcludeAll").Exist(nminwait) Then
			.Link("RSL_IncludeAllExcludeAll").Click
			WriteToReport micPass,"IncludeAll/ExcludeAll "," IncludeAll/ExcludeAll is present and clicked",false
			else:WriteToReport micfail,"IncludeAll/ExcludeAll"," IncludeAll/ExcludeAll isn't present ",true
		End If
		If .WebButton("BPO_Submit").Exist(nminwait) Then
			.WebButton("BPO_Submit").Click
			WriteToReport micPass,"Submit "," Submit is present and clicked",false
			else:WriteToReport micfail,"Submit"," Submit isn't present ",true
		End If
		app_searchsync()
		If .WebButton("Search").Exist(nminwait) Then
			.WebButton("Search").Click
			WriteToReport micPass,"Search "," Search is present and clicked",false
			else:WriteToReport micfail,"Search"," Search isn't present ",true
		End If
		app_searchsync()
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Requisistion submitted successfully "," Requisistion submitted successfully",false
		End If
	End With
	'PeopleTools>Process Scheduler>Process Monitor
	SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))
	
	app_Searchsync()
	Dim Count1
	With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor")
		If .WebTable("ProcessTable_ProcessMonitor").Exist(nminwait) Then
			Count1=0
			do while StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)<>0 AND count1<10
				If .WebButton("Refresh").Exist(nminwait) Then
					.WebButton("Refresh").Click: count1=count1+1
					WriteToReport micPass,"Refresh "," Refresh is present and clicked",false
				End If
				app_Searchsync()
			loop
			If StrComp(Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)),"Posted",1)=0 Then
				WriteToReport micPass,"Instace get processed successfully "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" is processed successfully",false
				else
				WriteToReport micfail,"Instace doesn't get processed "," Process name"&Trim(.WebTable("ProcessTable_ProcessMonitor").GetCellData(2,5))&" isn't processed",false
			End If
			
		End If
	End With
	
	'eProcurement>Manage Requisitions
	SelectMainMenu1(GlobalDictionary("MainMenuSelection5"))
	

	With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition")
		If .WebEdit("ManReq_BusinessUnit").Exist(NMINWAIT) Then
			.WebEdit("ManReq_BusinessUnit").Set GlobalDictionary("businessunit")
			WriteToReport micPass,"BusinessUnit "," BusinessUnit is present and entered as "&GlobalDictionary("businessunit"),false
			else:WriteToReport micfail,"BusinessUnit"," BusinessUnit isn't present ",true
		End If
		If .WebEdit("ManReq_RequisitionID").Exist(nminwait) Then
			.WebEdit("ManReq_RequisitionID").Set RequesitionID
			WriteToReport micPass,"RequesitionID "," RequesitionID is present and entered as "&RequesitionID,false
			else:WriteToReport micfail,"RequesitionID"," RequesitionID isn't present ",true
		End If
		If .WebEdit("ManReq_Requestor").Exist(nminwait) Then
			.WebEdit("ManReq_Requestor").Set GlobalDictionary("ReqUser")
			WriteToReport micPass,"Requestor "," Requestor is present and entered as "&GlobalDictionary("ReqUser"),false
			else:WriteToReport micfail,"Requestor"," Requestor isn't present ",true
		End If
		If .WebButton("ManReq_Search").Exist(nminwait) Then
			.WebButton("ManReq_Search").Click
			WriteToReport micPass,"Search "," Search is present and clicked",false
			else:WriteToReport micfail,"Search"," Search isn't present ",true
		End If
	End With
	app_searchsync()
Dim rowNo,cCount
	With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition")
		If .Image("Expand Section").Exist(nminwait) Then
			.Image("Expand Section").Click
			WriteToReport micPass,"Expand Section "," Expand Section is present and clicked",false
			else:WriteToReport micfail,"Expand Section"," Expand Section isn't present ",true
		End If

		If .WebTable("ManReq_RequistionList").Exist(nminwait) Then
			rowNo=.WebTable("ManReq_RequistionList").GetRowWithCellText(RequesitionID)
			cCount=.WebTable("ManReq_RequistionList").ColumnCount(rowNo)
			For i = 1 To cCount Step 1
				If isDate(Trim(.WebTable("ManReq_RequistionList").GetCellData(rowNo,i))) Then
					WriteToReport micPass,"Request state "," Request state is "&.WebTable("ManReq_RequistionList").GetCellData(rowNo,i+1),false
					Exit for
				End If
			Next
		End If
		If .link("PurchaseOrders").Exist(nminwait) Then
			.link("PurchaseOrders").Click
			WriteToReport micPass,"Purchase Orders link","Purchase Orders link is present and clicked",false
			else:WriteToReport micfail,"Purchase Orders link"," Purchase Orders link isn't present ",true
		End If
	end with
	
Dim PoNumber
	app_searchsync()
	With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("PO Line Inquiry")
		If .Exist(nminwait) Then
			WriteToReport micPass,"PO infirmation page dispalyed"," PO infirmation page dispalyed successfully" ,false
		End If
		If .WebElement("PO Number").Exist(nminwait) Then
			PoNumber=.WebElement("PO Number").GetROProperty("innertext")
			WriteToReport micPass,"PO infirmation "," PO number generated as "&PoNumber ,false
		End If
	End With
	
	'eProcurement>Manage Requisitions
	SelectMainMenu1(GlobalDictionary("MainMenuSelection6"))
	
	app_searchSync()
	
	With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders")
		If .WebEdit("BusinessUnit").Exist(nminwait) Then
			.WebEdit("BusinessUnit").Set businessunit
			WriteToReport micPass,"BusinessUnit "," BusinessUnit is present and entered as "&GlobalDictionary("businessunit"),false
			else:WriteToReport micfail,"BusinessUnit"," BusinessUnit isn't present ",true
		End If
		If .WebEdit("POID").Exist(nminwait) Then
			.WebEdit("POID").Set PoNumber
			WriteToReport micPass,"PoNumber "," PoNumber is present and entered as "&PoNumber,false
			else:WriteToReport micfail,"PoNumber"," PoNumber isn't present ",true
		End If
		If .WebButton("Search").Exist(nminwait) Then
			.WebButton("Search").Click
			WriteToReport micPass,"Search "," Search is present and clicked",false
			else:WriteToReport micfail,"Search"," Search isn't present ",true
		End If
		app_searchSync()
		
		If .WebTable("Searchresults").Exist(nminwait) Then
			WriteToReport micPass,"Search results displayed successfully ","Po information displayed in search results successfully",false
			.WebTable("Searchresults").ChildItem(1,1,"Link",0).click
			else:WriteToReport micfail,"Search results doesn't exist"," Search results not available",true
		End If
		app_searchSync()
	End With
	app_searchSync()
		
	
	With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder")
		If .Exist(nminwait) Then
			WriteToReport micPass,"Po information page "," Po information page dispalyed successfully",false
		End If
		If .WebEdit("PO_REF").Exist(nminwait) Then
			WriteToReport micPass,"Po reference displayed "," PO reference displayed as "&.WebEdit("PO_REF").GetROProperty("value") ,false
		End If
		If .WebElement("PO_Status").Exist(nminwait) Then
			If StrComp(Trim(.WebElement("PO_Status").GetROProperty("innertext")),"Approved",1)=0 Then
				WriteToReport micPass,"PO_Status "," PO_Status is present and displayed as Approved status",false
			else:WriteToReport micPass,"PO_Status"," PO_Status is present and displayed as "&.WebElement("PO_Status").GetROProperty("innertext") ,true
			End If
		else:WriteToReport micfail,"PO_Status"," PO_Status isn't present ",true
		End If
		If .WebList("DispatchMethod").Exist(nminwait) Then
			.WebList("DispatchMethod").Select GlobalDictionary("DispatchMethod")
			WriteToReport micPass,"DispatchMethod "," DispatchMethod is present and entered as "&GlobalDictionary("DispatchMethod"),false
			else:WriteToReport micfail,"DispatchMethod"," DispatchMethod isn't present ",true
		End If
		If .WebButton("Dispatch").Exist(nminwait) Then
			.WebButton("Dispatch").Click
			WriteToReport micPass,"Dispatch "," Dispatch is present and clicked",false
			else:WriteToReport micfail,"Dispatch"," Dispatch isn't present ",true
		End If
	End With
	
	app_searchSync()
	
	count1=0
	While  NOT Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("DispatchOptions").Exist(nminwait) AND count1<10
		app_searchSync():count1=count1+1
	Wend
	With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("DispatchOptions")
		If .WebList("OD Format").Exist(nminwait) Then
			WriteToReport micPass,"Output Destinaion Type "," Output Destinaion Type is present and selected as "&.WebList("OD Format").GetROProperty("selection"),false
		End If
		If .WebList("OD Type").Exist(nminwait) Then
			WriteToReport micPass,"Output Destinaion Type "," Output Destinaion Type is present and selected as "&.WebList("OD Type").GetROProperty("selection"),false
		End If
			app_searchSync()
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
			WriteToReport micPass,"OK "," OK is present and clicked",false
			else:WriteToReport micfail,"OK"," OK isn't present ",true
		End If
	End With

	app_searchSync()
	With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders")
		If .WebButton("Yes").Exist(nminwait) Then
			.WebButton("Yes").Click
			WriteToReport micPass,"Yes "," Yes is present and clicked",false
			else:WriteToReport micfail,"Yes"," Yes isn't present ",true
		End If
	End With
	
	count1=0:app_searchSync()
	While  (Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebButton("Dispatch").GetROProperty("disabled")=0) AND count1<10
		app_searchSync():count1=count1+1
	Wend
	
	app_searchSync()
	With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder")
		If .WebElement("PO_Status").Exist(nminwait) Then
			If StrComp(Trim(.WebElement("PO_Status").GetROProperty("innertext")),"Dispatched",1)=0 Then
				WriteToReport micPass,"PO_Status "," PO_Status is present and changed to Dispatched status",false
			else:WriteToReport micfail,"PO_Status"," PO_Status is present and changed to Dispatched status but "&.WebElement("PO_Status").GetROProperty("innertext") ,true
			End If
		else:WriteToReport micfail,"PO_Status"," PO_Status isn't present ",true
		End If
	End With
	
	
	
	GlobalDictionary("SignInUser")=GlobalDictionary("ReqUser")
	'signin as admin to get userids
	UserSignIn
		
	'eProcurement>Manage Requisitions
	SelectMainMenu1(GlobalDictionary("MainMenuSelection5"))
	

	With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition")
		If .WebEdit("ManReq_BusinessUnit").Exist(NMINWAIT) Then
			.WebEdit("ManReq_BusinessUnit").Set GlobalDictionary("businessunit")
			WriteToReport micPass,"BusinessUnit "," BusinessUnit is present and entered as "&GlobalDictionary("businessunit"),false
			else:WriteToReport micfail,"BusinessUnit"," BusinessUnit isn't present ",true
		End If
		If .WebEdit("ManReq_RequisitionID").Exist(nminwait) Then
			.WebEdit("ManReq_RequisitionID").Set RequesitionID
			WriteToReport micPass,"RequesitionID "," RequesitionID is present and entered as "&RequesitionID,false
			else:WriteToReport micfail,"RequesitionID"," RequesitionID isn't present ",true
		End If
		If .WebEdit("ManReq_Requestor").Exist(nminwait) Then
			.WebEdit("ManReq_Requestor").Set GlobalDictionary("ReqUser")
			WriteToReport micPass,"Requestor "," Requestor is present and entered as "&GlobalDictionary("ReqUser"),false
			else:WriteToReport micfail,"Requestor"," Requestor isn't present ",true
		End If
		If .WebButton("ManReq_Search").Exist(nminwait) Then
			.WebButton("ManReq_Search").Click
			WriteToReport micPass,"Search "," Search is present and clicked",false
			else:WriteToReport micfail,"Search"," Search isn't present ",true
		End If
	End With
	app_searchsync()
'Dim rowNo,cCount
	With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition")
		If .Image("Expand Section").Exist(nminwait) Then
			.Image("Expand Section").Click
			WriteToReport micPass,"Expand Section "," Expand Section is present and clicked",false
		End If

		If .WebTable("ManReq_RequistionList").Exist(nminwait) Then
			rowNo=.WebTable("ManReq_RequistionList").GetRowWithCellText(RequesitionID)
			cCount=.WebTable("ManReq_RequistionList").ColumnCount(rowNo)
			For i = 1 To cCount Step 1
				If isDate(Trim(.WebTable("ManReq_RequistionList").GetCellData(rowNo,i))) Then
					WriteToReport micPass,"Request state "," Request state is "&.WebTable("ManReq_RequistionList").GetCellData(rowNo,i+1),false
					Exit for
				End If
			Next
		End If
		If .WebList("Select Action").Exist(nminwait) Then
			.WebList("Select Action").Select GlobalDictionary("Select Action")
			WriteToReport micPass,"Select Action "," Select Action is present and entered as "&GlobalDictionary("Select Action"),false
			else:WriteToReport micfail,"Select Action"," Select Action isn't present ",true
		End If
		If .WebButton("Go").Exist(nminwait) Then
			.WebButton("Go").Click
			WriteToReport micPass,"Go "," Go is present and clicked",false
			else:WriteToReport micfail,"Go"," Go isn't present ",true
		End If
		app_searchsync()
		
	end with
	wait(3):app_searchsync()
	With Browser("PeopleSoft Browser").Page("ManageRequisition")
		If .WebElement("Message").Exist(nminwait) Then
			If InStr(1,Trim(.WebElement("Message").GetROProperty("innertext")),"restart the approval process",1) Then
				WriteToReport micPass,"Expected Message is displayed in popup "," Message displayed as "&.WebElement("Message").GetROProperty("innertext"),false
				else:WriteToReport micfail,"Expected message is not displayed"," 'This requisition is approved.  Editing this requisition may restart the approval process' message is not displayed ",true
			End If
		else:WriteToReport micfail,"Message pop up"," Message pop up isn't present ",true
		end if
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
			WriteToReport micPass,"OK Button "," OK Button is present and clicked",false
			else:WriteToReport micfail,"OK Button"," OK Button isn't present ",true
		End If
	End With
	
	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
			WriteToReport micPass,"Requesition opened "," Requesition is displayed and id is "&.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext") ,false
		End If
		
		If .Link("RequisitionLineDescription").Exist(nminwait) Then
			str1=.Link("RequisitionLineDescription").GetROProperty("innertext")
			.Link("RequisitionLineDescription").Click
			WriteToReport micPass,"Requisition Line Description "," Requisition Line Description link is present and clicked on "&str1,false
			else:WriteToReport micfail,"Requisition Line Description"," Requisition Line Description isn't present ",true
		End If
		If .WebEdit("SpecialRequest_Value").Exist(nminwait) Then
			.WebEdit("SpecialRequest_Value").Set GlobalDictionary("UpdatedPrice")
			WriteToReport micPass,"Price "," Price field is present and entered as"&GlobalDictionary("UpdatedPrice"),false
			else
			WriteToReport micfail,"Price "," Price field isn't present ",true
		End If
		If .WebButton("Apply").Exist(nminwait) Then
			.WebButton("Apply").Click
			WriteToReport micPass,"Apply Button "," Apply Button is present and clicked",false
			else:WriteToReport micfail,"Apply Button"," Apply Button isn't present ",true
		End If
		count=0
		While NOT(.WebButton("Save & submit").Exist(nminwait)) AND count<10
			app_searchsync():Count=count+1
		Wend

'	If .WebButton("Save for Later").Exist(nminwait) Then
'			.WebButton("Save for Later").Click
'			WriteToReport micPass,"Save for Later "," Save for Later is present and clicked",false
'			else:WriteToReport micfail,"Save for Later "," Save for Later isn't present ",true
'		End If
'		
'		app_searchSync()
'		
'		If .Link("PreviewApprovals").Exist(nminwait) Then
'			.Link("PreviewApprovals").Click
'			WriteToReport micPass,"PreviewApprovals "," PreviewApprovals is present and clicked",false
'			else:WriteToReport micfail,"PreviewApprovals"," PreviewApprovals isn't present ",true
'		End If
'		
	End With
		wait(3):app_searchSync()
'		wait(3):app_searchSync()
		

'		With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("Preview Approvals")
'			If .WebElement("Preview_Status").Exist(nminwait) Then
'				WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("Preview_Status").GetROProperty("innertext") ,false
'			End If
'			If .WebElement("eProApproval_CATapproval").Exist(nminwait) Then
'				WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("eProApproval_CATapproval").GetROProperty("innertext") ,false
'			End If
'			If .WebElement("eProApproval_ACCTapproval").Exist(nminwait) Then
'				WriteToReport micPass,"Satus of requsition "," Status is displayed as "&.WebElement("eProApproval_ACCTapproval").GetROProperty("innertext") ,false
'			End If
'			If .WebButton("Return").Exist(nminwait) Then
'				.WebButton("Return").Click
'				WriteToReport micPass,"Return "," Return is present and clicked",false
'			else:WriteToReport micfail,"Return"," Return isn't present ",true
'			End If
'		End With
				
		app_searchsync()
		
		

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
'			RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
			WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
		End If
		If .WebButton("Save & submit").Exist(nminwait) Then
			.WebButton("Save & submit").Click
			WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
		End If
End With
	
	With Browser("PeopleSoft Browser").Page("Requisition")
		If .WebElement("Message").Exist(nminwait) Then
			WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End With
	wait(3):app_searchSync()
		
	Dim ApproverList1
		ApproverList1=ep_captureApproverNames(Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions"))
		
		If IsArray(ApproverList1) Then
			For k = 0 To Ubound(ApproverList1) Step 1
				GlobalDictionary("user"&k+1)=ApproverList(k)
			Next
			GlobalDictionary("TotalUsers")=UBound(ApproverList1)+2
		End If
	wait(3):app_searchSync()

	With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
			WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
		End If
		If .WebElement("Confirmation_status").Exist(nminwait) Then
			WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
		End If
		If .WebTable("eProApproval").Exist(nminwait) Then
			WriteToReport micPass,"Satus of eProcurement Approval "," Status is "&Replace(Replace(Replace(Replace(Trim(.WebTable("eProApproval").GetROProperty("innertext")),"View/Hide Comments",""),"Start New Path",""),"Comment History",""),"Comments","") ,false
		End If
		If .WebTable("Change Reques Summary").Exist(nminwait) Then
			If .WebTable("Change Reques Summary").RowCount>0 Then
				WriteToReport micPass,"Change request deatils displayed","Change request details - "&.WebTable("Change Reques Summary").GetCellData(1,2)&" - "&.WebTable("Change Reques Summary").GetCellData(1,3)&" - "&.WebTable("Change Reques Summary").GetCellData(1,4),false
			End If
		End If
	End With
	With Browser("PeopleSoft Browser").Page("Requisition")
		If .WebButton("HomeTop").Exist(nminwait) Then
			.WebButton("HomeTop").Click
		End If
		app_searchsync()
		If .WebButton("No").Exist(nminwait) Then
			.WebButton("No").Click
		End If
		app_searchsync()
	End With

	GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
	'signin as admin to get userids
	UserSignIn
	
	'PeopleTools>Security>User Profiles>User Profiles
'	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	
	'retrieve user id
'	retrieveUserID()
	
	If IsArray(ApproverList1) Then
	
		GlobalDictionary("SignInUser")=GlobalDictionary("AdminID")
		
		'signin as admin to get userids
		UserSignIn
		
		'WorkList>WorkList
		SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
		call ep_ApproveinMonitorApprovals(RequesitionID,GlobalDictionary("ApprovalProcess"),"",GlobalDictionary("HeaderStatus"),GlobalDictionary("ReqUser"),"")
'		call ep_ApproveinMonitorApprovals(RequesitionID,GlobalDictionary("ApprovalProcess"),GlobalDictionary("DefinitionID"),GlobalDictionary("HeaderStatus"),GlobalDictionary("ReqUser"),"")
	End If
	
End Function

'*********************************************************************************************************************
'*********************************************************************************************************
'EC_3_01

Public Function DispatchPOAndFullyReceive()
'Navigate to below navigation to create the requisition
'Navigate to NavBar and select  eProcurement > Requisition > Create Requisition
'Navigate to below path to create the requisition
Category=GlobalDictionary("Category")
Qty=GlobalDictionary("Qty")
UOM=GlobalDictionary("UOM")
SupplierID=GlobalDictionary("SupplierID")
price=GlobalDictionary("price")
dtChartfeild=GlobalDictionary("Account") 
dtDept=GlobalDictionary("Dept")

'Navigate to below navigation
'eProcurement > Requisition > Create Requisition
SelectMainMenu1(GlobalDictionary("CreateRequisition"))

'Click on Add new value tab
'ENter businees unit and click on add button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebEdit("ECAN_BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set GlobalDIctionary("Setting_BusinessUnit")
	Reporter.ReportEvent micPass,"The Business unit is","present and set with"&GlobalDIctionary("Setting_BusinessUnit")
End If
End  With 

'CLick on Add button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

For i=0 to 1
'wait for the ojects to get loaded
app_SearchSync()
Next

'wait for pplitio load
 app_searchSync():count=0
 While (Not Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("Requisition Settings").Exist(nminwait)) AND count<10
  app_searchSync():count=count+1
  If count=10 Then
  	Reporter.ReportEvent micFail,"The requisisiont setting","link is not present or not loaded"
  	Exittest
  End If
  Wend


	'ENter the details in the REquisiton setting page
	Call RequisitionSettings()


'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Special request link","is present and clicked"
End If
End  With 


For i=0 to 1
'Create the Requuistion
Call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)

'wait for the ojects to get loaded
app_SearchSync()	
Next


'wait for the ojects to get loaded
app_SearchSync()

'CLick on Check out button and enter all the details
Call EditandSubmitRequitision()

'wait for the ojects to get loaded
app_SearchSync()
'wait for the ojects to get loaded
app_SearchSync()

GlobalDictionary("SignInUser")=GlobalDictionary("Admin")

'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'Navigate to monitor process approvals
'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("MonitorApproval"))

reasignTo=GlobalDictionary("userID1")
reqID=GlobalDictionary("RequisitionID")
ApprovalProcess=GlobalDictionary("ApprovalProcess") 'Requisition
DefinitionID=GlobalDictionary("DefinitionID")   'Share
HeaderStatus=GlobalDictionary("HeaderStatus")
Requestior=GlobalDictionary("RequestorName")

'cHECK THE MONITOR PROCESS APPROVALS
Call ep_ApproveinMonitorApprovals(reqID,ApprovalProcess,DefinitionID,HeaderStatus,Requestior,reasignTo)


'Navigate to manage Requisisiont
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'wait for the ojects to get loaded
app_SearchSync()

businessUnit=GlobalDictionary("Setting_BusinessUnit")
RequisitionID=GlobalDictionary("RequisitionID")

Call ManageRequisitionSearch(businessUnit, RequisitionID)

'wait for the ojects to get loaded
app_SearchSync()

Set oWebElement=Description.Create
oWebElement("MicClass").value="WebElement"
oWebElement("class").value="PSEDITBOX_DISPONLY"
oWebElement("html tag").value="SPAN"
oWebElement("html id").value="PSXLATITEM_XLATLONGNAME.*"

Set oStatus=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").ChildObjects(oWebElement)
appStatus=oStatus(0).getRoProperty("innertext")
Reporter.ReportEvent micPass,"The status of the Requisition","is"&appStatus

'Navigate to Expeeite trwequiaition
'Navigate to below pagfe
'eProcurement > Buyer Center > Expedite Requisitions
'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("ExpediteRequisition"))

'Enter the details and perform the requisition 
Call ExpediteRequisitions()

'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'Navigate back to manage requisisiotn poage and check for the status
Call ManageRequisitionSearch(businessUnit, RequisitionID)

'wait for the ojects to get loaded
app_SearchSync()

Set oWebElement=Description.Create
oWebElement("MicClass").value="WebElement"
oWebElement("class").value="PSEDITBOX_DISPONLY"
oWebElement("html tag").value="SPAN"
oWebElement("html id").value="PSXLATITEM_XLATLONGNAME.*"
app_SearchSync():app_SearchSync()
Set oStatus=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").ChildObjects(oWebElement)
appStatus=oStatus(0).getRoProperty("innertext")
Reporter.ReportEvent micPass,"The status of the Requisition","is"&appStatus

'Expand the Requisisiont and get the PO number
Call ManageRequisitionsLifeCycle()

'Navigate to Purchase orders and verify the details
'Navigate to Purchsae order and dispatch
SelectMainMenu1(GlobalDictionary("ManagePurchaseOrder"))

Call ManagePurchaseOrder()

'Navigate backt to Manage requisiution and verify the status
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'Navigate back to manage requisisiotn poage and check for the status
Call ManageRequisitionSearch(businessUnit, RequisitionID)

'wait for the ojects to get loaded
app_SearchSync()

Set oWebElement=Description.Create
oWebElement("MicClass").value="WebElement"
oWebElement("class").value="PSEDITBOX_DISPONLY"
oWebElement("html tag").value="SPAN"
oWebElement("html id").value="PSXLATITEM_XLATLONGNAME.*"
app_SearchSync():app_SearchSync()
Set oStatus=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").ChildObjects(oWebElement)
appStatus=oStatus(0).getRoProperty("innertext")
Reporter.ReportEvent micPass,"The status of the Requisition","is"&appStatus

GlobalDictionary("SignInUser")=GlobalDictionary("RequestorName")

'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'wait for the ojects to get loaded
app_SearchSync()

'Navigate to Manage Requisisiont and receive the Requisition
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'Navigate back to manage requisisiotn poage and check for the status
Call ManageRequisitionSearch(businessUnit, RequisitionID)

'Select the Receive drowpdown and click on GO button
PerformAction=GlobalDIctionary("PerformAction")
Call ManageRequisitionActionGO(PerformAction)

'wait for the ojects to get loaded
app_SearchSync()

If GlobalDictionary("ReceiveQuantityAmount")="Partial" Then
	Set oCheckBox=Description.Create
	oCheckBox("MicClass").value="WebCheckBox"
	oCheckBox("html id").value="RECV_PO_SCHEDULE.*"
	oCheckBox("name").value="RECV_PO_SCHEDULE.*"
	app_SearchSync():app_SearchSync()
	Set oSelectChkBox=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ReceiveItems").ChildObjects(oCheckBox)
	oSelectChkBox(0).click
	Else
	'clICK ON chECK ALL BUTTON AND click on on receice selected
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ReceiveItems").WebButton("CheckAll")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth
End If
 
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ReceiveItems").WebButton("ReceiveSelected")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

'CHange tha amount and click on save receipt
dtatus=GlobalDictionary("ReceiveQuantityAmount")
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("CasualReceiving").WebEdit("CasRec_Amount")
If .Exist(nMINWAIT) Then
change="100"
If dtatus=" " Then
	Reporter.ReportEvent micPass,"The Original Received amount","before changing is"&.GetROProperty("value")
	Else
	Reporter.ReportEvent micPass,"The Original Received amount","before changing is"&.GetROProperty("value")
	appValue=.GetROProperty("value")
	appUpdatedValue=Cint(appValue)-Cint(change)
	.Set appUpdatedValue
	Reporter.ReportEvent micPass,"The Original Received amount","after changing is"&appUpdatedValue
End If	
End If
End  WIth

With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("CasualReceiving").WebEdit("CasRec_Quantity")
If .Exist(nMINWAIT) Then
change="1"
	If IsEmpty(dtatus) Then
		Reporter.ReportEvent micPass,"The Original Received QUantity","before changing is"&.GetROProperty("value")
		Else
		Reporter.ReportEvent micPass,"The Original Received QUantity","before changing is"&.GetROProperty("value")
		appValue=.GetROProperty("value")
		appUpdatedValue=Cint(appValue)-Cint(change)
		.Set appUpdatedValue
		Reporter.ReportEvent micPass,"The Original Received QUantity","after changing is"&appUpdatedValue
	End If
End If
End  With 

'Click on Save receipt button
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("CasualReceiving").WebButton("CasRec_SaveReceipt")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

For i=0 to 2
'wait for the ojects to get loaded
app_SearchSync()
Next

'Get the receipt number
str=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("SucessFrame").WebElement("ReceiptID").GetROProperty("innertext")
Set RegEx = CreateObject("vbscript.regexp") 
RegEx.Pattern = "[^\d]"
RegEx.IgnoreCase = True 
RegEx.Global = True 
numStr=RegEx.Replace(str, "") 
GlobalDIctionary("ReceiptNumber")=numStr
Reporter.ReportEvent micDone,"The receipt number","is"&GLobalDIctionary("ReceiptNumber")

'Navigate to manage requisistion and validate the status
'Navigate backt to Manage requisiution and verify the status
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'Navigate back to manage requisisiotn poage and check for the status
Call ManageRequisitionSearch(businessUnit, RequisitionID)

'wait for the ojects to get loaded
app_SearchSync()

Set oWebElement=Description.Create
oWebElement("MicClass").value="WebElement"
oWebElement("class").value="PSEDITBOX_DISPONLY"
oWebElement("html tag").value="SPAN"
oWebElement("html id").value="PSXLATITEM_XLATLONGNAME.*"

Set oStatus=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").ChildObjects(oWebElement)
appStatus=oStatus(0).getRoProperty("innertext")
Reporter.ReportEvent micPass,"The status of the Requisition","is"&appStatus

End Function 
	
'*************************************************************************************************************
'*********************************************************************************************************************************
''' <summary>  
''' ep_ApproveinMonitorApprovals()
'''Parameter1:    None.
''' <para>
''' <note>Required Testcase Inputs are "reqID,ApprovalProcess,DefinitionID,HeaderStatus,Requestior,reasignTo"</note> 
''' </para>reqID:RequisitionID, ApprovalProcess:Requisition, DefinitionID:SHARE, HeaderStatus:Pending, Requestior:id of requestor, reasignTo:"" or id of reassined user (put "" if want approve) 
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/5/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

Public Function ep_ApproveinMonitorApprovals(reqID,ApprovalProcess,DefinitionID,HeaderStatus,Requestior,reasignTo)
                Dim flag
If isEmpty(reqID)  Then
                WriteToReport micfail,"Requsition id is invalid","Requsition id is invalid",true
ElseIf reqID="" Then
                WriteToReport micfail,"Requsition id is invalid","Requsition id is invalid",true
else
                With Browser("PeopleSoft Browser").Page("MonitorApprovals").PSFrame("MonitorApprovals")
                                If .WebEdit("Approval process").Exist(nminwait) AND ApprovalProcess<>"" Then
                                                .WebEdit("Approval process").Set ApprovalProcess
                                                WriteToReport micpass,"Approval process","Approval process is present and entered as "&ApprovalProcess ,false
                                else:WriteToReport micfail,"Approval process","Approval process  field isn't  present",true
                                End If
                                If .WebEdit("DefinitionID").Exist(nminwait) Then
                                                .WebEdit("DefinitionID").Set DefinitionID
                                                WriteToReport micpass,"DefinitionID","DefinitionID is present and entered as "&DefinitionID ,false
                                else:WriteToReport micfail,"DefinitionID","DefinitionID  field isn't  present",true
                                End If
                                If .WebList("HeaderStatus").Exist(nminwait) Then
                                                .WebList("HeaderStatus").Select(HeaderStatus)
'                                               WriteToReport micpass,"HeaderStatus","HeaderStatus is present and selected as "&headerstatus,false
                                else:WriteToReport micfail,"HeaderStatus","HeaderStatus  field isn't  present",true
                                End If
                                If .WebEdit("Requestor").Exist(nminwait) Then
                                                .WebEdit("Requestor").Set Requestior
                                                WriteToReport micpass,"Requestior","Requestior is present and entered as "&Requestior ,false
                                else:WriteToReport micfail,"Requestior","Requestior  field isn't  present",true
                                End If
                                If .WebButton("Search").Exist(nminwait) Then
                                                .WebButton("Search").Click
                                                WriteToReport micpass,"Search","Search is present and clicked",false
                                else:WriteToReport micfail,"Search","Search field isn't  present",true
                                End If
                                
                                app_searchSync():Count=0
                                While (Not .WebEdit("RequsitionID").Exist(nminwait)) AND count<10
                                                app_searchSync():count=count+1
                                Wend
                                If .WebEdit("RequsitionID").Exist(nminwait) Then
                                                .WebEdit("RequsitionID").Set ReqID
                                                WriteToReport micpass,"RequsitionID","RequsitionID is present and entered as "&Reqid ,false
                                else:WriteToReport micfail,"RequsitionID","RequsitionID  field isn't  present",true
                                End If
                                If .WebButton("Filter").Exist(nminwait) Then
                                                .WebButton("Filter").Click
                                                WriteToReport micpass,"Filter","Filter is present and clicked",false
                                else:WriteToReport micfail,"Filter","Filter field isn't  present",true
                                End If
                                app_searchSync():Count=0
                                While (Not .WebTable("SearchResults").Exist(nminwait)) AND count<2
                                                app_searchSync():count=count+1
                                Wend
                                If Not .WebTable("SearchResults").Exist(nminwait) Then
                                
                                WriteToReport micpass,"Search results","No Result has found" ,false
                                flag=true
                                               
                                  Else
                                                 
                                                 WriteToReport micpass,"Search results","Clicked on the seach result "&.WebTable("SearchResults").GetCellData(2,6) ,false
                                                .WebTable("SearchResults").ChildItem(2,6,"Link",0).click
                                                flag=false
                                End If
                End With
                                app_searchSync()
                                
               
if Not (flag)Then

		If reasignTo<>"" Then
                With Browser("PeopleSoft Browser").Page("MonitorApprovals").PSFrame("MonitorApprovals")
                                                                If .WebList("Approve_Approver").Exist(nminwait) Then
                                                                                .WebList("Approve_Approver").Select(1)
                                                                                WriteToReport micpass,"Approver list","Approver list is present and selected as "&.WebList("Approve_Approver").GetROProperty("Selection") ,false
                                                                else:WriteToReport micfail,"Approver list","Approver list field isn't  present",true
                                                                End If
                                          End  With 
                
                                With Browser("PeopleSoft Browser").Page("MonitorApprovals").PSFrame("MonitorApprovals")
                                               If .WebEdit("Approve_ReassignTo").Exist(nminwait) Then
                                                                .WebEdit("Approve_ReassignTo").Set  reasignTo
                                                End If
                                                If .WebButton("Approve_ReassignTo").Exist(nminwait) Then
                                                                .WebButton("Approve_ReassignTo").Click
                                                                WriteToReport micpass,"ReassignTo button","ReassignTo button is present and clicked",false
                                                else:WriteToReport micfail,"ReassignTo button","ReassignTo button field isn't  present",true
                                                End If
                                                
                                End With
                else
                                While Browser("PeopleSoft Browser").Page("MonitorApprovals").PSFrame("MonitorApprovals").WebButton("Approve_Approve").GetROProperty("disabled")=0
                                
                                                With Browser("PeopleSoft Browser").Page("MonitorApprovals").PSFrame("MonitorApprovals")
                                                                If .WebList("Approve_Approver").Exist(nminwait) Then
                                                                                .WebList("Approve_Approver").Select(1)
                                                                                WriteToReport micpass,"Approver list","Approver list is present and selected as "&.WebList("Approve_Approver").GetROProperty("Selection") ,false
                                                                else:WriteToReport micfail,"Approver list","Approver list field isn't  present",true
                                                                End If
                                                                If .WebEdit("Approve_Comments").Exist(nminwait) Then
                                                                                .WebEdit("Approve_Comments").Set now
                                                                End If
                                                                If .WebButton("Approve_Approve").Exist(nminwait) Then
                                                                                .WebButton("Approve_Approve").Click
                                                                                WriteToReport micpass,"Approver button","Approver button is present and clicked",false
                                                                else:WriteToReport micfail,"Approver button","Approver button field isn't  present",true
                                                                End If
                                                end with 
                                                app_searchSync()
                                                With Browser("PeopleSoft Browser").Page("MonitorApprovals")
                                                                If .WebElement("Message").Exist(nminwait) Then
                                                                                WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
                                                                End If
                                                                If .WebButton("OK").Exist(nminwait) Then
                                                                                .WebButton("OK").Click
                                                                End If
                                                End With
                                                wait(3)
                                                With Browser("PeopleSoft Browser").Page("MonitorApprovals").PSFrame("MonitorApprovals")
'                                                               If .WebTable("eProApproval").Exist(nminwait) Then
'                                                                               WriteToReport micpass,"Approved successfully","Approved and dispalyed as "&.WebTable("eProApproval").GetROProperty("innertext"),false
'                                                               End If
                                                                If .WebTable("eProApproval").Exist(nminwait) Then
                                                                                WriteToReport micPass,"Satus of eProcurement Approval "," Status is "&Replace(Replace(Replace(Replace(Trim(.WebTable("eProApproval").GetROProperty("innertext")),"View/Hide Comments",""),"Start New Path",""),"Comment History",""),"Comments","") ,false
                                                                End If
                                                End With
                                Wend

                End If
                
                End If
                
End If
End Function


'EP1.05
'***************************************************************************************************************************************
Public Function CategoryApprovalFlow()
'Navigate to below navigation to create the requisition
'Navigate to NavBar and select  eProcurement > Requisition > Create Requisition
'Navigate to below path to create the requisition
arrCategory=GlobalDictionary("Category")
Qty=GlobalDictionary("Qty")
UOM=GlobalDictionary("UOM")
SupplierID=GlobalDictionary("SupplierID")
price=GlobalDictionary("price")
dtChartfeild=GlobalDictionary("Account") 
dtDept=GlobalDictionary("Dept")

Category=split(arrCategory,";")

'Navigate to below navigation
'eProcurement > Requisition > Create Requisition
SelectMainMenu1(GlobalDictionary("CreateRequisition"))

'Click on Requisiion setting link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Requisition Settings")
If .Exist(nMINWAIT) Then
	.Click
	'ENter the details in the REquisiton setting page
	Call RequisitionSettings()
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Special request link","is present and clicked"
End If
End  With 

For i=0 to 1
Call addSpecialRequisition(Category(i),Qty,UOM,SupplierID,price)
Next


'wait for the ojects to get loaded
app_SearchSync()


'CLick on Check out button and enter all the details
Call EditandSubmitRequitision()
End Function

'6.02 Test case
'******************************************************************************************************************
Public Function SourcingWorkBenchToPO()
'Create the Requisisiont
'Navigate to below navigation to create the requisition
'Navigate to NavBar and select  eProcurement > Requisition > Create Requisition
'Navigate to below path to create the requisition
Category=GlobalDictionary("Category")
Qty=GlobalDictionary("Qty")
UOM=GlobalDictionary("UOM")
SupplierID=GlobalDictionary("SupplierID")
price=GlobalDictionary("price")
dtChartfeild=GlobalDictionary("Account") 
dtDept=GlobalDictionary("Dept")

'Navigate to below navigation
'eProcurement > Requisition > Create Requisition
SelectMainMenu1(GlobalDictionary("CreateRequisition"))

'Click on Add new value tab
'ENter businees unit and click on add button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebEdit("ECAN_BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set GlobalDIctionary("Setting_BusinessUnit")
	Reporter.ReportEvent micPass,"The Business unit is","present and set with"&GlobalDIctionary("Setting_BusinessUnit")
End If
End  With 

'CLick on Add button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

For i=0 to 1
'wait for the ojects to get loaded
app_SearchSync()
Next

'wait for pplitio load
 app_searchSync():count=0
 While (Not Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("Requisition Settings").Exist(nminwait)) AND count<10
  app_searchSync():count=count+1
  If count=10 Then
  	Reporter.ReportEvent micFail,"The requisisiont setting","link is not present or not loaded"
  	Exittest
  End If
  Wend

'Click on Requisiion setting link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("Requisition Settings")
If .Exist(nMINWAIT) Then
	.Click
	'ENter the details in the REquisiton setting page
	Call RequisitionSettings()
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Special request link","is present and clicked"
End If
End  With 

'Create the Requuistion
Call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)

'wait for the ojects to get loaded
app_SearchSync()


'CLick on Check out button and enter all the details
Call EditandSubmitRequitision()

'wait for the ojects to get loaded
app_SearchSync()
'wait for the ojects to get loaded
app_SearchSync()

GlobalDictionary("SignInUser")=GlobalDictionary("Admin")

'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'Navigate to monitor process approvals
'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("MonitorApproval"))

reasignTo=GlobalDictionary("userID1")
reqID=GlobalDictionary("RequisitionID")
ApprovalProcess=GlobalDictionary("ApprovalProcess") 'Requisition
DefinitionID=GlobalDictionary("DefinitionID")   'Share
HeaderStatus=GlobalDictionary("HeaderStatus")
Requestior=GlobalDictionary("RequestorName")

'cHECK THE MONITOR PROCESS APPROVALS
Call ep_ApproveinMonitorApprovals(reqID,ApprovalProcess,DefinitionID,HeaderStatus,Requestior,reasignTo)

'wait for the ojects to get loaded
app_SearchSync()
SelectMainMenu1(GlobalDictionary("QuickSourceRequisitions"))
Call QuickSourceRequisition()

'wait for the ojects to get loaded
app_SearchSync()

'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("ExpediteRequisition"))
Call ExpediteRequisitions()

'Navigate to manage Requisisiont
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'wait for the ojects to get loaded
app_SearchSync()
Call ManageRequisitionsLifeCycle()

'wait for the ojects to get loaded
app_SearchSync()

'Navigate to manage Requisisiont
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("SourcingWorkbench"))

'wait for the ojects to get loaded
app_SearchSync()

Call SourceRequisition()

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("SourceWorkBench").PSFrame("SourceWorkbench").Link("Source_POId")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The PO ID","lnk is present and clicked"
	Else
	Reporter.ReportEvent micFail,"The PO ID","lik is not present"
End If
End  With 

With Browser("PeopleSoft Browser NewTab").Page("MaintainPurchaseOrder").PSFrame("MaintainPurchaseOrder").WebElement("MaintainPO_POStatus")
If .Exist(nMINWAIT) Then
	Reporter.ReportEvent micPass, "The PO Status of the Requisition","is"&.GetROProperty("innertext")
End If
End  With 

End Function

'6.01
'*****************************************************************************************************
Public Function QuickSourceRequisitionPO()
'Create the Requisisiont
'Navigate to below navigation to create the requisition
'Navigate to NavBar and select  eProcurement > Requisition > Create Requisition
'Navigate to below path to create the requisition
Category=GlobalDictionary("Category")
Qty=GlobalDictionary("Qty")
UOM=GlobalDictionary("UOM")
SupplierID=GlobalDictionary("SupplierID")
price=GlobalDictionary("price")
dtChartfeild=GlobalDictionary("Account") 
dtDept=GlobalDictionary("Dept")

'Navigate to below navigation
'eProcurement > Requisition > Create Requisition
SelectMainMenu1(GlobalDictionary("CreateRequisition"))

'Click on Add new value tab
'ENter businees unit and click on add button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebEdit("ECAN_BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set GlobalDIctionary("Setting_BusinessUnit")
	Reporter.ReportEvent micPass,"The Business unit is","present and set with"&GlobalDIctionary("Setting_BusinessUnit")
End If
End  With 

'CLick on Add button
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

For i=0 to 1
'wait for the ojects to get loaded
app_SearchSync()
Next

'wait for pplitio load
 app_searchSync():count=0
 While (Not Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("Requisition Settings").Exist(nminwait)) AND count<10
  app_searchSync():count=count+1
  If count=10 Then
  	Reporter.ReportEvent micFail,"The requisisiont setting","link is not present or not loaded"
  	Exittest
  End If
  Wend

'Click on Requisiion setting link
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ECAN_TargetContent").Link("Requisition Settings")
If .Exist(nMINWAIT) Then
	.Click
	'ENter the details in the REquisiton setting page
	Call RequisitionSettings()
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("Special Requests")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Special request link","is present and clicked"
End If
End  With 

'Create the Requuistion
Call addSpecialRequisition(Category,Qty,UOM,SupplierID,price)

'wait for the ojects to get loaded
app_SearchSync()


'CLick on Check out button and enter all the details
Call EditandSubmitRequitision()

'wait for the ojects to get loaded
app_SearchSync()
'wait for the ojects to get loaded
app_SearchSync()

GlobalDictionary("SignInUser")=GlobalDictionary("Admin")

'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'Navigate to monitor process approvals
'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("MonitorApproval"))

reasignTo=GlobalDictionary("userID1")
reqID=GlobalDictionary("RequisitionID")
ApprovalProcess=GlobalDictionary("ApprovalProcess") 'Requisition
DefinitionID=GlobalDictionary("DefinitionID")   'Share
HeaderStatus=GlobalDictionary("HeaderStatus")
Requestior=GlobalDictionary("RequestorName")

'cHECK THE MONITOR PROCESS APPROVALS
Call ep_ApproveinMonitorApprovals(reqID,ApprovalProcess,DefinitionID,HeaderStatus,Requestior,reasignTo)

'Navigate to manage Requisisiont
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("ManageRequisition"))
businessUnit=GlobalDictionary("Setting_BusinessUnit")
RequisitionID=GlobalDictionary("RequisitionID")

'Navigate back to manage requisisiotn poage and check for the status
Call ManageRequisitionSearch(businessUnit, RequisitionID)

'Validate the status of the Requisisiont
'wait for the ojects to get loaded
app_SearchSync()
app_SearchSync()

Set oWebElement=Description.Create
oWebElement("MicClass").value="WebElement"
oWebElement("class").value="PSEDITBOX_DISPONLY"
oWebElement("html tag").value="SPAN"
oWebElement("html id").value="PSXLATITEM_XLATLONGNAME.*"

Set oStatus=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").ChildObjects(oWebElement)
appStatus=oStatus(0).getRoProperty("innertext")
Reporter.ReportEvent micPass,"The status of the Requisition","is"&appStatus

'wait for the ojects to get loaded
app_SearchSync()
SelectMainMenu1(GlobalDictionary("QuickSourceRequisitions"))
Call QuickSourceRequisition()

'wait for the ojects to get loaded
app_SearchSync()

'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("ExpediteRequisition"))
Call ExpediteRequisitions()

'wait for the ojects to get loaded
app_SearchSync()

'Navigate to manage Requisisiont
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'Validate the status of the Requisisiont
'wait for the ojects to get loaded
app_SearchSync()
app_SearchSync()

'Navigate back to manage requisisiotn poage and check for the status
Call ManageRequisitionSearch(businessUnit, RequisitionID)

Set oWebElement=Description.Create
oWebElement("MicClass").value="WebElement"
oWebElement("class").value="PSEDITBOX_DISPONLY"
oWebElement("html tag").value="SPAN"
oWebElement("html id").value="PSXLATITEM_XLATLONGNAME.*"

Set oStatus=Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").ChildObjects(oWebElement)
appStatus=oStatus(0).getRoProperty("innertext")
Reporter.ReportEvent micPass,"The status of the Requisition","is"&appStatus

End Function


Function RunVariousEproQueries

Call CreatePODispatchedRequisition()
businessUnit=GlobalDictionary("Setting_BusinessUnit")
RequisitionID=GlobalDictionary("RequisitionID")
price=GlobalDictionary("PriceNew")

'Navigate to manage Requisisiont
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'Navigate back to manage requisisiotn poage and check for the status
Call ManageRequisitionSearch(businessUnit, RequisitionID)

app_SearchSync()
	'Expand Line Details
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebTable("ManReq_RequistionList") 

	If .Image("Expand Image").Exist(wMinWait) Then
		.Image("Expand Image").Click
		Reporter.ReportEvent micPass,"Expand icon","Expand icon is displayed and clicked" 
	Else
	Reporter.ReportEvent micFail,"Expand icon","Expand icon is not displayed " 
	End If
	
	app_SearchSync()
	
	If Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebTable("ManReq_RequistionList").Link("Purchase order Icon").Exist(wMinWait) Then
		Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebTable("ManReq_RequistionList").Link("Purchase order Icon").Click
		Reporter.ReportEvent micPass,"Purchase order Icon"," is displayed and clicked" 
	Else
		Reporter.ReportEvent micFail,"Purchase order Icon"," is not displayed " 
	End If
	app_SearchSync()

End  With
	
'Verify the Requisition Po Number
Dim PONumber
With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("PO Line Inquiry").WebElement("PO Number")
	If .Exist(WMinWait) Then
		PONumber=.GetROProperty("innertext")
		GlobalDictionary("PONumber")=PONumber
		Reporter.ReportEvent micPass,"PO NUmber "," is displayed with " &PONumber
	Else
		Reporter.ReportEvent micFail,"PO NUmber"," is not displayed " 
	End If
End  With

With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("PO Line Inquiry").Link("ReturnTo")
	If .Exist(WMinWait) Then
		.Click
		Reporter.ReportEvent micPass,"Return to Manage requisition Link"," is displayed and clicked"
	Else
	Reporter.ReportEvent micFail,"Return to Manage requisition Link"," is not displayed " 
	End If
End  With

Call ManageRequisitionSearch(businessUnit, RequisitionID)

Call ManageRequisitionActionGO("Edit")

app_SearchSync()


With Browser("PeopleSoft Browser").Page("ManageRequisition").WebButton("OK")
	If .Exist(nMINWAIT) Then
		
			Browser("PeopleSoft Browser").Page("ManageRequisition").WebButton("OK").Click
			Call WriteToReport(micPass,"Alert message  ","is present and Click ok button",false)
		
	End If
	'Wait for the application to sync
 app_SearchSync()
 End  With

'click yes for alert
With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("TargetFrame")
	If .Exist(nMINWAIT) Then
		If .WebButton("Yes").Exist(nMINWAIT) Then
			.WebButton("Yes").Click
		End If
	End If
	'Wait for the application to sync
 app_SearchSync()
  End  With
 
  With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions").Link("RequisitionLineDescription")
 	if .Exist(nMINWAIT) Then
 		.Click
 		Call WriteToReport(micPass,"Requisition Description ","is present and Clicked",false)
 	End If
 End  With
 
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		
		If .WebEdit("SpecialRequest_Value").Exist(nminwait) Then
			.WebEdit("SpecialRequest_Value").Set price
			WriteToReport micPass,"Price "," Price field is present and entered as"&price,false
			else
			WriteToReport micfail,"Price "," Price field isn't present ",true
		End If
		
		If .WebButton("Apply").Exist(nminwait) Then
			.WebButton("Apply").Click
			WriteToReport micPass,"Apply Button "," Apply Button is present and clicked",false
			else
			WriteToReport micfail,"Apply Button"," Apply Button isn't present ",true
		End If
		
End  With

With Browser("PeopleSoft Browser").Page("Requisition").WebButton("No")

if Browser("PeopleSoft Browser").Page("Requisition").WebButton("No").Exist(nMINWAIT) Then
 		Browser("PeopleSoft Browser").Page("Requisition").WebButton("No").Click
 		Call WriteToReport(micPass,"Alert popup ","is present and click NO",false)
 	End If
End With 

app_SearchSync()
 

 
 With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
 
 	if .WebEdit("ReviewSubmit_RequisitionComments").Exist(nMINWAIT) Then
 		.WebEdit("ReviewSubmit_RequisitionComments").Set "comment"
 		Call WriteToReport(micPass,"ReviewSubmit_RequisitionComments","is present and set with"&RequisitionID,false)
 	End If
 
  	if .WebCheckBox("ReviewSubmit_SendtoSupplier").Exist(nMINWAIT) Then
 		.WebCheckBox("ReviewSubmit_SendtoSupplier").Set "ON"
 		Call WriteToReport(micPass,"ReviewSubmit_SendtoSupplier","is present and Checked",false)
 	End If
 
 	 if .WebCheckBox("ReviewSubmit_ShowAtReceipt").Exist(nMINWAIT) Then
 		.WebCheckBox("ReviewSubmit_SendtoSupplier").Set "ON"
 		Call WriteToReport(micPass,"ReviewSubmit_ShowAtReceipt","is present and Checked",false)
 	End If
 
  	if .WebCheckBox("ReviewSubmit_ShowatVoucher").Exist(nMINWAIT) Then
 		.WebCheckBox("ReviewSubmit_ShowatVoucher").Set "ON"
 		Call WriteToReport(micPass,"ReviewSubmit_ShowatVoucher","is present and Checked",false)
	End If
 
End With
		
app_searchsync()

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
		If .WebElement("Specialrequest_RequesitionID").Exist(nminwait) Then
			RequesitionID=.WebElement("Specialrequest_RequesitionID").GetROProperty("innertext")
			GlobalDictionary("RequesitionID")=RequesitionID
			WriteToReport micPass,"RequesitionID "," RequesitionID is generated as "&RequesitionID ,false
		End If
		If .WebButton("Save & submit").Exist(nminwait) Then
			.WebButton("Save & submit").Click
			WriteToReport micPass,"Save & submit "," Save & submit is present and clicked",false
		End If
End With
	
With Browser("PeopleSoft Browser").Page("Requisition")
	If .WebElement("Message").Exist(nminwait) Then
		WriteToReport micPass,"Mail confirmation pop up displayed"," Mail confirmation popup displayed and as "&.WebElement("Message").GetROProperty("innertext"),false
	End If
	If .WebButton("OK").Exist(nminwait) Then
		.WebButton("OK").Click
	End If
End With

With Browser("PeopleSoft Browser").Page("Requisition").PSFrame("ePro Requisitions")
	If .WebElement("Confirmation_ConfirmationMessage").Exist(nminwait) Then
		WriteToReport micPass,"confirmation Message displayed"," confirmation Message displayed and as "&.WebElement("Confirmation_ConfirmationMessage").GetROProperty("innertext"),false
	End If
	If .WebElement("Confirmation_status").Exist(nminwait) Then
		WriteToReport micPass,"Satus of requsition "," Status is changed to "&.WebElement("Confirmation_status").GetROProperty("innertext") ,false
	End If
	
	If .WebElement("No Approval Status").Exist(nminwait) Then
		If Not(.WebElement("No Approval Status").GetROProperty("innertext")="Approved")Then
			WriteToReport micFail,"Eprocurement approval status "," Status is changed to "&.WebElement("No Approval Status").GetROProperty("innertext") ,true
		Else
			WriteToReport micPass,"Eprocurement approval status is displayed"," Eprocurement approval status is displayed as "&.WebElement("No Approval Status").GetROProperty("innertext"),false
		End If
	End If
		
End  With


''Sign in with Admin user
GlobalDictionary("SignInUser")=GlobalDictionary("Admin")

With Browser("PeopleSoft Browser").Page("Requisition")
	If .PSFrame("ePro Requisitions").Link("Create New requisition").Exist(nminwait) Then
		.PSFrame("ePro Requisitions").Link("Create New requisition").Click
		WriteToReport micPass,"create new requisition link "," create new requisition link is displayed and clicked for save the requisition ",false
	End If
	
	If .WebButton("Yes").Exist(nminwait) Then
		
		.WebButton("Yes").Click
		WriteToReport micPass,"create new requisition link "," create new requisition link is displayed and clicked for save the requisition ",false
		
	End If
	
End With


'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'Check whether user is not having access to Process monitopr approvals
SelectMainMenu1(GlobalDictionary("MonitorApproval"))

ApproverNames=GlobalDIctionary("ApproverNames")
reasignTo=GlobalDictionary("ReassignTo")
reqID=GlobalDictionary("RequisitionID")
ApprovalProcess=GlobalDictionary("ApprovalProcess") 'Requisition
DefinitionID=GlobalDictionary("DefinitionID")   'Share
HeaderStatus=GlobalDictionary("HeaderStatus")
Requestior=GlobalDictionary("RequestorName")

'cHECK THE MONITOR PROCESS APPROVALS
Call ep_ApproveinMonitorApprovals(reqID,ApprovalProcess,DefinitionID,HeaderStatus,Requestior,reasignTo)

'Navigate to Procurement processes
SelectMainMenu1(GlobalDictionary("ProcurementProcess"))

app_searchsync()
'Click on change purchase order

With Browser("PeopleSoft Browser").Page("Procurement Process").Link("Change Purchase order") 
	If .Exist(nminwait) Then
		.Click
		WriteToReport micPass,"Procurement process Link"," is displayed and clicked" ,true
	Else
		WriteToReport micFail,"Procurement process Link","is not displayed",false
	End If
End  With

app_searchsync()	

With Browser("PeopleSoft Browser").Page("Change Purchase Order").WebElement("Add New Value")
	If .Exist(nminwait) Then
		.Click
		WriteToReport micPass,"Add new Value "," is displayed and clicked" ,true
	Else
		WriteToReport micFail,"Add new Value ","is not displayed",false
	End If
End  With

With Browser("PeopleSoft Browser").Page("Change Purchase Order").WebEdit("Run Control Id")
	If .Exist(nminwait) Then
		runcontrols=RandomNumberGeneraion & Day(Date)
		.set  runcontrols
		WriteToReport micPass,"Run Control Id"," is displayed and set "&runcontrols ,true
	Else
	WriteToReport micFail,"Run Control Id ","is not displayed",false
	End If
End  With

With Browser("PeopleSoft Browser").Page("Change Purchase Order").WebButton("Add")
	If .Exist(nminwait) Then
		.Click
		WriteToReport micPass,"Add Button "," is displayed and clicked" ,true
	Else
		WriteToReport micFail,"Add Button ","is not displayed",false
	End If
End  With

app_searchsync()

PSource=GlobalDictionary("psource")
With Browser("PeopleSoft Browser").Page("Change Purchase Order").PSFrame("Target content")
	
	If .WebList("Source").Exist(nminwait) Then
		.WebList("Source").Select(PSource)
		WriteToReport micPass,"Source field "," is displayed and set as"&PSource,false
	Else
		WriteToReport micFail,"Source field ","is not displayed",true
		
	End If
	
	If .WebEdit("Business Unit").Exist(nminwait) Then
		.WebEdit("Business Unit").Set GlobalDictionary("Setting_BusinessUnit")
		WriteToReport micPass,"Business Unit "," is displayed and set as"&GlobalDictionary("Setting_BusinessUnit"),false
	Else
		WriteToReport micFail,"Business Unit ","is not displayed",true
		
	End If
	
	If .WebEdit("Business Unit To").Exist(nminwait) Then
		.WebEdit("Business Unit To").Set GlobalDictionary("Setting_BusinessUnit")
		WriteToReport micPass,"Business Unit To "," is displayed and set as"&GlobalDictionary("Setting_BusinessUnit"),false
	Else
		WriteToReport micFail,"Business Unit To","is not displayed",true
		
	End If
	
	If .WebEdit("PO ID").Exist(nminwait) Then
		.WebEdit("PO ID").Set GlobalDictionary("PONumber")
		WriteToReport micPass,"PO ID "," is displayed and set as"&GlobalDictionary("PONumber"),false
	Else
		WriteToReport micFail,"PO ID","is not displayed",true
		
	End If
	
	
	If .WebEdit("PO ID TO").Exist(nminwait) Then
		.WebEdit("PO ID TO").Set GlobalDictionary("PONumber")
		WriteToReport micPass,"PO ID TO "," is displayed and set as"&GlobalDictionary("PONumber"),false
	Else
		WriteToReport micFail,"PO ID TO","is not displayed",true
	End If
	
End  With

With Browser("PeopleSoft Browser").Page("Change Purchase Order").PSFrame("Batch PO change Order Process")
	If .WebButton("Run").Exist(nminwait) Then
		.WebButton("Run").Click
		WriteToReport micPass,"Run Button "," is displayed and Clicked",false
	Else
		WriteToReport micFail,"Run Button ","is not displayed",true
		
	End If
End  With
	
app_searchsync()
	
	row=Browser("PeopleSoft Browser").Page("Change Purchase Order").PSFrame("Process scheduler request").WebTable("Select Table").RowCount()

With Browser("PeopleSoft Browser").Page("Change Purchase Order").PSFrame("Process scheduler request").WebTable("Select Table")

	For i=1 to row
	'wait for the ojects to get loaded
	 Desc=.GetCellData(i,3)
	 If Desc="PO_POCHNG" Then
		set check =.ChildItem(i,1,"WebCheckbox",0)
		check.Set "ON"
	 End If
	Next
app_SearchSync()

End  With

With Browser("PeopleSoft Browser").Page("Change Purchase Order").PSFrame("Process scheduler request").WebButton("ok")
If .Exist(nminwait) Then
	.Click
	WriteToReport micPass,"Ok Button"," is displayed and clicked" ,true
Else
	WriteToReport micFail,"Ok Button","is not displayed",false
End If

End  With



	appInstanceNumberWithoutTrim = Browser("creationtime:=0").Page("index:=1").WebElement("innertext:=Process Instance:.*", "index:=1").GetROProperty("innertext")
	'processInstance=Trim(.WebElement("Process Instance").GetROProperty("innertext"))
	If Not(appInstanceNumberWithoutTrim=Empty) Then
	
	PI=Split(Split(appInstanceNumberWithoutTrim,":")(1),",")
	GlobalDictionary("instanceNumber")=PI(0)
	WriteToReport micPass,"Process Instance"," is displayed as "&PI(0) ,true
	Else
	WriteToReport micFail,"Process Instance"," is not displayed  ",false
	End If

With Browser("PeopleSoft Browser").Page("Process change order").PSFrame("statusbar")

If .Link("Process monitor").Exist(nminwait) Then
	.Link("Process monitor").Click
	WriteToReport micPass,"Process Monitor Link"," is displayed and clicked" ,true
Else
	WriteToReport micFail,"Process Monitor Link","is not displayed",false
End If

'GlobalDictionary("instanceNumber")=Browser("creationtime:=0").Page("index:=1").WebTable("class:=PSLEVEL1GRID","html tag:=TABLE","name:=Select").GetCellData(2,2)

	Call CheckProcessMontiorStatus_PCARD()
	
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Save").Exist(wMinWait) Then
	
		Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Save").Click
	End If

	app_SearchSync()
	
	

End With


'Navigate to manage Requisisiont
'eProcurement > Manage Requisitions
SelectMainMenu1(GlobalDictionary("ManageRequisition"))

'Navigate back to manage requisisiotn poage and check for the status
Call ManageRequisitionSearch(businessUnit, RequisitionID)

With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebTable("ManReq_RequistionList") 

	If .Image("Expand Image").Exist(wMinWait) Then
		.Image("Expand Image").Click
		Reporter.ReportEvent micPass,"Expand icon","Expand icon is displayed and clicked" 
	Else
	Reporter.ReportEvent micFail,"Expand icon","Expand icon is not displayed " 
	End If
	
	app_SearchSync()
	
	
	

End  With

With Browser("PeopleSoft Browser").Page("ManageRequisition").PSFrame("ManageRequisition").WebTable("ManReq_LineInformation")

	If .WebElement("Status").Exist(wMinWait) Then
		status=.WebElement("Status").GetROProperty("innertext")
		Reporter.ReportEvent micPass,"Requisition Status is displayed","as "&status 
	Else
	Reporter.ReportEvent micFail,"Requisition Status"," not displayed " 
	End If
	
	If .WebElement("price").Exist(wMinWait) Then
		cuPrice=.WebElement("price").GetROProperty("innertext")
		Reporter.ReportEvent micPass,"Requisition Price is displayed","as "&cuPrice 
	Else
	Reporter.ReportEvent micFail,"Requisition Price"," is not displayed " 
	End If	

End  With
	

End Function


Function CreatePODispatchedRequisition
	
	call AmountOnlyRequisitionAndReceipts()
	
End Function








