'==========================================================
'PSF_AP_Updated contains
'Contains commonly used functions for AP related test cases.
'Changelog: 
'Date	11/22/2018		Author	Aspire Team				Description

'______________________________________________________ 

'Option Explicit
'Call AddNewSupplier()



'**********************************************************************************************************************************************************
''' <summary>  
''' AddNewSupplier() To add the new supplier
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "VendorID"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'************************************************************************************************************************************************************
'1.1.1
'1.1.15
Public Function AddNewSupplier()
Dim i,dtVendorID,dtDescription

dtVendorId=(GlobalDIctionary("VendorID")) & inVoiceNumberGeneration' RandomNumberGeneraion & Day(Date)

'Navigate to Suppliers --> Supplier Information --> Add/Update--> Supplier and add new supplier and provide the names
Call AddNewSupplierNavigate()

'wait for the ojects to get loaded
app_SearchSync()

'Click on Address Tab and enter all the mandatory details in the Address Tab

AddFirstAddress()

 'wait for the ojects to get loaded
 app_SearchSync()
 
'click on + icon for adding additiona address
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("+")
If .Exist(nMINWAIT) Then
	.Click

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Next_Address")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth 

'wait for the ojects to get loaded
 app_SearchSync()
 dtEffectiveDate=(GlobalDictionary("EffectiveDate2"))
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("Addr_EffectiveDate")
If .Exist(NMINWAIT) Then
      .Set dtEffectiveDate
      Call WriteToReport(micPass,"EffectiveDate="&dtEffectiveDate,"is displayed",false)
End If
End WIth 

Else
Call WriteToReport(micFail,"+ icon to add new address","is not present",True)
End If

End With

'Add the Banking infgormation of the Supplier.

'CLick on Location tab
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("LocationTab")
If .Exist(nMINWAIT) Then
	.Click
	
	'WAit for the application to load
	 app_SearchSync()
	 
	 'ENter the Location ID
	 dtLocationID=(GLobalDictionary("LocationID"))
	 With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("Location")
	 If .Exist(nMINWAIT) Then
	 	.Set dtLocationID
	 	Call WriteToReport(micPass,"LocationID="&dtLocationID,"is displayed",false) 
	 End If
	 End WIth
        
        'Click on Payables to enter the Bank information of the supplier
        With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").Link("Payables_Location")
        If .Exist(nMINWAIT) Then
             .Click
             
            'WAit for the application to load
	      app_SearchSync()
	     

	      'CLick on Supply Bank information section to update the details
	      With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebElement("SupplyBankInformation")
	      If .Exist(nMINWAIT) Then
	        .Click
	        
	         'WAit for the application to load
	           app_SearchSync()
	          
	          'Enter the bank details in this section
	          dtbankDescription=(GlobalDictionary("Description"))
	          dtBankName=(GlobalDictionary("BankName"))
	          dtBankQualifier=(GlobalDictionary("BankQualifier"))
	          dtBankID=(GlobalDictionary("BankID"))
	          dtAcctNumber=(GlobalDictionary("AcctNumber"))
	          dtDFIQualifier=(GlobalDictionary("DFIQualifier"))
	          dtAcctType=(GlobalDictionary("AcctType"))
	          
	          WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("Description")
	          If .Exist(nMINWAIT) Then
	          	.Set bankDescription
	          	Call WriteToReport(micPass,"BankDescription="&bankDescription,"is displayed",false)
	          End If
	          End WIth 
	          
	          'Entert the Bank name
	          WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("BankName")
	          If .Exist(nMINWAIT) Then
	          	.Set dtBankName
	          	Call WriteToReport(micPass,"BankName="&dtBankName,"is displayed",false)
	          End If
		   End WIth
		   
		   'Enter the Branch Name
		   With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("BranchName")
		   If .Exist(nMINWAIT) Then
		   	.Set dtBankName
		   	Call WriteToReport(micPass,"Branch Name="&dtBankName,"is displayed",false)
		   End If
		   End WIth 
		   
		   'Enter the Bank ID qualifier
		   WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("BankIdQualifier")
		   If .Exist(nMINWAIT) Then
		   	.Set dtBankQualifier
		   	With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").Image("BankIdQualifierLookUp")
		   	If .Exist(nMINWAIT) Then
		   		.Click
		   		
		   		 'WAit for the application to load
	                      app_SearchSync()
		   		With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("BankID_LookUp").WebTable("BankIDQualifier")
		   		If .Exist(nMINWAIT) Then
		   			For i=1 to .RowCount
		   				appBankIDqualifier=.GetCellData(i,1)
		   				If instr(1,dtBankQualifier,appBankIDqualifier)>0 Then
		   					Set oBankIDQualier=.ChildItem(i,1,"Link",0)
		   					If oBankIDQualier.exist(nMINWAIT) Then
		   					       oBankIDQualier.click
		   					 End If
		   				End If
		   			Next
		   			Else
		   			Call WriteToReport(micFail,"Bank ID qualifier is","is not present",True)
		   		End If
		   		End With 

		   	End If
		   	End WIth

		   End If
                 End With
                 
                ' WAit for the application to load
	           app_SearchSync()
                 
                'ENtert the Bank ID details
                With  Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("BankId")
                If .Exist(nMINWAIT) Then
                	.Set dtBankID
                	Call WriteToReport(micPass,"BankID="&dtBankID,"is displayed",false)
                End If
                End WIth
                
                'ENter Account NUmber
                WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("AcctNumber")
                If .Exist(nMINWAIT) Then
                	.Set dtAcctNumber
                	Call WriteToReport(micPass,"Account Number="&dtAcctNumber,"is displayed",false)
                End If
                End With
                
                'ENter DFI qualifier
                With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("DFIQualifier")
		   If .Exist(nMINWAIT) Then
		   	.Set dtDFIQualifier
		   	Call WriteToReport(micPass,"DFI Qualifier="&dtDFIQualifier,"is displayed",false)
		   End If
                End With
                
                ' WAit for the application to load
	           app_SearchSync()
                
                'Select the Account type
                With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebList("AccountType")
	          If .Exist(nMINWAIT) Then
	          	.Select dtAcctType
	          End If
                End With
                
                'Enter DFI ID
                With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("DFIId")
                If .Exist(nMINWAIT) Then
                	.Set dtBankID
                	Call WriteToReport(micPass,"Bank ID="&dtBankID,"is displayed",false)
                End If
                End WIth

		'Click on Ok button 
                WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebButton("Ok")
                If .Exist(nMINWAIT) Then
                	.Click
                End If
                End WIth
                
                ' WAit for the application to load
	           app_SearchSync()
	          

	   Else
	   Call WriteToReport(micFail,"Not able to find the Supply bank infroamtion section","Not able to enter the bank details of the vendor",True)
	   End If
	   End With

             
       Else
       Call WriteToReport(micFail,"Paybles link","is not present and Bank details are not entered",True)
       End If
       End WIth 

	
Else
Call WriteToReport(micFail,"Not able to click on LOcation Tab", "and not able to enter the Bank information",True)
End If
End With 


'Click on Procuremetn LInk
dtAcctTemplate=(GlobalDictionary("AcctTemplate"))
dtCurrency=(GlobalDictionary("Currency"))
dtRateType=(GlobalDictionary("RateType"))

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").Link("Procurement")
If .Exist(nMINWAIT) Then
	.Click

 'WAit for the application to load
 app_SearchSync()
 
 With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Procurement").WebElement("AdditionalProcOptions")
 If .Exist(nMINWAIT) Then
 	.Click
 	
 	 'WAit for the application to load
 	app_SearchSync()
 	
 	

 	'Enter the vcalue in Accounting template
 	WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Procurement").WebEdit("AccountingTemplate")
 	If .Exist(nMINWAIT) Then
 		.Set dtAcctTemplate
 		Call WriteToReport(micPass,"Accounting Template="&dtAcctTemplate,"is displayed",false)

 		 'WAit for the application to load
 		WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Procurement").Image("AccountingTemp_Image")
 		If .Exist(nMINWAIT) Then
 			.Click
 			
 			 'WAit for the application to load
 	                app_SearchSync()
 	                
 	                WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Procurement_AccountingTemplate").WebTable("AccountingTemplate")
 	                If .Exist(nMINWAIT) Then
 	                	For i=2 to .RowCount
 	                		appAccountTemplate=.GetCellData(i,1)
 	                		If instr(1,appAccountTemplate,dtAcctTemplate)>0 Then
 	                			Set oAcctTemplate=.ChildItem(i,1,"Link",0)
 	                			If oAcctTemplate.exist(nMINWAIT) Then
 	                			        oAcctTemplate.click
 	                			        Exit For
 	                			End If
 	                		End If
 	                	Next
 	                End If
 	               End WIth  

 		End If
 	End WIth	

 		

 		
 	End If
 	End WIth 
 	
 	'Enter the value in Currency
 	WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Procurement").WebEdit("Currency")
 	If .Exist(nMINWAIT) Then
 		.Set dtCurrency
 		WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Procurement").Image("Currency_LookUp")
 		If .Exist(nMINWAIT) Then
 			.Click
 			
 			'WAit for the application to load
 	                app_SearchSync()
 	                
 	               With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Procurement_Currency").WebTable("CurrencySearch")
 	               If .Exist Then
 	               	For i=2 to .RowCount
 	               		appCurrency=.GetCellData(i,1)
 	               		If instr(1,appCurrency,dtCurrency)>0 Then
 	               			Set oCurrencyLink=.ChildItem(i,1,"Link",0)
 	               			If oCurrencyLink.exist(nMINWAIT) Then
 	               				oCurrencyLink.click
 	               				Exit For
 	               			End If
 	               		End If
 	               	Next
 	               End If
 	               End WIth

 	       End If
 		End WIth

 	End If
 	End WIth
 	
 	'ENter the rate type

 	With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Procurement").WebEdit("RateType")
 	If .Exist(nMINWAIT) Then
 		.Set dtRateType
 		With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Procurement").Image("RateType_LookUp")
 		If .Exist(nMINWAIT) Then
 			.Click
 			
 			'WAit for the application to load
 	                app_SearchSync()
 	

	
 		End If
 		End With
 				
 	End If
 	End With


	'Click on Ok button
	With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Procurement").WebButton("Ok")
	If .Exist(nMINWAIT) Then
		.Click
	End If 	
	End WIth
   Else
   Call WriteToReport(micFail,"Not able to click on Additional Proc options ", "and not able to enter the Vendor Terms",True) 
   End If
   End WIth 
 
 Else
 Call WriteToReport(micFail,"Not able to click on Procurement LInk ", "and not able to enter the Vendor Terms",True) 
 End If
End WIth

'ENter the details in 1099/Withholding details
dtWithholdingEntry=(GlobalDictionary("WithholdingEntry"))
dtWithholdingType=(GlobalDictionary("WithholdingType"))
dtDefaultWithholdingClass=(GlobalDictionary("DefaultWithholdingClass"))
dtWithholdingJurisdiction=(GlobalDictionary("WithholdingJurisdiction"))
dtWIthholdingStatus=(GlobalDictionary("WIthholdingStatus"))

WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").Link("Global1099 Withholding")
If .Exist(nMINWAIT) Then
	.Click
	
	With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("WithHoldingErrorMessage").Link("ErrorMessage")
	If .Exist(nMINWAIT) Then
		.Click
	WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").Link("Global1099 Withholding")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End WIth
	End If
	End With 
	


	'enter all the mandatory fields int he page and click on OK button
	
	'Enter WIthholding entry
	WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_WithholdingInformation").WebEdit("WithholdingEntry")
	If .Exist(nMINWAIT) Then
		.Set dtWithholdingEntry
		Call WriteToReport(micPass,"WithholdingEntry="&dtWithholdingEntry,"is displayed",false)


	End If
	End WIth

	'ENter the value in Withholding Type
	With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_WithholdingInformation").WebEdit("WithholdingType")
	If .Exist(nMINWAIT) Then
		.Set dtWithholdingType
		Call WriteToReport(micPass,"WithholdingType="&dtWithholdingType,"is displayed",false)

	End If
	End WIth

	'ENter the value in WIthholding Jurinsdiction
	With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_WithholdingInformation").WebEdit("WithholdingJurisdiction")
	If .Exist(nMINWAIT) Then
		.Set dtWithholdingJurisdiction
		Call WriteToReport(micPass,"WithholdingJurisdiction="&dtWithholdingJurisdiction,"is displayed",false)
	End If
	End With

	'Enter the values in Default withholding class
	With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_WithholdingInformation").WebEdit("DefaultWithholdingClass")
	If .Exist(nMINWAIT) Then
		.Set dtDefaultWithholdingClass
		Call WriteToReport(micPass,"DefaultWithholdingClass="&dtDefaultWithholdingClass,"is displayed",false)
	End If
	End With

   	'Enter the vcalue in Withhold Status
   	With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_WithholdingInformation").WebEdit("WIthholdingStatus")
	If .Exist(nMINWAIT) Then
		.Set dtWIthholdingStatus
		Call WriteToReport(micPass,"WIthholdingStatus="&dtWIthholdingStatus,"is displayed",false)

	End If
   	End With
   	
   	'CLick on Ok button
   	WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_WithholdingInformation").WebButton("Ok")
   	If .Exist(nMINWAIT) Then
   		.Click
   	End If
   	End WIth

	Else
	 Call WriteToReport(micFail,"Not able to click on 1099/Withholding link ", "and not able to enter the Withjholding details",True) 
End If
End WIth

app_SearchSync()

'Enter the User ID in the Additiona information sectionm
dtUserID=(GlobalDictionary("UserID"))
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("AddtlInfoTab")
If .Exist(nMINWAIT) Then
.Click

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("UserID")
If .Exist(nMINWAIT) Then
	.Set dtUserID
	Call WriteToReport(micPass,"UserIDs="&dtUserID,"is displayed",false)
End If
End With
Else
 Call WriteToReport(micFail,"Not able to navigate to Additiona information tab ", "and not able to enter the User ID",True) 
End If
End WIth

'Waiting for the applicaiton to syns
app_SearchSync()

'Click on Save buttonm and submi tthe changes
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	 Call WriteToReport(micPass,"Save button is present ", "and clicked",False) 
	 Else
	 Call WriteToReport(micFail,"Save button is not present ", "and not clicked",True) 
End If
End WIth

'Waiting for the applicaiton to syns
app_SearchSync()

'Navigate to summary tab and check the status of Withholding 
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary")
If .Exist(nMINWAIT) Then
	.Click
	With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebTable("Summary")
	If .Exist(nMINWAIT) Then
		For i=3 to .RowCount
			appColumnName=.GetCellData(i,2)
			If appColumnName="Withholding" Then
			      appColumnValueName=.GetCellData(i,3)
			      If appColumnValueName="No" Then
			      	Call WriteToReport(micPass,"Withholding status is updated as No ", "Before updataing hte Withholding status",False) 
			      	Exit For
			      	Else
			      	Call WriteToReport(micFail,"Withholding status is updated as Yes ", "Before updataing hte Withholding status",True) 
			      	Exit For
			      End If
			End If
		Next
	End If
	End With
	
	Else
	Call WriteToReport(micFail,"Not able to navigate to Summary tab ", "and not able to validate the Withholding status",True) 
End If
End WIth

'Waiting for the applicaiton to syns
app_SearchSync()

'Click on Identifying information tab
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("IdentifyingInformation")
If .Exist(nMINWAIT) Then
	.Click
	With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebCheckBox("withholding")
	If .Exist(nMINWAIT) Then
		.Click
		 Call WriteToReport(micPass,"Withholding checkbox is present ", "and clicked",False) 
		 Else
		  Call WriteToReport(micFail,"Withholding checkbox is not present ", "and not clicked",True) 
	End If
	End With
	Else
	 Call WriteToReport(micFail,"Identify account information ", "and not able to enter the Withjholding details",True) 
End If
End With

'Waiting for the applicaiton to syns
app_SearchSync()

'Click on Save buttonm and submi tthe changes
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	 Call WriteToReport(micPass,"Save button is present ", "and clicked",False) 
	 Else
	 Call WriteToReport(micFail,"Save button is not present ", "and not clicked",True) 
End If
End WIth

'Waiting for the applicaiton to syns
app_SearchSync()

'CLick ok Button the Pop up displayed
With Browser("PeopleSoft Browser").Page("Supplier").WebButton("Warning_OKButton")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

'Waiting for the applicaiton to syns
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Supplier").WebButton("Warning_OKButton")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth

'Waiting for the applicaiton to syns
app_SearchSync()

'CLick on Summary tab and validate the details
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary")
If .Exist(nMINWAIT) Then
	.Click
	
	'Waiting for the applicaiton to syns
	app_SearchSync()

	
'Check for the Supplier ID and Status
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary_SupplierIDNo")
If .Exist(nMINWAIT) Then
	appSupplierID=.GetROProperty("innertext")
	If appSupplierID=dtVendorId Then
		Reporter.ReportEvent micPass,"The supplier is created","and supplier ID created in form is"&appSupplierID
	End If
	Reporter.ReportEvent micPass,"THe supplier is created","and supplier ID created in form is"&appSupplierID
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary_SupplierAddStatus")
If .Exist(nMINWAIT) Then
	appSummaryStatus=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"THe status of the Supplier creation","is"&appSummaryStatus
End If
End  With 
	
Else
 Call WriteToReport(micFail,"Not abel to navigatye to Summary tab ", "and not able to to varify the details",True) 
End If
End With

End Function

'*********************************************************************************************************************************
''' <summary>  
''' AddAddrWithEffecDateForExistingVendor() To Add Supplier Address with more than One Effective Date, across different years
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "AddressLine1, AddrEffectiveDate, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'1.1.2
Public Function AddAddrWithEffecDateForExistingVendor()
Dim dtVendorID,dtAddr_EffectiveDate,dtAddressLine1
dtVendorID=(GlobalDictionary("VendorID"))
dtAddr_EffectiveDate=(GlobalDictionary("AddrEffectiveDate"))
dtAddressLine1=(GlobalDictionary("AddressLine1"))

'Navigate to Suppliers --> Supplier Information --> Add/Update--> Supplier
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

'wait for the ojects to get loaded
app_SearchSync()

'Search for the Existing vendor
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("FindExistingValue_VendorID")
If .Exist(nMINWAIT) Then
	.Set dtVendorID
	Call WriteToReport(micPass,"VendorID="&dtVendorID,"is displayed",false)
	Call WriteToReport(micPass,""&.GetROProperty("value"), "is present and able to enter the value"&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"), "is not present",True)	
End If
End With

'Clickon Search Button
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

'wait for the ojects to get loaded
app_SearchSync()


'Click on Chanve hisotry to change to Editablke mode
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("CorrectHistory")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("value"), "is clicked and now app is in Editable mode:",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"), "is not present and now app is in non Editable mode:",True)	
End If
End WIth

'Clickon Address Tab
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("AddressTab")
If .Exist(nMINWAIT) Then
	.Click
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'Verify whether the DDLB is disabeld
	While Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebList("SupplierId_NoOfAddress").GetROProperty("disabled")="0"
			With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("-")
			If .Exist(nMINWAIT) Then
				.Click
			End If
			End  With 
			
			With Browser("PeopleSoft Browser").Page("Supplier").WebButton("Warning_OKButton")
			If .Exist(nMINWAIT) Then
				.Click
			End If
			End  With 	
	Wend
	
	'Get the Effective Date
	With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("Addr_EffectiveDate")
	If .Exist(nMINWAIT) Then
		appEffectiveDate=.GetROProperty("value")
		GlobalDictionary("effectiveDate")=DateAdd("yyyy",2,appEffectiveDate)
	End If
	End  With 

	'Click on + icon to add the addiiton address
	WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("+")
	If .Exist(nMINWAIT) Then
	.Click
	Else
	Call WriteToReport(micFail,"+ icon is not present", "and not able to add the additional address",True)	
	End If
	End With
	
	'CHange the effective address of the Address 1
	With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("Addr_EffectiveDate")
	If .Exist(nMINWAIT) Then
		.Set GlobalDictionary("effectiveDate")
		Call WriteToReport(micPass,"Effective date is set to", "future date sucessfully with"&.GetROProperty("value"),False)
		Else
		Call WriteToReport(micFail,"Not abel to set the effective date", "Unsucessfull",True)
	End If
	End With
	
	'Get the address from THe adress field
	With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("AddressLine1")
	If .Exist(nMINWAIT) Then
		appAddress=.GetROProperty("value")
		GlobalDictionary("appAddress")=appAddress
	End If
	End  With 

	
	'Click  on Save Button
	With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Save")
	If .Exist Then
		.Click
		Call WriteToReport(micPass,""&.GetROProperty("value"), "is present and clicekd",False)
		Else
		Call WriteToReport(micFail,""&.GetROProperty("value"), "is not present",True)
	End If
	End With
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'Navigate to Summary tab and verify the details
	With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary")
	If .Exist(nMINWAIT) Then
		.Click
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
		'CHeck in summary whether changes are not gettign reflected
		With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("SummaryTab_AddressLine")
		If .Exist(nMINWAIT) Then
			appSummaryAddress=.GetROProperty("innertext")
			If GlobalDictionary("appAddress")= appSummaryAddress Then
				Reporter.ReportEvent micPass,"The address is matching","adn the validated sucessfully and address is"&appSummaryAddress
			End If
		End If
		End  With 
		
		Else
		Call WriteToReport(micFail,"Not able to navigate to Summary tab", "and not able to verify the dtails",True)
	End If
	End WIth
	
	Else
	Call WriteToReport(micFail,"Not abel to navigate to Address tab", "And not abel to enter the details",True)
End If
End With

End Function

'*********************************************************************************************************************************
''' <summary>  
''' AddSupplierForACHWireTransferPayments() To Add Supplier Address with more than One Effective Date, across different years 
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "LocationID, PaymentMethod, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'1.1.3
Public Function AddSupplierForACHWireTransferPayments()
Dim  dtLocationID

'initializing variables
dtLocationID=(GlobalDictionary("LocationID"))
dtPaymentMethod=(GlobalDictionary("PaymentMethod"))
dtVendorID=(GlobalDIctionary("VendorID")) & inVoiceNumberGeneration' & Day(Date)


'Navigate to Suppliers --> Supplier Information --> Add/Update--> Supplier and add new supplier and provide the names
AddNewSupplierNavigate()

'click on Address Tab and enter all the mandatory details in teh Address Tab
AddFirstAddress()

'Navigate to Location and add the ACH payment Type
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("LocationTab")
If .Exist(nMINWAIT) Then
	.Click
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	 'ENter the Location ID
	 With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("Location")
	 If .Exist(nMINWAIT) Then
	 	.Set dtLocationID
	 	Call WriteToReport(micPass,"LocationID="&dtLocationID,"is displayed",false)
	 End If
	 End WIth
	
	'Click on paybles link
	 With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").Link("Payables_Location")
        If .Exist(nMINWAIT) Then
             .Click
             
             	'wait for the ojects to get loaded
		app_SearchSync()
		
		With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebElement("AdditionalPayablesOptions")
		If .Exist(nMINWAIT) Then
			.Click
			
			'wait for the ojects to get loaded
			
			app_SearchSync()
			'Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebList("PaymentMethod").Select

			'Enter trhe payment method as ACH
			'Wire Transfer
			'"Automated Clearing House"
			'dtPaymentMethod="Wire Transfer"
			With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebList("PaymentMethod")
			If .Exist(nMINWAIT) Then
				.Select dtPaymentMethod
				Call WriteToReport(micPass,"The payment method is","set with"&dtPaymentMethod,false)
			End If
			End With 
			

			
			Else
			Call WriteToReport(micFail,"Not abel to click on Additional payable", "And not abel to enter payment options",True)	   
		End If
		End With
   
   		'Clickon upply bank information element to enter all the Bank related information
   		With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebElement("SupplyBankInformation")
	      If .Exist(nMINWAIT) Then
	        .Click
	        
	         'WAit for the application to load
	           app_SearchSync()
	          
	          'Enter the bank details in this section
	          dtbankDescription=(GlobalDictionary("Description"))
	          dtBankName=(GlobalDictionary("BankName"))
	          dtBankQualifier=(GlobalDictionary("BankQualifier"))
	          dtBankID=(GlobalDictionary("BankID"))
	          dtAcctNumber=(GlobalDictionary("AcctNumber"))
	          dtDFIQualifier=(GlobalDictionary("DFIQualifier"))
	          dtAcctType=(GlobalDictionary("AcctType"))
	          
	          WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("Description")
	          If .Exist(nMINWAIT) Then
	          	.Set bankDescription
	          	Call WriteToReport(micPass,"BankDescription="&bankDescription,"is displayed",false)
	          End If
	          End WIth 
	          
	          'Entert the Bank name
	          WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("BankName")
	          If .Exist(nMINWAIT) Then
	          	.Set dtBankName
	          	Call WriteToReport(micPass,"BankName="&dtBankName,"is displayed",false)
	          End If
		   End WIth
		   
		   'Enter the Branch Name
		   With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("BranchName")
		   If .Exist(nMINWAIT) Then
		   	.Set dtBankName
		   	Call WriteToReport(micPass,"Branch Name="&dtBankName,"is displayed",false)
		   End If
		   End WIth 
		   
		   'Enter the Bank ID qualifier
		   WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("BankIdQualifier")
		   If .Exist(nMINWAIT) Then
		   	.Set dtBankQualifier
		   	Call WriteToReport(micPass,"BankQualifier="&dtBankQualifier,"is displayed",false)


		   End If
                 End With
                 
                ' WAit for the application to load
	           app_SearchSync()
                 
                'ENtert the Bank ID details
                With  Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("BankId")
                If .Exist(nMINWAIT) Then
                	.Set dtBankID
                	Call WriteToReport(micPass,"BankID="&dtBankID,"is displayed",false)
                End If
                End WIth
                
                'ENter Account NUmber
                WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("AcctNumber")
                If .Exist(nMINWAIT) Then
                	.Set dtAcctNumber
                	Call WriteToReport(micPass,"AcctNumber="&dtAcctNumber,"is displayed",false)
                End If
                End With
                
                'ENter DFI qualifier
                With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("DFIQualifier")
		   If .Exist(nMINWAIT) Then
		   	.Set dtDFIQualifier
		   	Call WriteToReport(micPass,"DFIQualifier="&dtDFIQualifier,"is displayed",false)
		   End If
                End With
                
                ' WAit for the application to load
	           app_SearchSync()
                
                'Select the Account type
                With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebList("AccountType")
	          If .Exist(nMINWAIT) Then
	          	.Select dtAcctType
	          End If
                End With
                
                'Enter DFI ID
                With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("DFIId")
                If .Exist(nMINWAIT) Then
                	.Set dtBankID
                	Call WriteToReport(micPass,"DFIID="&dtBankID,"is displayed",false)
                End If
                End WIth

		'Click on Ok button 
                WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebButton("Ok")
                If .Exist(nMINWAIT) Then
                	.Click
                End If
                End WIth
                
                ' WAit for the application to load
	           app_SearchSync()
	           
	           			'Clicko n Ok Button
			With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebButton("Ok")
			If .Exist(nMINWAIT) Then
				.Click
			End If
			End WIth
	          

	   Else
	   Call WriteToReport(micFail,"Not able to find the Supply bank infroamtion section","Not able to enter the bank details of the vendor",True)
	   End If
	   End With
   
            Else
		Call WriteToReport(micFail,"Not abel to click on Paybles link", "And not abel to enter payment options",True)	            
	End If
	End WIth
	
	Else
	Call WriteToReport(micFail,"Not abel to navigate to Location Tab", "And not abel to enter the details",True)
End If
End WIth 
	
'Click on Additionl Information tan to enter the User ID
dtUserID=(GlobalDictionary("UserID"))
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("AddtlInfoTab")
If .Exist(nMINWAIT) Then
.Click
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("UserID")
If .Exist(nMINWAIT) Then
	.Set dtUserID
	Call WriteToReport(micPass,"UserID="&dtUserID,"is displayed",false)
	.Click
End If
End With
Else
 Call WriteToReport(micFail,"Not able to navigate to Additiona information tab ", "and not able to enter the User ID",True) 
End If
End WIth

'Clickon Save button
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Save button is present ", "clicked and able to save the changes",False) 
	Else
	Call WriteToReport(micFail,"Save button is not present ", "and not abel to click ",True) 
End If
End WIth

'Waiting for the applicaiton to syns
app_SearchSync()

'CLick ok Button the Pop up displayed
With Browser("PeopleSoft Browser").Page("Supplier").WebButton("Warning_OKButton")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

'Waiting for the applicaiton to syns
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Supplier").WebButton("Warning_OKButton")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth

'Waiting for the applicaiton to syns
app_SearchSync()

'CLick on Summary tab and validate the details
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary")
If .Exist(nMINWAIT) Then
	.Click
	
	'Waiting for the applicaiton to syns
	app_SearchSync()

	
'Check for the Supplier ID and Status
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary_SupplierIDNo")
If .Exist(nMINWAIT) Then
	appSupplierID=.GetROProperty("innertext")
	If appSupplierID=dtVendorID Then
		Reporter.ReportEvent micPass,"The supplier is created","and supplier ID created in form is"&appSupplierID
	End If
	Reporter.ReportEvent micPass,"THe supplier is created","and supplier ID created in form is"&appSupplierID
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary_SupplierAddStatus")
If .Exist(nMINWAIT) Then
	appSummaryStatus=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"THe status of the Supplier creation","is"&appSummaryStatus
End If
End  With 
	
Else
 Call WriteToReport(micFail,"Not abel to navigatye to Summary tab ", "and not able to to varify the details",True) 
End If
End With

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************


Public Function  AddNewSupplierNavigate()
'Navigate to Suppliers --> Supplier Information --> Add/Update--> Supplier
'SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

'wait for the ojects to get loaded
app_SearchSync()

'CLick on Add New value Tab
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present",True)
End If
End With 

'wait for the ojects to get loaded
app_SearchSync()

'Set the value in the Supplier ID
dtVendorID=(GlobalDIctionary("VendorID")) & RandomNumberGeneraion & Day(Date)
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("VendorID")
If .Exist(nMINWAIT) Then
	.Set dtVendorID
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked and set with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present",True)
End If
End With 


'click on Add Button
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present",True)
End If
End with 

'wait for the ojects to get loaded
app_SearchSync()

'Enter the Supplier name and supplier details inteh INforamtion section
dtSupplierName=(GlobalDictionary("SupplierName"))
dtSupplierShortName=(GlobalDictionary("ShortName"))

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("SupplierName")
If .Exist(nMINWAIT) Then
	.Set dtSupplierName
	Call WriteToReport(micPass,"SupplierName="&dtSupplierName,"is displayed",false)
End If
End WIth

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("SupplierShortName")
If .Exist(nMINWAIT) Then
	.Set dtSupplierShortName
	Call WriteToReport(micPass,"SupplierShortName="&dtSupplierShortName,"is displayed",false)
End If
End WIth
End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************


Public Function AddFirstAddress()
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("AddressTab")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",False)

'Enter the description
dtDescription=(GlobalDictionary("Description"))
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("AddressDescription")
If .Exist(nMINWAIT) Then
	.Set dtDescription
	Call WriteToReport(micPass,"Description="&dtDescription,"is displayed",false)	
End If
End With 

'Enter the Addres in the Address field, CIty and country and postal code
dtAddressLine1=(GlobalDictionary("AddressLine1"))
dtCity=(GlobalDictionary("City"))
dtState=(GlobalDictionary("State"))
dtPostalCode=(GlobalDictionary("PostalCode"))
dtEffectiveDate=(GlobalDictionary("EffectiveDate"))

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("AddressLine1")
If .Exist(nMINWAIT) Then
	.Set dtAddressLine1
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and set with"&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present",True)
End If
End With 

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("City")
If .Exist(nMINWAIT) Then
	.Set dtCity
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and set with"&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present",True)
End If
End With 

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("Country_2")
If .Exist(nMINWAIT) Then
	.Set dtCountry
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and set with"&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present",True)
End If
End With 

'ENter the state and search in the look up window
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("State")
If .Exist(nMINWAIT) Then
	.Set dtState
	Call WriteToReport(micPass,"State="&dtState,"is displayed",false)	
	'wait for the ojects to get loaded
        app_SearchSync()
        
        'click on the image look up
        With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").Image("StateLookUpSearch")
        If .Exist(nMINWAIT) Then
        	.Click
        End If
        End WIth
        
         app_SearchSync()

With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Mod_Win_StateLookUp").WebTable("StateNames")
   If .Exist(nMINWAIT) Then
     For j=1 to .RowCount
        appStateName=.GetCellData(j,1)
      	    If instr(1,appStateName,dtState)>0 Then
             Set oStateLink=.ChildItem(j,1,"Link",0)
     		oStateLink.click
     		Exit For
     	   End If
        Next
     Else
     Call WriteToReport(micFail,"Look up window","is not present",True)
    End If
  End With   

Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present",True)
End If
End With 

'ENter the postal code
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("PostalCode")
If .Exist(nMINWAIT) Then
	.Set dtPostalCode
	Call WriteToReport(micPass,"State="&dtPostalCode,"is displayed",false)	
End If
End With 

'Click on the Look up lijnk in the postal code
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").Link("LookUp")
If .Exist(nMINWAIT) Then
        .Click
        
            'wait for the application to sync
             app_SearchSync()
             

           'select the checkbox displeyed
           With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("PostalLookUpFrame").WebCheckBox("SelectCountry")
           If .Exist(nMINWAIT) Then
           	.Click
           End If
           End With 
           
           'CLick on Ok button
           WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("PostalLookUpFrame").WebButton("Ok")
           If .Exist(nMINWAIT) Then
           	.Click
           End If
           End WIth 
           
	Else
	Call WriteToReport(micFail,"Look up link","is not present",True)
End If
End With

Else
	Call WriteToReport(micFail,"Address tab is not presnt","and not able to enter the AAddress details",True)
End If
End WIth
End Function

'*********************************************************************************************************************************
''' <summary>  
''' AddSupplierDifferentAddressOneLocation() To Add Supplier with Different Addresses for one Location
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "EffectiveDate1, AddressLineSecond"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'1.1.5
Public Function AddSupplierDifferentAddressOneLocation()
dtEffectiveDate1=(GlobalDictionary("EffectiveDate1"))
dtAddressLineSecond=(GlobalDictionary("AddressLineSecond"))

'Navigate to Suppliers --> Supplier Information --> Add/Update--> Supplier and add new supplier and provide the names
Call AddNewSupplierNavigate()

'wait for the ojects to get loaded
app_SearchSync()

'Click on Address Tab and enter all the mandatory details in the Address Tab
Call AddFirstAddress()

 'wait for the ojects to get loaded
 app_SearchSync()
 
 ''CLickon + icon to add the new address with different address with same stata
 'click on + icon for adding additiona address
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("+")
If .Exist(nMINWAIT) Then
	.Click

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Next_Address")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth 

'wait for the ojects to get loaded
 app_SearchSync()
 
 'Enter the effective date lesser than the first address
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("Addr_EffectiveDate")
If .Exist(NMINWAIT) Then
      .Set dtEffectiveDate1
      Call WriteToReport(micPass,"EffectiveDate1="&dtEffectiveDate1,"is displayed",false)	
End If
End WIth 

'Enter the address inthe Address line 1
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("AddressLine1")
If .Exist(nMINWAIT) Then
	.Set dtAddressLineSecond
	Call WriteToReport(micPass,"AddressLineSecond="&dtAddressLineSecond,"is displayed",false)	
End If	
End With

Else
Call WriteToReport(micFail,"+ icon to add new address","is not present",True)
End If
End With

'Enter ht location
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("LocationTab")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'Set th elocation
dtLocation=(GlobalDictionary("Location"))
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("Location")
If .Exist(nMINWAIT) Then
	.Set dtLocation
	Call WriteToReport(micPass,"Location="&dtLocation,"is displayed",false)	
End If
End WIth 

'CLickon Addi info
dtUserId=(GlobalDictionary("UserId"))
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("AddtlInfoTab")
If .Exist(nMINWAIT) Then
	.Click
	With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("UserID")
		If .Exist(nMINWAIT) Then
			.Set dtUserId
			Call WriteToReport(micPass,"UserId="&dtUserId,"is displayed",false)	
		End If
		End WIth
End If
End With 


'Click on Save Button
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Save button is present","clicked and able to save the changes",False)
	Else
	Call WriteToReport(micFail,"Save button is not present","not able to save the changes",True)
End If
End With

End Function

'*********************************************************************************************************************************
''' <summary>  
''' SupplierCurrentBalance() To Supplier Current Balance
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "FromBusinessUnit, SupplierID"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'1.1.7
Public Function SupplierCurrentBalance()
dtFromBusinessUnit=(GlobalDictionary("FromBusinessUnit"))
SupplierID=(GlobalDictionary("SupplierID"))

'Navigate to Accounts Payable --> Review Accounts Payable Info --> Supplier --> Current Balance
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'wait for the objects to get loaded
app_SearchSync()

'ENter from and TO business UNIt
If Browser("PeopleSoft Browser").Page("CurrentBalance").Frame("TargetContent").WebEdit("FromBusinessUnit").WaitProperty("visible",True,2000) Then
	
'Enter the From Business Unit
With Browser("PeopleSoft Browser").Page("CurrentBalance").Frame("TargetContent").WebEdit("FromBusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtFromBusinessUnit
	Call WriteToReport(micPass,"FromBusinessUnit="&dtFromBusinessUnit,"is displayed",false)	
End If
End WIth

'ENtetr the TO Business UNIT
With Browser("PeopleSoft Browser").Page("CurrentBalance").Frame("TargetContent").WebEdit("ToBusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtFromBusinessUnit
	Call WriteToReport(micPass,"To BusinessUnit="&dtFromBusinessUnit,"is displayed",false)	
End If	
End With

'Enter the From and To supplier ID
With Browser("PeopleSoft Browser").Page("CurrentBalance").Frame("TargetContent").WebEdit("FromSupplierID")
If .Exist(nMINWAIT) Then
	.Set SupplierID
	Call WriteToReport(micPass,"From SupplierID="&SupplierID,"is displayed",false)	
End If
End WIth

'Enter To Supplier ID
WIth Browser("PeopleSoft Browser").Page("CurrentBalance").Frame("TargetContent").WebEdit("ToSupplierID")
If .Exist(nMINWAIT) Then
	.Set SupplierID
	Call WriteToReport(micPass,"To SupplierID="&SupplierID,"is displayed",false)	
End If
End WIth
wait(5)

'CLick on Search BUtton
With Browser("PeopleSoft Browser").Page("CurrentBalance").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth

'wait for the objects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("CurrentBalance").Frame("TargetContent").WebTable("Balance_SearchResults")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
		appSuuplierID=.GetCellData(i,2)
		If instr(1,appSuuplierID,SupplierID)>0 Then
			appPayableBalance=.GetCellData(i,8)
			Call WriteToReport(micPass,"Payable balance is displayed","and payable balance is"&appPayableBalance,False)
		End If
	Next
End If

End WIth


Else
Call WriteToReport(micFail,"SUpplier CUrrent Balance page","is not displayed",True)
End If

End Function

'*********************************************************************************************************************************
''' <summary>  
''' AddSupplierNoZipCode() To  Create Supplier with No Zipcode
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "AddressLine1, City,State,PostalCode,EffectiveDate,Location"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'1.1.4
Public Function AddSupplierNoZipCode()
'Navigate to Suppliers --> Supplier Information --> Add/Update--> Supplier and add new supplier and provide the names
Call AddNewSupplierNavigate()

'wait for the ojects to get loaded
app_SearchSync()

'Click on the Address and enter the address detials without the ZIP code
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("AddressTab")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and clicked",False)

'Enter the description
dtDescription=(GlobalDictionary("Description"))
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("AddressDescription")
If .Exist(nMINWAIT) Then
	.Set dtDescription
	Call WriteToReport(micPass,"Description="&dtDescription,"is displayed",false)	
End If
End With 

'Enter the Addres in the Address field, CIty and country and postal code
dtAddressLine1=(GlobalDictionary("AddressLine1"))
dtCity=(GlobalDictionary("City"))
dtState=(GlobalDictionary("State"))
dtPostalCode=(GlobalDictionary("PostalCode"))
dtEffectiveDate=(GlobalDictionary("EffectiveDate"))
dtLocation=(GlobalDictionary("Location"))

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("AddressLine1")
If .Exist(nMINWAIT) Then
	.Set dtAddressLine1
	Call WriteToReport(micPass,"AddressLine1="&dtAddressLine1,"is displayed",false)	
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and set with"&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present",True)
End If
End With 

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("City")
If .Exist(nMINWAIT) Then
	.Set dtCity
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and set with"&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present",True)
End If
End With 

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("Country_2")
If .Exist(nMINWAIT) Then
	.Set dtCountry
	Call WriteToReport(micPass,""&.GetROProperty("value"),"is present and set with"&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present",True)
End If
End With 

'ENter the state and search in the look up window
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("State")
If .Exist(nMINWAIT) Then
	.Set dtState
	
	'wait for the ojects to get loaded
        app_SearchSync()
        
        'click on the image look up
'        WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").Image("StateLookUpSearch")
'        If .Exist(nMINWAIT) Then
'        	.Click
'        End If
'        End WIth
'        
'         app_SearchSync()
'         
'With Browser("PeopleSoft Browser").Page("Supplier").Frame("Mod_WIn").WebTable("StateNames")
'   If .Exist(nMINWAIT) Then
'     For j=1 to .RowCount
'        appStateName=.GetCellData(j,1)
'      	    If instr(1,appStateName,dtState)>0 Then
'             Set oStateLink=.ChildItem(j,1,"Link",0)
'     		oStateLink.click
'     		Exit For
'     	   End If
'        Next
'     Else
'     Call WriteToReport(micFail,"Look up window","is not present",True)
'    End If
'  End With   

Else
	Call WriteToReport(micFail,""&.GetROProperty("value"),"is not present",True)
End If
End With 
Else
	Call WriteToReport(micFail,"Address tab is not presnt","and not able to enter the AAddress details",True)
End If
End WIth

'Enter the Location
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("LocationTab")
If .Exist(nMINWAIT) Then
	.Click
	
	'wait for the ojects to get loaded
        app_SearchSync()
        
        'Entetr the location in the Text box
        With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("Location")
        If .Exist(nMINWAIT) Then
        	.Set dtLocation
        	Call WriteToReport(micPass,"Location="&dtLocation,"is displayed",false)	
        End If
        End With
        
        Else
        Call WriteToReport(micFail,"Not able to click the Location Tab","and not able to enter the details",True)
End If
End WIth

	'wait for the ojects to get loaded
        app_SearchSync()

'Enter the User ID in the Additiona information sectionm
dtUserID=(GlobalDictionary("UserID"))
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("AddtlInfoTab")
If .Exist(nMINWAIT) Then
	.Click
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("UserID")
If .Exist(nMINWAIT) Then
	.Set dtUserID
	Call WriteToReport(micPass,"UserID="&dtUserID,"is displayed",false)	
End If
End With
Else
 Call WriteToReport(micFail,"Not able to navigate to Additiona information tab ", "and not able to enter the User ID",True) 
End If
End WIth

'Click on Save Button
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Save button is presnt","and abloe to click and save the changes",False)
	Else
	Call WriteToReport(micFail,"Save button is not presnt","and not abloe to click and save the changes",True)
End If
End WIth

	'wait for the ojects to get loaded
        app_SearchSync()
        
        WIth Browser("PeopleSoft Browser").Page("Supplier").WebElement("PostalCodeErrorMessage")
        If .Exist(nMINWAIT) Then
        	appPostalCodeErrorMessage=.GetROProperty("innertext")
        	Call WriteToReport(micPass,"Postal Code Error message","is displayed is"&appPostalCodeErrorMessage,False)
        	Call WriteToReport(micPass,"Postal Code Error message","is displayed and sucess",False)
        	With Browser("PeopleSoft Browser").Page("Supplier").WebButton("Warning_OKButton")
        	If .Exist(nMINWAIT) Then
        		.Click
        	End If
        	End With
        End If
        End With

'ENter the postal code
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("PostalCode")
If .Exist(nMINWAIT) Then
	.Set dtPostalCode
	Call WriteToReport(micPass,"PostalCode="&dtPostalCode,"is displayed",false)	
End If
End With 

'Click on the Look up lijnk in the postal code
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").Link("LookUp")
If .Exist(nMINWAIT) Then
        .Click
        
            'wait for the application to sync
             app_SearchSync()
             
           'select the checkbox displeyed
           With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("PostalLookUpFrame").WebCheckBox("SelectCountry")
           If .Exist(nMINWAIT) Then
           	.Click
           End If
           End With 
           'Browser("PeopleSoft Browser").Page("Supplier").PSFrame("PostalLookUpFrame").WebButton("Ok").Click

           'CLick on Ok button
           WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("PostalLookUpFrame").WebButton("Ok")
           If .Exist(nMINWAIT) Then
           	.Click
           End If
           End WIth 
           
	Else
	Call WriteToReport(micFail,"Look up link","is not present",True)
End If
End With

'Click on Save Button
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Save button is presnt","and abloe to click and save the changes",False)
	Else
	Call WriteToReport(micFail,"Save button is not presnt","and not abloe to click and save the changes",True)
End If
End WIth


End Function

'*********************************************************************************************************************************
''' <summary>  
''' AddPayGroup() To Add a Pay Group
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "MainMenuSelection, VendorID"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'1.1.16
Public Function AddPayGroup()
'Navigate to Suppliers --> Supplier Information --> Add/Update-->
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
'Waiting for the application sync
For i=0 to 2
	Browser("PeopleSoft Browser").Sync
Next

'wait for the ojects to get loaded
app_SearchSync()

'Select the HIstory tab
'dtVendorID=(GlobalDictionary("vendorID"))
'With
'If .Exist(nMINWAIT) Then
'	.Set dtVendorID
'End If


dtVendorID=(GlobalDictionary("VendorID"))
'Search for the Existing vendor
With  Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("FindExistingValue_VendorID")
If .Exist(nMINWAIT) Then
	.Set dtVendorID
	Call WriteToReport(micPass,""&.GetROProperty("value"), "is present and able to enter the value"&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"), "is not present",True)	
End If
End With

'Click on Search Button
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

'wait for the ojects to get loaded
app_SearchSync()

'CLick on Th4e search hyperlinl
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebTable("SearchResults")

Set oSuppLink=.ChildItem(2,2,"Link",0)
If oSuppLink.Exist(nMINWAIT) Then
	oSuppLink.click
End If
Set oSuppLink=Nothing
End With	

'Click on Chanve hisotry to change to Editablke mode
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("CorrectHistory")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("value"), "is clicked and now app is in Editable mode:",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("value"), "is not present and now app is in non Editable mode:",True)	
End If
End WIth


dtPayGroup=(GlobalDictionary("PayGroup"))
'Click on Location Tab
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("LocationTab")
If .Exist(nMINWAIT) Then
	.Click
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'Click on Payables link
	With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").Link("Payables_Location")
	If .Exist(nMINWAIT) Then
		.Click
		
	'wait for the ojects to get loaded
	app_SearchSync()
	
	WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebElement("AdditionalPayablesOptions")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End WIth
	

	With Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebEdit("Payables_PayGroup")
	If .Exist(nMINWAIT) Then
		.Set dtPayGroup
		Call WriteToReport(micPass,"Payables_PayGroup="&dtPayGroup,"is displayed",false)	

    End If
    End WIth
	
	'CLick on Ok button
	WIth Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Location_Payables").WebButton("Ok")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End WIth
		
		Else
		Call WriteToReport(micFail,"NOt able to click on Payabled link", "and not able to fuill the details:",True)
	End If
	End WIth

	
	Else
	Call WriteToReport(micFail,"NOt able to navigate to Location Tab", "and not able to fuill the details:",True)	
End If
End With 

'CLick  on Save button
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
End If
End WIth
End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'2.1
Public Function AddRegularVoucherOneInvoiceLine()

'Navigate to Accounts Payable -> Vouchers -> Add Update -> Regular entry
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Declarring the variables:- 
dtBusinessUnit=GlobalDictionary("BusinessUnit")
dtinvoiceNo=GlobalDictionary("invoiceNo") & inVoiceNumberGeneration' & Day(Date)
dtInvoiceDate=GlobalDictionary("InvoiceDate")
'dtSupplierID=GlobalDictionary("SupplierID")
dtLineAmount=GlobalDictionary("LineAmount")
dtAccountNumber=GlobalDictionary("AccountNumber")
dtDept=GlobalDictionary("Dept")
dtAdditionalComments=GlobalDictionary("AdditionalComments")
dtTotalAmount=GlobalDictionary("TotalAmount")

'Enter the BusinessUnit anrd and voucher ID and click on Add button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is not present" ,True)
End If
End WIth 

'Clickon Add Button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Add Button is clicked", "and able to process tonext page",False)
	Else
	Call WriteToReport(micPass,"Add Button is cnot present", "and not able to process tonext page",True)
End If
End WIth

'wait for the applicaiton to load
Browser("PeopleSoft Browser").Sync
 
 'Set the values in Invoice
 With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceNo")
 If .Exist(nMINWAIT) Then
 	.Set dtinvoiceNo
 	Call WriteToReport(micPass,"InvoiceNo="&dtinvoiceNo,"is displayed",false)	
 End If
End With

'Set the invoiuce Date
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceDate")
If .Exist(nMINWAIT) Then
	.Set dtInvoiceDate
	Call WriteToReport(micPass,"InvoiceDate="&dtInvoiceDate,"is displayed",false)	
End If
End With

'CLick on the magnifying glass
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

'Click on the Supplier ID
With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID")
If .Exist(nMINWAIT) Then
	dtSupplierID=.GetCellData(2,1)
	GlobalDictionary("SupplierID")=dtSupplierID
	Set oLink=.ChildItem(2,1,"Link",0)
	If oLink.Exist(nMINWAIT) Then
		oLink.click
		Reporter.ReportEvent micPass,"The Supplier Selected","is"&dtSupplierID
	End If
	Set oLink=Nothing
End If
End  WIth 

'wait for the ojects to get loaded
app_SearchSync()

 

'ENte the Total Amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total")
If .Exist(nMINWAIT) Then
	.Set dtTotalAmount
	Call WriteToReport(micPass,"TotalAmount="&dtTotalAmount,"is displayed",false)	
End If
End With


'Enter the Line amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("LineAmount")
If .Exist(nMINWAIT) Then
	.Set dtLineAmount
	Call WriteToReport(micPass,"LineAmount="&dtLineAmount,"is displayed",false)	
End If
End With


'Ente the details in Account and Depty
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Account")
If .Exist(nMINWAIT) Then
	.Set dtAccountNumber
	Call WriteToReport(micPass,"AccountNumber="&dtAccountNumber,"is displayed",false)	
End If
End With

'Enter the Dept ID number
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Dept")
If .Exist(nMINWAIT) Then
	.Set dtDept
	Call WriteToReport(micPass,"Dept="&dtDept,"is displayed",false)	
End If
End With

'Click on Save button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Save Button is clicked", "and able to process the changes",False)
	Else
	Call WriteToReport(micFail,"Save Button is not clicked", "and not able to process the changes",False)
End If
End With

'CLick on Ok button if exists
With Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
	'Call WriteToReport(micFail,"Error message is displayed", "Correct the errors and click on save button",True)
	'ExitTest
	Else
	Call WriteToReport(micPass,"No error message displayed", "and changfes are saved sucessfully",False)
End If
End With

'CLick on VOucher Attribute pagfe
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("VoucherAttribute")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"),"is clicked and navigated to next page",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"),"is not present",True)
End If
End With

'Click on SUbmit for Approcal page
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SubmitForApproval_VoucherAttribute")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"),"is clicked and navigated to next page",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"),"is not present",True)
End If
End With

'Ente trth addition details adn click on Ok button
With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("ApprovalComments_VoucherAttribute").WebEdit("AdditionalComments")
If .Exist(nMINWAIT) Then
	.Set dtAdditionalComments
	Call WriteToReport(micPass,""&.GetROProperty("innertext"),"is present and set with"&.GetROProperty("value"),False)
End If
End With

'CLick on Ok button
With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("ApprovalComments_VoucherAttribute").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

'Click on Ok button
With Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
	'Call WriteToReport(micFail,"Error message is displayed", "Correct the errors and click on save button",True)
	'ExitTest
	Else
	Call WriteToReport(micPass,"No error message displayed", "and changfes are saved sucessfully",False)
End If
End With

'cLICK ON summary Tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("Summary")
If .Exist(nMINWAIT) Then
	.Click
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("ApproveStatus")
	If .Exist(nMINWAIT) Then
		appStatus=.GetROProperty("innertext")
		If instr(1,appStatus,"Approved")>0 Then
			Reporter.ReportEvent micDone,"The status of the","voucher is"&appStatus
		End If
	End If
	End  With 
End If
End With

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'2.2.2
Public Function AddRegularVoucherWithDollarAmount()
	
	'Navigate to Accounts Payable -> Vouchers -> Add Update -> Regular entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	'INitialize variable
	dtSupplierId=GlobalDictionary("SupplierId")
	dtBusinessUnit=GlobalDictionary("BusinessUnit")
	dtGrossAmount=GlobalDictionary("dtGrossAmount")
	dtClassification=GlobalDictionary("Classification")
	dtinvoiceNo=GlobalDictionary("invoiceNo") & inVoiceNumberGeneration' & Day (Date)
	dtInvoiceDate=GlobalDictionary("InvoiceDate")
	dtAccountNumber=GlobalDictionary("AccountNumber")
	dtDept=GlobalDictionary("Dept")
	
	'Enter the BusinessUnit anrd and voucher ID and click on Add button
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("BusinessUnit")
	If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is not present" ,True)
	End If
	End WIth 
	
	'ENte the Supplier ID and Inoice Amount
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SuuplierId_AddValue")
	If .Exist(nMINWAIT) Then
	.Set dtSupplierId
	Call WriteToReport(micPass, "SupplierId="&dtSupplierId,"is displayed",False)
	End If
	End With
	
	'EWnte the Gross Amount
	'EWnte the Gross Amount
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("GrossInvoiceAmount")
	If .Exist(nMINWAIT) Then
	.Set dtGrossAmount
	Call WriteToReport(micPass, "GrossAmount="&dtGrossAmount,"is displayed",False)
	End If
	End With
	
	'Clickon Add Button
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Add")
	If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Add Button is clicked", "and able to process tonext page",False)
	Else
	Call WriteToReport(micPass,"Add Button is cnot present", "and not able to process tonext page",True)
	End If
	End WIth
	
	'wait for the applicaiton to load
	Browser("PeopleSoft Browser").Sync
	
	'Set the values in Invoice
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceNo")
	If .Exist(nMINWAIT) Then
		.Set dtinvoiceNo
		Call WriteToReport(micPass, "InvoiceNo="&dtinvoiceNo,"is displayed",False)
	End If
	End With
	
	'Set the invoiuce Date
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceDate")
	If .Exist(nMINWAIT) Then
	.Set dtInvoiceDate
	Call WriteToReport(micPass, "InvoiceDate="&dtInvoiceDate,"is displayed",False)
	End If
	End With
	
	'Entert the Distribution Details
	
	'Ente the details in Account and Depty
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Account")
	If .Exist(nMINWAIT) Then
	.Set dtAccountNumber
	Call WriteToReport(micPass, "AccountNumber="&dtAccountNumber,"is displayed",False)
	End If
	End With
	
	'Enter the Dept ID number
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Dept")
	If .Exist(nMINWAIT) Then
	.Set dtDept
	Call WriteToReport(micPass, "Department="&dtDept,"is displayed",False)
	End If
	End With
	
	'Enter the classification
	WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Classification")
	If .Exist(nMINWAIT) Then
	.Set dtClassification
	Call WriteToReport(micPass, "Classification="&dtClassification,"is displayed",False)
	End If
	End With
	
	'Click on + sym,bol to add new Value
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("AddDistributionLine")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End With
	
	'Enter the No of rows in the section box 
	With Browser("PeopleSoft Browser").Dialog("NoofRowsToAdd")
	If .Exist(nMINWAIT) Then
	With Browser("PeopleSoft Browser").Dialog("NoofRowsToAdd").WinEdit("NoOfRows")
		If .Exist(nMINWAIT) Then
			.Set "1"
		End If
	End With
	'CLick on Ok button
	With Browser("PeopleSoft Browser").Dialog("NoofRowsToAdd").WinButton("Ok")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End With
	End If
	End With
	
	'Enter the Details in Second disriion line
	dtAccountLine2=(GlobalDictionary("AccountLine2"))
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("AccountLine2")
	If .Exist(nMINWAIT) Then
	.Set dtAccountLine2
	Call WriteToReport(micPass, "AccountLine2="&dtAccountLine2,"is displayed",False)
	End If
	End WIth
	
	'ENter dept ID
	dtDeptId2=(GlobalDictionary("DeptId2"))
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("DeptLine2")
	If .Exist(nMINWAIT) Then
	.Set dtDeptId
	Call WriteToReport(micPass, "DeptId="&dtDeptId,"is displayed",False)
	End If
	End WIth
	
	'Click on Save button
	WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Save")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End With
	
	End Function
	
	'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'2.2.5

Public Function CopyPurchaseOrder()
'Public Function CopyPurchaseOrder()
	'Navigate to Accounts Payable -> Vouchers -> Add Update -> Regular entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	'Declarring the variables:- 
	dtBusinessUnit=GlobalDictionary("BusinessUnit")
	dtinvoiceNo=GlobalDictionary("invoiceNo") & inVoiceNumberGeneration' & Day (Date)
	dtInvoiceDate=GlobalDictionary("InvoiceDate") 
	dtPOUnit=GlobalDictionary("POUnit") 
	dtPONUmber=GlobalDictionary("PONumber") 
	dtSupplierId=GlobalDictionary("dtSupplierId")
	
	'dtBusinessUnit="00000"
	
	'Enter the BusinessUnit anrd and voucher ID and click on Add button
	
	'Clickon Add Button
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Add")
	If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Add Button is clicked", "and able to process tonext page",False)
	Else
	Call WriteToReport(micPass,"Add Button is cnot present", "and not able to process tonext page",True)
	End If
	End WIth
	
	'wait for the applicaiton to load
	Browser("PeopleSoft Browser").Sync
	
	'dtinvoiceNo= "COPYPO06122018"
	'Set the values in Invoice
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceNo")
	If .Exist(nMINWAIT) Then
		.Set dtinvoiceNo
		Call WriteToReport(micPass, "InvoiceNo="&dtinvoiceNo,"is displayed",False)
	End If
	End With
	
	dtInvoiceDate=CDate(Dateadd("m",1,Date))
	'Set the invoiuce Date
	'dtInvoiceDate="06/12/2018"
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceDate")
	If .Exist(nMINWAIT) Then
	.Set dtInvoiceDate
	Call WriteToReport(micPass, "InvoiceDate="&dtInvoiceDate,"is displayed",False)
	End If
	End With
	
	'Enter the Supplier IDF
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID")
	If .Exist(nMINWAIT) Then
		.Set dtSupplierId
	End If
	End  With
	
	'ENter the PO details 
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("POUnit")
	If .Exist(nMINWAIT) Then
	.Set dtPOUnit
	Call WriteToReport(micPass, "POUnit="&dtPOUnit,"is displayed",False)
	End If
	End  WIth 
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").Image("RegEntry_PONumLookUp")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With 
	
	'Get one PO from the lst
	With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("lookUpPONumberForm").WebTable("PONumber")
	If .Exist(nMINWAIT) Then
		If .RowCount>1 Then
			appPoNumber=.GetCellData(2,1)
			Set oLink=.ChildItem(2,1,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Reporter.ReportEvent micPass,"The Po Number","selected is"&appPoNumber
			End If
			Set oLink=Nothing
		End If
	End If
	End  With 


	'CLickon COPY PO
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("CopyPO")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  WIth 
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("RegEntry_LineAmount")
	If .Exist(nMINWAIT) Then
	GlobalDictionary("TotalAmountfromApp")=.GetROProperty("innertext")
	End If
	End  WIth
	
	'COpy the amount froim the Line amout and enter in the Total
	
	TotalAmountFromApp=Cdbl(GlobalDictionary("TotalAmountfromApp"))
	'Enter the amount in the total
	WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total")
	If .Exist(nMINWAIT) Then
	.Set TotalAmountFromApp
	Reporter.ReportEvent micPass,"The Total Amount from the App","is"&TotalAmountFromApp
	End If
	End  With 
	
	'Click on Save button
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Save")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  WIth 
	
	End Function

'**********************************************************************************************************************************************************
''' <summary>  
''' AddRegularVoucherWithFreightCharges() To add Regular Voucher w/ Freight or Misc. Charges  				
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, invoiceNo, InvoiceDate, dtSupplierID, LineAmount, AccountNumber,Dept,AdditionalComments,TotalAmount,FreightAmount,MiscAmount"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>10/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Voucher submitted and approved</endstate>
'Change Control: 
'   Date of Change          Author                Description of change
'   11/12/2018				Keerthana			Updated for OR changes in Peoplesoft

'================================================================================================================
'2.2.6
'================================================================================================================
Public Function AddRegularVoucherWithFreightCharges()
'Navigate to Accounts Payable -> Vouchers -> Add Update -> Regular entry
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Declarring the variables:- 
dtBusinessUnit=GlobalDictionary("BusinessUnit")
dtinvoiceNo=GlobalDictionary("invoiceNo") &inVoiceNumberGeneration
dtInvoiceDate=GlobalDictionary("InvoiceDate")
dtSupplierID=GlobalDictionary("dtSupplierID")
dtLineAmount=GlobalDictionary("LineAmount")
dtAccountNumber=GlobalDictionary("AccountNumber")
dtDept=GlobalDictionary("Dept")
dtAdditionalComments=GlobalDictionary("AdditionalComments")
dtTotalAmount=GlobalDictionary("TotalAmount")
dtFreight=GlobalDictionary("FreightAmount")
dtMiscellaus=GlobalDictionary("MiscAmount")



'Enter the BusinessUnit anrd and voucher ID and click on Add button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is not present" ,True)
End If
End WIth 

'Clickon Add Button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Add Button is clicked", "and able to process tonext page",False)
	Else
	Call WriteToReport(micPass,"Add Button is cnot present", "and not able to process tonext page",True)
End If
End WIth

'wait for the applicaiton to load
Browser("PeopleSoft Browser").Sync
 
 'Set the values in Invoice
 With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceNo")
 If .Exist(nMINWAIT) Then
 	.Set dtinvoiceNo
 	Call WriteToReport(micPass, "InvoiceNo=" &dtinvoiceNo,"is displayed",False)
 End If
End With

'Set the invoiuce Date
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceDate")
If .Exist(nMINWAIT) Then
	.Set dtInvoiceDate
	Call WriteToReport(micPass, "InvoiceDate=" &dtInvoiceDate,"is displayed",False)
End If
End With

'Enter the Supplier IDF
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID")
If .Exist(nMINWAIT) Then
	.Set dtSupplierID
	Call WriteToReport(micPass, "SupplierID=" &dtSupplierID,"is displayed",False)
End If
End With 

'ENte the Total Amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total")
If .Exist(nMINWAIT) Then
	.Set dtTotalAmount
	Call WriteToReport(micPass, "TotalAmount=" &dtTotalAmount,"is displayed",False)
End If
End With

'ENter the Friedhgt amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("freight")
If .Exist(nMINWAIT) Then
	.Set dtFreight
	Call WriteToReport(micPass, "Freight=" &dtFreight,"is displayed",False)
End If
End With 

'Enter Misc amount
WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("MiscellaousAmount")
If .Exist(nMINWAIT) Then
	.Set dtMiscellaus
	Call WriteToReport(micPass, "Miscellaus=" &dtMiscellaus,"is displayed",False)
End If
End WIth


'Enter the Line amount
dtLineAmount="88.00"
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("LineAmount")
If .Exist(nMINWAIT) Then
	.Set dtLineAmount
	Call WriteToReport(micPass, "LineAmount=" &dtLineAmount,"is displayed",False)
End If
End With

'Ente the details in Account and Depty
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Account")
If .Exist(nMINWAIT) Then
	.Set dtAccountNumber
	Call WriteToReport(micPass, "AccountNumber=" &dtAccountNumber,"is displayed",False)
End If
End With

'Enter the Dept ID number
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Dept")
If .Exist(nMINWAIT) Then
	.Set dtDept
	Call WriteToReport(micPass, "Dept=" &dtDept,"is displayed",False)
End If
End With

'Click on Save button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Save Button is clicked", "and able to process the changes",False)
	Else
	Call WriteToReport(micFail,"Save Button is not clicked", "and not able to process the changes",False)
End If
End With

'CLick on Ok button if exists
With Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
	'Call WriteToReport(micFail,"Error message is displayed", "Correct the errors and click on save button",True)
	'ExitTest
	Else
	Call WriteToReport(micPass,"No error message displayed", "and changfes are saved sucessfully",False)
End If
End With

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("RegEntry_labelValueVOUCHER_ID")
If .Exist(nMINWAIT) Then
	vocherID=.GetROProperty("innertext")
	Call WriteToReport(micPass,"Voucher ID"&vocherID,"",False)
	Else
	Call WriteToReport(micFail,"Voucher ID","is not present",True)
End If
End With

'CLick on VOucher Attribute pagfe
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("VoucherAttribute")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"),"is clicked and navigated to next page",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"),"is not present",True)
End If
End With

'Click on SUbmit for Approcal page
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SubmitForApproval_VoucherAttribute")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"),"is clicked and navigated to next page",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"),"is not present",True)
End If
End With

'Ente trth addition details adn click on Ok button

dtAdditionalComments=(GlobalDictionary("Comments"))
With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("ApprovalComments_VoucherAttribute").WebEdit("AdditionalComments")
If .Exist(nMINWAIT) Then
	.Set dtAdditionalComments
	Call WriteToReport(micPass,""&.GetROProperty("innertext"),"is present and set with"&.GetROProperty("value"),False)
End If
End With


'CLick on Ok button
With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("ApprovalComments_VoucherAttribute").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

'Click on Ok button
With Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
	'Call WriteToReport(micFail,"Error message is displayed", "Correct the errors and click on save button",True)
	'ExitTest
	Else
	Call WriteToReport(micPass,"No error message displayed", "and changfes are saved sucessfully",False)
End If
End With

AddRegularVoucherWithFreightCharges=vocherID

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'2.2.7

Public Function AddRegularVoucherWithoutMiscCharges()
'Navigate to Accounts Payable -> Vouchers -> Add Update -> Regular entry
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Declarring the variables:- 
dtBusinessUnit=GlobalDictionary("BusinessUnit")
dtinvoiceNo=GlobalDictionary("invoiceNo") & inVoiceNumberGeneration' & Day (Date)
dtInvoiceDate=GlobalDictionary("InvoiceDate")
dtSupplierID=GlobalDictionary("dtSupplierID")
dtLineAmount=GlobalDictionary("LineAmount")
dtAccountNumber=GlobalDictionary("AccountNumber")
dtDept=GlobalDictionary("Dept")
dtAdditionalComments=GlobalDictionary("AdditionalComments")
dtTotalAmount=GlobalDictionary("TotalAmount")
dtFreight=GlobalDictionary("FreightAmount")
dtMiscellaus=GlobalDictionary("MiscAmount")


'Enter the BusinessUnit anrd and voucher ID and click on Add button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is not present" ,True)
End If
End WIth 

'Clickon Add Button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Add Button is clicked", "and able to process tonext page",False)
	Else
	Call WriteToReport(micPass,"Add Button is cnot present", "and not able to process tonext page",True)
End If
End WIth

'wait for the applicaiton to load
Browser("PeopleSoft Browser").Sync
 
 'Set the values in Invoice
 With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceNo")
 If .Exist(nMINWAIT) Then
 	.Set dtinvoiceNo '& inVoiceNumberGeneration' & Day(Date)
 	Call WriteToReport(micPass, "Invoice number=" &dtinvoiceNo & inVoiceNumberGeneration,"is displayed",False)
 End If
End With

'Set the invoiuce Date
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceDate")
If .Exist(nMINWAIT) Then
	.Set dtInvoiceDate
	Call WriteToReport(micPass, "Invoice Date=" &dtInvoiceDate,"is displayed",False)
End If
End With

'Enter the Supplier IDF
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID")
If .Exist(nMINWAIT) Then
	.Set dtSupplierID
	Call WriteToReport(micPass, "SupplierID=" &dtSupplierID,"is displayed",False)
End If
End With 

'ENte the Total Amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total")
If .Exist(nMINWAIT) Then
	.Set dtTotalAmount
	Call WriteToReport(micPass, "TotalAmount=" &dtTotalAmount,"is displayed",False)
End If
End With

'Enter the Line amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("LineAmount")
If .Exist(nMINWAIT) Then
	.Set dtLineAmount
	Call WriteToReport(micPass, "LineAmount=" &dtLineAmount,"is displayed",False)
End If
End With

'Ente the details in Account and Depty
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Account")
If .Exist(nMINWAIT) Then
	.Set dtAccountNumber
	Call WriteToReport(micPass, "AccountNumber=" &dtAccountNumber,"is displayed",False)
End If
End With

'Enter the Dept ID number
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Dept")
If .Exist(nMINWAIT) Then
	.Set dtDept
	Call WriteToReport(micPass, "Dept=" &dtDept,"is displayed",False)
End If
End With

'Click on Save button
'Click on Save button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Save Button is clicked", "and able to process the changes",False)
	Else
	Call WriteToReport(micFail,"Save Button is not clicked", "and not able to process the changes",False)
End If
End With

'CLick on Ok button if exists
With Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
	'Call WriteToReport(micFail,"Error message is displayed", "Correct the errors and click on save button",True)
	'ExitTest
	Else
	Call WriteToReport(micPass,"No error message displayed", "and changfes are saved sucessfully",False)
End If
End With

'CLick on VOucher Attribute pagfe
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("VoucherAttribute")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"),"is clicked and navigated to next page",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"),"is not present",True)
End If
End With

'Click on SUbmit for Approcal page
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SubmitForApproval_VoucherAttribute")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"),"is clicked and navigated to next page",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"),"is not present",True)
End If
End With

'Ente trth addition details adn click on Ok button

dtAdditionalComments=(GlobalDictionary("Comments"))
With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("ApprovalComments_VoucherAttribute").WebEdit("AdditionalComments")
If .Exist(nMINWAIT) Then
	.Set dtAdditionalComments
	Call WriteToReport(micPass,""&.GetROProperty("innertext"),"is present and set with"&.GetROProperty("value"),False)
End If
End With



'CLick on Ok button
With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("ApprovalComments_VoucherAttribute").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

'Click on Ok button
With Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
	'Call WriteToReport(micFail,"Error message is displayed", "Correct the errors and click on save button",True)
	'ExitTest
	Else
	Call WriteToReport(micPass,"No error message displayed", "and changfes are saved sucessfully",False)
End If
End With	
End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


Public Function AddRegularPOMultiLineVoucher()
'Navigate to Accounts Payable -> Vouchers -> Add Update -> Regular entry
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'INitialize variable
dtSupplierId=GlobalDictionary("SupplierId")
dtBusinessUnit=GlobalDictionary("BusinessUnit")
dtGrossAmount=GlobalDictionary("dtGrossAmount")
dtClassification=GlobalDictionary("Classification")
dtinvoiceNo=GlobalDictionary("invoiceNo")
dtInvoiceDate=GlobalDictionary("InvoiceDate")
dtAccountNumber=GlobalDictionary("AccountNumber")
dtDept=GlobalDictionary("Dept")
dtCopyFrom=GlobalDictionary("CopyFrom")
dtPOUNit=GlobalDictionary("POUnit")
dtPONUmber=GlobalDictionary("PONumber")
dtDeptLine2=GlobalDictionary("DeptLine2")
dtLineAmount=GlobalDictionary("LineAmount")
dtMerchnAmt=GlobalDictionary("MerchnAmt")
dtAccountLine2=GlobalDictionary("AccountLine2")

'Enter the BusinessUnit anrd and voucher ID and click on Add button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present" ,True)
End If
End WIth 

'ENte the Supplier ID and Inoice Amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SuuplierId_AddValue")
If .Exist(nMINWAIT) Then
	.Set dtSupplierId
	Call WriteToReport(micPass, "SupplierId=" &dtSupplierId,"is displayed",False)
End If
End WIth	

'Enter the Invoiuce Number
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("InvoiceNumber_AddNewValue")
If .Exist(nMINWAIT) Then
	.Set dtinvoiceNo & inVoiceNumberGeneration' & Day(Date)
	Call WriteToReport(micPass, "Invoice No=" &dtinvoiceNo,"is displayed",False)
End If
End WIth

''Enter Invocie Date
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("InvoiceDate_AddNewValue")
If .Exist(nMINWAIT) Then
	.Set dtInvoiceDate
	Call WriteToReport(micPass, "InvoiceDate=" &dtInvoiceDate,"is displayed",False)
End If
End WIth

'CLick on Add Button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is cliced and navigated to next page",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present and not able to navigate to next page" ,True)
End If
End With 

'wAITfro the application sync
Browser("PeopleSoft Browser").Page("Regular Entry").Sync

'Select the PO only option
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebList("CopyFrom")
If .Exist(nMINWAIT) Then
	.Select dtCopyFrom
End If
End With 

'Enter the PO unit and PO number
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("POUnit")
If .Exist(nMINWAIT) Then
	.Set dtPOUNit
	Call WriteToReport(micPass, "POUNit=" &dtPOUNit,"is displayed",False)
End If
End With 

'CLick on Search button fro getting po number
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")                    
                                If .WebList("CopyFrom").Exist(nMINWAIT) Then
                                                .WebList("CopyFrom").Select dtCopyFrom
                                                Call WriteToReport(micPass,"CopyFrom","is present and selected "&CopyFrom,false)
                                                else
                                                Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
                                End If
                                
                                If .Link("Go").Exist(nMINWAIT) Then
'                                               wait(3)
                                                .Link("Go").Click
                                                Call WriteToReport(micPass,"go link ","is present and clicked",false)
                                                else
                                                Call WriteToReport(micFail,"Go link","is not present",True)
                                End If
                                
                                If .WebEdit("POBusinessUnit").Exist(nMINWAIT) Then
                                                .WebEdit("POBusinessUnit").Set dtBusinessUnit
                                                Call WriteToReport(micPass,"POBusinessUnit ","is present and entered as"&businessunit,false)
                                                else
                                                Call WriteToReport(micFail,"POBusinessUnit","is not present",True)
                                End If
                End with              
                                If NOT IsEmpty(PONumberfrom) AND PONumberfrom<>"" Then
                                                If  PONumberfrom>0  Then
                                                                If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PONumberFrom").Exist(nMINWAIT) Then
                                                                                Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PONumberFrom").Set PONumberFrom
                                                                                Call WriteToReport(micPass,"PONumberFrom ","is present and entered as"&PONumberFrom,false)
                                                                                temp=2
                                                                                else
                                                                                Call WriteToReport(micFail,"PONumberFrom","is not present",True)
                                                                End If
                                                End If
                                else
                                                with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")    
                                
                                                                If .WebButton("PONumberLookup").Exist(nMINWAIT) Then
                                                                                .WebButton("PONumberLookup").Click
                                                                End If
                                                End with              
                                                                
                                                app_SearchSync()'wait(4)
                                                
                                                If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").Exist(nMINWAIT) Then
                                                                If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").RowCount))>1 Then
                                                                                PONumberFrom=Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").GetCellData(2,2)
                                                                                Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").ChildItem(2,1,"Link",0).click
                                                                                temp=2
                                                                                Call WriteToReport(micPass,"PO number seletced","Selecetd PO number is "&PONumberFrom,True)
                                                                else
                                                                                Call WriteToReport(micFail,"invoices for "&businessunit&","&supplierID ,"is not present",True)
                                                                End If
                                                End If
                                                
                                End If
                                with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")    
                
                                If .WebButton("CopyEntireDocument").Exist(nMINWAIT) Then
                                                .WebButton("CopyEntireDocument").Click
                                                Call WriteToReport(micPass,"CopyEntireDocument","is present and clicked",false)
                                                else
                                                Call WriteToReport(micFail,"CopyEntireDocument","is not present",True)
                                End If
                                end with



 

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("LineAmount")
If .Exist(nMINWAIT) Then
	appLineAmount=.GetROProperty("value")
End If
End  With

 
'Ente th Header amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total")
If .Exist(nMINWAIT) Then
	.Set appLineAmount
	Call WriteToReport(micPass, "Total=" &dtLineAmount,"is displayed",False)
End If
End With 

'CLickon Canclulate button
WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Calculate")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'CLickon + button 
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("AddInvoiceLine")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

With Browser("PeopleSoft Browser").Dialog("NoofRowsToAdd").WinEdit("NoOfRows")
If .Exist(nMINWAIT) Then
	.Set "1"
End If
End With

With Browser("PeopleSoft Browser").Dialog("NoofRowsToAdd").WinButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

dtLineAmount2=(GlobalDictionary("dtLineAmount2"))
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("RegularEntry_LineInvoice2")
If .Exist(nMINWAIT) Then
	.Set dtLineAmount2
End If
End With

'Add the line amout value with the Total
CurrentTotalAmt=Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total").GetROProperty("value")
TotalAmountafterlineAmount=cdbl(CurrentTotalAmt)+cdbl(dtLineAmount2)

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total")
	If .Exist(nMINWAIT) Then
		.Set TotalAmountafterlineAmount
	End If
End With

'CLickon Canclulate button
WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Calculate")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

dtAccountLine2=Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Account").GetROProperty("value")
dtDeptLine2=Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Dept").GetROProperty("value")

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("AccountLine2")
If .Exist(nMINWAIT) Then
	.Set dtAccountLine2
	Call WriteToReport(micPass, "AccountLine2=" &dtAccountLine2,"is displayed",False)
End If
End With 

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("DeptLine2")
If .Exist(nMINWAIT) Then
	.Set dtDeptLine2
	Call WriteToReport(micPass, "DeptLine2=" &dtDeptLine2,"is displayed",False)
End If
End With 

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("MerchandiseAmt_LIne2")
If .Exist(nMINWAIT) Then
	.Set dtLineAmount2
	Call WriteToReport(micPass, "Merchandise Amt=" &dtMerchnAmt,"is displayed",False)
End If
End With


'CLick on Save button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is cliced and changes are saved",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present" ,True)
End If
End With 

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


Public Function AddRegularVoucherWithFreightMiscST()
'Navigate to Accounts Payable -> Vouchers -> Add Update -> Regular entry
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'INitialize variable
dtSupplierId=GlobalDictionary("SupplierId")
dtBusinessUnit=GlobalDictionary("BusinessUnit")
dtGrossAmount=GlobalDictionary("dtGrossAmount")
dtClassification=GlobalDictionary("Classification")
dtinvoiceNo=GlobalDictionary("invoiceNo") & inVoiceNumberGeneration' & Day (Date)
dtInvoiceDate=GlobalDictionary("InvoiceDate")
dtAccountNumber=GlobalDictionary("AccountNumber")
dtDept=GlobalDictionary("Dept")
dtCopyFrom=GlobalDictionary("CopyFrom")
dtPOUNit=GlobalDictionary("POUnit")
dtPONUmber=GlobalDictionary("PONumber")
dtDeptLine2=GlobalDictionary("DeptLine2")
dtLineAmount=GlobalDictionary("LineAmount")
dtMerchnAmt=GlobalDictionary("MerchnAmt")
dtAccountLine2=GlobalDictionary("AccountLine2")
dtPONumberFrom=GlobalDictionary("PONumberFro")
dtPOOptoinDate=GlobalDictionary("POOptoinDate")
dtMaxrows=GlobalDictionary("Maxrows")


'Enter the BusinessUnit anrd and voucher ID and click on Add button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present" ,True)
End If
End WIth 

'ENte the Supplier ID and Inoice Amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SuuplierId_AddValue")
If .Exist(nMINWAIT) Then
	.Set dtSupplierId
	Call WriteToReport(micPass, "SupplierId=" &dtSupplierId,"is displayed",False)
End If
End WIth	

'Enter the Invoiuce Number
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("InvoiceNumber_AddNewValue")
If .Exist(nMINWAIT) Then
	.Set dtinvoiceNo
	Call WriteToReport(micPass, "InvoiceNo=" &dtinvoiceNo,"is displayed",False)
End If
End WIth

''Enter Invocie Date
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("InvoiceDate_AddNewValue")
If .Exist(nMINWAIT) Then
	.Set dtInvoiceDate
	Call WriteToReport(micPass, "InvoiceDate=" &dtInvoiceDate,"is displayed",False)
End If
End WIth

'CLick on Add Button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is cliced and navigated to next page",False)
	Else
	Call WriteToReport(micFail,""&.GetROProperty("innertext"), "is not present and not able to navigate to next page" ,True)
End If
End With 

'wAITfro the application sync
Browser("PeopleSoft Browser").Sync

'Select the PO only option
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebList("CopyFrom")
If .Exist(nMINWAIT) Then
	.Select dtCopyFrom
End If
End With 	

'Enter the PO unit and PO number
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("POUnit")
If .Exist(nMINWAIT) Then
	.Set dtPOUNit
	Call WriteToReport(micPass, "dtPOUNit=" &dtPOUNit,"is displayed",False)
End If
End With 

'CLick on Search button fro getting po number
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")                    
                                If .WebList("CopyFrom").Exist(nMINWAIT) Then
                                                .WebList("CopyFrom").Select dtCopyFrom
                                                Call WriteToReport(micPass,"CopyFrom","is present and selected "&CopyFrom,false)
                                                else
                                                Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
                                End If
                                
                                If .Link("Go").Exist(nMINWAIT) Then
'                                               wait(3)
                                                .Link("Go").Click
                                                Call WriteToReport(micPass,"go link ","is present and clicked",false)
                                                else
                                                Call WriteToReport(micFail,"Go link","is not present",True)
                                End If
                                
                                If .WebEdit("POBusinessUnit").Exist(nMINWAIT) Then
                                                .WebEdit("POBusinessUnit").Set dtBusinessUnit
                                                Call WriteToReport(micPass,"POBusinessUnit ","is present and entered as"&businessunit,false)
                                                else
                                                Call WriteToReport(micFail,"POBusinessUnit","is not present",True)
                                End If
                End with              
                                If NOT IsEmpty(PONumberfrom) AND PONumberfrom<>"" Then
                                                If  PONumberfrom>0  Then
                                                                If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PONumberFrom").Exist(nMINWAIT) Then
                                                                                Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PONumberFrom").Set PONumberFrom
                                                                                Call WriteToReport(micPass,"PONumberFrom ","is present and entered as"&PONumberFrom,false)
                                                                                temp=2
                                                                                else
                                                                                Call WriteToReport(micFail,"PONumberFrom","is not present",True)
                                                                End If
                                                End If
                                else
                                                with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")    
                                
                                                                If .WebButton("PONumberLookup").Exist(nMINWAIT) Then
                                                                                .WebButton("PONumberLookup").Click
                                                                End If
                                                End with              
                                                                
                                                app_SearchSync()'wait(4)
                                                
                                                If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").Exist(nMINWAIT) Then
                                                                If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").RowCount))>1 Then
                                                                                PONumberFrom=Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").GetCellData(2,2)
                                                                                Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").ChildItem(2,1,"Link",0).click
                                                                                temp=2
                                                                                Call WriteToReport(micPass,"PO number seletced","Selecetd PO number is "&PONumberFrom,True)
                                                                else
                                                                                Call WriteToReport(micFail,"invoices for "&businessunit&","&supplierID ,"is not present",True)
                                                                End If
                                                End If
                                                
                                End If
                                with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")    
                
                                If .WebButton("CopyEntireDocument").Exist(nMINWAIT) Then
                                                .WebButton("CopyEntireDocument").Click
                                                Call WriteToReport(micPass,"CopyEntireDocument","is present and clicked",false)
                                                else
                                                Call WriteToReport(micFail,"CopyEntireDocument","is not present",True)
                                End If
                                end with 

'Wait for the application to sync
Browser("PeopleSoft Browser").Sync

'COpy the Line amount fromt he Line amount field
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("LineAmount")
appLineAmount=.GetROProperty("value")
GlobalDictionary("LineAmount")=appLineAmount
End With 

'Enter the Toal amount same as Line amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total")
If .Exist(nMINWAIT) Then
	.Set (GlobalDictionary("LineAmount"))
	Call WriteToReport(micPass, "Total=" &(GlobalDictionary("LineAmount")),"is displayed",False)
End If
End With 

'CLick on Calculate buttoin
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Calculate")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'Wait for the app to sync
Browser("PeopleSoft Browser").Sync

'Check forht eDifference amount
dtColumn="Difference"
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebTable("LineAmountTable")
If .Exist(NMINWAIT) Then
	For i=21 to .RowCount
		appDifferenceColumn=.GetCellData(i,2)
		If (dtColumn=appDifferenceColumn) Then
			appDifferenceValue=.GetCellData(i+1,2)
			If appDifferenceValue="0.00" Then
			Call WriteToReport(micPass,"The difference is zero", "and the amout is matching",False)
			Else
			Call WriteToReport(micFail,"The amount is not zero", "and is not matching" ,True)	
			End If
		End If
	Next
End If
End With 

'Enter the Freight amount
dtFreightAmount=(GlobalDictionary("FreightAmount"))
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("freight")
If .Exist(nMINWAIT) Then
	.Set dtFreightAmount
	Call WriteToReport(micPass, "FreightAmount=" &dtFreightAmount,"is displayed",False)
End If
End With 

'Reenter the Total amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total")
If .Exist(nMINWAIT) Then
	.Set (cdbl(GlobalDictionary("LineAmount")) + cdbl(dtFreightAmount))
	Call WriteToReport(micPass, "Total=" &(cdbl(GlobalDictionary("LineAmount")) + cdbl(dtFreightAmount)),"is displayed",False)
	wait(2)
	appcurrentTotalAmount=.GetROProperty("value")
	GlobalDictionary("CurrentTotalAmount")=appcurrentTotalAmount
End If
End With 

'CLick on Calculate buttoin
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Calculate")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'Wait for the app to sync
Browser("PeopleSoft Browser").Sync

'Check forht eDifference amount
dtColumn="Difference"
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebTable("LineAmountTable")
If .Exist(NMINWAIT) Then
	For i=21 to .RowCount
		appDifferenceColumn=.GetCellData(i,2)
		If (dtColumn=appDifferenceColumn) Then
			appDifferenceValue=.GetCellData(i+1,2)
			If appDifferenceValue="0.00" Then
			Call WriteToReport(micPass,"The difference is zero", "after adding freight amount",False)
			Else
			Call WriteToReport(micFail,"The amount is not zero", "and is not matching after adding freight amount" ,True)	
			End If
		End If
	Next
End If
End With 

'Enter the Sales Tax
dtSalesTax=(GlobalDictionary("SalesTax"))
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SalesTax")
If .Exist(nMINWAIT) Then
	.Set dtSalesTax
	Call WriteToReport(micPass, "SalesTax=" &dtSalesTax,"dtSalesTax is displayed",False)
	
End If
End With 

'Reenter the Total amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total")
If .Exist(nMINWAIT) Then
	.Set (cdbl(GlobalDictionary("LineAmount")) + cdbl(dtFreightAmount) + cdbl(dtSalesTax))
	Call WriteToReport(micPass,"Total", "Total=" &(cdbl(GlobalDictionary("LineAmount")) + cdbl(dtFreightAmount) + cdbl(dtSalesTax)),False)
End If
End With 

'CLick on Calculate buttoin
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Calculate")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'Wait for the app to sync
Browser("PeopleSoft Browser").Sync

'Check forht eDifference amount
dtColumn="Difference"
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebTable("LineAmountTable")
If .Exist(NMINWAIT) Then
	For i=21 to .RowCount
		appDifferenceColumn=.GetCellData(i,2)
		If (dtColumn=appDifferenceColumn) Then
			appDifferenceValue=.GetCellData(i+1,2)
			If appDifferenceValue="0.00" Then
			Call WriteToReport(micPass,"The difference is zero", "and the amout is matching after adding sales tax",False)
			Else
			Call WriteToReport(micFail,"The amount is not zero", "and is not matching after adding sales tax" ,True)	
			End If
		End If
	Next
End If
End With 

'Enter the Distribution details
'Ente the details in Account and Depty

'CLick on Save button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Save button is clicked", "and able to sdave the changes ",False)
	Else
	Call WriteToReport(micFail,"Save button is not present", "and not abel to save the changes" ,True)	
End If
End With 

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


Public Function AddNonPOServRelPO()
'Navigate to Accounts Payable -> Vouchers -> Add Update -> Regular entry
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'INitialize variable
dtSupplierId=GlobalDictionary("SupplierId")
dtBusinessUnit=GlobalDictionary("BusinessUnit")
dtGrossAmount=GlobalDictionary("dtGrossAmount")
dtinvoiceNo=GlobalDictionary("invoiceNo") & inVoiceNumberGeneration' & Day (Date) 
dtInvoiceDate=GlobalDictionary("InvoiceDate")
dtAccountNumber=GlobalDictionary("AccountNumber")
dtDept=GlobalDictionary("Dept")

'Enter the BusinessUnit anrd and voucher ID and click on Add button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,"BusinessUnit", "is present and set with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micPass,"BusinessUnit", "is not present" ,True)
End If
End WIth 

'ENte the Supplier ID and Inoice Amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SuuplierId_AddValue")
If .Exist(nMINWAIT) Then
	.Set dtSupplierId
	Call WriteToReport(micPass, "SupplierId","SupplierId=" &dtSupplierId,False)
End If
End With

'EWnte the Gross Amount
'EWnte the Gross Amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("GrossInvoiceAmount")
If .Exist(nMINWAIT) Then
	.Set dtGrossAmount
	Call WriteToReport(micPass, "GrossAmount","GrossAmount=" &dtGrossAmount,False)
End If
End With

'Enter the Invocie Details
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("InvoiceNumber_AddNewValue")
If .Exist(nMINWAIT) Then
	.Set dtInvoiceNumber
	Call WriteToReport(micPass, "InvoiceNumber","InvoiceNumber=" &dtInvoiceNumber,False)
End If
End With 

WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("InvoiceDate_AddNewValue")
If .Exist(nMINWAIT) Then
	.Set dtInvoiceDate
	Call WriteToReport(micPass, "InvoiceDate","InvoiceDate=" &dtInvoiceDate,False)
End If
End With 

'Clickon Add Button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Add Button is clicked", "and able to process tonext page",False)
	Else
	Call WriteToReport(micPass,"Add Button is cnot present", "and not able to process tonext page",True)
End If
End WIth

'wait for the applicaiton to load
Browser("PeopleSoft Browser").Sync

'Ente the details in Account and Depty

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Account")
If .Exist(nMINWAIT) Then
	.Set dtAccountNumber
	Call WriteToReport(micPass, "AccountNumber","AccountNumber=" &dtAccountNumber,False)
End If
End With

'Enter the Dept ID number
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Dept")
If .Exist(nMINWAIT) Then
	.Set dtDept
	Call WriteToReport(micPass,"Dept", "Dept=" &dtDept,False)
End If
End With

'CLick on Save button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Save Button is clicked", "and able to process changes",False)
	Else
	Call WriteToReport(micPass,"Add Button is cnot present", "and not able to process changes",True)
End If
End WIth 

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


Public Function AddVoucherInvoice()
Dim voucherID,businessunit,invoiceID,approvalStatus,Dept,Account,unitPrice,Quantity,freight,Total,supplierID,invoiceDate,appinvoiceNo

	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo") 
	invoiceDate=GlobalDictionary("invoiceDate")
	supplierID=GlobalDictionary("SupplierID")
	Total=GlobalDictionary("Total")
	freight=GlobalDictionary("freight")
	Quantity=GlobalDictionary("Quantity")
	unitPrice=GlobalDictionary("UnitPrice")
	Account=GlobalDictionary("Account")
	Dept=GlobalDictionary("Dept")
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit ","is present and BU=" &businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id ","is present and voucherId=" &voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo & inVoiceNumberGeneration' & Day(Date)
		Call WriteToReport(micPass,"invoiceNo ","is present=" &invoiceNo & inVoiceNumberGeneration,false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date ","is present=" &invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	

'CLick on the magnifying glass
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

'Click on the Supplier ID
With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID")
If .Exist(nMINWAIT) Then
	dtSupplierID=.GetCellData(2,1)
	GlobalDictionary("SupplierID")=dtSupplierID
	Set oLink=.ChildItem(2,1,"Link",0)
	If oLink.Exist(nMINWAIT) Then
		oLink.click
		Reporter.ReportEvent micPass,"The Supplier Selected","is"&dtSupplierID
	End If
	Set oLink=Nothing
End If
End  WIth
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		.WebEdit("Total").Set Total
		Call WriteToReport(micPass,"Total","is present="&Total,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebEdit("freight").Exist(nMINWAIT) Then
		.WebEdit("freight").Set freight
		Call WriteToReport(micPass,"freight","is present="&freight,false)
		else
		Call WriteToReport(micFail,"freight","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If .WebEdit("Quantity").Exist(nMINWAIT) Then
		.WebEdit("Quantity").Set Quantity
		Call WriteToReport(micPass,"Quantity","is present=" &Quantity,false)
		else
		Call WriteToReport(micFail,"Quantity","is not present",True)
	End If
	
	If .WebEdit("unitPrice").Exist(nMINWAIT) Then
		.WebEdit("unitPrice").Set unitPrice
		Call WriteToReport(micPass,"unitPrice","is present=" &unitPrice,false)
		else
		Call WriteToReport(micFail,"unitPrice","is not present",True)
	End If
	
	If .WebButton("CalculateInvoiceLine").Exist(nMINWAIT) Then
		.WebButton("CalculateInvoiceLine").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .WebEdit("Account").Exist(nMINWAIT) Then
		.WebEdit("Account").Set Account
		Call WriteToReport(micPass,"Account","is present="&Account,false)
		else
		Call WriteToReport(micFail,"Account","is not present",True)
	End If
	
	
	If .WebEdit("Dept").Exist(nMINWAIT) Then
		.WebEdit("Dept").Set Dept
		Call WriteToReport(micPass,"Dept","is present="&Dept,false)
		else
		Call WriteToReport(micFail,"Dept","is not present",True)
	End If
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK")
		if .Exist(5) Then
		Call WriteToReport(micFail,"Regular Entry Page","Alert Message Exists -Duplicate Voucher ID",True)
		.Click
		EndTest
		End if
	End With
	
'	If .WebElement("voucherID").Exist(nMINWAIT) Then
'		voucherID=.WebElement("voucherID").GetROProperty("innertext")
'	End If
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("VoucherAttribute")	

	If .Exist(10) Then
		 .Click
		 Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
	else
		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
	End If
	End WIth 
	
'	If .WebTabStrip("tabSelection").Exist(10) Then
'		.WebTabStrip("tabSelection").Select("Voucher Attributes")
'		Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
'	else
'		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
'	End If
	'Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceNo")

	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		appinvoiceNo=.WebEdit("invoiceNo").GetROProperty("value") 
		If StrComp(Trim(appinvoiceNo),trim(invoiceNo))=0 Then
			Call WriteToReport(micPass,"Voucher Attributes ","data is present",false)
		End If
	End If
	
	If .WebTabStrip("tabSelection").Exist(10) Then
		.WebTabStrip("tabSelection").Select("Invoice Information")
		Call WriteToReport(micPass,"Invoice Information tab","is present",false)
	else
		Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
	End If
	
	If .WebButton("SubmitApproval").Exist(nMINWAIT) Then
		.WebButton("SubmitApproval").Click
		Call WriteToReport(micPass,"SubmitApproval button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"SubmitApproval button in invoice information","is not present",True)
	End If
	
	
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Set voucherID&" is Approved"
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Click
	End If
	
	If .WebTabStrip("tabSelection").Exist(nMINWAIT) Then
		.WebTabStrip("tabSelection").Select("Summary")
		Call WriteToReport(micPass,"Summary tab","is present",false)
		else
		Call WriteToReport(micFail,"Summary tab","is not present",True)
	End If
	
	If .WebElement("approvalStatus").Exist(nMINWAIT) Then
		approvalStatus=.WebElement("approvalStatus").GetROProperty("innertext")
		If StrComp(approvalStatus,"Approved",1)=0 Then
			Call WriteToReport(micPass,"Approval status changed to Approved status","is present",false)
			else
			Call WriteToReport(micFail,"Approval status","doesn't chaged to Approved, Actual status is "&approvalStatus,True)
		End If
	End If


End with

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

Public Function AddVoucherFreigMisc()
Dim voucherID,businessunit,invoiceID,approvalStatus,Dept,Account,unitPrice,Quantity,freight,Total,supplierID,invoiceDate,appinvoiceNo

	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo")
	invoiceDate=GlobalDictionary("invoiceDate")
	supplierID=GlobalDictionary("SupplierID")
	
	freight=GlobalDictionary("freight")
	Quantity=GlobalDictionary("Quantity")
	unitPrice=GlobalDictionary("UnitPrice")
	Account=GlobalDictionary("Account")
	Dept=GlobalDictionary("Dept")
	Total=GlobalDictionary("Total")
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit ","is present=" &businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id ","is present=" &voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	dtinvoiceNumber=invoiceNo & inVoiceNumberGeneration
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set dtinvoiceNumber' & Day(Date)
		Call WriteToReport(micPass,"invoiceNo ","is present=" &invoiceNo & inVoiceNumberGeneration,false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date ","is present=" &invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	
'CLick on the magnifying glass
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

'Click on the Supplier ID
With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID")
If .Exist(nMINWAIT) Then
	supplierID=.GetCellData(2,1)
	GlobalDictionary("SupplierID")=supplierID
	Set oLink=.ChildItem(2,1,"Link",0)
	If oLink.Exist(nMINWAIT) Then
		oLink.click
		Reporter.ReportEvent micPass,"The Supplier Selected","is"&supplierID
	End If
	Set oLink=Nothing
End If
End  WIth
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		.WebEdit("Total").Set Total
		Call WriteToReport(micPass,"Total","is present=" &Total,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebEdit("freight").Exist(nMINWAIT) Then
		.WebEdit("freight").Set freight
		Call WriteToReport(micPass,"freight","is present=" &freight,false)
		else
		Call WriteToReport(micFail,"freight","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If .WebEdit("Quantity").Exist(nMINWAIT) Then
		.WebEdit("Quantity").Set Quantity
		Call WriteToReport(micPass,"Quantity","is present=" &Quantity,false)
		else
		Call WriteToReport(micFail,"Quantity","is not present",True)
	End If
	
	If .WebEdit("unitPrice").Exist(nMINWAIT) Then
		.WebEdit("unitPrice").Set unitPrice
		Call WriteToReport(micPass,"unitPrice","is present=" &unitPrice,false)
		else
		Call WriteToReport(micFail,"unitPrice","is not present",True)
	End If
	
	If .WebButton("CalculateInvoiceLine").Exist(nMINWAIT) Then
		.WebButton("CalculateInvoiceLine").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .WebEdit("Account").Exist(nMINWAIT) Then
		.WebEdit("Account").Set Account
		Call WriteToReport(micPass,"Account","is present=" &Account,false)
		else
		Call WriteToReport(micFail,"Account","is not present",True)
	End If
	
	
	If .WebEdit("Dept").Exist(nMINWAIT) Then
		.WebEdit("Dept").Set Dept
		Call WriteToReport(micPass,"Dept","is present=" &Dept,false)
		else
		Call WriteToReport(micFail,"Dept","is not present",True)
	End If
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").WebElement("PeolpleSoft_AlertMessage")
'		if .Exist(5) Then
'		Call WriteToReport(micFail,"Regular Entry Page","Alert Message Exists -Duplicate Voucher ID",True)
'		EndTest
'		End if
'	End With
	
'	If .WebElement("voucherID").Exist(nMINWAIT) Then
'		voucherID=.WebElement("voucherID").GetROProperty("innertext")
'	End If
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("VoucherAttribute")

		
	If .Exist(10) Then
		.Click
		 Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
	else
		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
	End If
	End WIth 
	
'	If .WebTabStrip("tabSelection").Exist(10) Then
'		.WebTabStrip("tabSelection").Select("Voucher Attributes")
'		Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
'	else
'		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
'	End If
	
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		appinvoiceNo=.WebEdit("invoiceNo").GetROProperty("value") 
		If StrComp(Trim(appinvoiceNo),trim(dtinvoiceNumber))=0 Then
			Call WriteToReport(micPass,"Voucher Attributes ","data is present",false)
		End If
	End If
	
	If .WebTabStrip("tabSelection").Exist(10) Then
		.WebTabStrip("tabSelection").Select("Invoice Information")
		Call WriteToReport(micPass,"Invoice Information tab","is present",false)
	else
		Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
	End If
	
	If .WebButton("SubmitApproval").Exist(nMINWAIT) Then
		.WebButton("SubmitApproval").Click
		Call WriteToReport(micPass,"SubmitApproval button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"SubmitApproval button in invoice information","is not present",True)
	End If
	
	
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Set voucherID&" is Approved"
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Click
	End If
	
	If .WebTabStrip("tabSelection").Exist(nMINWAIT) Then
		.WebTabStrip("tabSelection").Select("Summary")
		Call WriteToReport(micPass,"Summary tab","is present",false)
		else
		Call WriteToReport(micFail,"Summary tab","is not present",True)
	End If
	
	If .WebElement("approvalStatus").Exist(nMINWAIT) Then
		approvalStatus=.WebElement("approvalStatus").GetROProperty("innertext")
		If StrComp(approvalStatus,"Approved",1)=0 Then
			Call WriteToReport(micPass,"Approval status changed to Approved status","is present",false)
			else
			Call WriteToReport(micFail,"Approval status","doesn't chaged to Approved, Actual status is "&approvalStatus,True)
		End If
	End If


End with

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucherID")
If .Exist(nMINWAIT) Then
	Reporter.ReportEvent micDone,"The VOucher ID","is"&.GetROProperty("innertext")
End If
End  With 

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


Public Function SupplierGreaterVx()
Dim voucherID,businessunit,invoiceID,approvalStatus,Dept,Account,unitPrice,Quantity,freight,Total,supplierID,invoiceDate,appinvoiceNo

	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo")
	invoiceDate=GlobalDictionary("invoiceDate")
	supplierID=GlobalDictionary("SupplierID")
	
	freight=GlobalDictionary("freight")
	Quantity=GlobalDictionary("Quantity")
	unitPrice=GlobalDictionary("UnitPrice")
	Account=GlobalDictionary("Account")
	Dept=GlobalDictionary("Dept")
	Total=GlobalDictionary("Total")
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit ","is present"&businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id ","is present"&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo & RandomNumberGeneraion & Day(Date)
		Call WriteToReport(micPass,"invoiceNo ","is present" &invoiceNo & RandomNumberGeneraion & Day(Date),false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date ","is present" &invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	
	If .WebEdit("SupplierID").Exist(nMINWAIT) Then
		.WebEdit("SupplierID").Set supplierID
		Call WriteToReport(micPass,"Supplier ID","is present" &supplierID,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		.WebEdit("Total").Set Total
		Call WriteToReport(micPass,"Total","is present",false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebEdit("freight").Exist(nMINWAIT) Then
		.WebEdit("freight").Set freight
		Call WriteToReport(micPass,"freight","is present=" &freight,false)
		else
		Call WriteToReport(micFail,"freight","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If .WebEdit("Quantity").Exist(nMINWAIT) Then
		.WebEdit("Quantity").Set Quantity
		Call WriteToReport(micPass,"Quantity","is present="&Quantity,false)
		else
		Call WriteToReport(micFail,"Quantity","is not present",True)
	End If
	
	If .WebEdit("unitPrice").Exist(nMINWAIT) Then
		.WebEdit("unitPrice").Set unitPrice
		Call WriteToReport(micPass,"unitPrice","is present="&unitPrice,false)
		else
		Call WriteToReport(micFail,"unitPrice","is not present",True)
	End If
	
	If .WebButton("CalculateInvoiceLine").Exist(nMINWAIT) Then
		.WebButton("CalculateInvoiceLine").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .WebEdit("Account").Exist(nMINWAIT) Then
		.WebEdit("Account").Set Account
		Call WriteToReport(micPass,"Account","is present="&Account,false)
		else
		Call WriteToReport(micFail,"Account","is not present",True)
	End If
	
	
	If .WebEdit("Dept").Exist(nMINWAIT) Then
		.WebEdit("Dept").Set Dept
		Call WriteToReport(micPass,"Dept","is present=" &Dept,false)
		else
		Call WriteToReport(micFail,"Dept","is not present",True)
	End If
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").WebElement("PeolpleSoft_AlertMessage")
'		if .Exist(5) Then
'		Call WriteToReport(micFail,"Regular Entry Page","Alert Message Exists -Duplicate Voucher ID",True)
'		EndTest
'		End if
'	End With
'	
'	If .WebElement("voucherID").Exist(nMINWAIT) Then
'		voucherID=.WebElement("voucherID").GetROProperty("innertext")
'	End If
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("VoucherAttribute")

	If .Exist(10) Then
		 .Click
		 Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
	else
		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
	End If
	End WIth 
	
'	If .WebTabStrip("tabSelection").Exist(10) Then
'		.WebTabStrip("tabSelection").Select("Voucher Attributes")
'		Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
'	else
'		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
'	End If
	
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		appinvoiceNo=.WebEdit("invoiceNo").GetROProperty("value") 
		If StrComp(Trim(appinvoiceNo),trim(invoiceNo))=0 Then
			Call WriteToReport(micPass,"Voucher Attributes ","data is present=" &appinvoiceNo,false)

		End If
	End If
	
	If .WebTabStrip("tabSelection").Exist(10) Then
		.WebTabStrip("tabSelection").Select("Invoice Information")
		Call WriteToReport(micPass,"Invoice Information tab","is present",false)
	else
		Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
	End If
	
	If .WebButton("SubmitApproval").Exist(nMINWAIT) Then
		.WebButton("SubmitApproval").Click
		Call WriteToReport(micPass,"SubmitApproval button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"SubmitApproval button in invoice information","is not present",True)
	End If
	
	
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Set voucherID&" is Approved"
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Click
	End If
	
	If .WebTabStrip("tabSelection").Exist(nMINWAIT) Then
		.WebTabStrip("tabSelection").Select("Summary")
		Call WriteToReport(micPass,"Summary tab","is present",false)
		else
		Call WriteToReport(micFail,"Summary tab","is not present",True)
	End If
	
	If .WebElement("approvalStatus").Exist(nMINWAIT) Then
		approvalStatus=.WebElement("approvalStatus").GetROProperty("innertext")
		If StrComp(approvalStatus,"Approved",1)=0 Then
			Call WriteToReport(micPass,"Approval status changed to Approved status","is present",false)
			else
			Call WriteToReport(micFail,"Approval status","doesn't chaged to Approved, Actual status is "&approvalStatus,True)
		End If
	End If


End with

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

Public Function SupplierLessVertex()
Dim voucherID,businessunit,invoiceID,approvalStatus,Dept,Account,unitPrice,Quantity,freight,Total,supplierID,invoiceDate,appinvoiceNo

	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo")
	invoiceDate=GlobalDictionary("invoiceDate")
	supplierID=GlobalDictionary("SupplierID")
	
	freight=GlobalDictionary("freight")
	Quantity=GlobalDictionary("Quantity")
	unitPrice=GlobalDictionary("UnitPrice")
	Account=GlobalDictionary("Account")
	Dept=GlobalDictionary("Dept")
	Total=GlobalDictionary("Total")
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit ","is present and BU="&businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id ","is present and voucherID="&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo & RandomNumberGeneraion & Day(Date)
		Call WriteToReport(micPass,"invoiceNo ","is present and invoiceNo=" &invoiceNo & RandomNumberGeneraion & Day(Date),false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	

	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date ","is present and invoiceDate=" &invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	
	If .WebEdit("SupplierID").Exist(nMINWAIT) Then
		.WebEdit("SupplierID").Set supplierID
		Call WriteToReport(micPass,"Supplier ID","is present and supplierID="&supplierID,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		.WebEdit("Total").Set Total
		Call WriteToReport(micPass,"Total","is present="&Total,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebEdit("freight").Exist(nMINWAIT) Then
		.WebEdit("freight").Set freight
		Call WriteToReport(micPass,"freight","is present="&freight,false)
		else
		Call WriteToReport(micFail,"freight","is not present",True)
	End If
	
	'ENter sales tax
	dtSalesTax=(GlobalDictionary("SalesTax"))
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SalesTax")
	If .Exist(nMINWAIT) Then
		.Set dtSalesTax
	End If
	End WIth 
	
	'EMNter oine amount
	dtLineAmount=(GlobalDictionary("LineAmount"))
	WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("LineAmount")
	If .Exist(nMINWAIT) Then
		.Set dtLineAmount
	End If
	End With 


	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If .WebEdit("Quantity").Exist(nMINWAIT) Then
		.WebEdit("Quantity").Set Quantity
		Call WriteToReport(micPass,"Quantity","is present="&Quantity,false)
		else
		Call WriteToReport(micFail,"Quantity","is not present",True)
	End If
	
	dtEom=(GlobalDIctionary("UOM"))
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("EOM")
	If .Exist(nMINWAIT) Then
		.Set dtEom
	End If
	End WIth 
	
	
	If .WebEdit("unitPrice").Exist(nMINWAIT) Then
		.WebEdit("unitPrice").Set unitPrice
		Call WriteToReport(micPass,"unitPrice","is present="&unitPrice,false)
		else
		Call WriteToReport(micFail,"unitPrice","is not present",True)
	End If
	
	If .WebButton("CalculateInvoiceLine").Exist(nMINWAIT) Then
		.WebButton("CalculateInvoiceLine").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .WebEdit("Account").Exist(nMINWAIT) Then
		.WebEdit("Account").Set Account
		Call WriteToReport(micPass,"Account","is present="&Account,false)
	End If
	
	
	If .WebEdit("Dept").Exist(nMINWAIT) Then
		.WebEdit("Dept").Set Dept
		Call WriteToReport(micPass,"Dept","is present="&Dept,false)
		else
		Call WriteToReport(micFail,"Dept","is not present",True)
	End If
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").WebElement("PeolpleSoft_AlertMessage")
'		if .Exist(5) Then
'		Call WriteToReport(micFail,"Regular Entry Page","Alert Message Exists -Duplicate Voucher ID",True)
'		EndTest
'		End if
'	End With
	
'	If .WebElement("voucherID").Exist(nMINWAIT) Then
'		voucherID=.WebElement("voucherID").GetROProperty("innertext")
'	End If
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("VoucherAttribute")
	
	If .Exist(10) Then
		.Click
		 Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
	else
		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
	End If
	End WIth 
	
'	If .WebTabStrip("tabSelection").Exist(10) Then
'		.WebTabStrip("tabSelection").Select("Voucher Attributes")
'		Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
'	else
'		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
'	End If
	
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		appinvoiceNo=.WebEdit("invoiceNo").GetROProperty("value") 
		If StrComp(Trim(appinvoiceNo),trim(invoiceNo))=0 Then
			Call WriteToReport(micPass,"Voucher Attributes ","data is present",false)

		End If
	End If
	
	If .WebTabStrip("tabSelection").Exist(10) Then
		.WebTabStrip("tabSelection").Select("Invoice Information")
		Call WriteToReport(micPass,"Invoice Information tab","is present",false)
	else
		Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
	End If
	
	If .WebButton("SubmitApproval").Exist(nMINWAIT) Then
		.WebButton("SubmitApproval").Click
		Call WriteToReport(micPass,"SubmitApproval button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"SubmitApproval button in invoice information","is not present",True)
	End If
	
	
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Set voucherID&" is Approved"
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Click
	End If
	
	If .WebTabStrip("tabSelection").Exist(nMINWAIT) Then
		.WebTabStrip("tabSelection").Select("Summary")
		Call WriteToReport(micPass,"Summary tab","is present",false)
		else
		Call WriteToReport(micFail,"Summary tab","is not present",True)
	End If
	
	If .WebElement("approvalStatus").Exist(nMINWAIT) Then
		approvalStatus=.WebElement("approvalStatus").GetROProperty("innertext")
		If StrComp(approvalStatus,"Approved",1)=0 Then
			Call WriteToReport(micPass,"Approval status changed to Approved status","is present",false)
			else
			Call WriteToReport(micFail,"Approval status","doesn't chaged to Approved, Actual status is "&approvalStatus,True)
		End If
	End If
End with

End Function

'*********************************************************************************************************************************
''' <summary>  
''' addRegularVoucherNonPORelatedwithfreightMiscellaneousChargesandSalesTaxesMultiInvoicesLines() Add Regular Voucher - (Non-PO Related) with freight, Miscellaneous Charges, Sales Taxes, and Multi Invoices Lines
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "voucherID,businessunit,invoiceNo,Dept,Account,Quantity,freight,supplierID,salesTax,Classification,lineAmount,i"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to add vouchers</startstate>
''' <endstate>Voucher id generated successfully fo the Voucher</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_02_01_09_NonPOFreigMiscSTMIL
'**********************************************************************************************************************************
Public Function addRegularVoucherNonPORelatedwithfreightMiscellaneousChargesandSalesTaxesMultiInvoicesLines()
Dim voucherID,businessunit,invoiceNo,approvalStatus,Dept,Account,Quantity,freight,Total,supplierID,invoiceDate,appinvoiceNo,salesTax,Classification,lineAmount,i

	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo")&inVoiceNumberGeneration
	invoiceDate=GlobalDictionary("invoiceDate")
	supplierID=GlobalDictionary("SupplierID")
	Total=GlobalDictionary("Total")
	freight=GlobalDictionary("freight")
	Quantity=GlobalDictionary("Quantity")
	lineAmount=GlobalDictionary("lineAmount")
	Account=GlobalDictionary("Account")
	Dept=GlobalDictionary("Dept")
	salesTax=GlobalDictionary("salesTax")
	Classification=GlobalDictionary("Classification")
	
	'wait for the ojects to get loaded
	app_SearchSync()
'	wait 3
	
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit :"&businessunit,"is present and entered as"&businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id :"&voucherID,"is present and entered as "&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		wait(5)
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
'	For i = 0 To 10 Step 1
'		If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
'			Exit for
'		else
'			wait(5)
'		End If
'	Next
	.WebEdit("invoiceNo").WaitProperty "visible",true,20000
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo
		Call WriteToReport(micPass,"invoiceNo :"&invoiceNo," invoiceNo is present as "&invoiceNo,false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date "&invoiceDate,"is present and entered as "&invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	
	If .WebEdit("SupplierID").Exist(nMINWAIT) Then
		.WebEdit("SupplierID").Set supplierID
		Call WriteToReport(micPass,"Supplier ID :"&supplierID,"is present and entered as"&supplierID,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If .WebEdit("freight").Exist(nMINWAIT) Then
		.WebEdit("freight").Click
		wait(3)
		.WebEdit("freight").Click
	End If
	
	wait 3 
	
	If .WebEdit("salesTax").Exist(nMINWAIT) Then
		.WebEdit("salesTax").Click
	End If
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
'		app_SearchSync()
		wait 5
		.WebEdit("Total").Click
		.WebEdit("Total").Set Total
		Call WriteToReport(micPass,"Total :"&Total,"is present and entered as "&Total,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
'	wait 4
	If .WebEdit("Account").Exist(nMINWAIT) Then
		.WebEdit("Account").Click
		wait(3)
		.WebEdit("Account").Set Account
		Call WriteToReport(micPass,"Account :"&Account,"is present and entered as"&Account,false)
		else
		Call WriteToReport(micFail,"Account","is not present",True)
	End If
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
	
'	For i = 0 To 10 Step 1
		If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
'			Exit for
'		else
'			wait(5)
		End If
'	Next
	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	'wait for the ojects to get loaded
	app_SearchSync()
'	For i = 0 To 10 Step 1
'		If .WebButton("SubmitApproval").Exist(nMINWAIT) Then
'			Exit for
'		else
'			wait(5)
'		End If
'	Next

	If .WebElement("voucherID").Exist(nMINWAIT) Then
		voucherID=.WebElement("voucherID").GetROProperty("innertext")
		If StrComp(approvalStatus,"NEXT",1)<>0 Then
			Call WriteToReport(micPass,"voucherID :"&voucherID,"is present and generated as"&voucherID,false)
			else
			Call WriteToReport(micFail,"voucherID","doesn't get generated",True)
		End If
	End If
	
End with
	
'	Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	
	.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
	If .WebTabStrip("tabSelectionMain").Exist(nMINWAIT) Then
		.WebTabStrip("tabSelectionMain").Select("Find an Existing Value")
		Call WriteToReport(micPass,"Find an existing Value tab ","is present",false)
		else
		Call WriteToReport(micFail,"Find an existing Value tab","is not present",True)
	End If

	.WebEdit("BusinessUnitFEV").WaitProperty "visible",True,20000
	If .WebEdit("BusinessUnitFEV").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnitFEV").Set businessunit
		Call WriteToReport(micPass,"Business unit :"&v,"is present and entered as"&businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherIdFEV").Exist(nMINWAIT) Then
		.WebEdit("VoucherIdFEV").Set voucherID
		Call WriteToReport(micPass,"Voucher Id :"&voucherID,"is present and entered as "&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Search").Exist(nMINWAIT) Then
		.WebButton("Search").Click
		Call WriteToReport(micPass,"Search button to Search the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Search button to Search the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
'	For i = 0 To 10 Step 1
'		If .WebTabStrip("tabSelection").Exist(nMINWAIT) Then
'			Exit for
'		else
'			wait(5)
'		End If
'	Next
	.WebTabStrip("tabSelection").WaitProperty "visible",true,20000
	If .WebTabStrip("tabSelection").Exist(10) Then
		.WebTabStrip("tabSelection").Select("Invoice Information")
		Call WriteToReport(micPass,"Invoice Information tab","is present and clicked",false)
	else
		Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
	End If
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo
		Call WriteToReport(micPass,"invoiceNo :"&invoiceNo,"is present and entered as"&invoiceNo,false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date :"&invoiceDate,"is present and entered as "&invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	
	If .WebEdit("SupplierID").Exist(nMINWAIT) Then
		.WebEdit("SupplierID").Set supplierID
		Call WriteToReport(micPass,"Supplier ID :"&supplierID,"is present and entered as "&supplierID,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If .WebEdit("freight").Exist(nMINWAIT) Then
		.WebEdit("freight").Set freight
		Call WriteToReport(micPass,"freight :"&freight,"is present and entered as "&freight,false)
		else
		Call WriteToReport(micFail,"freight","is not present",True)
	End If
	
	If .WebEdit("lineAmount").Exist(nMINWAIT) Then
		.WebEdit("lineAmount").Click
		wait(5)
		.WebEdit("lineAmount").Click
		.WebEdit("lineAmount").Set lineAmount
		Call WriteToReport(micPass,"lineAmount","is present",false)
		else
		Call WriteToReport(micFail,"lineAmount","is not present",True)
	End If
	
	wait 3 
	
	If .WebEdit("salesTax").Exist(nMINWAIT) Then
		.WebEdit("salesTax").Click
		wait 5
		.WebEdit("salesTax").Click
		.WebEdit("salesTax").Set salesTax
		Call WriteToReport(micPass,"salesTax :"&salesTax,"is present and entered as "&salesTax,false)
		else
		Call WriteToReport(micFail,"salesTax","is not present",True)
	End If
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		wait 5
		.WebEdit("Total").Click
		.WebEdit("Total").Set Total
		Call WriteToReport(micPass,"Total : "&Total,"is present and entered as "&Total,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	wait 4
	If .WebEdit("Quantity").Exist(nMINWAIT) Then
		.WebEdit("Quantity").Set Quantity
		Call WriteToReport(micPass,"Quantity : "&Quantity,"is present and entered as "&Quantity,false)
		else
		Call WriteToReport(micFail,"Quantity","is not present",True)
	End If
	
	
	
	If .WebButton("CalculateInvoiceLine").Exist(nMINWAIT) Then
		.WebButton("CalculateInvoiceLine").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("Yes").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("Yes").Click
	End if
	
	If .WebEdit("Account").Exist(nMINWAIT) Then
		.WebEdit("Account").Click
		.WebEdit("Account").Set Account
		Call WriteToReport(micPass,"Account : "&Account,"is present and entered as "&Account,false)
		else
		Call WriteToReport(micFail,"Account","is not present",True)
	End If
	
	
	If .WebEdit("Dept").Exist(nMINWAIT) Then
		.WebEdit("Dept").Set Dept
		Call WriteToReport(micPass,"Dept :"&Dept,"is present and entered as "&Dept,false)
		else
		Call WriteToReport(micFail,"Dept","is not present",True)
	End If
	
	If .WebEdit("Classification").Exist(nMINWAIT) Then
		.WebEdit("Classification").Set Classification
		Call WriteToReport(micPass,"Classification :"&Classification,"is present and entered as "&Classification,false)
		else
		Call WriteToReport(micFail,"Classification","is not present",True)
	End If
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
	
'	For i = 0 To 10 Step 1
		If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
'			Exit for
'		else
'			wait(5)
		End If
'	Next
	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	'wait for the ojects to get loaded
	app_SearchSync()
'	For i = 0 To 10 Step 1
'		If .WebButton("SubmitApproval").Exist(nMINWAIT) Then
'			Exit for
'		else
'			wait(5)
'		End If
'	Next
'	If .WebElement("voucherID").Exist(nMINWAIT) Then
'		voucherID=.WebElement("voucherID").GetROProperty("innertext")
'	End If
	
	If .WebTabStrip("tabSelection").Exist(10) Then
		.WebTabStrip("tabSelection").Select("Voucher Attributes")
		If .webElement("tabVoucherAttributes").Exist(nMINWAIT) Then
			.webElement("tabVoucherAttributes").Click
		End If
		Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
	else
		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		appinvoiceNo=.WebEdit("invoiceNo").GetROProperty("value") 
		If StrComp(Trim(appinvoiceNo),trim(invoiceNo))=0 Then
			Call WriteToReport(micPass,"Voucher Attributes ","data is present",false)
			else
			Call WriteToReport(micFail,"Voucher Attributes","data is not present",True)
		End If
	End If
	
	If .WebButton("SubmitForApproval_VoucherAttribute").Exist(nMINWAIT) Then
		.WebButton("SubmitForApproval_VoucherAttribute").Click
		Call WriteToReport(micPass,"SubmitApproval button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"SubmitApproval button in invoice information","is not present",True)
	End If
End with
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Set voucherID&" is Approved"
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Click
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
'wait for the ojects to get loaded
	app_SearchSync()	
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
	If .WebTabStrip("tabSelection").Exist(nMINWAIT) Then
		.WebTabStrip("tabSelection").Select("Summary")
		Call WriteToReport(micPass,"Summary tab","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Summary tab","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebElement("approvalStatus").Exist(nMINWAIT) Then
		approvalStatus=.WebElement("approvalStatus").GetROProperty("innertext")
		If StrComp(approvalStatus,"Approved",1)=0 Then
			Call WriteToReport(micPass,"Approval status changed to Approved status","is present",false)
			else
			Call WriteToReport(micFail,"Approval status","doesn't chaged to Approved, Actual status is "&approvalStatus,True)
		End If
	End If


End with

End Function
'*********************************************************************************************************************************
''' <summary>  
''' addRegularVoucherNonPORelatedwithfreightMiscellaneousChargesandSalesTaxes() To Add Regular Voucher - (Non-PO Related) with freight,Miscellaneous Charges, and Sales Taxes. TAX: Non Direct Pay/Supplier Tax = 0 Vertex Tax > 0. Short Pay.
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "voucherID,businessunit,invoiceNo,Dept,Account,Quantity,freight,supplierID,salesTax,Classification,lineAmount"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to add vouchers</startstate>
''' <endstate>Voucher id will generated successfully</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_02_01_05_SuppEql0_VertGreat0
'**********************************************************************************************************************************
Public Function addRegularVoucherNonPORelatedwithfreightMiscellaneousChargesandSalesTaxes()
Dim voucherID,businessunit,invoiceNo,approvalStatus,Dept,Account,Quantity,freight,Total,supplierID,invoiceDate,appinvoiceNo,salesTax,Classification,lineAmount,i

	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	
	invoiceNo=GlobalDictionary("invoiceNo")&inVoiceNumberGeneration
	invoiceDate=GlobalDictionary("invoiceDate")
	supplierID=GlobalDictionary("SupplierID")
	Total=GlobalDictionary("Total")
	freight=GlobalDictionary("freight")
	Quantity=GlobalDictionary("Quantity")
	lineAmount=GlobalDictionary("UnitPrice")
	Account=GlobalDictionary("Account")
	Dept=GlobalDictionary("Dept")
	salesTax=GlobalDictionary("salesTax")
	Classification=GlobalDictionary("Classification")
	
	'wait for the ojects to get loaded
	app_SearchSync()
'	wait 3
	'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit : "&businessunit,"is present and entered as "&businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id :"&voucherID,"is present and entered as "&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		wait(5)
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
'	For i = 0 To 10 Step 1
'		If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
'			Exit for
'		else
'			wait(5)
'		End If
'	Next
	.WebEdit("invoiceNo").WaitProperty "visible",true,20000
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo
		Call WriteToReport(micPass,"invoiceNo :"&invoiceNo,"is present and entered as "&invoiceNo,false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date : "&invoiceDate,"is present and entered as "&invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	
	If .WebEdit("SupplierID").Exist(nMINWAIT) Then
		.WebEdit("SupplierID").Set supplierID
		Call WriteToReport(micPass,"Supplier ID : "&supplierID,"is present and entered as "&supplierIDs,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If .WebEdit("freight").Exist(nMINWAIT) Then
		.WebEdit("freight").Click
		wait(3)
		.WebEdit("freight").Click
		.WebEdit("freight").Set freight
		Call WriteToReport(micPass,"freight : "&freight,"is present and entered as "&freight,false)
		else
		Call WriteToReport(micFail,"freight","is not present",True)
	End If
	
	If .WebEdit("lineAmount").Exist(nMINWAIT) Then
		.WebEdit("lineAmount").Set lineAmount
		Call WriteToReport(micPass,"lineAmount","is present",false)
		else
		Call WriteToReport(micFail,"lineAmount","is not present",True)
	End If
	
	wait 3 
	
	If .WebEdit("salesTax").Exist(nMINWAIT) Then
		.WebEdit("salesTax").Set salesTax
		Call WriteToReport(micPass,"salesTax :"&salesTax,"is present and entered as "&salesTax,false)
		else
		Call WriteToReport(micFail,"salesTax","is not present",True)
	End If
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		wait 5
		.WebEdit("Total").Click
		.WebEdit("Total").Set Total
		Call WriteToReport(micPass,"Total : "&Total,"is present and entered as "&Total,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
'	wait 4
	If .WebEdit("Quantity").Exist(nMINWAIT) Then
		.WebEdit("Quantity").Set Quantity
		Call WriteToReport(micPass,"Quantity :"&Quantity,"is present end entered as "&Quantity,false)
		else
		Call WriteToReport(micFail,"Quantity","is not present",True)
	End If
	
	
	
	If .WebButton("CalculateInvoiceLine").Exist(nMINWAIT) Then
		.WebButton("CalculateInvoiceLine").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebEdit("Account").Exist(nMINWAIT) Then
		.WebEdit("Account").Click
		wait(3)
		.WebEdit("Account").Set Account
		Call WriteToReport(micPass,"Account "&Account,"is present and entered as "&vs,false)
		else
		Call WriteToReport(micFail,"Account","is not present",True)
	End If
	
	
	If .WebEdit("Dept").Exist(nMINWAIT) Then
		.WebEdit("Dept").Set Dept
		Call WriteToReport(micPass,"Dept "&Dept,"is present and entered as "&Dept,false)
		else
		Call WriteToReport(micFail,"Dept","is not present",True)
	End If
	
	If .WebEdit("Classification").Exist(nMINWAIT) Then
		.WebEdit("Classification").Set Classification
		Call WriteToReport(micPass,"Classification :"&Classification,"is present and entered as "&Classification,false)
		else
		Call WriteToReport(micFail,"Classification","is not present",True)
	End If
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
'	For i = 0 To 10 Step 1
		If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(nMINWAIT) Then
'			Exit for
'		else
'			wait(5)
		End If
'	Next
	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	
'	For i = 0 To 10 Step 1
'		If .WebButton("SubmitApproval").Exist(nMINWAIT) Then
'			Exit for
'		else
'			wait(5)
'		End If
'	Next
'	If .WebElement("voucherID").Exist(nMINWAIT) Then
'		voucherID=.WebElement("voucherID").GetROProperty("innertext")
'	End If
	
	If .WebTabStrip("tabSelection").Exist(10) Then
		.WebTabStrip("tabSelection").Select("Voucher Attributes")
		Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
	else
		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		appinvoiceNo=.WebEdit("invoiceNo").GetROProperty("value") 
		If StrComp(Trim(appinvoiceNo),trim(invoiceNo))=0 Then
			Call WriteToReport(micPass,"Voucher Attributes ","data is present",false)
			else
			Call WriteToReport(micFail,"Voucher Attributes","data is not present",True)
		End If
	End If
	
'	If .WebTabStrip("tabSelection").Exist(10) Then
'		.WebTabStrip("tabSelection").Select("Invoice Information")
'		Call WriteToReport(micPass,"Invoice Information tab","is present",false)
'	else
'		Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
'	End If
	
	If .WebButton("SubmitForApproval_VoucherAttribute").Exist(nMINWAIT) Then
		.WebButton("SubmitForApproval_VoucherAttribute").Click
		Call WriteToReport(micPass,"SubmitApproval button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"SubmitApproval button in invoice information","is not present",True)
	End If
End with
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Sync
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Click
		wait(2)
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Set voucherID&" is Approved"
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Click
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
'wait for the ojects to get loaded
	app_SearchSync()	
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
	If .WebTabStrip("tabSelection").Exist(nMINWAIT) Then
		.WebTabStrip("tabSelection").Click
		wait(3)
		.WebTabStrip("tabSelection").Select("Summary")
		Call WriteToReport(micPass,"Summary tab","is present",false)
		else
		Call WriteToReport(micFail,"Summary tab","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebElement("approvalStatus").Exist(nMINWAIT) Then
		approvalStatus=.WebElement("approvalStatus").GetROProperty("innertext")
		If StrComp(approvalStatus,"Approved",1)=0 Then
			Call WriteToReport(micPass,"Approval status changed to Approved status","is present",false)
			else
			Call WriteToReport(micFail,"Approval status","doesn't chaged to Approved, Actual status is "&approvalStatus,True)
		End If
	End If


End with

End Function

'*********************************************************************************************************************************
''' <summary>  
''' overridePaymentTermsonaRegularNonPORelatedVoucher() To Override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "voucherID,businessunit,invoiceNo,supplierID,invoiceDate,CopyFrom,PayTerm"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to add vouchers</startstate>
''' <endstate>pay term will be overriden after do the copy PO</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'AP_02_01_15_OverridePayNonPO
'**********************************************************************************************************************************
Public Function overridePaymentTermsonaRegularNonPORelatedVoucher()
Dim voucherID,businessunit,approvalStatus,invoiceNo,Total,supplierID,invoiceDate,i,CopyFrom,PayTerm

	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo")&inVoiceNumberGeneration
	invoiceDate=GlobalDictionary("invoiceDate")
	supplierID=GlobalDictionary("SupplierID")
	CopyFrom=GlobalDictionary("CopyFrom")
	PayTerm=GlobalDictionary("PayTerm")

	'wait for the ojects to get loaded
	app_SearchSync()
	wait 3
	'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit :"&businessunit,"is present and entered as "&businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id "&voucherID,"is present and entered as "&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		wait(4)
		.WebButton("Add").highlight
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
'	For i = 0 To 10 Step 1
'		If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
'			Exit for
'		else
'			wait(5)
'		End If
'	Next
	.WebEdit("invoiceNo").WaitProperty "visible",true,20000
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo
		Call WriteToReport(micPass,"invoiceNo "&invoiceNo,"is present and entered as "&invoiceNo,false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date "&invoiceDate,"is present and entered as "&invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	If .WebEdit("PayTerms").Exist(nMINWAIT) Then
		.WebEdit("PayTerms").Set PayTerm
		Call WriteToReport(micPass,"PayTerm "&PayTerm,"is present and entered as "&PayTerm,false)
		else
		Call WriteToReport(micFail,"PayTerm","is not present",True)
	End If
End with	
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Exist(nMINWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Click
	End If

	If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Exist(nMINWAIT) Then
'		If InStr(supplierID,"...")<>0 Then
		Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Set Replace(supplierID,"...","")'left(supplierID,3)
		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Click
		End If

		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").Exist(nMINWAIT) Then
			If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").RowCount))>1 Then
				Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").ChildItem(2,1,"Link",0).click
			End If
		End If
'		else
'			Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID").Set Trim(supplierID)
'		End If
		Call WriteToReport(micPass,"Supplier ID","is present and value entered",false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")		
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If .WebEdit("freight").Exist(nMINWAIT) Then
		.WebEdit("freight").Click
	End If
	wait 3 
	If .WebEdit("salesTax").Exist(nMINWAIT) Then
		.WebEdit("salesTax").Click
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	wait 4
	
	If .WebList("CopyFrom").Exist(nMINWAIT) Then
		.WebList("CopyFrom").Select CopyFrom
		Call WriteToReport(micPass,"CopyFrom","is present and selected "&CopyFrom,false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .Link("Go").Exist(nMINWAIT) Then
		wait(3)
		.Link("Go").Click
		Call WriteToReport(micPass,"go link ","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Go link","is not present",True)
	End If
	
	If .WebEdit("POBusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("POBusinessUnit").Set businessunit
		Call WriteToReport(micPass,"POBusinessUnit "&businessunit,"is present and entered as "&businessunit,false)
		else
		Call WriteToReport(micFail,"POBusinessUnit","is not present",True)
	End If
	
	If .WebButton("PONumberLookup").Exist(nMINWAIT) Then
		.WebButton("PONumberLookup").Click
	End If
End with	
	Dim temp:temp=0
	wait(4)
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").Exist(nMINWAIT) Then
		If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").RowCount))>1 Then
			Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").ChildItem(2,1,"Link",0).click
			temp=1
		else
			Call WriteToReport(micFail,"invoices for "&businessunit&","&supplierID ,"is not present",True)
		End If
	End If
	
If temp=1 Then
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	

	If .WebButton("CopyEntireDocument").Exist(nMINWAIT) Then
		.WebButton("CopyEntireDocument").Click
		Call WriteToReport(micPass,"CopyEntireDocument","is present and clicked",false)
		else
		Call WriteToReport(micFail,"CopyEntireDocument","is not present",True)
	End If
	
	.WebEdit("Total").WaitProperty "visible",True,20000
	If .WebElement("Difference").Exist(nMINWAIT) Then
		Total=.WebElement("Difference").GetROProperty("innertext")
	End If
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		wait 5
		.WebEdit("Total").Click
		.WebEdit("Total").Set Total
		Call WriteToReport(micPass,"Total","is present and entered as "&Total,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	wait(5)
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
'	For i = 0 To 10 Step 1
		If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
'			Exit for
'		else
'			wait(5)
		End If
'	Next
'wait for the ojects to get loaded
	app_SearchSync()	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	
'	For i = 0 To 10 Step 1
'		If .WebButton("SubmitApproval").Exist(nMINWAIT) Then
'			Exit for
'		else
'			wait(5)
'		End If
'	Next
'wait for the ojects to get loaded
	app_SearchSync()
	If .WebElement("voucherID").Exist(nMINWAIT) Then
		approvalStatus=.WebElement("voucherID").GetROProperty("innertext")
		If StrComp(approvalStatus,"NEXT",1)<>0 Then
			Call WriteToReport(micPass,"voucherID :"&approvalStatus,"is present and generated as "&approvalStatus,false)
			else
			Call WriteToReport(micFail,"voucherID","doesn't get generated",True)
		End If
	End If


End with
End If
End Function

'*********************************************************************************************************************************
''' <summary>  
''' VoucherPost() To verify voucher Post accounting entries is displayed
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "RunControlID, RequestID, Description,PostVoucherOption,PrepaymentApplicationMethod,ProcessFrequency,BusinessUnit,VoucherID,MainMenuSelection2,supplierID"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************

'3.1.1
Public Function VoucherPost()

	dtControlID=(GlobalDictionary("RunControlID"))&inVoiceNumberGeneration
	dtRequestID=(GlobalDictionary("RequestID"))
	dtDescription=(GlobalDictionary("Description"))
	dtPostVoucherOption=(GlobalDictionary("PostVoucherOption"))
	dtPrepaymentApplicationMethod=(GlobalDictionary("PrepaymentApplicationMethod"))
	dtProcessFrequency=(GlobalDictionary("ProcessFrequency"))
	dtBusinessUnit=(GlobalDictionary("BusinessUnit"))
	dtVoucherID=(GlobalDictionary("VoucherID"))
	SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
	supplierID=(GlobalDictionary("supplierID"))
	
	VoucherId=ap_createVoucherWithCopyPO(dtBusinessUnit,supplierID)
	
	'Navigate to Following page
	'Accounts Payable / Batch Processes / Vouchers / Voucher Posting
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	
	'CLick on Add NEw value Tab
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebElement("AddNewValue")
	If .Exist(nMINWAIT) Then
		.Click
		
		'Enter the control ID
		With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("PRCSRUNCNTL_RUN_CNTL_ID")
		If .Exist(nMINWAIT) Then
			.Set dtControlID
			Call WriteToReport(micPass,"Control ID","Control ID is="&dtControlID,false)
		End If
		End WIth 
		
		'CLick onb Add Button
		With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebButton("Add")
		If .Exist(nMINWAIT) Then
			.Click:Call WriteToReport(micPass,"Add button","is present and clicked",false)
		End If
		End With 

	End If
	End WIth 

	'Wait for the applicatoin load
	Browser("PeopleSoft Browser").Sync
	
	'Check if the add ing nwe contorl page ois displayed
	If Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("RequestID").WaitProperty("visible",True,2000) Then
		
	'Enter the Run control IDF values in the Page
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("RequestID")
	If .Exist(nMINWAIT) Then
		.Set dtRequestID
		Call WriteToReport(micPass,"Request ID","Request ID is="&dtRequestID,false)
	End If
	End WIth 
	
	'Enter the description
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("Description")
	If .Exist(nMINWAIT) Then
		.Set dtDescription
		Call WriteToReport(micPass,"Description ID","Description ID is="&dtDescription,false)
	End If
	End WIth 
	
	'Select the voucher Posting option
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebList("PostVoucherOption")
	If .Exist(nMINWAIT) Then
		.Select dtPostVoucherOption
	End If
	End WIth 
	
	'Select the Prepamenty application
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebList("PrepaymentApplicationMethod")
	If .Exist(nMINWAIT) Then
		.Select dtPrepaymentApplicationMethod
	End If
	End With
	
	'Select the process frequency
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebList("ProcessFrequency")
	If .Exist(nMINWAIT) Then
		.Select dtProcessFrequency
	End If
	End With
	
	'ENter the Business UNit
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("BusinessUnit")
	If .Exist(nMINWAIT) Then
		.Set dtBusinessUnit
		Call WriteToReport(micPass,"BusinessUnit","BusinessUnit is="&dtBusinessUnit,false)
	End If
	End WIth 
	
	'Enter the Voucher ID
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("VoucherID")
	If .Exist(nMINWAIT) Then
		.Set VoucherId
		Call WriteToReport(micPass,"VoucherID","VoucherID is="&dtVoucherID,false)
	End If
	End WIth 
	
	'Click on Run button
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebButton("Run")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End WIth 
	
	app_SearchSync()
	app_SearchSync()
	
	'Selcet the post voucejhr and clickon Ok button
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("ProcessSchdeluerRequest").WebTable("ProcessList")
	If .Exist(nMINWAIT) Then
		For i=2 to .RowCount
			appDescription=.GetCellData(i,2)
			If appDescription="Post vouchers" Then
				appProcessName=.GetCellData(i,3)
				Set oVoucherLink=.ChildItem(i,1,"WebCheckBox",0)
				If oVoucherLink.exist(nMINWAIT) Then
					oVoucherLink.click
					Exit For
				End If
			End If
		Next
	End If
	End With 
	End  If
	
	'Click on Ok button
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("ProcessSchdeluerRequest").WebButton("Ok")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End WIth 
	
	app_SearchSync()
	
	'Click on Process moonitor
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("VoucherPostingRequest").Link("Process Monitor")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End With 
	
	app_SearchSync()
	Call CheckProcessMontiorStatus (sProcessName)
	

Browser("PeopleSoft Browser").Sync

'Navigate toe Next page toe search for the entries
'(Accounts Payable / Review / Vouchers / Voucher Accounting Entries)
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

'Enter the voucher NUmber and Business UNit
With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebEdit("BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
Call WriteToReport(micPass,"BusinessUnit","BusinessUnit is="&dtBusinessUnit,false)
End If
End With 

'Enter the voucher ID
With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebEdit("VoucherID")
If .Exist(nMINWAIT) Then
	.Set dtVoucherID
	Call WriteToReport(micPass,"VoucherID","VoucherID is="&dtVoucherID,false)
End If
End With 

'Click on Seqarch button
With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'Search for the Table
WIth Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebTable("AccountingInformation")
If .Exist(nMINWAIT) Then
Call WriteToReport(micPass,"THe voucehr entries are added in the", "table",false)
	If .RowCount>=2 Then
		For i=1 to .RowCount
			appDate=.GetCellData(i,6)
			If appDate=Date() Then
				Call WriteToReport(micPass,"THe voucehr entries are added in the", "table",false)
			End If
		Next
	End If
	
End If
End With 

End Function

'*********************************************************************************************************************************
''' <summary>  
''' VoucherDelete() To verify Delete Voucher is displayed
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, MainMenuSelection2, invoiceNo,InvoiceDate,SupplierID,LineAmount,Account,Dept,AdditionalComments,TotalAmount"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'3.1.2

Public Function VoucherDelete()
	'Create the vouchers
	'Navigate to Accounts Payable -> Vouchers -> Add Update -> Regular entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
	
	'Declarring the variables:- 
	dtBusinessUnit=GlobalDictionary("BusinessUnit")
	dtinvoiceNo=GlobalDictionary("invoiceNo") & inVoiceNumberGeneration' & Day(Date)
	dtInvoiceDate=GlobalDictionary("InvoiceDate")
	dtSupplierID=GlobalDictionary("SupplierID")
	dtLineAmount=GlobalDictionary("LineAmount")
	dtAccountNumber=GlobalDictionary("Account")
	dtDept=GlobalDictionary("Dept")
	dtAdditionalComments=GlobalDictionary("AdditionalComments")
	dtTotalAmount=GlobalDictionary("TotalAmount")
	
	'Enter the BusinessUnit anrd and voucher ID and click on Add button
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("BusinessUnit")
	If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is present and set with "&.GetROProperty("value"),False)
	Else
	Call WriteToReport(micPass,""&.GetROProperty("innertext"), "is not present" ,True)
	End If
	End WIth 
	
	'Clickon Add Button
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Add")
	If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Add Button is clicked", "and able to process tonext page",False)
	Else
	Call WriteToReport(micPass,"Add Button is cnot present", "and not able to process tonext page",True)
	End If
	End WIth
	
	'wait for the applicaiton to load
	Browser("PeopleSoft Browser").Sync
	
	'Set the values in Invoice
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceNo")
	If .Exist(nMINWAIT) Then
		.Set dtinvoiceNo
		Call WriteToReport(micPass,"InvoiceNo="&dtinvoiceNo,"is displayed",false)	
	End If
	End With
	
	dtInvoiceDate=CDate(DateAdd("m",-1,Date))
	'Set the invoiuce Date
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("invoiceDate")
	If .Exist(nMINWAIT) Then
	.Set dtInvoiceDate
	Call WriteToReport(micPass,"InvoiceDate="&dtInvoiceDate,"is displayed",false)	
	End If
	End With
	
	'Enter the Supplier IDF
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID")
	If .Exist(nMINWAIT) Then
	.Set dtSupplierID
	Call WriteToReport(micPass,"SupplierID="&dtSupplierID,"is displayed",false)	
	End If
	End With 
	
	'ENte the Total Amount
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total")
	If .Exist(nMINWAIT) Then
	.Set dtTotalAmount
	Call WriteToReport(micPass,"TotalAmount="&dtTotalAmount,"is displayed",false)	
	End If
	End With
	
	
	'Enter the Line amount
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("LineAmount")
	If .Exist(nMINWAIT) Then
	.Set dtLineAmount
	Call WriteToReport(micPass,"LineAmount="&dtLineAmount,"is displayed",false)	
	End If
	End With
	
	

	'Ente the details in Account and Depty
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Account")
	If .Exist(nMINWAIT) Then
	.Set dtAccountNumber
	Call WriteToReport(micPass,"AccountNumber="&dtAccountNumber,"is displayed",false)	
	End If
	End With
	
	'Enter the Dept ID number
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Dept")
	If .Exist(nMINWAIT) Then
	.Set dtDept
	Call WriteToReport(micPass,"Dept="&dtDept,"is displayed",false)	
	End If
	End With
	
	'Click on Save button
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Save")
	If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Save Button is clicked", "and able to process the changes",False)
	Else
	Call WriteToReport(micFail,"Save Button is not clicked", "and not able to process the changes",False)
	End If
	End With

	For i=0 to 4
		app_SearchSync()
	Next
	
	'Get the Voucher Id
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucherID")
	If .Exist(nMINWAIT) Then
		appVoucherId=.GetROProperty("innertext")
		GlobalDictionary("voucherId")=appVoucherId
	End If
	End  With 
	
	'Navigate to below page
	'Accounts Payable/ Vouchers/Add/Update/ Delete Voucher
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	
	
	'Click on Delete buttton
	With Browser("PeopleSoft Browser").Page("VoucherDeleteMainPage").PSFrame("VoucherDeleteMainPage").WebEdit("MainPage_VoucherId")
	If .Exist(nMINWAIT) Then
		.Set GlobalDictionary("voucherId")
		
		'sET THE bUSNESS UNT
		With Browser("PeopleSoft Browser").Page("VoucherDeleteMainPage").PSFrame("VoucherDeleteMainPage").WebEdit("MainPage_BusUnit")
		If .Exist(nMINWAIT) Then
			.Set dtBusinessUnit
		End If
		End  With 
		
		'Click on search button
		With Browser("PeopleSoft Browser").Page("VoucherDeleteMainPage").PSFrame("VoucherDeleteMainPage").WebButton("MainPage_Search")
		If .Exist(nMINWAIT) Then
		.Click
		End If
		End  With
		
		'Search for the voucher ID in table
		With Browser("PeopleSoft Browser").Page("VoucherDeleteMainPage").PSFrame("VoucherDeleteMainPage").WebTable("MainPage_VoucherDelete")
		If .Exist(nMINWAIT) Then
			For i=1 to .RowCount
				appVoucherIDTable=.GetCellData(i,2)
				If appVoucherIDTable=GlobalDictionary("voucherId") Then
					Set oVOucherLink=.ChildItem(i,2,"Link",0)
					If oVOucherLink.exist(nMINWAIT) Then
						oVOucherLink.click
					End If
				End If
			Next
		End If
		End  With 
		
	End If
	End  With 
	

	With Browser("PeopleSoft Browser").Page("VoucherDeleteMainPage").PSFrame("VoucherDeleteMainPage").WebButton("MainPage_Delete")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End With 
	

	With Browser("PeopleSoft Browser").Page("VoucherDeleteMainPage").WebElement("DeleteVoucher_Warning")
	If .Exist(nMINWAIT) Then
	appWarningMess=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The warning message","is displayed is"&appWarningMess
	End If
	End With 
	
	

	'Clickon Wartning mesage
	With Browser("PeopleSoft Browser").Page("VoucherDeleteMainPage").WebButton("Ok")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End With 
	
	Browser("PeopleSoft Browser").Sync
	
	'Navigate to Foloinwq page
	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	
	'Enter the voucher NUmber and Business UNit
	With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebEdit("BusinessUnit")
	If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,"BusinessUnit","BusinessUnit is="&dtBusinessUnit,false)
	End If
	End With 
	
	dtVoucherID=GlobalDictionary("voucherId")
	'Enter the voucher ID
	With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebEdit("VoucherID")
	If .Exist(nMINWAIT) Then
	.Set dtVoucherID
	Call WriteToReport(micPass,"VoucherID","VoucherID is="&dtVoucherID,false)
	End If
	End With 
	
	'Click on Seqarch button
	With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebButton("Search")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End With 
	
	'Validate the Error message
	With Browser("PeopleSoft Browser").Page("VoucherDelete").WebButton("Ok")
	If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"The voucher is deleted from the", "table",false)
	Else
	Call WriteToReport(micFail,"The voucher is not deleted from the", "table",True)
	End If
	End WIth 
	
	
	End Function
	
	'*********************************************************************************************************************************
''' <summary>  
''' UnPostVoucher() To Unpost Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "dtBusinessUnit,dtControlID,dtRequestID,dtDescription,dtPostVoucherOption,dtPrepaymentApplicationMethod,dtProcessFrequency"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to unpost vouchers</startstate>
''' <endstate>unposted successfully</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_03_01_03
Public Function UnPostVoucher()
'Navigate ot Below Screen
'Accounts Payable/ Vouchers/Add/Update/ Unpost Voucher
'Before Unpost
'Navigate toe Next page toe search for the entries


dtBusinessUnit=(GlobalDictionary("BusinessUnit"))
'dtVoucherID=(GlobalDictionary("VoucherID"))
dtControlID=(GlobalDictionary("RunControlID"))
dtRequestID=(GlobalDictionary("RequestID"))
dtDescription=(GlobalDictionary("Description"))
dtPostVoucherOption=(GlobalDictionary("PostVoucherOption"))
dtPrepaymentApplicationMethod=(GlobalDictionary("PrepaymentApplicationMethod"))
dtProcessFrequency=(GlobalDictionary("ProcessFrequency"))


''Accounts Payable> Vouchers>Add/Update>Unpost Voucher
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'EBrowser("PeopleSoft Browser").Page("UnPost").PSFrame("Unpost").WebEdit("BusinessUnit").Set
'Ntert ht eBusiness UNit and Voucher ID
With Browser("PeopleSoft Browser").Page("UnPost").PSFrame("Unpost").WebEdit("BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,"BusinessUnit :"&dtBusinessUnit, "is present and entered as"&dtBusinessUnit,false)
		else
		Call WriteToReport(micfail,"BusinessUnit", "is not present in the application",false)
End If
End  With 

'With Browser("PeopleSoft Browser").Page("UnPost").PSFrame("Unpost").WebEdit("VoucherID")
'If .Exist(nMINWAIT) Then
'	.Set dtVoucherID
'End If
'End  With 

'CLick on Searcb button
With Browser("PeopleSoft Browser").Page("UnPost").PSFrame("Unpost").WebButton("Unpost_Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 
app_SearchSync()
With Browser("PeopleSoft Browser").Page("UnPost").PSFrame("Unpost").WebTable("SearchResults")
	If .Exist(nminwait) Then
		If .RowCount>1 Then
			dtVoucherID=.GetCellData(2,2)
			.ChildItem(2,2,"Link",0).click
			Call WriteToReport(micPass,"Voucher selected from search results :"&dtVoucherID, "Voucher is present and selected as"&dtVoucherID,false)
		else
		Call WriteToReport(micfail,"Search results", "is not present in the application",false)
		End If
	End If
End With



'Click on Unpost button
With Browser("PeopleSoft Browser").Page("UnPost").PSFrame("Unpost").WebButton("Unpost_Unpost")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Click Ok on warning message
With Browser("PeopleSoft Browser").Page("UnPost").WebElement("Unpost_WarningMessage")
If .Exist(nMINWAIT) Then
	appWarningMessage=.GetROProperty("innertext")
	Call WriteToReport(micPass,"The warning message is displayed", "and is"&appWarningMessage,false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("UnPost").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

With Browser("PeopleSoft Browser").Page("UnPost").WebElement("Unpost_UnpostSucess")
If .Exist(nMINWAIT) Then
appCOnfirmationMessage=.GetROProperty("innertext")
	Call WriteToReport(micPass,"The warning message is displayed", "and is"&appCOnfirmationMessage,false)
End If
End  With	

With Browser("PeopleSoft Browser").Page("UnPost").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 


''Accounts Payable> Vouchers>Add/Update>Unpost Voucher
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'EBrowser("PeopleSoft Browser").Page("UnPost").PSFrame("Unpost").WebEdit("BusinessUnit").Set
'Ntert ht eBusiness UNit and Voucher ID
With Browser("PeopleSoft Browser").Page("UnPost").PSFrame("Unpost").WebEdit("BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,"BusinessUnit :"&dtBusinessUnit, "is present and entered"&dtBusinessUnit,false)
else
	Call WriteToReport(micfail,"BusinessUnit ", "is not present in the application",false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("UnPost").PSFrame("Unpost").WebEdit("VoucherID")
If .Exist(nMINWAIT) Then
	.Set dtVoucherID
	Call WriteToReport(micPass,"VoucherID :"&dtVoucherID, "is present and entered"&dtVoucherID,false)
else
	Call WriteToReport(micfail,"VoucherID ", "is not present in the application",false)
End If
End  With 

'CLick on Searcb button
With Browser("PeopleSoft Browser").Page("UnPost").PSFrame("Unpost").WebButton("Unpost_Search")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Search button ", "is present and clicked",false)
else
	Call WriteToReport(micfail,"Search button ", "is not present in the application",false)
End If
End  With 


With Browser("PeopleSoft Browser").Page("UnPost").PSFrame("Unpost").WebElement("NomatchingVal")
	If .Exist(nminwait) Then
		Call WriteToReport(micPass,"Voucher shouldn't displayed after unpost "&.GetROProperty("innertext") , "Voucher doesn't displayed as expected",false)
	End If
End With


'Accounts Payable> Review Accounts Payable Info>Vouchers>Accounting Entries
SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))

'Enter the voucher NUmber and Business UNit
With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebEdit("BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,"BusinessUnit :"&dtBusinessUnit, "is present and entered as"&dtBusinessUnit,false)
		else
		Call WriteToReport(micfail,"BusinessUnit", "is not present in the application",false)
End If
End With 

'Enter the voucher ID
With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebEdit("VoucherID")
If .Exist(nMINWAIT) Then
	.Set dtVoucherID
	Call WriteToReport(micPass,"VoucherID :"&dtVoucherID, "is present and entered as"&dtVoucherID,false)
		else
		Call WriteToReport(micfail,"VoucherID", "is not present in the application",false)
End If
End With 

If Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebList("SortBy").Exist(nminwait) Then
	Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebList("SortBy").Select(2)
	Call WriteToReport(micPass,"Sortby is selected "&"Posting Process", "sortby is selected as"&"Posting Process" ,false)
End If

'Click on Seqarch button
With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'Search for the Table
WIth Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebTable("AccountingInformation")
If .Exist(nMINWAIT) Then
	If .RowCount>=2 Then
		For i=1 to .RowCount
			appDate=.GetCellData(i,6)
			If Cdate(appDate)=Date OR Cdate(appDate)=Date-1 Then
				Call WriteToReport(micPass,"Posting date is captured  "&appdate, "Posting date is captured as"&appdate ,false)
				Exit for
'				Call WriteToReport(micPass,"THe voucehr entries are added in the", "table and date is"&appDate,false)
'				GlobalDictionary("Rowcount")=.RowCount
			End If
		Next
	End If
	Else
	Call WriteToReport(micFail,"THe voucehr entries are not added in the", "table",True)
End If
End With

'
'
''Navigate to below 
''Accounts Payable>Batch Processes>Vouchers>Voucher Posting
'SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
'
'	
'	'CLick on Add NEw value Tab
'	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebElement("AddNewValue")
'	If .Exist(nMINWAIT) Then
'		.Click
'		
'		'Enter the control ID
'		With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("PRCSRUNCNTL_RUN_CNTL_ID")
'		If .Exist(nMINWAIT) Then
'			.Set dtControlID & RandomNumberGeneraion & Day(Date)
'			
'		End If
'		End WIth 
'		
'		'CLick onb Add Button
'		With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebButton("Add")
'		If .Exist(nMINWAIT) Then
'			.Click
'			Call WriteToReport(micPass,"Add button ", "is present and clicked",false)
'		else
'		Call WriteToReport(micPass,"Add button", "is not present in the application",false)
'		End If
'		End With 
'
'		Else
'		Call WriteToReport(micFail,"Add New value is not present","and not able to enter  the Details",True)
'	End If
'	End WIth 
'
'	'Wait for the applicatoin load
'	Browser("PeopleSoft Browser").Sync
'	
'	'Check if the add ing nwe contorl page ois displayed
'	If Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("RequestID").WaitProperty("visible",True,2000) Then
'		
'	'Enter the Run control IDF values in the Page
'	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("RequestID")
'	If .Exist(nMINWAIT) Then
'		.Set dtRequestID
'		Call WriteToReport(micPass,"RequestID :"&dtRequestID, "is present and entered as"&dtRequestID,false)
'		else
'		Call WriteToReport(micPass,"RequestID", "is not present in the application",false)
'	End If
'	End WIth 
'	
'	'Enter the description
'	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("Description")
'	If .Exist(nMINWAIT) Then
'		.Set dtDescription
'		Call WriteToReport(micPass,"Description :"&dtDescription, "is present and entered as"&dtDescription,false)
'		else
'		Call WriteToReport(micPass,"Description", "is not present in the application",false)
'	End If
'	End WIth 
'	
'	'Select the voucher Posting option
'	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebList("PostVoucherOption")
'	If .Exist(nMINWAIT) Then
'		.Select dtPostVoucherOption
'		Call WriteToReport(micPass,"PostVoucherOption :"&dtPostVoucherOption, "is present and entered as"&dtPostVoucherOption,false)
'		else
'		Call WriteToReport(micPass,"PostVoucherOption", "is not present in the application",false)
'	End If
'	End WIth 
'	
'	'Select the Prepamenty application
'	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebList("PrepaymentApplicationMethod")
'	If .Exist(nMINWAIT) Then
'		.Select dtPrepaymentApplicationMethod
'		Call WriteToReport(micPass,"PrepaymentApplicationMethod :"&dtPrepaymentApplicationMethod, "is present and entered as"&dtPrepaymentApplicationMethod,false)
'		else
'		Call WriteToReport(micPass,"PrepaymentApplicationMethod", "is not present in the application",false)
'	End If
'	End With
'	
'	'Select the process frequency
'	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebList("ProcessFrequency")
'	If .Exist(nMINWAIT) Then
'		.Select dtProcessFrequency
'		Call WriteToReport(micPass,"ProcessFrequency :"&dtProcessFrequency, "is present and entered as"&dtProcessFrequency,false)
'		else
'		Call WriteToReport(micPass,"ProcessFrequency", "is not present in the application",false)
'	End If
'	End With
'	
'	'ENter the Business UNit
'	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("BusinessUnit")
'	If .Exist(nMINWAIT) Then
'		.Set dtBusinessUnit
'		Call WriteToReport(micPass,"BusinessUnit :"&dtBusinessUnit, "is present and entered as"&dtBusinessUnit,false)
'		else
'		Call WriteToReport(micPass,"BusinessUnit", "is not present in the application",false)
'	End If
'	End WIth 
'	
'	'Enter the Voucher ID
'	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("VoucherID")
'	If .Exist(nMINWAIT) Then
'		.Set dtVoucherID
'		Call WriteToReport(micPass,"VoucherID :"&dtVoucherID, "is present and entered as"&dtVoucherID,false)
'		else
'		Call WriteToReport(micPass,"VoucherID", "is not present in the application",false)
'	End If
'	End WIth 
'	
'	'Click on Run button
'	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebButton("Run")
'	If .Exist(nMINWAIT) Then
'		.Click
'		Call WriteToReport(micPass,"Run button", "is present and clicked",false)
'		else
'		Call WriteToReport(micPass,"Run button", "is not present in the application",false)
'	End If
'	End WIth 
'	
'	'Selcet the post voucejhr and clickon Ok button
'	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("ProcessSchdeluerRequest").WebTable("ProcessList")
'	If .Exist(nMINWAIT) Then
'		For i=2 to .RowCount
'			appDescription=.GetCellData(i,2)
'			If appDescription="Post vouchers" Then
'				Set oVoucherLink=.ChildItem(i,1,"WebCheckBox",0)
'				appProcessName=.GetCellData(i,3)
'				Call WriteToReport(micPass,"The Process Name is", "is"&appProcessName,False)
'				If oVoucherLink.exist(nMINWAIT) Then
'					oVoucherLink.click
'				End If
'			End If
'		Next
'	End If
'	End With
'
'	
'	'Click on Ok button
'	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("ProcessSchdeluerRequest").WebButton("Ok")
'	If .Exist(nMINWAIT) Then
'		.Click
'	End If
'	End WIth 
'	
'	'Get the Process INstance Number
'	'Get the instance number present to validate in upcoming steps
'	appInstanceNumberWithoutTrim = Browser("creationtime:=0").Page("index:=1").WebElement("innertext:=Process Instance:.*", "index:=1").GetROProperty("innertext")
'	appInstanceNumber=Trim(Mid(appInstanceNumberWithoutTrim,18))
'	app_SearchSync()
'	GlobalDictionary("instanceNumber")=appInstanceNumber
'	
'
'	'Click on Process moonitor
'	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("VoucherPostingRequest").Link("Process Monitor")
'	If .Exist(nMINWAIT) Then
'		.Click
'		Call WriteToReport(micPass,"Process Monitor", "is present and clicked",false)
'		else
'		Call WriteToReport(micPass,"Process Monitor", "is not present in the application",false)
'	End If
'	End With 
'	
'	'Enter all the detail in the Process monitor screen
'	With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebEdit("InstanceFrom")
'	If .Exist(nMINWAIT) Then
'		.Set (GlobalDictionary("instanceNumber"))
'		Call WriteToReport(micPass,"instanceNumber :"& (GlobalDictionary("instanceNumber")), "is generated and entered in Instance from"& (GlobalDictionary("instanceNumber")),false)
'		else
'		Call WriteToReport(micPass,"InstanceFrom ", "is not present in the application",false)
'	End If
'	End WIth 
'	
'	'Click on Refresh button
'	With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Refresh")
'	If .Exist(nMINWAIT) Then
'		.Click
'	End If
'	End With 
'	
'	sStatus="Success"
'	'check the status of the Job 
'	With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor")
'	If .Exist(nMINWAIT) Then
'	While Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor").GetCellData(2,8)<>sStatus and nCount<10
'		wait(10)
'		nCount=nCount+1
'		Set oRefresh=Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Refresh")
'		If oRefresh.Exist(nMAXWAIT) Then
'			oRefresh.Click
'		End If
'		Set oRefresh=Nothing
'		Wend
'	End If
'	End With
'
'	dtStatus="Posted"
'	'check the distribution status
'	If Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor").GetCellData(2,8)="Success" Then
'	While Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)<>dtStatus and dtCount<20
'		dtCount=dtCount+1
'		Set oRefresh=Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Refresh")
'		If oRefresh.Exist(nMAXWAIT) Then
'			oRefresh.Click
'		End If
'		Set oRefresh=Nothing
'	Wend
'	
'	If Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)="Posted" Then
'		Call WriteToReport(micPass,"Process Monitor", "able to successfully complete process = [ " & instanceNumber &"]",false)
'		Else
'		Call WriteToReport(micFail,"Process Monitor", "Unable to successfully complete process = [ " & instanceNumber &"]",True)
'	End If
'	Else
'	Call WriteToReport(micFail,"Process Monitor", "Unable to successfully complete process = [ " & instanceNumber &"]",True)
'	End If
'	
'Else
'	Call WriteToReport(micFail,"Not able to enter the details ","for running voiucher and not able to run the voucher control",True)
'End If
'
'Browser("PeopleSoft Browser").Sync
'
'
'
''Navigate toe Next page toe search for the entries
''(Accounts Payable / Review / Vouchers / Voucher Accounting Entries)
'SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))
'
''Enter the voucher NUmber and Business UNit
'With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebEdit("BusinessUnit")
'If .Exist(nMINWAIT) Then
'	.Set dtBusinessUnit
'	Call WriteToReport(micPass,"BusinessUnit :"&dtBusinessUnit, "is present and entered as"&dtBusinessUnit,false)
'		else
'		Call WriteToReport(micPass,"BusinessUnit", "is not present in the application",false)
'End If
'End With 
'
''Enter the voucher ID
'With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebEdit("VoucherID")
'If .Exist(nMINWAIT) Then
'	.Set dtVoucherID
'	Call WriteToReport(micPass,"VoucherID :"&dtVoucherID, "is present and entered as"&dtVoucherID,false)
'		else
'		Call WriteToReport(micPass,"VoucherID", "is not present in the application",false)
'End If
'End With 
'If Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebList("SortBy").Exist(nminwait) Then
'	Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebList("SortBy").Select(2)
'	Call WriteToReport(micPass,"Sortby is selected "&"Posting Process", "sortby is selected as"&"Posting Process" ,false)
'End If
'
''Click on Seqarch button
'With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebButton("Search")
'If .Exist(nMINWAIT) Then
'	.Click
'End If
'End With 
'
''Search for the Table
'WIth Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebTable("AccountingInformation")
'If .Exist(nMINWAIT) Then
'	If .RowCount>=2 Then
'		For i=1 to .RowCount
'			appDate=.GetCellData(i,6)
'			If Cdate(appDate)=Date Then
''				If (GlobalDictionary("Rowcount"))=.RowCount Then
'				Call WriteToReport(micPass,"Posting date is updated  "&appdate, "Posting date is updated as"&appdate ,false)
'				Exit for
''			End If
'			End  If
'		Next
'	End If
'	Else
'	Call WriteToReport(micFail,"THe voucehr entries are not added in the", "table",True)
'End If
'End With 
'
'


''Click on Find Exisgin value
'With Browser("PeopleSoft Browser").Page("VoucherRegularEntry").PSFrame("TargetContent").WebElement("Find an Existing Value")
'If .Exist(nMINWAIT) Then
'	.Click
'	Call WriteToReport(micPass,"Find existing value", "is present and clicked",false)
'End If
'End  With 
'
''ENter voucher ID
'With Browser("PeopleSoft Browser").Page("VoucherRegularEntry").PSFrame("TargetContent").WebEdit("Search_VOUCHER_ID")
'If .Exist(nMINWAIT) Then
'	.Set dtVoucherID
'End If
'End  With 
'
'Browser("PeopleSoft Browser").Page("VoucherRegularEntry").PSFrame("TargetContent").WebButton("Search")
'If .Exist(nMINWAIT) Then
'	.Click
'	Call WriteToReport(micPass,"Search", "is present and clicked",false)
'End If
'End  With 
'
''CLick on Invoice information
'With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("InvoiceInformation")
'If .Exist(nMINWAIT) Then
'	.Click
'	
'	app_SearchSync()
'	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("GLUnit")
'	If .Exist(nMINWAIT) Then
'		.Set dtGLUnit
'	End If
'	End  WIth 
'	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Account")
'	If .Exist(nMINWAIT) Then
'		.Set dtAccount
'	End If
'	End  WIth 
'	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Dept")
'	If .Exist(nMINWAIT) Then
'		.Set dtDept
'	End If
'	End  WIth 
'	
'	'CLicko n Save
'	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Save")
'	If .Exist(nMINWAIT) Then
'		.Click
'	End If
'	End  WIth

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


Public Function RandomNumberGeneraion()
max=54
min=23
Randomize
RandomNumberGeneraion = CInt(Int((max-min+1))*Rnd+min)
End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_02_02_13
'**********************************************************************************************************************************
Public Function addRegularNonPORelatedVoucherManuallyAssoicateaReceiver()
Dim voucherID,businessunit,approvalStatus,invoiceNo,Total,supplierID,invoiceDate,i,CopyFrom,PayTerm

	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo")&inVoiceNumberGeneration
	invoiceDate=GlobalDictionary("invoiceDate")
	supplierID=GlobalDictionary("SupplierID")
	CopyFrom=GlobalDictionary("CopyFrom")
	PayTerm=GlobalDictionary("PayTerm")

	'wait for the ojects to get loaded
	app_SearchSync()
	wait 3
	'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit "&businessunit,"is present and entered as "&businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id "&voucherID,"is present and entered as "&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		wait(4)
		.WebButton("Add").highlight
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
'	For i = 0 To 10 Step 1
'		If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
'			Exit for
'		else
'			wait(5)
'		End If
'	Next
	.WebEdit("invoiceNo").WaitProperty "visible",true,20000
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo
		Call WriteToReport(micPass,"invoiceNo "&invoiceNo,"is present and entered as "&invoiceNo,false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date "&invoiceDate,"is present and entered as "&invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	If .WebEdit("PayTerms").Exist(nMINWAIT) Then
		.WebEdit("PayTerms").Set PayTerm
		Call WriteToReport(micPass,"PayTerm "&PayTerm,"is present and entered as "&PayTerm,false)
		else
		Call WriteToReport(micFail,"PayTerm","is not present",True)
	End If
End with	
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Exist(nMINWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Click
	End If

	If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Exist(nMINWAIT) Then
'		If InStr(supplierID,"...")<>0 Then
		Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Set Replace(supplierID,"...","")'left(supplierID,3)
		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Click
		End If

		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").Exist(nMINWAIT) Then
			If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").RowCount))>1 Then
				Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").ChildItem(2,1,"Link",0).click
			End If
		End If
'		else
'			Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID").Set Trim(supplierID)
'		End If
		Call WriteToReport(micPass,"Supplier ID","is present and value entered",false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")		
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If .WebEdit("freight").Exist(nMINWAIT) Then
		.WebEdit("freight").Click
	End If
	wait 3 
	If .WebEdit("salesTax").Exist(nMINWAIT) Then
		.WebEdit("salesTax").Click
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	wait 4
	
	If .WebList("CopyFrom").Exist(nMINWAIT) Then
		.WebList("CopyFrom").Select CopyFrom
		Call WriteToReport(micPass,"CopyFrom","is present and selected "&CopyFrom,false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .Link("Go").Exist(nMINWAIT) Then
		wait(3)
		.Link("Go").Click
		Call WriteToReport(micPass,"go link ","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Go link","is not present",True)
	End If
	
	If .WebEdit("POBusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("POBusinessUnit").Set businessunit
		Call WriteToReport(micPass,"POBusinessUnit "&businessunit,"is present and entered as "&businessunit,false)
		else
		Call WriteToReport(micFail,"POBusinessUnit","is not present",True)
	End If
	
	If .WebButton("PONumberLookup").Exist(nMINWAIT) Then
		.WebButton("PONumberLookup").Click
	End If
End with	
	Dim temp:temp=0
	wait(4)
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").Exist(nMINWAIT) Then
		If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").RowCount))>1 Then
			Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").ChildItem(2,1,"Link",0).click
			temp=1
		else
			Call WriteToReport(micFail,"invoices for "&businessunit&","&supplierID ,"is not present",True)
		End If
	End If
	
If temp=1 Then
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	

	If .WebButton("CopyEntireDocument").Exist(nMINWAIT) Then
		.WebButton("CopyEntireDocument").Click
		Call WriteToReport(micPass,"CopyEntireDocument","is present and clicked",false)
		else
		Call WriteToReport(micFail,"CopyEntireDocument","is not present",True)
	End If
	
	.WebEdit("Total").WaitProperty "visible",True,20000
	If .WebElement("Difference").Exist(nMINWAIT) Then
		Total=.WebElement("Difference").GetROProperty("innertext")
	End If
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		wait 5
		.WebEdit("Total").Click
		.WebEdit("Total").Set Total
		Call WriteToReport(micPass,"Total","is present and entered as "&Total,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	wait(5)
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
	
'	For i = 0 To 10 Step 1
		If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
'			Exit for
'		else
'			wait(5)
		End If
'	Next
'wait for the ojects to get loaded
	app_SearchSync()	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	
'	For i = 0 To 10 Step 1
'		If .WebButton("SubmitApproval").Exist(nMINWAIT) Then
'			Exit for
'		else
'			wait(5)
'		End If
'	Next
'wait for the ojects to get loaded
	app_SearchSync()
	If .WebElement("voucherID").Exist(nMINWAIT) Then
		approvalStatus=.WebElement("voucherID").GetROProperty("innertext")
		If StrComp(approvalStatus,"NEXT",1)<>0 Then
			Call WriteToReport(micPass,"voucherID "&approvalStatus,"is present and generated as "&approvalStatus,false)
			else
			Call WriteToReport(micFail,"voucherID","doesn't get generated",True)
		End If
	End If

	If .WebElement("tabPayments").Exist(nMINWAIT) Then
		.WebElement("tabPayments").Click
		Call WriteToReport(micPass,"Payments tab","is present and clicked",false)
		else
		Call WriteToReport(micFail,"voucherID","doesn't present",True)
	End If
	
End with
End If
End Function

'*********************************************************************************************************************************
''' <summary>  
''' searchsupplierContactInfo() To Supplier Contact Information
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "MainMenuSelection, setID, SupplierID"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'1.1.13

Public Function searchsupplierContactInfo()
	Dim setid,supplierID
'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	setid=GlobalDictionary("setID")
	supplierID=GlobalDictionary("SupplierID")
with Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Contact")
	
	If .WebEdit("SetID").Exist(nMINWAIT) Then
		.WebEdit("SetID").Set setID
		Call WriteToReport(micPass,"Set ID","is present and entered="&setID,false)
		else
		Call WriteToReport(micFail,"Set id","doesn't present",True)
	End If
	If .WebEdit("SupplierID").Exist(nMINWAIT) Then
		.WebEdit("SupplierID").Set supplierID
		Call WriteToReport(micPass,"Supplier id","is present and entered="&supplierID,false)
		else
		Call WriteToReport(micFail,"Supplier id","doesn't present",True)
	End If
	If .WebButton("Search").Exist(nMINWAIT) Then
		.WebButton("Search").Click
		Call WriteToReport(micPass,"Search","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Search","doesn't present",True)
	End If
	'wait for the ojects to get loaded
	app_SearchSync()
	If .WebButton("ReturntoSearch").Exist(nMINWAIT) Then
		Call WriteToReport(micPass,"Search results","Search results displayed successfully",false)
		else
		Call WriteToReport(micFail,"Search results","search results doesnt dispalyed",True)
	End If
End with 
End Function

'*********************************************************************************************************************************
''' <summary>  
''' overridePaymentTermsonVoucherPORelated() To Override Payment Terms on Voucher (PO Related)
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "voucherID,businessunit,invoiceNo,supplierID,invoiceDate,CopyFrom,PayTerm"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to add vouchers</startstate>
''' <endstate>Payterm will be overiden</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'Test case:2.2.19 Override Payment Terms on Voucher (PO Related)
'AP_02_02_19
Public Function overridePaymentTermsonVoucherPORelated()
Dim voucherID,businessunit,approvalStatus,invoiceNo,Total,supplierID,invoiceDate,i,CopyFrom,PayTerm

	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo")&inVoiceNumberGeneration
	invoiceDate=GlobalDictionary("invoiceDate")
	supplierID=GlobalDictionary("SupplierID")
	CopyFrom=GlobalDictionary("CopyFrom")
	PayTerm=GlobalDictionary("PayTerm")

	'wait for the ojects to get loaded
	app_SearchSync()
	wait 3
	'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit ","is present and entered "&businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id ","is present and entered "&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		wait(4)
		.WebButton("Add").highlight
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()

	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo
		Call WriteToReport(micPass,"invoiceNo ","is present and entered "&invoiceNo,false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date ","is present and entred as "&invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	
End with	
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Exist(nMINWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Click
	End If

	If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Exist(nMINWAIT) Then
'		If InStr(supplierID,"...")<>0 Then
		Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Set Replace(supplierID,"...","")
		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Click
		End If

		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").Exist(nMINWAIT) Then
			If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").RowCount))>1 Then
				Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").ChildItem(2,1,"Link",0).click
			End If
		End If
'		else
'			Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID").Set Trim(supplierID)
'		End If
		Call WriteToReport(micPass,"Supplier ID","is present and value entered"&supplierID,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")		
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If .WebEdit("freight").Exist(nMINWAIT) Then
		.WebEdit("freight").Click
	End If
	wait 3 
	If .WebEdit("salesTax").Exist(nMINWAIT) Then
		.WebEdit("salesTax").Click
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	wait 4
	
	If .WebList("CopyFrom").Exist(nMINWAIT) Then
		.WebList("CopyFrom").Select CopyFrom
		Call WriteToReport(micPass,"CopyFrom","is present and selected "&CopyFrom,false)
		else
		Call WriteToReport(micFail,"CopyFrom","is not present",True)
	End If
	
	If .Link("Go").Exist(nMINWAIT) Then
		wait(3)
		.Link("Go").Click
		Call WriteToReport(micPass,"go link ","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Go link","is not present",True)
	End If
	
	If .WebEdit("POBusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("POBusinessUnit").Set businessunit
		Call WriteToReport(micPass,"POBusinessUnit ","is present and entered as"&businessunit,false)
		else
		Call WriteToReport(micFail,"POBusinessUnit","is not present",True)
	End If
	
	If .WebButton("PONumberLookup").Exist(nMINWAIT) Then
		.WebButton("PONumberLookup").Click
	End If
End with	
	Dim temp:temp=0
	wait(4)
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").Exist(nMINWAIT) Then
		If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").RowCount))>1 Then
			Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").ChildItem(2,1,"Link",0).click
			temp=1
		else
			Call WriteToReport(micFail,"invoices for "&businessunit&","&supplierID ,"is not present",True)
		End If
	End If
	
If temp=1 Then
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
	
	If .WebButton("CopyEntireDocument").Exist(nMINWAIT) Then
		.WebButton("CopyEntireDocument").Click
		Call WriteToReport(micPass,"CopyEntireDocument","is present and clicked",false)
		else
		Call WriteToReport(micFail,"CopyEntireDocument","is not present",True)
	End If
	app_SearchSync()
'	.WebEdit("Total").WaitProperty "visible",True,20000
	If .WebElement("Difference").Exist(nMINWAIT) Then
		Total=.WebElement("Difference").GetROProperty("innertext")
		Call WriteToReport(micPass,"Deifference is captured","Captured from application as"&Total,false)
	End If
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		.WebEdit("Total").Click
		.WebEdit("Total").Set Total
		Call WriteToReport(micPass,"Total","is present",false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	app_SearchSync()
	If .WebEdit("PayTerms").Exist(nMINWAIT) Then
		If .WebElement("regEntry_labelDueNow").Exist(nminwait) Then
			Call WriteToReport(micPass,"CopyFrom is captured from application","Captured values are "&.WebEdit("PayTerms").GetROProperty("value")&"- "&.WebElement("regEntry_labelDueNow").GetROProperty("innertext") ,false)
		End If
		.WebEdit("PayTerms").Set PayTerm
		Call WriteToReport(micPass,"PayTerm ","is present and entered as"&PayTerm,false)
		
		else
		Call WriteToReport(micFail,"PayTerm","is not present",True)
	End If
	app_SearchSync()
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	

		If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click

		End If

'wait for the ojects to get loaded
	app_SearchSync()	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	

'wait for the ojects to get loaded
	app_SearchSync()
	If .WebElement("voucherID").Exist(nMINWAIT) Then
		approvalStatus=.WebElement("voucherID").GetROProperty("innertext")
		If StrComp(approvalStatus,"NEXT",1)<>0 Then
			Call WriteToReport(micPass,"voucherID","is present and generated as "&approvalStatus,false)
			else
			Call WriteToReport(micFail,"voucherID","doesn't get generated",True)
		End If
	End If
	If .WebEdit("PayTerms").Exist(nMINWAIT) Then
		If .WebElement("regEntry_labelDueNow").Exist(nminwait) Then
			Call WriteToReport(micPass,"CopyFrom is captured from application","Captured values are "&.WebEdit("PayTerms").GetROProperty("value")&"- "&.WebElement("regEntry_labelDueNow").GetROProperty("innertext") ,false)
		End If
	End If
End with
else
	Call WriteToReport(micFail,"PO Number search","no results(Supllier details) available while PO lookup for BU:"&businessunit,True)
End If

End Function

Function inVoiceNumberGeneration()
	inVoiceNumberGeneration=left(Replace(date,"/",""),4)&left(Replace(Time,":",""),4)&mid(Replace(Time,":",""),8,1)
End Function


'**********************************************************************************************************************************************************
''' <summary>  
''' InquireVoucher () To Inquire on Voucher					
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "businessUnit, fromVoucherID, toVoucherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/18/2018</datecreated>
''' <startstate>Logged in as user that has right to inquire vouchers</startstate>
''' <endstate>Voucher details should be displayed.</endstate>
'Change Control: 
'NA
'**********************************************************************************************************************************
'3.1.8

Public Function InquireVoucher()
Dim dtBusinessUnit,dtFromVoucherID,dtToVoucherID

'Navigate to Accounts Payable/ Review Accounts Payable Info/Vouchers/Voucher
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
dtBusinessUnit=(GlobalDictionary("businessUnit"))
dtFromVoucherID=(GlobalDictionary("fromVoucherID"))
dtToVoucherID=(GlobalDictionary("toVoucherID"))

'Enter FromBusinessunit
With Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").WebEdit("vouInquiry_txtFromBU")
If .Exist(NMINWAIT) Then
      .Set dtBusinessUnit
      Call WriteToReport(micPass,"From BusinessUnit","From BusinessUnit is="&dtBusinessUnit,false)
End If
End WIth 

'Enter ToBusinesssunit
With Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").WebEdit("vouInquiry_txtToBU")
If .Exist(NMINWAIT) Then
      .Set dtBusinessUnit
       Call WriteToReport(micPass,"To BusinessUnit","To BusinessUnit is="&dtBusinessUnit,false)
End If
End WIth 

'Enter FromVoucherId
With Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").WebEdit("vouInquiry_txtFromVoucherID")
If .Exist(NMINWAIT) Then
      .Set dtFromVoucherID
      Call WriteToReport(micPass,"From VoucherId","From VoucherId is="&dtFromVoucherID,false)
End If
End WIth 

'Enter ToVoucherId
With Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").WebEdit("vouInquiry_txtToVoucherId")
If .Exist(NMINWAIT) Then
      .Set dtToVoucherID
      Call WriteToReport(micPass,"To VoucherID","To VoucherID is="&dtToVoucherID,false)
End If
End WIth 

'Click Search Button
With Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").WebButton("vouInquiry_btnSearch")
If .Exist(NMINWAIT) Then
      .Click
End If
End WIth 

'Search Voucher table
If Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").WebTable("vouInquiry_tblSearchVoucher").Exist(10) then
	If Cint(Trim(Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").WebTable("vouInquiry_tblSearchVoucher").RowCount))>1 Then
			Set obj1=Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").WebTable("vouInquiry_tblSearchVoucher").ChildItem(2,1,"Link",0)
			obj1.Click
			Set obj1=Nothing	
	End If
				Call WriteToReport(micPass,"Action table", "displayed successfully",false)

'Click Voucher link
   With Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").Link("vouInquiry_linkVoucherDetails")
		If .Exist(NMINWAIT) Then
			.Click			
		End If
	End  With
	
	'Click Voucher details and displayed
    With Browser("PeopleSoft Browser").Page("Voucher").PSFrame("Voucher Line Details").WebTable("vouInquiry_VoucherDetails")
		If .Exist(NMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Voucher").WebElement("vouLine_btnVoucherLineClose").Click
			Call WriteToReport(micPass,"Voucher Line details page is", "displayed successfully",false)
		Else
		  	Call WriteToReport(micFail,"Voucher Line details page is", "not displayed successfully",True)
		End If
	End  With
	
Else
			Call WriteToReport(micFail,"Action table", "not displayed successfully",True)
End If


End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'Testcase 1.28
'**********************************************************************************************************************************
Function FormAttachments
'Navigate to below page
'CDW Menu/CDW System process requst
SelectMainMenu1(GlobalDictionary("FormAttachmentNav"))

'Initializing variable
Dim processInst,dtrunControlId,nCount
dtrunControlId=GlobalDictionary("runControlID") &inVoiceNumberGeneration
nCount=GlobalDictionary("Count")
sStatus=GlobalDictionary("Status")

'Click AddNewTab
With Browser("PeopleSoft Browser").Page("CDW System Process Request").PSFrame("TargetContent").WebElement("spr_tabAddNewValue")
 If .Exist(nMINWAIT) Then
 	.Click
 End If
End With

'Enter RunControlId
With Browser("PeopleSoft Browser").Page("CDW System Process Request").PSFrame("TargetContent").WebEdit("spr_txtRunControlD")
 If .Exist(nMINWAIT) Then
 	.Set dtrunControlId 
 	Call WriteToReport(micPass,"RunControlId","RunControlId is="&dtrunControlId,false)
 End If
End With

'Click Add button
With Browser("PeopleSoft Browser").Page("CDW System Process Request").PSFrame("TargetContent").WebButton("spr_btnAdd")
 If .Exist(nMINWAIT) Then
 	.Click
 	 	 	Call WriteToReport(micPass,"Add button is clicked and CDW System process request page is", "displayed successfully",false)
		Else
		  	Call WriteToReport(micFail,"CDW System process request page is", "not displayed successfully",True)
 End If
End With

'Click Run button
With Browser("PeopleSoft Browser").Page("CDW System Process Request").PSFrame("TargetContent").WebButton("sprSauce_btnRun")
 If .Exist(nMINWAIT) Then
 	.Click
 		Call WriteToReport(micPass,"Run button is clicked and Process Scheduler request page is", "displayed successfully",false)
	Else
	  	Call WriteToReport(micFail,"Process Scheduler request page is", "not displayed successfully",True)
 End If
End With

'Search for the table
If Browser("PeopleSoft Browser").Page("CDW System Process Request").PSFrame("Process Scheduler Request").WebTable("psr_tblProcessList").Exist(10) Then

With Browser("PeopleSoft Browser").Page("CDW System Process Request").PSFrame("Process Scheduler Request").WebTable("psr_tblProcessList")
	If .Exist(nMAXWAIT) Then
		For i=2 to .RowCount
			appDescription=.GetCellData(i,2)
			If appDescription="Vendor Form Attachment Load" Then
			appProcessName=.GetCellData(i,3)
				Set oVendorForm=.ChildItem(i,1,"WebCheckBox",0)
				If oVendorForm.exist(nMAXWAIT) Then
					oVendorForm.click
					Exit For
				End If
			End If
		Next
	End If
End With 
 			Call WriteToReport(micPass,"Process Scheduler request webtable is", "displayed and vendor form attachement load check box is checked successfully",false)
		Else
		  	Call WriteToReport(micFail,"Process Scheduler request page is", "not displayed and not checked successfully",True)
End If

'Click Ok button
With Browser("PeopleSoft Browser").Page("CDW System Process Request").PSFrame("Process Scheduler Request").WebButton("psr_btnOK")
 If .Exist(nMINWAIT) Then
 	.Click
 	Call WriteToReport(micPass,"OK button", "is clicked successfully",false)
 End If
End With

'Displayed process instance
With Browser("PeopleSoft Browser").Page("CDW System Process Request").PSFrame("Status Bar").WebElement("spr_labelProcessInstance")
 If .Exist(nMINWAIT) Then
 	processInst=Browser("PeopleSoft Browser").Page("CDW System Process Request").PSFrame("Status Bar").WebElement("spr_labelProcessInstance").GetROProperty("innertext")
 	pInst=Split(processInst,":")
 	pNo=pInst(1)
 	 		Call WriteToReport(micPass,"Process Instance value is", "displayed successfully= [ " & pNo &"]",false)
		Else
		  	Call WriteToReport(micFail,"Process Instance value is", "not displayed successfully= [ " & pNo &"]",True)
 End If
End With

'Click the process monitor link
With Browser("PeopleSoft Browser").Page("CDW System Process Request").PSFrame("Status Bar").Link("spr_linkProcessMonitor")
 If .Exist(nMINWAIT) Then
 	.Click
 	Call WriteToReport(micPass,"Process Monitor link is", "clicked",false)
 End If
End With


'In the process list table verify whether status becomes success
'Check the Run status
For i=0 to 2
	app_SearchSync()
Next

Call CheckProcessMontiorStatus (appProcessName)

For i=0 to 2
	app_SearchSync()
Next

With Browser("PeopleSoft Browser").Page("Process Requests").WebButton("No")
If .Exist(nMINWAIT) Then
	.click
End If
End  With 



'With Browser("PeopleSoft Browser").Page("Process Requests").PSFrame("Process Monitor").WebTable("procReq_tableSelect")
'If .Exist(nMINWAIT) Then
'	Browser("PeopleSoft Browser").Page("Process Requests").PSFrame("Process Monitor").WebEdit("procReqDial_txtInstanceFrom").Set pNo
'	Browser("PeopleSoft Browser").Page("Process Requests").PSFrame("Process Monitor").WebButton("procReq_btnRefresh").Click
'                While Browser("PeopleSoft Browser").Page("Process Requests").PSFrame("Process Monitor").WebTable("procReq_tableSelect").GetCellData(2,8)<>sStatus and nCount<400
'                                wait(nMINWAIT)
'                                nCount=nCount+1
'                                Set oRefresh=Browser("PeopleSoft Browser").Page("Process Requests").PSFrame("Process Monitor").WebButton("procReq_btnRefresh")
'                                If oRefresh.Exist(nMINWAIT) Then
'                                      oRefresh.Click
'                                End If
'                                Set oRefresh=Nothing
'                Wend
'            
'End If
'Call WriteToReport(micPass,"Refresh button is", "clicked until the status is changed to Success",false)
'End With

'Navigate back to CDW System Process Request page
With Browser("PeopleSoft Browser").Page("Process Requests").WebElement("procReq_btnBacProcReqDialog")
 If .Exist(nMINWAIT) Then
 	.Click
 	Call WriteToReport(micPass,"Navigate back", "to CDW system process request page",false)
 End If
End With

For i=0 to 2
	app_SearchSync()
Next

With Browser("PeopleSoft Browser").Page("Process Requests").WebButton("No")
If .Exist(nMINWAIT) Then
	.click
End If
End  With 

'Click on Report Manager link
With Browser("PeopleSoft Browser").Page("CDW System Process Request").PSFrame("CDW System Process Request").Link("spr_linkReportManager")
 If .Exist(5) Then
 	.Click
 	Call WriteToReport(micPass,"Report manager link", "is clicked",false)
 End If
End With

'Set Instance in Report List
With Browser("PeopleSoft Browser").Page("Report List").PSFrame("Report Distribution Mgr").WebEdit("reportList_txtInstance")
 If .Exist(nMINWAIT) Then
 	.Set  pNo
 	Call WriteToReport(micPass,"Process Instance number","Process Instance number is set="&pNo,false)
 End If
End With

'Click refresh button
With Browser("PeopleSoft Browser").Page("Report List").PSFrame("Report Distribution Mgr").WebButton("reportList_btnRefresh")
 If .Exist(5) Then
 	.Click
' 	Call WriteToReport(micPass,"Refresh button","is clicked",false)
 End If
End With

'Search for the table 
With Browser("PeopleSoft Browser").Page("Report List").PSFrame("Report Distribution Mgr").WebTable("reportList_tableReport")
 If .Exist(5) Then
 	.Click
 	Call WriteToReport(micPass,"Search for the","Process Instance number in table",false)
 End If
End With

'check recent process instance and click
If Browser("PeopleSoft Browser").Page("Report List").PSFrame("Report Distribution Mgr").WebTable("reportList_tableReport").Exist then
	If Browser("PeopleSoft Browser").Page("Report List").PSFrame("Report Distribution Mgr").WebTable("reportList_tableReport").GetCellData(2,7)=pNo Then
			If Cint(Trim(Browser("PeopleSoft Browser").Page("Report List").PSFrame("Report Distribution Mgr").WebTable("reportList_tableReport").RowCount))>1 Then
				Browser("PeopleSoft Browser").Page("Report List").PSFrame("Report Distribution Mgr").WebTable("reportList_tableReport").ChildItem(2,2,"Link",0).click
				Call WriteToReport(micPass,"CDW_VNDRFRM link ", "is clicked",false)
			End If
	End  If
		Call WriteToReport(micPass,"Report List table ", "is displayed successfully",false)
End If

'Check whether report index page is displayed
If Browser("PeopleSoft Browser").Page("Report Index").PSFrame("Report Index").WebTable("reportIndex_tableReport").Exist then
		Call WriteToReport(micPass,"Report Index page", "is displayed successfully",false)
		Else
		Call WriteToReport(micFail,"Report Index page","is not displayed successfully",True)
End If

'wait for the ojects to get loaded
For i=0 to 2
	app_SearchSync()
Next

Call VerifyAttachments()

End Function


'**********************************************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'************************************************************************************************************************************************************
'2.2.23

Public Function OverridePayNonPO()
Dim dtBusinessUnit
dtBusinessUnit=GlobalDictionary("BusinessUnit")
dtPayTerm=GlobalDictionary("PayTerm")

'To created and get the value of voucher id - calling the testcase-2.2.26
vocherID=AddRegularVoucherWithFreightCharges

'Navigate to below page
'CDW Menu/CDW System process requst
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'To click on Find an Existing value tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucher_tabFindExistingValue")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'To enter BU
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("voucherFE_txtBUSINESS_UNIT")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,"BusinessUnit is="&dtBusinessUnit,"is displayed",false)
End If
End With 

'To enter voucher ID which we get from testcase 2.2.26
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("voucherFE_txtVOUCHER_ID")
If .Exist(nMINWAIT) Then
	.Set vocherID
	Call WriteToReport(micPass,"VoucherId is="&vocherID,"is displayed",false)
End If
End With

'To click on search
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("voucher_btnSearch")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'To click on Invoice Information tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucher_tabInvoice Information")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'To capture the Pay Term value
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("regEntry_txtPayTerms")
If .Exist(nMINWAIT) Then
	txtPayterm=.GetROProperty("value")
	Call WriteToReport(micPass,"Before changing the PayTerm value ="&txtPayterm,"is displayed",false)
End If
End With

'To capture the existing value before changing the pay term value
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("regEntry_labelDueNow")
If .Exist(nMAXWAIT) Then
	valDueNow1=.GetROProperty("innertext")
		Call WriteToReport(micPass,"Payment date before re-sheduling="&valDueNow1,"is displayed",false)
End If
End With

'To enter the blank value in pay terms tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("regEntry_txtPayTerms")
If .Exist(nMINWAIT) Then
	.Set ""
End If
End With

'To set the Pay Term value
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("regEntry_txtPayTerms")
If .Exist(nMINWAIT) Then
	.Set dtPayTerm
	Call WriteToReport(micPass,"PayTerm is="&dtPayTerm,"is displayed",false)
End If
End With

'To click on Save button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("regEntry_btnSave")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

'To click on alert message
With Browser("PeopleSoft Browser").Page("Regular Entry").WebElement("MessageforDifference")
If .Exist(nMAXWAIT) Then
	Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
End If
End With

'To verify the label "DueNow"
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("regEntry_labelDueNow")
If .Exist(nMAXWAIT) Then
	valDueNow=.GetROProperty("innertext")
	If StrComp(valDueNow,"Due Now",1)=0 Then
		Call WriteToReport(micPass,"Payment date after rescheduling-changed to current date="&valDueNow,"is displayed",false)
	End If
	
End If
End With

End Function

'*********************************************************************************************************************************
''' <summary>  
''' inquireonJournalsGenerated() To Inquire on Journals Generated
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit,JournalID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to inquire the Journals</startstate>
''' <endstate>Journals will be searched</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_03_01_07 Inquire on Journals Generated
Public Function inquireonJournalsGenerated()
Dim BusinessUnit,JournalID,JournalDate
	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	BusinessUnit=GlobalDictionary("BusinessUnit")
	JournalID=GlobalDictionary("JournalID")
	JournalDate=Date-50'GlobalDictionary("JournalDate")
	With Browser("PeopleSoft Browser").Page("JournalDrillDown").PSFrame("JournalDrill")
		If .WebEdit("BussinessUnit").Exist(nMINWAIT) Then
			.WebEdit("BussinessUnit").Set BusinessUnit
			Call WriteToReport(micPass,"BusinessUnit","is present and value entered as"&BusinessUnit,false)
		else
			Call WriteToReport(micFail,"BusinessUnit","is not present in application",True)
		End If
		'wait for the ojects to get loaded638
	app_SearchSync()
		If .WebEdit("JournalDate").Exist(nminwait) Then
			.WebEdit("JournalDate").Set JournalDate
			Call WriteToReport(micPass,"JournalDate","is present and value entered as"&JournalDate,false)
		else
			Call WriteToReport(micFail,"JournalDate","is not present in application",True)
		End If
		If .WebEdit("JournalID").Exist(nminwait) Then
			.WebEdit("JournalID").Set JournalID
			Call WriteToReport(micPass,"JournalID","is present and value entered as"&JournalID,false)
		else
			Call WriteToReport(micFail,"JournalID","is not present in application",True)
		End If
		If .WebButton("Search").Exist(nminwait) Then
			.WebButton("Search").Click
			Call WriteToReport(micPass,"Search button","is present and clicked",false)
		else
			Call WriteToReport(micFail,"Search button","is not present in application",True)
		End If
'wait for the ojects to get loaded
	app_SearchSync()		
		Dim appJournalID,appGLlinenumber,temp
		If .WebTable("SearchResults").Exist(nminwait) Then
			If Cint(Trim(.WebTable("SearchResults").RowCount))>1 Then
				Call WriteToReport(micPass,"Search Results"," Results are displayed successfully",false)
				appJournalID=.WebTable("SearchResults").GetCellData(2,2)
				appGLlinenumber=.WebTable("SearchResults").GetCellData(2,4)
				.WebTable("SearchResults").ChildItem(2,1,"Link",0).click
				Call WriteToReport(micPass,"Journal Selected from Search Results"," journal id "&appJournalID&",GL Journal line number "&appGLlinenumber&" is opened from search results", false)
				temp=1
			else
				Call WriteToReport(micFail,"Search Results","No journal is displayed in application",True)
			End If
		else
			Call WriteToReport(micFail,"Search Results","is not present in application",True)
		End If
End With
'wait for the ojects to get loaded

	For i=0 to 3
	app_SearchSync()
	Next

with Browser("PeopleSoft Browser").Page("JournalDrillDown").PSFrame("DrilltoSource")
	If .WebElement("VoucherInformation").Exist(nminwait) Then
		.WebElement("VoucherInformation").Click
		Call WriteToReport(micPass,"Voucher information tab","is present and clicked",false)
	else
		Call WriteToReport(micFail,"Voucher information tab","is not present in application",True)
	End If
	Dim appVoucherID
	If .WebTable("VoucherInformation").Exist(nminwait) Then
		If Cint(Trim(.WebTable("VoucherInformation").RowCount))>0 Then
			Call WriteToReport(micPass,"Search Results"," Results are displayed successfully",false)
			appVoucherID=.WebTable("VoucherInformation").GetCellData(1,1)
			.WebTable("VoucherInformation").ChildItem(1,1,"Link",0).click
			Call WriteToReport(micPass,"Voucher under voucher information"," Voucher iD "&appVoucherID&" is opened from Voucher information", false)
			temp=1
		else
			Call WriteToReport(micFail,"No Voucher under Voucher Information","No Voucher is displayed in application",True)
		End If
	End If
End with 
End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_03_01_06 Inquire on Voucher Accounting Entries
Public Function inquireonVoucherAccountingEntries()
	Dim businessunit,voucherID
	'Accounts Payable/ Review Accounts Payable Info/Vouchers/Accounting Entries
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")

'Enter the voucher NUmber and Business UNit
With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries")
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"businessunit : "&businessunit,"is present and entered as "&businessunit,false)
		else
		Call WriteToReport(micFail,"businessunit field","is not present",True)
	End If
	
	'Enter the voucher ID
	If .WebEdit("VoucherID").Exist(nMINWAIT) Then
		.WebEdit("VoucherID").Set voucherID
		Call WriteToReport(micPass,"voucherID : "&voucherID,"is present and entered as "&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucherid field","is not present",True)
	End If
	
	'Click on Seqarch button
	If .WebButton("Search").Exist(nMINWAIT) Then
		.WebButton("Search").Click
		Call WriteToReport(micPass,"Search button ","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Search button","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	Dim rc
	
'main information table	
	If .WebTabStrip("TabSelection_MainChartJour").Exist(nminwait) Then
		.WebTabStrip("TabSelection_MainChartJour").Select("Main Information")'Chartfields;Journal
		Call WriteToReport(micPass,"Main Information tab ","is present and selected",false)
		If .WebTable("AccountingInformation").Exist(nminwait) Then
			rc=.WebTable("AccountingInformation").RowCount
			Call WriteToReport(micPass,"Main Information table ","is present and it has "&rc&" rows",false)
			else
			Call WriteToReport(micFail,"Main Information table","is not present",True)
		End If
		else
		Call WriteToReport(micFail,"Main Information tab","is not present",True)
	End If
	
'chartfield table
	If .WebTabStrip("TabSelection_MainChartJour").Exist(nminwait) Then
		.WebTabStrip("TabSelection_MainChartJour").Select("Chartfields")
		Call WriteToReport(micPass,"Chartfields tab ","is present and selected",false)
		If .WebTable("Chartfields").Exist(nminwait) Then
			rc=.WebTable("Chartfields").RowCount
			Call WriteToReport(micPass,"Chartfields table ","is present and it has "&rc&" rows",false)
			else
			Call WriteToReport(micFail,"Chartfields table","is not present",True)
		End If
		else
		Call WriteToReport(micFail,"Chartfields tab","is not present",True)
	End If
'journal table
	If .WebTabStrip("TabSelection_MainChartJour").Exist(nminwait) Then
		.WebTabStrip("TabSelection_MainChartJour").Select("Journal")'
		Call WriteToReport(micPass,"Journal tab ","is present and selected",false)
		If .WebTable("Journal").Exist(nminwait) Then
			rc=.WebTable("Journal").RowCount
			Call WriteToReport(micPass,"Journal table ","is present and it has "&rc&" rows",false)
			else
			Call WriteToReport(micFail,"Journal table","is not present",True)
		End If
		else
		Call WriteToReport(micFail,"Main Information tab","is not present",True)
	End If

End With 
End Function

'*********************************************************************************************************************************
'*********************************************************************************************************************************
''' <summary>  
''' changePOVoucher() To Change the details after saved
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "businessunit,voucherID,appUnitPrice,supplierID"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to create vouchers</startstate>
''' <endstate>Voucher should be saved with updated details</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'AP_03_01_05 Change PO Voucher
Public Function changePOVoucher()
	Dim businessunit,voucherID,appUnitPrice,appDifference
	Dim supplierID
	
	businessunit=GlobalDictionary("businessunit")
	sheetName=GlobalDictionary("sheetName")
	connectionString = "Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
	

strSQL=GlobalDictionary("strSQL")
	If NOT dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
		Call WriteToReport(micFail, "Verifying the Record from Database", "No Record Exist for SQL: [" & strSQL & "] to getthe PO number",true)
	else
		Call WriteToReport(micPass,"DB records fetched successfully","SQL query executed sucessfully ["&strSQL&"]" ,false)
		Set table=DataTable.GetSheet(sheetName)
		table.SetCurrentRow(1)
		
		GlobalDictionary("PONumberFrom")=DataTable.Value("PO_ID",sheetName)
		GlobalDictionary("SupplierID")=DataTable.Value("VENDOR_ID",sheetName)


	
		GlobalDictionary("SupplierID")=Datatable.Value("VENDOR_ID",sheetname)
		supplierID=GlobalDictionary("SupplierID")
		'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
		SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		
		'VoucherID=ap_createaVoucherWithMiscSalestaxFrieghtpaytermandwithoutCopyPO(businessunit,supplierID)
		VoucherID=ap_createVoucherWithCopyPO(businessunit,supplierID)
		
		If StrComp(VoucherID,"NEXT",1)<>0 Then
			
		
		'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
				SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
				
			On Error Resume Next	
				''	Open a existing voucher(created voucher)
			Call ap_openExistingVoucher(businessunit,voucherID)	
			If Err.Number>0 Then
				Reporter.ReportEvent micFail,"The VOucher is not created","to proceed with furhter steps"
				Err.clear
				Exittest
			End If
			On Error Goto 0
				
				'Add business unit and voucgher id in existing value
				with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
				
				'wait for the ojects to get loaded
				app_SearchSync()
				
				On Error Resume Next
				If .WebTabStrip("tabSelection").Exist(10) Then
					.WebTabStrip("tabSelection").Select("Invoice Information")
					Call WriteToReport(micPass,"Invoice Information tab","is present and selected",false)
				else
					Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
				End If
				
				
					app_SearchSync()
					
				If .WebEdit("unitPrice").Exist(nMINWAIT) Then
					appUnitPrice=Cdbl(.WebEdit("unitPrice").GetROProperty("value"))
					Call WriteToReport(micPass,"unitPrice captured from application :"&appUnitPrice ,"unit price is captured from application as "&appUnitPrice ,false)
					appUnitPrice=appUnitPrice+1
					.WebEdit("unitPrice").Set(appUnitPrice)
					Call WriteToReport(micPass,"unitPrice :"&appUnitPrice ,"Unit price value changed to "&appUnitPrice ,false)
					else
					Call WriteToReport(micFail,"Unitprice","is not present",True)
				End If
				
				
				
				If .WebButton("CalculateInvoiceLine").Exist(nMINWAIT) Then
					.WebButton("CalculateInvoiceLine").Click
					Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked",false)
					else
					Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
				End If
				
				app_SearchSync()
				
				If .WebButton("Calculate").Exist(nMINWAIT) Then
					.WebButton("Calculate").Click
					Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked for get the difference",false)
					else
					Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
				End If
				
				
				If .WebElement("Difference").Exist(nMINWAIT) Then
					appDifference=.WebElement("Difference").GetROProperty("innertext")
					Call WriteToReport(micPass,"Deifference is captured","Captured from application as"&appDifference,false)
					If appDifference=0 Then
						Call WriteToReport(micFAIL,"Deifference is captured","Captured from application as "&appDifference&" and expected difference is 1" ,false)
					End If
				End If
				
				If .WebEdit("Total").Exist(nMINWAIT) Then
					.WebEdit("Total").Click
					app_SearchSync()
					wait 5
					.WebEdit("Total").Click
					appDifference=cdbl(appDifference)+Cdbl(.WebEdit("Total").GetROProperty("value"))
					.WebEdit("Total").Set appDifference
					Call WriteToReport(micPass,"Total : "&appDifference,"is present and entered as "&appDifference,false)
					else
					Call WriteToReport(micFail,"Total","is not present",True)
				End If
				
				If .WebButton("Calculate").Exist(nMINWAIT) Then
					.WebButton("Calculate").Click
					Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked to get difeerence",false)
					else
					Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
				End If
				
				If .WebElement("Difference").Exist(nMINWAIT) Then
					appDifference=.WebElement("Difference").GetROProperty("innertext")
					Call WriteToReport(micPass,"Deifference shouldbe 0","Captured from application as"&appDifference,false)
				End If
				
			'wait for the ojects to get loaded
			app_SearchSync()
			
				If .WebButton("Save").Exist(nMINWAIT) Then
					.WebButton("Save").Click
					Call WriteToReport(micPass,"Save button in invoice information","is present and clicked",false)
					else
					Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
				End If
			
			app_SearchSync()
				
		end with 	
			With Browser("PeopleSoft Browser").Page("Regular Entry")
				If .WebElement("MessageforDifference").Exist(nminwait) Then
					appDifference=.WebElement("MessageforDifference").GetROProperty("innertext")
					Call WriteToReport(micPass,"Deifference message is captured","Captured from application popup as"&appDifference,false)
				End If
				If .WebButton("OK").Exist(nminwait) Then
					.WebButton("OK").Click
					Call WriteToReport(micPass,"OK button in popup","is present and clicked",false)
					else
					Call WriteToReport(micFail,"Deifference message is not displayed","Deifference message pop up is not displayed",True)
				End If
			End With
			
			If Err.Number>0 Then
				Reporter.ReportEvent micFail,"Not able to Execute","Test case sucessfully"
			End If
			
			On Error Goto 0
		End If
	End If
End Function
'*********************************************************************************************************************************
''' <summary>  
''' InventorySupplierForm() To  Inventory Supplier Form
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "MainMenuSelection,setID,businessunit,dtSubject,dtSupplierName,dtDBAName,dtMinorityBusiness,dtPaymentCapability,dtNotificationEmail,dtZip,dtState,dtCity,dtAddressLine1,dtCountry,dtCorporatePostal,dtCorporateState,dtCorporateCity,dtCorporateAddress1,dtCorporateCountry,dtAcctContName,dtDepartment,dtRequestorPhone,dtRequestorName,dtBusinessPhon,dtContactEmail,Approver1,dtFromName,dtFromName2,dtComments,Approver2,APPaymentPerson,Approver3,dtFrom3,dtFrom4,dtFilePath,MainMenuSelection3,MainMenuSelection1,dtSupplierId,dtSupplierType,dtShortName,dtPayTerms,dtSubjectTo,dtVendorGroup,dtCompanyType,dtTaxId,dtMatchExceptio,dtBankName,dtTransitNumber,dtDFIQualifier,dtAccountType,MainMenuSelection5,AccountNumber"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'1.25
'**********************************************************************************************************************************
Public Function InventorySupplierForm()
'Navigate to Below page
'Suppliers > Supplier Registration > Supplier Forms > Inventory Supplier Form
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

dtSubject=(GlobalDictionary("dtSubject"))
dtSupplierName=(GlobalDictionary("dtSupplierName"))
dtDBAName=(GlobalDictionary("dtDBAName"))
dtMinorityBusiness=(GlobalDictionary("dtMinorityBusiness"))
dtPaymentCapability=(GlobalDictionary("dtPaymentCapability"))
dtNotificationEmail=(GlobalDictionary("dtNotificationEmail"))
dtZip=(GlobalDictionary("dtZip"))
dtState=(GlobalDictionary("dtState"))
dtCity=(GlobalDictionary("dtCity"))
dtAddressLine1=(GlobalDictionary("dtAddressLine1"))
dtCountry=(GlobalDictionary("dtCountry"))
dtCorporatePostal=(GlobalDictionary("dtCorporatePostal"))
dtCorporateState=(GlobalDictionary("dtCorporateState"))
dtCorporateCity=(GlobalDictionary("dtCorporateCity"))
dtCorporateAddress1=(GlobalDictionary("dtCorporateAddress1"))
dtCorporateCountry=(GlobalDictionary("dtCorporateCountry"))
dtAcctContName=(GlobalDictionary("dtAcctContName"))
dtDepartment=(GlobalDictionary("dtDepartment"))
dtRequestorPhone=(GlobalDictionary("dtRequestorPhone"))
dtRequestorName=(GlobalDictionary("dtRequestorName"))
dtBusinessPhone=(GlobalDictionary("dtBusinessPhone"))
dtContactEmail=(GlobalDictionary("dtContactEmail"))
Approver1=(GlobalDictionary("Approver1"))
dtFromName=(GlobalDictionary("dtFromName"))
dtFromName2=(GlobalDictionary("dtFromName2"))
dtComments=(GlobalDictionary("dtComments"))
Approver2=(GlobalDictionary("Approver2"))
APPaymentPerson=(GlobalDictionary("APPaymentPerson"))
Approver3=(GlobalDictionary("Approver3"))
dtFrom3=(GlobalDictionary("dtFrom3"))
dtFrom4=(GlobalDictionary("dtFrom4"))
dtFilePath=(GlobalDictionary("dtFilePath"))


'CLick on Add New Value
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Add New value is ","is present and clicked", false)
	Else
	Call WriteToReport(micFail,"Add New value is ","is not present and clicked", True)
End If
End  With 

'wait for the ojects to get loaded
 app_SearchSync()
 
 'Enter all the detasil in the Form
 With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("Fill a Form_Subject")
If .Exist(nMINWAIT) Then
	.Set dtSubject
	Call WriteToReport(micPass,"Subject Field  is present ","and set with="&dtSubject, false)
End If
End  With 

'Enter the supplier name and DBAname
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_SupplierName")
If .Exist(nMINWAIT) Then
	.Set dtSupplierName
	Call WriteToReport(micPass,"SupplierName Field  is present ","and set with="&dtSupplierName, false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_DBAName")
If .Exist(nMINWAIT) Then
	.Set dtDBAName
	Call WriteToReport(micPass,"DBAName Field  is present ","and set with="&dtDBAName, false)
End If
End  With

'Check all the checkbnox if not selected
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_SmallBusinessEnterprise")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
		.Click
		Call WriteToReport(micPass,"SmallBusinessEnterprise checkbox is present ","and checked  ", false)
	End If
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_WomanOwned")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
		.Click
		Call WriteToReport(micPass,"WomanOwned check box is present ","and checked ", false)
	End If
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_DIsabledOwned")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
		.Click
		Call WriteToReport(micPass,"DisabledOwned checkbox is present ","and checked  ", false)
	End If
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_NonProfit")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
		.Click
		Call WriteToReport(micPass,"NonProfit checkbox is present ","and checked  ", false)
	End If
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_VeteranOwned")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
		.Click
		Call WriteToReport(micPass,"VeteranOwned checkbox is present ","and checked  ", false)
	End If
End If
End  With

'Select the Minority
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebList("FillaForm_MinorityBusiness")
If .Exist(nMINWAIT) Then
	.Select dtMinorityBusiness
	Call WriteToReport(micPass,"Minority business  is present ","and set with="&dtMinorityBusiness, false)
End If
End  With 

'Enter all the deail in the Payment capability
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebList("FillaForm_PaymentMethod")
If .Exist(nMINWAIT) Then
	.Select dtPaymentCapability
	Call WriteToReport(micPass,"Payment methond   is present ","and set with="&dtPaymentCapability, false)
End If
End  WIth 

'Enter th enotification EMail
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FilaForm_NotificationEmail")
If .Exist(nMINWAIT) Then
	.Set dtNotificationEmail
	Call WriteToReport(micPass,"Notification Email   is present ","and set with="&dtNotificationEmail, false)
End If
End  With 

'Enter all the details in Remittance Address
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Country")
If .Exist(nMINWAIT) Then
	.Set dtCountry
	Call WriteToReport(micPass,"Country   is present ","and set with="&dtCountry, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_AddressLine1")
If .Exist(nMINWAIT) Then
	.Set dtAddressLine1
	Call WriteToReport(micPass,"Address1   is present ","and set with="&dtAddressLine1, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_City")
If .Exist(nMINWAIT) Then
	.Set dtCity
	Call WriteToReport(micPass,"City   is present ","and set with="&dtCity, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_State")
If .Exist(nMINWAIT) Then
	.Set dtState
	Call WriteToReport(micPass,"State   is present ","and set with="&dtState, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Zip")
If .Exist(nMINWAIT) Then
	.Set dtZip
	Call WriteToReport(micPass,"Zip   is present ","and set with="&dtZip, false)
End If
End  With

'ENtert the address of Offcice
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Corporate_Country")
If .Exist(nMINWAIT) Then
	.Set dtCorporateCountry
	Call WriteToReport(micPass,"CorporateCountry is present ","and set with="&dtCorporateCountry, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Corporate_Address1")
If .Exist(nMINWAIT) Then
	.Set dtCorporateAddress1
	Call WriteToReport(micPass,"CorporatAddress is present ","and set with="&dtCorporateAddress1, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Corporate_City")
If .Exist(nMINWAIT) Then
	.Set dtCorporateCity
	Call WriteToReport(micPass,"City is present ","and set with="&dtCorporateCity, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Corporate_State")
If .Exist(nMINWAIT) Then
	.Set dtCorporateState
	Call WriteToReport(micPass,"State   is present ","and set with="&dtCorporateState, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Corporate_Postal")
If .Exist(nMINWAIT) Then
	.Set dtCorporatePostal
	Call WriteToReport(micPass,"Zip is present ","and set with="&dtCorporatePostal, false)
End If
End  With

'Enter te Accounting contact ndetails
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_AcctContName")
If .Exist(nMINWAIT) Then
	.Set dtAcctContName:Call WriteToReport(micPass,"Account name is present ","and set with="&dtAcctContName, false)
End If
End  With 

'Enter the REmail
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_ContactEmail")
If .Exist(nMINWAIT) Then
	.Set dtContactEmail:Call WriteToReport(micPass,"Contact email is present ","and set with="&dtContactEmail, false)
End If
End  With 

'Phoinr no
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_BusinessPhone")
If .Exist(nMINWAIT) Then
	.Set dtBusinessPhone:Call WriteToReport(micPass,"BusinessPhone is present ","and set with="&dtBusinessPhone, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_RequestorName")
If .Exist(nMINWAIT) Then
	.Set dtRequestorName:Call WriteToReport(micPass,"RequestorName is present ","and set with ="&dtRequestorName, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_RequestorPhone")
If .Exist(nMINWAIT) Then
	.Set dtRequestorPhone:Call WriteToReport(micPass,"RequestorPhone is present ","and set with="&dtRequestorPhone, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Department")
If .Exist(nMINWAIT) Then
	.Set dtDepartment:Call WriteToReport(micPass,"Department is present ","and set with="&dtDepartment, false)
End If
End  With 

'Check the attachedmtn checkbox
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_DocumentsAttached")
If .Exist(nMINWAIT) Then
	.Click:Call WriteToReport(micPass,"DocumentsAttached is present ","and clicked  ", false)
End If
End  WIth 

'Save trge page
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FillaForm_Save")
If .Exist(nMINWAIT) Then
	.Click:Call WriteToReport(micPass,"Save is present ","and clicked  ", false)
End If
End  WIth

'Get the sequence Number
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("FillaFormSeqenceNumber")
If .Exist(nMINWAIT) Then
	appSequenceNumber=.GetROProperty("innertext")
	GlobalDictionary("SequenceNumber")=appSequenceNumber
	Reporter.ReportEvent micPass,"The form is saved","and the sequence number is="&appSequenceNumber
End If
End  With 

 'wait for the ojects to get loaded
 app_SearchSync()

'Click on Instruction tab
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").Link("FillaForm_Instructions")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Instruction link is present ","and clicked  ", false)
End If
End  WIth

 'wait for the ojects to get loaded
 app_SearchSync()

'Validate the detail ni Instruiction tab
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("Fillaform_InstructionPage")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"Instruction page is displayed ","and validated", false)
End If
End  WIth

'CLick on Attachemnt link
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").Link("FillaForm_Attachments")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Attachments link is present ","and clicked  ", false)
End If
End  With 

 'wait for the ojects to get loaded
 app_SearchSync()
 
 'CLick on Attach button
 With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FillaForm_Attach")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Attachments button is present ","and clicked  ", false)
End If
End  With

 'wait for the ojects to get loaded
 app_SearchSync()
 
 'wait for the ojects to get loaded
 app_SearchSync()


'Upload the file
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("FileAttachment").WebFile("fillaForm_AttachDocs")
If .Exist(nMINWAIT) Then
	.Set dtFilePath
End If
End  With 

 'wait for the ojects to get loaded
 For i=0 to 3
  'wait for the ojects to get loaded
 app_SearchSync()
 Next


'CLick on Upload Button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("FileAttachment").WebButton("FillAttachment_Upload")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Attachments button is present ","and clicked  ", false)
End If
End  With

 'To capture the file name
 
'dtFilePath="C:\2.2.1_TestScript.docx"
docNameSplit=split(dtFilePath,"\")
docName=docNameSplit(UBound(docNameSplit))

With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").PSFrame("TargetContent").WebTable("table_attachments")
	If .Exist(nMINWAIT) Then
		fileName=.GetCellData(1,2)
	End If
End With

fileNameSplit=split(fileName,".")
fileNameUpdated=fileNameSplit(LBound(fileNameSplit))

'fileName=Browser("PeopleSoft Browser").Page("Search/Fill in a Form").PSFrame("TargetContent").WebTable("table_attachments").GetCellData(1,2)

If docName=fileNameUpdated Then
	Call WriteToReport(micPass,"Attachments are uploaded successfully","and the file uploaded is=" &fileName,false)
End If

GlobalDictionary("docFileName")=fileName

 'wait for the ojects to get loaded
 app_SearchSync()



'click on FOrm LInk
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").Link("FillaForm_Form")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Form link is present ","and clicked  ", false)
End If
End  With


With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FillaForm_Submit")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Submit button is present ","and clicked  ", false)
End If
End  With

'CLick on Ok buttonm
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FilaForm_Submit_Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'Set the GLobal dictionary of Usert id to MICHBER
GlobalDictionary("SignInUser")=(GlobalDictionary("Approver1"))

End Function

Public Function InventorySupplierFormApproval1ApproveFlow()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
dtFromName=(GlobalDictionary("dtFromName"))


If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If

Call MoveToNextPageForApproving()
app_SearchSync()

'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 1 step-1
	appFrom=.GetCellData(i,1)
	If instr(1,appFrom,dtFromName )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'CLicko n Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve button is present ","and clicked  ", false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The form is approved ","and green tick is displayed in the approval flow ", false)
End If
End WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("Approver2"))

'Sign out of application

End Function

Public Function InventorySupplierFormApproval2DenyFlow()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
Call WriteToReport(micPass,"Now following user is loggedin="&(GlobalDIctionary("Approver2")),"to Deny the sequence", false)
dtFromName2=(GlobalDictionary("dtFromName2"))
dtComments=(GlobalDictionary("dtComments"))
If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If

Call MoveToNextPageForApproving()

'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 1 step-1
	appFrom2=.GetCellData(i,1)
	If instr(1,appFrom2,dtFromName2 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'Enter the comments
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebEdit("CommentBox")
If .Exist(nMINWAIT) Then
	.Set dtComments
End If
End  WIth 

'CLickon Deny button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Deny")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Deny button ","is present and clicked", false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Deny")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The form is Denied ","and Red tick is displayed in the approval flow ", false)
End If
End  WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("SignInUser1"))

'Log out of applciation

End  Function

Public Function InventorySupplierFormReUserSignIn()
'Navigate toi beow poath
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("chksup_SeqaNumber")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("SequenceNumber")
	Reporter.ReportEvent micDone,"The Sequence number set is","is"&GlobalDictionary("SequenceNumber")
End If
End  WIth 

'clICKON sEARch button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'Search for the tabe=le for deniewd stqatua
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebTable("SequenceNumber")
If .Exist(nMINWAIT) Then
	For i=2 to  .RowCount
		appSeqNumber=.GetCellData(i,1)
		If Trim(appSeqNumber)=Trim(GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,1,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	Next
End If
End  With 

'CLick on Submit button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FillaForm_Submit")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FilaForm_Submit_Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth

GlobalDictionary("SignInUser")=(GlobalDictionary("Approver1"))

End Function

Public Function InventorySupplierFormApproval1ReApproveFlow()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

Call WriteToReport(micPass,"Now following user is loggedin "&(GlobalDictionary("Approver1")),"to Approve the sequence", false)

dtFromName2=(GlobalDictionary("dtFromName"))
dtComments=(GlobalDictionary("dtComments"))
dtSupplierId=(GlobalDictionary("dtSupplierId")) & RandomNumberGeneraion & Day(Date)
GlobalDictionary("SupplierIdCreated")=dtSupplierId
dtSupplierType=(GlobalDictionary("dtSupplierType"))
' -Cloud
dtShortName=(GlobalDictionary("dtShortName"))
dtPayTerms=(GlobalDictionary("dtPayTerms"))
'000
dtSubjectTo=(GlobalDictionary("dtSubjectTo"))
'- Yes
dtVendorGroup=(GlobalDictionary("dtVendorGroup"))
'- 01
dtCompanyType=(GlobalDictionary("dtCompanyType"))
'-Customer
dtTaxId=(GlobalDictionary("dtTaxId"))
'- 0003365541
dtMatchException=(GlobalDictionary("dtMatchException"))
'- AIDESEG
dtBankName=(GlobalDictionary("dtBankName"))
dtTransitNumber=(GlobalDictionary("dtTransitNumber"))
dtDFIQualifier=(GlobalDictionary("dtDFIQualifier"))
'- Transit Number
dtAccountType=(GlobalDictionary("dtAccountType"))
'- Checking Account
'dtAccountNumber="00133698514"

If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If


Call MoveToNextPageForApproving()
app_SearchSync()

'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 1 step-1
	appFrom2=.GetCellData(i,1)
	If instr(1,appFrom2,dtFromName2 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'CLick on GO to Form
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("GoToForm")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Go to Form is present and","clicked"
	
		'wait for the ojects to get loaded
		app_SearchSync()
		
		Browser("PeopleSoft Browser").Sync
		
		'Enter all the details in the form
		'Enter supplier ID
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebEdit("ApprovalForm_SuppId")
		If .Exist(nMINWAIT) Then
			.Set dtSupplierId
			Reporter.ReportEvent micPass,"The supplier field is present and","set with="&dtSupplierId
			Else
			Reporter.ReportEvent micFail,"The suppleir field is not","present"
		End If
		End  WIth 

		'Assign the Supplier ID to the global dictionary
		GlobalDictionary("SupplierIdCreated")=dtSupplierId
		
		'Set the short namre
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebEdit("ApprovalForm_SuppShortName")
		If .Exist(nMINWAIT) Then
			.Set dtShortName
			Reporter.ReportEvent micPass,"The supplier name is present and","set with="&dtShortName
			Else
			Reporter.ReportEvent micFail,"The suppleir name is not","present"
		End If
		End  WIth 
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebList("ApprovalForm_SuppType")
		If .Exist(nMINWAIT) Then
			.Select dtSupplierType
			Reporter.ReportEvent micPass,"The supplier type is present and","set with="&dtSupplierType
			Else
			Reporter.ReportEvent micFail,"The supplier type is not","present"
		End If
		End  WIth
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebEdit("ApprovalForm_PayTerms")
		If .Exist(nMINWAIT) Then
			.Set dtPayTerms
			Reporter.ReportEvent micPass,"The PayTerms is present and","set with="&dtPayTerms
			Else
			Reporter.ReportEvent micFail,"The payterms is not","present"
		End If
		End  WIth
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebEdit("ApprovalForm_CompanyType")
		If .Exist(nMINWAIT) Then
			.Set dtCompanyType
			Reporter.ReportEvent micPass,"The CompanyType is present and","set with="&dtCompanyType
			Else
			Reporter.ReportEvent micFail,"The CompanyType is not","present"
		End If
		End  WIth
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebEdit("ApprovalForm_VendorGroup")
		If .Exist(nMINWAIT) Then
			.Set dtVendorGroup
			Reporter.ReportEvent micPass,"The VendorGroup is present and","set with="&dtVendorGroup
			Else
			Reporter.ReportEvent micFail,"The VendorGroup is not","present"
		End If
		End  WIth
		
		WIth Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebList("ApprovalForm_SubjectTo")
		If .Exist(nMINWAIT) Then
			.Select dtSubjectTo
			Reporter.ReportEvent micPass,"The dtSubjectTo is present and","set with="&dtSubjectTo
			Else
			Reporter.ReportEvent micFail,"The dtSubjectTo is not","present"
		End If
		End  WIth
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebEdit("ApprovalForm_TaxPayerId")
		If .Exist(nMINWAIT) Then
			.Set dtTaxId
			Reporter.ReportEvent micPass,"The TaxId is present and","set with="&dtTaxId
			Else
			Reporter.ReportEvent micFail,"The TaxId is not","present"
		End If
		End  WIth
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebEdit("ApprovalForm_MatchException")
		If .Exist(nMINWAIT) Then
			.Set dtMatchException
			Reporter.ReportEvent micPass,"The MatchException is present and","set with="&dtMatchException
			Else
			Reporter.ReportEvent micFail,"The MatchException is not","present"
		End If
		End  WIth
		
		'Enter the bank details
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebEdit("ApprovalForm_BankName")
		If .Exist(nMINWAIT) Then
			.Set dtBankName
			Reporter.ReportEvent micPass,"The Bank name is present and","set with="&dtBankName
			Else
			Reporter.ReportEvent micFail,"The Bank name is not","present"
		End If
		End  WIth
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebEdit("ApprovalForm_TransitNumber")
		If .Exist(nMINWAIT) Then
			.Set dtTransitNumber
			Reporter.ReportEvent micPass,"The TransitNumber is present and","set with="&dtTransitNumber
			Else
			Reporter.ReportEvent micFail,"The TransitNumber is not","present"
		End If
		End  WIth
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebList("ApprovalForm_DFIQualifier")
		If .Exist(nMINWAIT) Then
			.Select dtDFIQualifier
			Reporter.ReportEvent micPass,"The DFIQualifier is present and","set with="&dtDFIQualifier
			Else
			Reporter.ReportEvent micFail,"The DFIQualifier is not","present"
		End If
		End  WIth
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebList("ApprovalForm_AccountType")
		If .Exist(nMINWAIT) Then
			.Select dtAccountType
			Reporter.ReportEvent micPass,"The AccountType is present and","set with="&dtAccountType
			Else
			Reporter.ReportEvent micFail,"The AccountType is not","present"
		End If
		End  WIth
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebEdit("ApprovalForm_AcctNumber")
		If .Exist(nMINWAIT) Then
			.Set (GlobalDictionary("AccountNumber"))
		End If
		End  With 
		
		'Click on Ok button
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebButton("Ok")
		If .Exist(nMINWAIT) Then
			.Click
			Reporter.ReportEvent micPass,"The Ok button is present and","clicked and able to save all the changes"
			Else
			Reporter.ReportEvent micFail,"The Ok is not","present"
		End If
		End  WIth	
	Else
	Reporter.ReportEvent micFail,"The Go to Link is","Not present and not able to fill the details"
End If
End  With


'Enter the comments
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebEdit("CommentBox")
If .Exist(nMINWAIT) Then
	.Set dtComments
	Reporter.ReportEvent micPass,"The comments","are entered=" &dtComments
End If
End  WIth 


'CLick on Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve buttion ","is present and clicked", false)
End If
End  WIth 


With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The form is Approved ","aand Green tick is displayed in the approval flow ", false)
End If
End  WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("Approver2"))

'Log out of applciation

End  Function

Public Function InventorySupplierFormApproval2ApproveFlow()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
Call WriteToReport(micPass,"Now following user is loggedin "&(GlobalDIctionary("Approver2")),"to Approve the sequence", false)
dtFromName2=(GlobalDictionary("dtFromName2"))
dtComments=(GlobalDictionary("dtComments"))

If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If

Call MoveToNextPageForApproving()

'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 1 step-1
	appFrom2=.GetCellData(i,1)
	If instr(1,appFrom2,dtFromName2 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'Enter the comments
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebEdit("CommentBox")
If .Exist(nMINWAIT) Then
	.Set dtComments
End If
End  WIth 

'CLickon Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve button ","is present and clicked", false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved2")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The status is approved ","and able to see the green tick", false)
End If
End  WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("Approver3"))

'Log out of applciation

End  Function

Public Function InventorySupplierFormApprover3ApproveFlow()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

Call WriteToReport(micPass,"Now following user is loggedin "&(GlobalDIctionary("Approver3")),"to Approve the sequence", false)
dtFromName3=(GlobalDictionary("dtFrom3"))
dtComments=(GlobalDictionary("dtComments"))
If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If

Call MoveToNextPageForApproving()
app_SearchSync()

'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 2 step-1
	appFrom3=.GetCellData(i,1)
	If instr(1,appFrom3,dtFromName3 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'Enter the comments
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebEdit("CommentBox")
If .Exist(nMINWAIT) Then
	.Set dtComments
End If
End  WIth 


'CLick on Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve buttion ","is present and clicked", false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved3")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The status is approved ","and able to see the green tick", false)
End If
End  WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("APPaymentPerson"))

'Log out of applciation

End  Function

Public Function InventorySupplierFormAPPerson()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
Call WriteToReport(micPass,"Now following user is loggedin "&(GlobalDIctionary("APPaymentPerson")),"to Approve the sequence", false)

dtName4=(GlobalDictionary("dtFrom4"))
If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If

Call MoveToNextPageForApproving()
app_SearchSync()

'Chck the worklist table and search for the name
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 2 step-1
	appFrom4=.GetCellData(i,1)
	If instr(1,appFrom4,dtName4 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'Click on Submit
 'CLickon Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve buttion ","is present and clicked", false)
End If
End  WIth 


With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved4")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The status is approved ","and able to see the green tick", false)
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("GoToForm")
	If .Exist(nMINWAIT) Then
	 .Click
End If
End  WIth

'Wait for the app to sync
Browser("PeopleSoft Browser").Sync

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebButton("Approve_SaveAndPost")
If .Exist(nMINWAIT) Then
	 .Click
End If
End  WIth

'Wait for the app to sync
Browser("PeopleSoft Browser").Sync
 
'Validate the error message
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").WebElement("SucessMessage")
If .Exist(nMINWAIT) Then
	appPostedMessage=.GetROProperty("innertext")
	Call WriteToReport(micPass,"Posted messge is ","displayed as below="&appPostedMessage,False)
End If
End  With 

'CLick on Ok button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").WebButton("Approve_Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").WebButton("Approve_Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebButton("Approve_FillForm_Cancel")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 


With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve_Save")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Navigate to below page
'Suppliers > Supplier Information > Add/Update > Supplier 
'Enter the Supplier ID
SelectMainMenu1(GlobalDictionary("MainMenuSelection5"))

'Enter the Supplier ID
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("FindExistingValue_VendorID")
If .Exist(nMINWAIT) Then
	.Set (GlobalDictionary("SupplierIdCreated"))
	Reporter.ReportEvent micPass,"THe supplier id is ","set which we have created from previous steps="&(GlobalDictionary("SupplierIdCreated"))
End If
End  With 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With


'Validate whether page is opened
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The summary tab is","present details are validated"
End If
End  With 

'Assign the GWENCHO user to validate the forms attachement
GlobalDictionary("SignInUser")=(GlobalDictionary("FormAttachmentUser"))

End Function


'*********************************************************************************************************************************
''' <summary>  
''' NonInventorySupplierForm() To  Non-Inventory Supplier Form
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "MainMenuSelection,setID,businessunit,dtSubject,dtSupplierName,dtDBAName,dtMinorityBusiness,dtPaymentCapability,dtNotificationEmail,dtZip,dtState,dtCity,dtAddressLine1,dtCountry,dtCorporatePostal,dtCorporateState,dtCorporateCity,dtCorporateAddress1,dtCorporateCountry,dtAcctContName,dtDepartment,dtRequestorPhone,dtRequestorName,dtBusinessPhon,dtContactEmail,Approver1,dtFromName,dtFromName2,dtComments,Approver2,APPaymentPerson,Approver3,dtFrom3,dtFrom4,dtFilePath,MainMenuSelection3,MainMenuSelection1,dtSupplierId,dtSupplierType,dtShortName,dtPayTerms,dtSubjectTo,dtVendorGroup,dtCompanyType,dtTaxId,dtMatchException,dtBankName,dtTransitNumber,dtDFIQualifier,dtAccountType,MainMenuSelection5,AccountNumber,InvDescription,WorkList"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>01/19/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'1.26

Public Function NonInventorySupplierForm()
'Navigate to below page
'Suppliers > Supplier Registration > Supplier Non-Inventory
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

dtSubject=(GlobalDictionary("dtSubject"))
dtSupplierName=(GlobalDictionary("dtSupplierName"))
dtDBA=(GlobalDictionary("dtDBAName"))
dtMinorityBusiness=(GlobalDictionary("dtMinorityBusiness"))
dtPaymentMethod=(GlobalDictionary("dtPaymentCapability"))
dtNotificationEmail=(GlobalDictionary("dtNotificationEmail"))
dtRemittanceCountry=(GlobalDictionary("dtCountry"))
dtRemittanceAddress1=(GlobalDictionary("dtAddressLine1"))
dtRemittanceCity=(GlobalDictionary("dtCity"))
dtRemittanceState=(GlobalDictionary("dtState"))
dtRemittanceZip=(GlobalDictionary("dtZip"))
dtCorporateAddress=(GlobalDictionary("dtCorporateAddress1"))
dtAcctContactName=(GlobalDictionary("dtAcctContName"))
dtBusinessEmail=(GlobalDictionary("dtContactEmail"))
dtDeptName=(GlobalDictionary("dtDepartment"))
dtRequestorName=(GlobalDictionary("dtRequestorName"))
dtRequestorPhone=(GlobalDictionary("dtRequestorPhone"))
dtRequestorDeptName=(GlobalDictionary("dtDepartment"))
dtInvDescription=(GlobalDictionary("InvDescription"))
Approver1=(GlobalDictionary("Approver1"))

'Click on Add New value
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Add new value tab","is present and clicked"
End If
End  WIth

'ENter all the detail in form
'ENter the subject
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_Subject")
If .Exist(nMINWAIT) Then
	.Set dtSubject
	Reporter.ReportEvent micPass,"Subject is present","and set with="&dtSubject
End If
End  WIth

'Enter supplier name
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_SuppName")
If .Exist(nMINWAIT) Then
	.Set dtSupplierName
	Reporter.ReportEvent micPass,"Supplier Name is present","and set with="&dtSupplierName
End If
End  With 


'Enter DBA name
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_DBAName")
If .Exist(nMINWAIT) Then
	.Set dtDBA
	Reporter.ReportEvent micPass,"DBAName  is present","and set with="&dtDBA
End If
End  With 

'Check the checknboxes
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebCheckBox("NonInv_SmallBusEnterprose")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")=0 Then
		.Click
		Reporter.ReportEvent micPass,"Small business enterprise checkbox","is present and selected"
	End If
End If
End  WIth 


With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebCheckBox("NonINv_WomenOwned")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")=0 Then
		.Click
		Reporter.ReportEvent micPass,"Women owned checkbox","is present and selected"
	End If
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebCheckBox("NonInv_DisabledOwned")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")=0 Then
		.Click
		Reporter.ReportEvent micPass,"Disabled Owned checkbox","is present and selected"
	End If
End If
End  WIth 

WIth Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebCheckBox("NonInv_NonProfit")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")=0 Then
		.Click
		Reporter.ReportEvent micPass,"Non-profit checkbox","is present and selected"
	End If
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebCheckBox("NonInv_VeteranOwned")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")=0 Then
		.Click
		Reporter.ReportEvent micPass,"Veteran Owned checkbox","is present and selected"
	End If
End If
End  WIth 

'CLick on Minority business drop down
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebList("NOnInv_MinorityBus")
If .Exist(nMINWAIT) Then
	.Select dtMinorityBusiness
	Reporter.ReportEvent micPass,"Minority Bus drop down","is present and selected with="&dtMinorityBusiness
End If
End  With

'Select payment method
WIth Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebList("NonInv_PaymentMethod")
If .Exist(nMINWAIT) Then
	.Select dtPaymentMethod
	Reporter.ReportEvent micPass,"Paymetnt method drop down","is present and selected with="&dtPaymentMethod
End If
End  With 

'Enter Email id
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_NotificationEmail")
If .Exist(nMINWAIT) Then
	.Set dtNotificationEmail
	Reporter.ReportEvent micPass,"Notification Email","is present and set with="&dtNotificationEmail
End If
End  With 

'Enter the address details
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RemittanceCountry")
If .Exist(nMINWAIT) Then
	.Set dtRemittanceCountry
	Reporter.ReportEvent micPass,"RemittanceCountry" ,"is present and set with="&dtRemittanceCountry
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RemittanceAddress1")
If .Exist(nMINWAIT) Then
	.Set dtRemittanceAddress1
	Reporter.ReportEvent micPass,"RemittanceAddress" ,"is present and set with="&dtRemittanceAddress1
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RemittanceCity")
If .Exist(nMINWAIT) Then
	.Set dtRemittanceCity
	Reporter.ReportEvent micPass,"RemittanceCity" ,"is present and set with="&dtRemittanceCity
End If
End  With


With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RemittanceState")
If .Exist(nMINWAIT) Then
	.Set dtRemittanceState
	Reporter.ReportEvent micPass,"RemittanceState" ,"is present and set with="&dtRemittanceState
End If
End  With

WIth Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RemittanceZip")
If .Exist(nMINWAIT) Then
	.Set dtRemittanceZip
	Reporter.ReportEvent micPass,"RemittanceZip" ,"is present and set with="&dtRemittanceZip
End If
End  With

'ENter corporate details
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_CorporateCountry")
If .Exist(nMINWAIT) Then
	.Set dtRemittanceCountry
	Reporter.ReportEvent micPass,"RemittanceCountry" ,"is present and set with="&dtRemittanceCountry
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_CorporateAddress1")
If .Exist(nMINWAIT) Then
	.Set dtCorporateAddress
	Reporter.ReportEvent micPass,"CorporateAddress" ,"is present and set with="&dtCorporateAddress
End If
End  With 

WIth Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_CorporateCity")
If .Exist(nMINWAIT) Then
	.Set dtRemittanceCity
	Reporter.ReportEvent micPass,"RemittanceCity" ,"is present and set with="&dtRemittanceCity
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NOnInv_CorporateState")
If .Exist(nMINWAIT) Then
	.Set dtRemittanceState
	Reporter.ReportEvent micPass,"RemittanceState" ,"is present and set with="&dtRemittanceState
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_CorporateZip")
If .Exist(nMINWAIT) Then
	.Set dtRemittanceZip
	Reporter.ReportEvent micPass,"RemittanceZip" ,"is present and set with="&dtRemittanceZip
End If
End  With

'Enter the Accountng contact inform
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_AcctContactName")
If .Exist(nMINWAIT) Then
	.Set dtAcctContactName
	Reporter.ReportEvent micPass,"AcctContactName" ,"is present and set with="&dtAcctContactName
End If
End  With

'ENter dept name
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_DeptName")
If .Exist(nMINWAIT) Then
	.Set dtDeptName
	Reporter.ReportEvent micPass,"DeptName" ,"is present and set with="&dtDeptName
End If
End  With

'ENter business contact Email
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_BusinessEmail")
If .Exist(nMINWAIT) Then
	.Set dtBusinessEmail
	Reporter.ReportEvent micPass,"BusinessEmail" ,"is present and set with="&dtBusinessEmail
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_BusinessPhone")
If .Exist(nMINWAIT) Then
	.Set dtBusinessPhone
	Reporter.ReportEvent micPass,"BusinessPhone" ,"is present and set with="&dtBusinessPhone
End If
End  With

WIth Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_Fax")
If .Exist(nMINWAIT) Then
	.Set dtFax
	Reporter.ReportEvent micPass,"Fax" ,"is present and set with="&dtFax
End If
End  With

'Enter all teh detaisl in requestor detsila
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RequestorName")
If .Exist(nMINWAIT) Then
	.Set dtRequestorName
	Reporter.ReportEvent micPass,"RequestorName" ,"is present and set with="&dtRequestorName
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RequestorPhone")
If .Exist(nMINWAIT) Then
	.Set dtRequestorPhone
	Reporter.ReportEvent micPass,"RequestorPhone" ,"is present and set with="&dtRequestorPhone
End If
End  With

WIth Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RequestorDeptName")
If .Exist(nMINWAIT) Then
	.Set dtRequestorDeptName
	Reporter.ReportEvent micPass,"RequestorDeptName" ,"is present and set with="&dtRequestorDeptName
End If
End  With

'Check all the checkboes
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebCheckBox("NonInv_DocumentsAttached")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")=0 Then
		.Click
		Reporter.ReportEvent micPass,"DocumentsAttached checkbox","is present and selected"
	End If
End If
End  WIth


WIth Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebCheckBox("NonInv_SuppReimbursement")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")=0 Then
		.Click
		Reporter.ReportEvent micPass,"SuppReimbursement checkbox","is present and selected"
	End If
End If
End  WIth

WIth Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebCheckBox("NonInv_AffiliateFees")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")=0 Then
		.Click
		Reporter.ReportEvent micPass,"AffiliateFees checkbox","is present and selected"
	End If
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebCheckBox("NonInv_OneTimePurchase")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")=0 Then
		.Click
		Reporter.ReportEvent micPass,"OneTimePurchase checkbox","is present and selected"
	End If
End If
End  WIth

'Enter the Description
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_Description")
If .Exist(nMINWAIT) Then
	.Set dtInvDescription
	Reporter.ReportEvent micPass,"The Description","is="&dtInvDescription
End If
End  WIth 

'CLick on Save button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebButton("NonInv_Save")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Form is saved","sucessfully"
End If
End  WIth

'Get the sequence NUmber
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebElement("NonInv_SequenceNumber")
If .Exist(nMINWAIT) Then
	appSeqNo=.GetROProperty("innertext")
	GlobalDictionary("SequenceNumber")=appSeqNo
	Reporter.ReportEvent micPass,"The form Sequence number","is="&appSeqNo
End If
End  WIth 

'CLick on Instruction link
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebElement("NonInv_Instructions")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Vertify the instruction page
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebElement("NonInv_InstrusctionPage")
If .Exist(nMINWAIT) Then
	Reporter.ReportEvent micPass,"The user is navigaed","to INstruction page"
End If
End  With 

'Click on Attachemts tab
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebElement("NonInv_Attachments")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

	'wait for the objects to get loaded
	app_SearchSync()

'Click on Attachments link
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebButton("NonInv_Attach")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With

	'wait for the objects to get loaded
	app_SearchSync()
	
	'wait for the objects to get loaded
	app_SearchSync()

'Upload the file
dtFilePath=(GlobalDictionary("dtFilePath"))
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("FileAttachment").WebFile("fillaForm_AttachDocs")
If .Exist(nMINWAIT) Then
	.Set dtFilePath
End If
End  With 

For i=0 to 3
		'wait for the objects to get loaded
	app_SearchSync()
Next

'CLick on Upload Button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("FileAttachment").WebButton("FillAttachment_Upload")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Attachments button is present ","and clicked  ", false)
End If
End  With

	'wait for the objects to get loaded
	app_SearchSync()
	
		'wait for the objects to get loaded
	app_SearchSync()

'To capture the file name
 
'dtFilePath="C:\2.2.1_TestScript.docx"
docNameSplit=split(dtFilePath,"\")
docName=docNameSplit(UBound(docNameSplit))

With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").PSFrame("TargetContent").WebTable("table_attachments")
	If .Exist(nMINWAIT) Then
		fileName=.GetCellData(1,2)
	End If
End With

fileNameSplit=split(fileName,".")
fileNameUpd=fileNameSplit(LBound(fileNameSplit))

'fileName=Browser("PeopleSoft Browser").Page("Search/Fill in a Form").PSFrame("TargetContent").WebTable("table_attachments").GetCellData(1,2)

If docName=fileNameUpd Then
	Call WriteToReport(micPass,"Attachments are uploaded successfully","and the file uploaded is=" &fileName,false)
End If

GlobalDictionary("docFileName")=fileName

 'wait for the ojects to get loaded
 app_SearchSync()
 
 'Navigate back to form
 With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebElement("NonInv_Forms")
 If .Exist(nMINWAIT) Then
 	.Click
 End If
 End  With 
 
  'wait for the ojects to get loaded
Browser("PeopleSoft Browser").Sync

'Click on Submit button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebButton("NonInv_Submit")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"THe application","is submitted sucessfully"
End If
End  With 

GlobalDictionary("SignInUser")=(GlobalDIctionary("Approver1"))

End Function

Public Function NonInventorySupplierFormApproval1ApproveFlow()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
dtFromName=(GlobalDictionary("dtFromName"))
If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If
'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 1 step-1
	appFrom=.GetCellData(i,1)
	If instr(1,appFrom,dtFromName )>0 Then
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'CLick on Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve button is present ","and clicked  ", false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The form is approved ","and green tick is displayed in the approval flow ", false)
End If
End WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("Approver2"))

'Sign out of application

End Function

Public Function NonInventorySupplierFormApproval2DenyFlow()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
Call WriteToReport(micPass,"Now following user is loggedin "&Approver2,"to Deny the sequence", false)
dtFromName2=(GlobalDictionary("dtFromName2"))
dtComments=(GlobalDictionary("dtComments"))
If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If

Call MoveToNextPageForApproving()
app_SearchSync()

'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 1 step-1
	appFrom2=.GetCellData(i,1)
	If instr(1,appFrom2,dtFromName2 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'Enter the comments
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebEdit("CommentBox")
If .Exist(nMINWAIT) Then
	.Set dtComments
End If
End  WIth 

'Click on Deny button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Deny")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Deny buttion ","is present and clicked", false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Deny")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The form is Denied ","aand Red tick is displayed in the approbval flow ", false)
End If
End  WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("SignInUser1"))

'Log out of applciation

End  Function

Public Function NonInventorySupplierFormReUserSignIn()
'Navigate toi beow poath
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("chksup_SeqaNumber")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("SequenceNumber")
	Reporter.ReportEvent micDone,"The Sequence number set is","is"&GlobalDictionary("SequenceNumber")
End If
End  WIth 


'clICKON sEARch button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'wait for the ojects to get loaded
app_SearchSync()

If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If
'Search for the table for denied status
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebTable("SequenceNumber")
If .Exist(nMINWAIT) Then
	For i=2 to  .RowCount
		appSeqNumber=.GetCellData(i,1)
		If Trim(appSeqNumber)=Trim(GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,1,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	Next
End If
End  With 

'CLick on Submit button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FillaForm_Submit")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FilaForm_Submit_Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth

GlobalDictionary("SignInUser")=(GlobalDictionary("Approver1"))

End Function

Public Function NonInventorySupplierFormApproval1ReApproveFlow()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

Call WriteToReport(micPass,"Now following user is loggedin "&(GlobalDictionary("Approver1")),"to Approve the sequence", false)

dtFromName2=(GlobalDictionary("dtFromName"))
dtComments=(GlobalDictionary("dtComments"))
dtSupplierId=(GlobalDictionary("dtSupplierId")) & RandomNumberGeneraion & Day(Date)
GlobalDictionary("SupplierIdCreated")=dtSupplierId
dtSupplierType=(GlobalDictionary("dtSupplierType"))
' -Cloud
dtShortName=(GlobalDictionary("dtShortName"))
dtPayTerms=(GlobalDictionary("dtPayTerms"))
'000
dtSubjectTo=(GlobalDictionary("dtSubjectTo"))
'- Yes
dtVendorGroup=(GlobalDictionary("dtVendorGroup"))
'- 01
dtCompanyType=(GlobalDictionary("dtCompanyType"))
'-Customer
dtTaxId=(GlobalDictionary("dtTaxId"))
'- 0003365541
dtMatchException=(GlobalDictionary("dtMatchException"))
'- AIDESEG
dtBankName=(GlobalDictionary("dtBankName"))
dtTransitNumber=(GlobalDictionary("dtTransitNumber"))
dtDFIQualifier=(GlobalDictionary("dtDFIQualifier"))
'- Transit Number
dtAccountType=(GlobalDictionary("dtAccountType"))
'- Checking Account
'dtAccountNumber="00133698514"
If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If

Call MoveToNextPageForApproving()
Call app_SearchSync()

'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 1 step-1
	appFrom2=.GetCellData(i,1)
	If instr(1,appFrom2,dtFromName2 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'CLick on GO to Form
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("GoToForm")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"THe Go to FOrm is present and","clicked"
	
		'wait for the ojects to get loaded
		app_SearchSync()
		
		Browser("PeopleSoft Browser").Sync
		
		'Enter all the details in the form
		'Enter supplier ID
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_SuppId")
		If .Exist(nMINWAIT) Then
			.Set dtSupplierId
			Reporter.ReportEvent micPass,"The supplier field is present and","set with="&dtSupplierId
			Else
			Reporter.ReportEvent micFail,"The suppleir field is not","present"
		End If
		End  WIth 
		
		'Take the Supplier ID in the GLobal dictionary for further validation. 
		GlobalDictionary("SupplierIdCreated")=dtSupplierId
		
		'Set the short namre
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_SuppShortName")
		If .Exist(nMINWAIT) Then
			.Set dtShortName
			Reporter.ReportEvent micPass,"The supplier name is present and","set with="&dtShortName
			Else
			Reporter.ReportEvent micFail,"The suppleir name is not","present"
		End If
		End  WIth 
		
		'Set SupplierType
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebList("Approve_NonInv_SuppType")
		If .Exist(nMINWAIT) Then
			.Select dtSupplierType
			Reporter.ReportEvent micPass,"The supplier type is present and","set with="&dtSupplierType
			Else
			Reporter.ReportEvent micFail,"The suppleir type is not","present"
		End If
		End  WIth
		

		'To set payterms
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_PayTerms")
		If .Exist(nMINWAIT) Then
			.Set dtPayTerms
			Reporter.ReportEvent micPass,"The PayTerms is present and","set with="&dtPayTerms
			Else
			Reporter.ReportEvent micFail,"The payterms is not","present"
		End If
		End  WIth
		
		
		'To set Company type
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_CompanyType")
		If .Exist(nMINWAIT) Then
			.Set dtCompanyType
			Reporter.ReportEvent micPass,"The CompanyType is present and","set with="&dtCompanyType
			Else
			Reporter.ReportEvent micFail,"The CompanyType is not","present"
		End If
		End  WIth
			
		'To set Payment Group
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_PaymentGroup")
		If .Exist(nMINWAIT) Then
			.Set dtVendorGroup
			Reporter.ReportEvent micPass,"The VendorGroup is present and","set with="&dtVendorGroup
			Else
			Reporter.ReportEvent micFail,"The VendorGroup is not","present"
		End If
		End  WIth
		
		'To select Subject To		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebList("ApprovalForm_NonInv_SubjectTo")
		If .Exist(nMINWAIT) Then
			.Select dtSubjectTo
			Reporter.ReportEvent micPass,"The dtSubjectTo is present and","set with="&dtSubjectTo
			Else
			Reporter.ReportEvent micFail,"The dtSubjectTo is not","present"
		End If
		End  WIth
		
		'To set Tax Id
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_TaxPayerId")
		If .Exist(nMINWAIT) Then
			.Set dtTaxId
			Reporter.ReportEvent micPass,"The TaxId is present and","set with="&dtTaxId
			Else
			Reporter.ReportEvent micFail,"The TaxId is not","present"
		End If
		End  With
		
		'To set Match Exception
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_ExceptionUser")
		If .Exist(nMINWAIT) Then
			.Set dtMatchException
			Reporter.ReportEvent micPass,"The MatchException is present and","set with="&dtMatchException
			Else
			Reporter.ReportEvent micFail,"The MatchException is not","present"
		End If
		End  WIth
		
		'Enter the bank details
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_BankName")
		If .Exist(nMINWAIT) Then
			.Set dtBankName
			Reporter.ReportEvent micPass,"The Bank name is present and","set with="&dtBankName
			Else
			Reporter.ReportEvent micFail,"The Bank name is not","present"
		End If
		End  WIth
		
		'To Enter the Transit number
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NOnInv_BankTransitNo")
		If .Exist(nMINWAIT) Then
			.Set dtTransitNumber
			Reporter.ReportEvent micPass,"The TransitNumber is present and","set with="&dtTransitNumber
			Else
			Reporter.ReportEvent micFail,"The TransitNumber is not","present"
		End If
		End  WIth
			
		'To select dfi qualifier
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebList("Approver_NonInv_DFIQualifier")
		If .Exist(nMINWAIT) Then
			.Select dtDFIQualifier
			Reporter.ReportEvent micPass,"The DFI Qualifier is present and","set with="&dtDFIQualifier
			Else
			Reporter.ReportEvent micFail,"The DFI Qualifier is not","present"
		End If
		End  WIth
		
		'To select Account type
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebList("Approve_NonInv_AcctType")
		If .Exist(nMINWAIT) Then
			.Select dtAccountType
			Reporter.ReportEvent micPass,"The AccountType is present and","set with="&dtAccountType
			Else
			Reporter.ReportEvent micFail,"The AccountType i is not","present"
		End If
		End  WIth
		
		'To set account number
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NOnInv_BankAcctNumber")
		If .Exist(nMINWAIT) Then
			.Set (GlobalDictionary("AccountNumber"))
		End If
		End  With 
		
		'Click on Ok button
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebButton("Approve_NOnInv_Ok")
		If .Exist(nMINWAIT) Then
			.Click
			Reporter.ReportEvent micPass,"The Ok button is present and","clicked and able to save all the changes"
			Else
			Reporter.ReportEvent micFail,"The Ok button is not","present"
		End If
		End  WIth	
'	Else
'	Reporter.ReportEvent micFail,"The Go to Link is","Not present and not able to fill the details"
End If
End  With


'Enter the comments
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebEdit("CommentBox")
If .Exist(nMINWAIT) Then
	.Set dtComments
End If
End  WIth 


'CLick on Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve button ","is present and clicked", false)
End If
End  WIth 


With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The form is Approved ","and Green tick is displayed in the approval flow ", false)
End If
End  WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("Approver2"))

'Log out of applciation

End  Function

Public Function NonInventorySupplierFormApproval2ApproveFlow()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
Call WriteToReport(micPass,"Now following user is loggedin "&(GlobalDIctionary("Approver2")),"to Approve the sequence", false)
dtFromName2=(GlobalDictionary("dtFromName2"))
dtComments=(GlobalDictionary("dtComments"))
If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If

Call MoveToNextPageForApproving()
app_SearchSync()

'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 1 step-1
	appFrom2=.GetCellData(i,1)
	If instr(1,appFrom2,dtFromName2 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'Enter the comments
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebEdit("CommentBox")
If .Exist(nMINWAIT) Then
	.Set dtComments
End If
End  WIth 

'CLickon Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve buttion ","is present and clicked", false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved2")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The form is Approved ","and Green tick is displayed in the approval flow ", false)
End If
End  WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("Approver3"))

'Log out of applciation

End  Function

Public Function NonInventorySupplierFormApprover3ApproveFlow()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

Call WriteToReport(micPass,"Now following user is loggedin= "&(GlobalDIctionary("Approver3")),"to Approve the sequence", false)
dtFromName3=(GlobalDictionary("dtFrom3"))
dtComments=(GlobalDictionary("dtComments"))

If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If

Call MoveToNextPageForApproving()
app_SearchSync()

'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 2 step-1
	appFrom3=.GetCellData(i,1)
	If instr(1,appFrom3,dtFromName3 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'Enter the comments
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebEdit("CommentBox")
If .Exist(nMINWAIT) Then
	.Set dtComments
End If
End  WIth 


'CLick on Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve buttion ","is present and clicked", false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved3")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The status is approved","and able to see the green tick", false)
End If
End  WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("APPaymentPerson"))

'Log out of applciation

End  Function


Public Function NonInventorySupplierFormAPPerson()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
Call WriteToReport(micPass,"Now following user is loggedin "&(GlobalDIctionary("APPaymentPerson")),"to Approve the sequence", false)

dtName4=(GlobalDictionary("dtFrom4"))
'Chck the eworklist table and search for the name
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 2 step-1
	appFrom4=.GetCellData(i,1)
	If instr(1,appFrom4,dtName4 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'Click on Submit
'CLick on Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve button ","is present and clicked", false)
End If
End  WIth 


With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved4")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The status is approved ","and able to see the green tick", false)
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("GoToForm")
	If .Exist(nMINWAIT) Then
	 .Click
End If
End  WIth

'Wait for the app to sync
Browser("PeopleSoft Browser").Sync

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebButton("Approve_SaveAndPost")
If .Exist(nMINWAIT) Then
	 .Click
End If
End  WIth

'Wait for the app to sync
Browser("PeopleSoft Browser").Sync
 
'Validate the error message
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").WebElement("SucessMessage")
If .Exist(nMINWAIT) Then
	appPostedMessage=.GetROProperty("innertext")
	Call WriteToReport(micPass,"Posted messge is ","displayed as below="&appPostedMessage,False)
End If
End  With 

'Click on Ok button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").WebButton("Approve_Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").WebButton("Approve_Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebButton("Approve_FillForm_Cancel")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 


With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve_Save")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Navigate to below page
'Suppliers > Supplier Information > Add/Update > Supplier 
'Enter the Supplier ID
SelectMainMenu1(GlobalDictionary("MainMenuSelection5"))

'Enter the Suppleir ID
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("FindExistingValue_VendorID")
If .Exist(nMINWAIT) Then
	.Set (GlobalDictionary("SupplierIdCreated"))
	Reporter.ReportEvent micPass,"THe supplier id is","set with we created in previous steps"&(GlobalDictionary("SupplierIdCreated"))
End If
End  With 

'CLicko n Search button
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With


'Validate whether page is opened
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The summary tab is","present details are validated"
End If
End  With 


End Function



'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************


'AP_03_01_04
Public Function closeVoucher030104()
Dim dtBusinessUnit,dtVoucherID,dtControlID,dtRequestID,dtDescription,dtPostVoucherOption,dtPrepaymentApplicationMethod,dtProcessFrequency
	dtBusinessUnit=(GlobalDictionary("BusinessUnit"))
dtVoucherID=(GlobalDictionary("VoucherID"))
dtControlID=(GlobalDictionary("RunControlID"))
dtRequestID=(GlobalDictionary("RequestID"))
dtDescription=(GlobalDictionary("Description"))
dtPostVoucherOption=(GlobalDictionary("PostVoucherOption"))
dtPrepaymentApplicationMethod=(GlobalDictionary("PrepaymentApplicationMethod"))
dtProcessFrequency=(GlobalDictionary("ProcessFrequency"))


''Accounts Payable> Vouchers>Add/Update>Close Voucher
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	For i=0 to 2
		app_SearchSync()
	Next


With Browser("PeopleSoft Browser").Page("VoucherClose").PSFrame("VoucherClose")
	If .WebEdit("BusinessUnit").Exist(nminwait) Then
		.WebEdit("BusinessUnit").Set dtBusinessUnit
		Call WriteToReport(micPass,"BusinessUnit : "&dtBusinessUnit,"is present and entered as"&dtBusinessUnit, false)
	End If
	If .WebEdit("VoucherID").Exist(nminwait) Then
		.WebEdit("VoucherID").Set dtVoucherID
		Call WriteToReport(micPass,"VoucherID : "&dtVoucherID,"is present and entered as"&dtVoucherID, false)
	End If
	If .WebButton("Search").Exist(nminwait) Then
		.WebButton("Search").Click
		Call WriteToReport(micPass,"Saerch button clicked","is present and clicked", false)
	End If
	Dim appMessage
	If .WebElement("NomatchingValues").Exist(nminwait) Then
		appMessage=.WebElement("NomatchingValues").GetROProperty("innertext")
		Call WriteToReport(micPass,"Search the closed voucher","Expceted message is present : "&appMessage, false)
	End If
	
End With

'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
		SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))
		
		
		'Add business unit and voucgher id in existing value
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
		
		.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
		If .WebTabStrip("tabSelectionMain").Exist(nMINWAIT) Then
			.WebTabStrip("tabSelectionMain").Select("Find an Existing Value")
			Call WriteToReport(micPass,"Find an existing Value tab ","is present",false)
			else
			Call WriteToReport(micFail,"Find an existing Value tab","is not present",True)
		End If
	
		.WebEdit("BusinessUnitFEV").WaitProperty "visible",True,20000
		If .WebEdit("BusinessUnitFEV").Exist(nMINWAIT) Then
			.WebEdit("BusinessUnitFEV").Set dtBusinessUnit
			Call WriteToReport(micPass,"Business unit :"&dtBusinessUnit ,"is present and entered as "&dtBusinessUnit ,false)
			else
			Call WriteToReport(micFail,"Business unit","is not present",True)
		End If
		
		If .WebEdit("VoucherIdFEV").Exist(nMINWAIT) Then
			.WebEdit("VoucherIdFEV").Set dtVoucherID
			Call WriteToReport(micPass,"Voucher Id :"&dtVoucherID ,"is present and entered as "&dtVoucherID ,false)
			else
			Call WriteToReport(micFail,"Voucher Id","is not present",True)
		End If
		
		If .WebButton("Search").Exist(nMINWAIT) Then
			.WebButton("Search").Click
			Call WriteToReport(micPass,"Search button to Search the voucher","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Search button to Search the voucher","is not present",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
		If .WebTabStrip("tabSelection").Exist(10) Then
			.WebTabStrip("tabSelection").Select("Payments")
			Call WriteToReport(micPass,"Payments tab","is present and selected",false)
		else
			Call WriteToReport(micFail,"Payments tab","is not present",True)
		End If
		
	end with	
			app_SearchSync()
		Dim paymentdate
With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Payments")
			
		If .WebEdit("PaymentDate").Exist(nminwait) Then
			If .WebEdit("PaymentDate").GetROProperty("disabled")=1 and .WebEdit("PaymentDate").GetROProperty("value")<>"" Then
				Call WriteToReport(micPass,"payments date : "&.WebEdit("PaymentDate").GetROProperty("value")," Payment date is present under scheduled payment section",false)
			End If
		End If
		If .WebEdit("Reference").Exist(nminwait) Then
			If .WebEdit("Reference").GetROProperty("disabled")=1 and .WebEdit("Reference").GetROProperty("value")<>"" Then
				Call WriteToReport(micPass,"Reference : "&.WebEdit("Reference").GetROProperty("value")," Reference is present under scheduled payment section",false)
			End If
		End If
End With

''Accounts Payable> Vouchers>Add/Update>Close Voucher
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

For i=0 to 2
		app_SearchSync()
	Next

With Browser("PeopleSoft Browser").Page("VoucherClose").PSFrame("VoucherClose")
	If .WebEdit("BusinessUnit").Exist(nminwait) Then
		.WebEdit("BusinessUnit").Set dtBusinessUnit
		Call WriteToReport(micPass,"BusinessUnit : "&dtBusinessUnit,"is present and entered as"&dtBusinessUnit, false)
	else
		Call WriteToReport(micFail,"BusinessUnit","is not present",True)
	End If
'	If .WebEdit("VoucherID").Exist(nminwait) Then
'		.WebEdit("VoucherID").Set dtVoucherID
'		Call WriteToReport(micPass,"VoucherID : "&dtVoucherID,"is present and entered as"&dtVoucherID, false)
'	End If
	If .WebButton("Search").Exist(nminwait) Then
		.WebButton("Search").Click
		Call WriteToReport(micPass,"Saerch button clicked","is present and clicked", false)
	else
		Call WriteToReport(micFail,"Saerch button","is not present",True)
	End If
	
	app_SearchSync()
	
	If .WebTable("SearchResults").Exist(nminwait) Then
		If .WebTable("SearchResults").RowCount>1 Then
			dtVoucherID=.WebTable("SearchResults").GetCellData(2,2)
			.WebTable("SearchResults").ChildItem(2,2,"Link",0).click
			Call WriteToReport(micPass,"Voucher selected from search results :"&dtVoucherID, "Voucher is present and selected as"&dtVoucherID,false)
		else
		Call WriteToReport(micPass,"Search results", "is not present in the application",false)
		End If
	End If
	app_SearchSync()

	If .WebCheckBox("MarkVoucherforClosed").Exist(nminwait) Then
		.WebCheckBox("MarkVoucherforClosed").Set "ON"
			Call WriteToReport(micPass,"Mark Voucher for Closed:", " is present and selected",false)
	else
		Call WriteToReport(micFail,"Mark Voucher for Closed field","is not present",True)
	End If
end with 	
	If Browser("PeopleSoft Browser").Page("VoucherClose").WebButton("No").Exist(nmaxwait) Then
		Browser("PeopleSoft Browser").Page("VoucherClose").WebButton("No").Click
	End If
	
With Browser("PeopleSoft Browser").Page("VoucherClose").PSFrame("VoucherClose")
	If .WebEdit("CloseDate").Exist(nminwait) Then
		.WebEdit("CloseDate").Set date
			Call WriteToReport(micPass,"Close date :"&date, "Close date is present and entered as"&date,false)
		else
		Call WriteToReport(micFail,"Close date field","is not present",True)
	End If
	If .WebEdit("Comments").Exist(nminwait) Then
		.WebEdit("Comments").Set "Closed"
			Call WriteToReport(micPass,"Comments :"&"Closed", "Comments is present and entered as"&"Closed",false)
		else
			Call WriteToReport(micFail,"Comments field","is not present",True)
	End If
	If .WebButton("Save").Exist(nminwait) Then
		.WebButton("Save").Click
			Call WriteToReport(micPass,"Save button ", "is present and clicked",false)
		else
			Call WriteToReport(micFail,"Save button","is not present",True)
	End If
end with

'Navigate to below 
'Accounts Payable>Batch Processes>Vouchers>Voucher Posting
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

	For i=0 to 2
		app_SearchSync()
	Next

	
	'CLick on Add NEw value Tab
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebElement("AddNewValue")
	If .Exist(nMINWAIT) Then
		.Click
		
		'Enter the control ID
		With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("PRCSRUNCNTL_RUN_CNTL_ID")
		If .Exist(nMINWAIT) Then
			.Set dtControlID & inVoiceNumberGeneration' & Day(Date)
			
		End If
		End WIth 
		
		'CLick onb Add Button
		With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebButton("Add")
		If .Exist(nMINWAIT) Then
			.Click
			Call WriteToReport(micPass,"Add button ", "is present and clicked",false)
		else
		Call WriteToReport(micPass,"Add button", "is not present in the application",false)
		End If
		End With 

		Else
		Call WriteToReport(micFail,"Add New value is not present","and not able to enter  the Details",True)
	End If
	End WIth 

	'Wait for the applicatoin load
	Browser("PeopleSoft Browser").Sync
	
	'Check if the add ing nwe contorl page ois displayed
	If Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("RequestID").WaitProperty("visible",True,2000) Then
		
	'Enter the Run control IDF values in the Page
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("RequestID")
	If .Exist(nMINWAIT) Then
		.Set dtRequestID
		Call WriteToReport(micPass,"RequestID :"&dtRequestID, "is present and entered as"&dtRequestID,false)
		else
		Call WriteToReport(micPass,"RequestID", "is not present in the application",false)
	End If
	End WIth 
	
	'Enter the description
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("Description")
	If .Exist(nMINWAIT) Then
		.Set dtDescription
		Call WriteToReport(micPass,"Description :"&dtDescription, "is present and entered as"&dtDescription,false)
		else
		Call WriteToReport(micPass,"Description", "is not present in the application",false)
	End If
	End WIth 
	
	'Select the voucher Posting option
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebList("PostVoucherOption")
	If .Exist(nMINWAIT) Then
		.Select dtPostVoucherOption
		Call WriteToReport(micPass,"PostVoucherOption :"&dtPostVoucherOption, "is present and entered as"&dtPostVoucherOption,false)
		else
		Call WriteToReport(micPass,"PostVoucherOption", "is not present in the application",false)
	End If
	End WIth 
	
	'Select the Prepamenty application
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebList("PrepaymentApplicationMethod")
	If .Exist(nMINWAIT) Then
		.Select dtPrepaymentApplicationMethod
		Call WriteToReport(micPass,"PrepaymentApplicationMethod :"&dtPrepaymentApplicationMethod, "is present and entered as"&dtPrepaymentApplicationMethod,false)
		else
		Call WriteToReport(micPass,"PrepaymentApplicationMethod", "is not present in the application",false)
	End If
	End With
	
	'Select the process frequency
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebList("ProcessFrequency")
	If .Exist(nMINWAIT) Then
		.Select dtProcessFrequency
		Call WriteToReport(micPass,"ProcessFrequency :"&dtProcessFrequency, "is present and entered as"&dtProcessFrequency,false)
		else
		Call WriteToReport(micPass,"ProcessFrequency", "is not present in the application",false)
	End If
	End With
	
	'ENter the Business UNit
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("BusinessUnit")
	If .Exist(nMINWAIT) Then
		.Set dtBusinessUnit
		Call WriteToReport(micPass,"BusinessUnit :"&dtBusinessUnit, "is present and entered as"&dtBusinessUnit,false)
		else
		Call WriteToReport(micPass,"BusinessUnit", "is not present in the application",false)
	End If
	End WIth 
	
	'Enter the Voucher ID
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("VoucherID")
	If .Exist(nMINWAIT) Then
		.Set dtVoucherID
		Call WriteToReport(micPass,"VoucherID :"&dtVoucherID, "is present and entered as"&dtVoucherID,false)
		else
		Call WriteToReport(micPass,"VoucherID", "is not present in the application",false)
	End If
	End WIth 
	
	'Click on Run button
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebButton("Run")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Run button", "is present and clicked",false)
		else
		Call WriteToReport(micPass,"Run button", "is not present in the application",false)
	End If
	End WIth 

	For i=0 to 3
		app_SearchSync()
	Next
	
	'Selcet the post voucejhr and clickon Ok button
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("ProcessSchdeluerRequest").WebTable("ProcessList")
	If .Exist(nMINWAIT) Then
		For i=2 to .RowCount
			appDescription=.GetCellData(i,2)
			If appDescription="Post vouchers" Then
				Set oVoucherLink=.ChildItem(i,1,"WebCheckBox",0)
				appProcessName=.GetCellData(i,3)
				Call WriteToReport(micPass,"The Process Name is", "is"&appProcessName,False)
				If oVoucherLink.exist(nMINWAIT) Then
					oVoucherLink.click
				End If
			End If
		Next
	End If
	End With

	For i=0 to 2
		app_SearchSync()
	Next

	
	'Click on Ok button
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("ProcessSchdeluerRequest").WebButton("Ok")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End WIth 

	For i=0 to 4
		app_SearchSync()
	Next
	
	'Get the Process INstance Number
	'Get the instance number present to validate in upcoming steps
	appInstanceNumberWithoutTrim = Browser("creationtime:=0").Page("index:=1").WebElement("innertext:=Process Instance:.*", "index:=1").GetROProperty("innertext")
	appInstanceNumber=Trim(Mid(appInstanceNumberWithoutTrim,18))
	app_SearchSync()
	GlobalDictionary("instanceNumber")=appInstanceNumber
	
	

	'Click on Process moonitor
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("VoucherPostingRequest").Link("Process Monitor")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Process Monitor", "is present and clicked",false)
		else
		Call WriteToReport(micPass,"Process Monitor", "is not present in the application",false)
	End If
	End With 

	For i=0 to 3
		app_SearchSync()
	Next
	
	'Enter all the detail in the Process monitor screen
	With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebEdit("InstanceFrom")
	If .Exist(nMINWAIT) Then
		.Set (GlobalDictionary("instanceNumber"))
		Call WriteToReport(micPass,"instanceNumber :"& (GlobalDictionary("instanceNumber")), "is generated and entered in Instance from"& (GlobalDictionary("instanceNumber")),false)
		else
		Call WriteToReport(micPass,"InstanceFrom ", "is not present in the application",false)
	End If
	End WIth 
	
	'Click on Refresh button
	With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Refresh")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End With 
	
	sStatus="Success"
	'check the status of the Job 
	With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor")
	If .Exist(nMINWAIT) Then
	While Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor").GetCellData(2,8)<>sStatus and nCount<10
		wait(10)
		nCount=nCount+1
		Set oRefresh=Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Refresh")
		If oRefresh.Exist(nMAXWAIT) Then
			oRefresh.Click
		End If
		Set oRefresh=Nothing
		Wend
	End If
	End With

	dtStatus="Posted"
	'check the distribution status
	If Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor").GetCellData(2,8)="Success" Then
	While Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)<>dtStatus and dtCount<20
		dtCount=dtCount+1:wait(10)
		Set oRefresh=Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebButton("Refresh")
		If oRefresh.Exist(nMAXWAIT) Then
			oRefresh.Click
		End If
		Set oRefresh=Nothing
	Wend
	
	If Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor").GetCellData(2,9)="Posted" Then
		Call WriteToReport(micPass,"Process Monitor", "able to successfully complete process = [ " & instanceNumber &"]",false)
		Else
		Call WriteToReport(micFail,"Process Monitor", "Unable to successfully complete process = [ " & instanceNumber &"]",True)
	End If
	Else
	Call WriteToReport(micFail,"Process Monitor", "Unable to successfully complete process = [ " & instanceNumber &"]",True)
	End If
	
Else
	Call WriteToReport(micFail,"Not able to enter the details ","for running voiucher and not able to run the voucher control",True)
End If

Browser("PeopleSoft Browser").Sync



'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
		SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))
		
		For i=0 to 2
		app_SearchSync()
		Next
		'Add business unit and voucgher id in existing value
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
		
		.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
		If .WebTabStrip("tabSelectionMain").Exist(nMINWAIT) Then
			.WebTabStrip("tabSelectionMain").Select("Find an Existing Value")
			Call WriteToReport(micPass,"Find an existing Value tab ","is present",false)
			else
			Call WriteToReport(micFail,"Find an existing Value tab","is not present",True)
		End If
	
		.WebEdit("BusinessUnitFEV").WaitProperty "visible",True,20000
		If .WebEdit("BusinessUnitFEV").Exist(nMINWAIT) Then
			.WebEdit("BusinessUnitFEV").Set dtBusinessUnit
			Call WriteToReport(micPass,"Business unit :"&dtBusinessUnit ,"is present and entered as "&dtBusinessUnit ,false)
			else
			Call WriteToReport(micFail,"Business unit","is not present",True)
		End If
		
		If .WebEdit("VoucherIdFEV").Exist(nMINWAIT) Then
			.WebEdit("VoucherIdFEV").Set dtVoucherID
			Call WriteToReport(micPass,"Voucher Id :"&dtVoucherID ,"is present and entered as "&dtVoucherID ,false)
			else
			Call WriteToReport(micFail,"Voucher Id","is not present",True)
		End If
		
		If .WebButton("Search").Exist(nMINWAIT) Then
			.WebButton("Search").Click
			Call WriteToReport(micPass,"Search button to Search the voucher","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Search button to Search the voucher","is not present",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
		If .WebElement("ClosedStatus").Exist(nminwait) Then
			Dim appclosedstatus:appclosedstatus=.WebElement("ClosedStatus").GetROProperty("innertext")
			If StrComp(Trim(appclosedstatus),"closed",1)=0 Then
				Call WriteToReport(micPass,"Voucher status:" &appclosedstatus,"Voucher status is present as "&appclosedstatus,false)
				else
				Call WriteToReport(micFAIL,"Voucher status:" &.appclosedstatus,"Voucher status is present and exected status is Closed but actual is "&appclosedstatus,false)
			End If
		else
				Call WriteToReport(micFAIL,"Closed status field" ,"Closed status is not present in the application",True)
		End If
		
		
	end with	
			

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'download a file from url
Public Function downloadAfilefromURL(Byref strFileUrl,Byref strSaveFileTo)
	
' Path of the file you want to download
'strFileUrl = "https://psfnapwbregvh1.corp.cdw.com:444/psreports/fnreg/8458446/CDW_APR032B.xlsx" 

'Local drive's path where you want to save the file
'strSaveFileTo = "C:\AutoSource_Prod\PSFINUFT\Reports\CDW_APR032B.xlsx"


' create a XMLHTTP object
Set oHTTP = CreateObject("MSXML2.XMLHTTP")

oHTTP.open "GET", strFileUrl, False
oHTTP.send

'create FSO object
Set oFSO = CreateObject("Scripting.FileSystemObject")

'If  strSaveFileTo file already exist, delete it
If oFSO.FileExists(strSaveFileTo) Then
  oFSO.DeleteFile(strSaveFileTo)
End If

If oHTTP.Status = 200 Then
  Dim oADOStream
  Set oADOStream = CreateObject("ADODB.Stream")
  With oADOStream
    .Type = 1
    .Open
    .Write oHTTP.ResponseBody
    .SaveToFile strSaveFileTo
    .Close
  End With
  set oADOStream = Nothing
End If

If oFSO.FileExists(strSaveFileTo) Then
  Call WriteToReport(micPass,"File has been downloaded successfully ", "File has been downloaded successfully and save to  " & strSaveFileTo,false)
 else
  Call WriteToReport(micFAIL,"File Doesn't downloaded ", "File doesn't downloaded",false)
End If

End Function



'*********************************************************************************************************************************
''' <summary>  
''' ap_matchingVoucher() To match  Voucher
'''Parameter1:	businessunit,voucherID
''' <para>
''' <note>Required Testcase Inputs are "Desciption,ProcessFrequency,MatchActions,Options,RunControlID"</note> 
''' </para>
''' </summary>
''' <author>gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to match vouchers</startstate>
''' <endstate>match vouched</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'AP_matchingVoucher
Public Function ap_matchingVoucher(Byref businessunit,Byref voucherID)
	Dim Desciption,ProcessFrequency,MatchActions,Options,RunControlID,appProcessInstance,appProcess,flag
	flag=false
		'Accounts Payable --> Batch Processes --> Voucher --> Matching
'		SelectMainMenu1(GlobalDictionary("VoucherMatchingSelection"))
		
		RunControlID=GlobalDictionary("RunControlID")
	'Voucher matching
	With Browser("PeopleSoft Browser").Page("Matching").PSFrame("MatchRequest")
		If .WebElement("AddaNewValue").Exist(nminwait) Then
			.WebElement("AddaNewValue").Click
			Call WriteToReport(micPass,"Add new Value tab selected","Add New Value tab is present and clicked",false)
		else
			Call WriteToReport(micFail,"Add New value tab","doesn't present in the application",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
		If .WebEdit("RunControlID").Exist(nminwait) Then
			.WebEdit("RunControlID").Set RunControlID&inVoiceNumberGeneration
			Call WriteToReport(micPass,"Run Control ID : "&RunControlID,"RunControlID is present and enterred as "&RunControlID,false)
		else
			Call WriteToReport(micFail,"RunControlID","doesn't present in the application",True)
		End If
		If .WebButton("Add").Exist(nminwait) Then
			.WebButton("Add").Click
			Call WriteToReport(micPass,"Add button clicked","Add button is present and clicked",false)
		else
			Call WriteToReport(micFail,"Add button","doesn't present in the application",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
	
		Desciption=GlobalDictionary("Desciption")
		ProcessFrequency=GlobalDictionary("ProcessFrequency")
		MatchActions=GlobalDictionary("MatchActions")
		Options=GlobalDictionary("Options")
	'enter Run Control parameters values
		If .WebEdit("Description").Exist(nminwait) Then
			.WebEdit("Description").Set Desciption
			Call WriteToReport(micPass,"Description : "&Desciption,"Description is present and enterred as "&Desciption,false)
		else
			Call WriteToReport(micFail,"Description","doesn't present in the application",True)
		End If
		If .WebList("ProcessFrequency").Exist(nminwait) Then
			.WebList("ProcessFrequency").Select ProcessFrequency
			Call WriteToReport(micPass,"ProcessFrequency : "&ProcessFrequency,"ProcessFrequency is present and enterred as "&ProcessFrequency,false)
		else
			Call WriteToReport(micFail,"ProcessFrequency","doesn't present in the application",True)
		End If
		If .WebList("MatchActions").Exist(nminwait) Then
			.WebList("MatchActions").Select MatchActions
			Call WriteToReport(micPass,"MatchActions : "&MatchActions,"MatchActions is present and enterred as "&MatchActions,false)
		else
			Call WriteToReport(micFail,"MatchActions","doesn't present in the application",True)
		End If
		If .WebList("Options").Exist(nminwait) Then
			.WebList("Options").Select Options
			Call WriteToReport(micPass,"Options : "&Options,"Options is present and enterred as "&Options,false)
		else
			Call WriteToReport(micFail,"Options","doesn't present in the application",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
	'Enter Voucher details
		If .WebEdit("BusinessUnit").Exist(nminwait) Then
			.WebEdit("BusinessUnit").Set businessunit
			Call WriteToReport(micPass,"BusinessUnit : "&businessunit,"BusinessUnit is present and enterred as "&businessunit,false)
		else
			Call WriteToReport(micFail,"BusinessUnit","doesn't present in the application",True)
		End If
		If .WebEdit("VoucherID").Exist(nminwait) Then
			.WebEdit("VoucherID").Set voucherID
			Call WriteToReport(micPass,"voucher ID : "&voucherID,"voucherID is present and enterred as "&voucherID,false)
		else
			Call WriteToReport(micFail,"voucher ID","doesn't present in the application",True)
		End If
		If .WebButton("Run").Exist(nminwait) Then
			.WebButton("Run").Click
			Call WriteToReport(micPass,"Run button clicked","Run button is present and clicked",false)
		else
			Call WriteToReport(micFail,"Run button","doesn't present in the application",True)
		End If
	End with
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
	'Enter values in Process scheduler request
	
	With Browser("PeopleSoft Browser").Page("Matching").PSFrame("ProcessSchedularrequest")
		If .WebTable("ProcessList").Exist(nminwait) Then
			If Cint(trim(.WebTable("ProcessList").RowCount))>1 Then
				.WebTable("ProcessList").ChildItem(2,1,"WebCheckBox",0).set "ON"
				appProcess=.WebTable("ProcessList").GetCellData(2,3)
				Call WriteToReport(micPass,"Process : "&appProcess," Process is present and selected as "& appProcess ,false)
			End If
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End with 

	
	
	'wait for the ojects to get loaded
	app_SearchSync()

			
		with Browser("PeopleSoft Browser").Page("Matching").PSFrame("MatchRequest")
			If .WebElement("ProcessInstance").Exist(nminwait) Then
				appProcessInstance=.WebElement("ProcessInstance").GetROProperty("innertext")
				appProcessInstance=Trim(Split(appProcessInstance,":")(1))
				Call WriteToReport(micPass,"ProcessInstance : "&appProcessInstance,"is present and generated as "&appProcessInstance,false)
			else
				Call WriteToReport(micFail,"ProcessInstance","doesn't get generated",True)
			End If
			If .Link("ProcessMonitor").Exist(nminwait) Then
				.Link("ProcessMonitor").Click
			End If
		
		End with 

'Enter all the detail in the Process monitor screen
		flag=ap_ProcesstheInstanseinProcessMonitor(appProcessInstance)
'End If
If flag Then
	ap_matchingVoucher="success"
else
	ap_matchingVoucher="fail"
End If


End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_openExistingVoucher() To open existing  Voucher
'''Parameter1:	businessunit,voucherID
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran s</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to open vouchers</startstate>
''' <endstate>Voucher opened</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_openExisting Voucher
Public Function ap_openExistingVoucher(businessunit,voucherID)

		
		'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
		
		.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
		If .WebTabStrip("tabSelectionMain").Exist(nMINWAIT) Then
			.WebTabStrip("tabSelectionMain").Select("Find an Existing Value")
			Call WriteToReport(micPass,"Find an existing Value tab ","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Find an existing Value tab","is not present",True)
		End If
	
		.WebEdit("BusinessUnitFEV").WaitProperty "visible",True,20000
		If .WebEdit("BusinessUnitFEV").Exist(nMINWAIT) Then
			.WebEdit("BusinessUnitFEV").Set businessunit
			Call WriteToReport(micPass,"Business unit ","is present and entered as "&businessunit,false)
			else
			Call WriteToReport(micFail,"Business unit","is not present",True)
		End If
		
		If .WebEdit("VoucherIdFEV").Exist(nMINWAIT) Then
			.WebEdit("VoucherIdFEV").Set voucherID
			Call WriteToReport(micPass,"Voucher Id ","is present and entered as "&voucherID,false)
			else
			Call WriteToReport(micFail,"Voucher Id","is not present",True)
		End If
		
		If .WebButton("Search").Exist(nMINWAIT) Then
			.WebButton("Search").Click
			Call WriteToReport(micPass,"Search button to Search the voucher","is present",false)
			else
			Call WriteToReport(micFail,"Search button to Search the voucher","is not present",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
	End with 	
	
	

End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_verifyMatchstatusofVoucher() To verify the match status of  Voucher
'''Parameter1:	strMatchStatus(status to be validated),strOption(if exception lick exist,put "Click")
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to open vouchers</startstate>
''' <endstate>Voucher opened</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_verify match status of voucher
Public Function ap_verifyMatchstatusofVoucher(strMatchStatus,strOption)
	Dim MatchStatus	
		'wait for the ojects to get loaded
		app_SearchSync()
		
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
		If .WebElement("MatchStatus").Exist(nMINWAIT) Then
			MatchStatus=Trim(.WebElement("MatchStatus").GetROProperty("outertext"))
			If InStr(1,strMatchStatus,MatchStatus,1)<>0 Then
'				.WebElement("MatchStatus").Click
				Call WriteToReport(micPass,"MatchStatus : "&MatchStatus,"is present and generated as "&MatchStatus,false)
				If StrComp(strOption,"click",1)=0 Then
					If .Link("Exceptions").exist(nminwait) Then
						.Link("Exceptions").Click
						wait(4)
						Call WriteToReport(micPass,"Exceptions Link ","is present and Clicked",false)
						If Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").WebButton("OK").Exist(nminwait) Then
							Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").WebButton("OK").Click
							Call WriteToReport(micPass,"Ok button","is present and Clicked",false)
						End If
'					else
'						Call WriteToReport(micFail,"Exceptions Link ","doesn't exist in the application",True)	
					End If
				End If
			else
				Call WriteToReport(micFail,"MatchStatus","doesn't get changed from Ready status",True)
			End If
		End If
	End with
End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_matchRuleValidations() To validate the Match rule of Voucher
'''Parameter1:	matchRuleOption.(Match rule can be one or more than one, if more than one enter with colon separated)
'matchRuleOption - "all" - it will capture all the rules
'matchRuleOption - "RuleID" (one or more rule id)
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to open vouchers</startstate>
''' <endstate>Match rule validated</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'AP_ Match rule validations
'matchRuleOption - "all" - it will capture all the rules
'matchRuleOption - "RuleID" (one or more rule id)
Function ap_matchRuleValidations(matchRuleOption)
	Dim MatchRule,rc,Ruledescription,i	
'	If Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchWorkBenchExceptions").Image("NoreciptsFound").Exist(minwait) Then
'		Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchWorkBenchExceptions").Image("NoreciptsFound").Click
'	End If
'
'wait(3)
'With Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchRuledetails")
'	If .WebElement("MatchRule").Exist(nminwait) Then
'		MatchRule=.WebElement("MatchRule").GetROProperty("innertext")
'		Call WriteToReport(micPass,"MatchRules : "&MatchRule,"is present and displayed as "&MatchRule,false)
'	else
'		Call WriteToReport(micFail,"MatchRules","doesn't get generated to No receipts found status",True)
'	End If
'	If .WebButton("Return").Exist(nminwait) Then
'		.WebButton("Return").Click
'	End If
'End With
	


'Set obj=Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchWorkBenchExceptions")
'	
'	If obj.WebTable("MatchRules").Exist(nminwait) Then
'		rc=obj.WebTable("MatchRules").RowCount
'		For i = 1 To rc Step 1
'			Ruledescription=obj.WebTable("MatchRules").GetCellData(i,3)
'			obj.WebTable("MatchRules").ChildItem(i,2,"WebButton",0).click
'		With Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchRuledetails")
'			If .WebElement("MatchRule").Exist(nminwait) Then
'				MatchRule=.WebElement("MatchRule").GetROProperty("innertext")
'				If StrComp(matchRuleOption,"all",1)=0 Then
'					Call WriteToReport(micPass,"MatchRules : "&MatchRule,"is present and displayed as "&MatchRule&": "&Ruledescription ,false)
'				ElseIf InStr(1,matchRuleOption,Trim(MatchRule),1)=0 Then
'					Call WriteToReport(micPass,"MatchRules : "&MatchRule,"is present and displayed as "&MatchRule&": "&Ruledescription ,false)
'					Exit for
'				else
'					Call WriteToReport(micFail,"MatchRules","Expected match rule doesn't displayed in application Expected:"&matchRuleOption&" Actual :"&MatchRule,True)
'				End If
'			else
'				Call WriteToReport(micFail,"MatchRules","doesn't displayed in application",True)
'			End If
'			If .WebButton("Return").Exist(nminwait) Then
'				.WebButton("Return").Click
'			End If
'		end with
'		Next
'	End If
'Set obj=nothing
Set obj=Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchWorkBenchExceptions")
	Set objdes=Description.Create
	objdes("micclass").value="IMAGE"
	objdes("html tag").value="IMG"
	objdes("title").value="Exception"
	Set imglist=obj.WebTable("MatchRules").ChildObjects(objdes)
	Dim X()
	For l=0 to imglist.count()-1
		ReDim preserve x(l)
		x(l)=imglist.item(l).getroproperty("xpath")
		Ruledescription=obj.WebTable("MatchRules").GetCellData(Mid(x(l),InstrRev(x(l),"TR[")+3,1),3)
		obj.WebTable("MatchRules").ChildItem(Mid(x(l),InstrRev(x(l),"TR[")+3,1),2,"WebButton",0).click
		With Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchRuledetails")
			If .WebElement("MatchRule").Exist(nminwait) Then
				MatchRule=.WebElement("MatchRule").GetROProperty("innertext")
				If StrComp(matchRuleOption,"all",1)=0 Then
					Call WriteToReport(micPass,"MatchRules : "&MatchRule,"is present and displayed as "&MatchRule&": "&Ruledescription ,false)
				ElseIf InStr(1,matchRuleOption,Trim(MatchRule),1)<>0 Then
					Call WriteToReport(micPass,"MatchRules : "&MatchRule,"is present and displayed as "&MatchRule&": "&Ruledescription ,false)
					Exit for
				else
					Call WriteToReport(micFail,"MatchRules","Expected match rule doesn't displayed in application Expected:"&matchRuleOption&" Actual :"&MatchRule,True)
				End If
			else
				Call WriteToReport(micFail,"MatchRules","doesn't displayed in application",True)
			End If
			If .WebButton("Return").Exist(nminwait) Then
				.WebButton("Return").Click
			End If
		end with
	Next
If Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").Exist(nminwait) Then
	Browser("PeopleSoft Browser NewTab").Close
End If
End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'=======================================================================================================================
'TestCase: 1.29
'=======================================================================================================================

'SelectExistingID
Public Function SelectExistingID()

Dim supplierID
dtInactSupp=(GlobalDictionary("dtInactSupp"))
''Suppliers > Supplier Registration > Supplier Forms > Inventory Supplier Form USA
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
'
'Click the search butotn
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("chkSupp_btnSearch")
 If .Exist(nMINWAIT) Then
 	.Click
 End If
End With

'To click on "/" link - posted

If Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebTable("chkSupp_tblSequenceNumber").Exist(nMINWAIT) Then
	nRows=Cint(Trim(Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebTable("chkSupp_tblSequenceNumber").RowCount))
		If nRows>1 Then
		For i=nRows to 1 step-1
			valPosted=Trim(Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebTable("chkSupp_tblSequenceNumber").GetCellData(i,4))
			If valPosted="/" Then
				Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebTable("chkSupp_tblSequenceNumber").ChildItem(i,4,"Link",0).click 
				Exit for
			'else
			'	Call WriteToReport(micFAIL,"No vouchers", "are in posted state to capture the Supplier ID",false)
			End If
		Next
		End If
ElseIf Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("searchForm_labelNoMatchingValues").Exist Then
	Call WriteToReport(micFAIL,"No Matching values", "were found-Table not found after search",false)
End If


' To get the supplier ID from the posted voucher
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("chkSupp_labelSupplierID")
 If .Exist(nMINWAIT) Then
	supplierID=Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("chkSupp_labelSupplierID").GetROProperty("innertext") 	
	Call WriteToReport(micPass,"Getting the value of Supplier ID from the posted voucher="&supplierID,"is displayed",false)
 End If
End With

'=================
'Test case: 1.30
'=================

'To click on the Approver status button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("searchForm_btnApproverStatus")
 If .Exist(nMINWAIT) Then
	.Click
 End If
End With

'To check for Approved status
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebTable("Inventory Supplier Form")
 If .Exist(nMINWAIT) Then
	status=.GetCellData(1,4)
	Call WriteToReport(micPass,"(TESTCASE: 1.30) The status of the posted voucher is="&status,"and is displayed",false)
 End If
End With

'===========================
'Test case:1.29 continuation
'===========================

'Suppliers > Supplier Registration > Supplier Forms > Inventory Supplier Form USA
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

'Click on Add New value
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Add new value tab","is present and clicked"
End If
End  With

'To set the Supplier ID and check for the error message
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("chkSupp_txtSupplierID")
If .Exist(nMINWAIT) Then
	.Set supplierID
	Call WriteToReport(micPass,"Already existing SupplierID (Active Supplier Check)="&supplierID,"is set",false)	
End If
End With 

'To capture the error message
With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").WebElement("alertMsg")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The Message for Active Supplier Check is="&.GetROProperty("innertext"),"is displayed",false)	
End If
End With

'To click on ok
With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

wait(1)
'To set the Supplier ID and check for the error message for Inactive Supplier id = ACCTEM
'InactSupp="ACCTEM"
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("chkSupp_txtSupplierID")
If .Exist(nMINWAIT) Then
	.Set dtInactSupp
	Call WriteToReport(micPass,"Inactive SupplierID="&dtInactSupp,"is set",false)	
End If
End With 

'To capture the error message of inactive supplier id
With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").WebElement("alertmsg")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The Message for In-active Supplier Check is is="&.GetROProperty("innertext"),"is displayed",false)	
End If
End With

'To click on Ok
With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

'To click on Check supplier button (To clear the alert message)
With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").WebButton("Back to Check Supplier")
If .Exist(nMINWAIT) Then
	.Click
End If
End With

'To click on alert message
With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").WebElement("alertbutton")
If .Exist(nMINWAIT) Then
	Browser("PeopleSoft Browser").Page("Search/Fill in a Form").WebButton("No").Click
End If
End With


End Function



'**********************************************************************************************************************************************************
''' <summary>  
''' Paypagemods() To Verify Express Payment page mods
'''Parameter1:	None.
''' <para>
''' <note>NA</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/20/2018</datecreated>
''' <startstate>Logged in as user that has right to pay vouchers</startstate>
''' <endstate>"File Name" text box and "Load Vouchers" button at the bottom of the screen is displayed</endstate>
'Change Control: 
'NA
'**********************************************************************************************************************************************************
'4.1.21 

Public Function Paypagemods()

'Navigate to:  Accounts Payable > Payments > Express Payments > Create Express Payment
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'To check Filename label is present or not
With Browser("PeopleSoft Browser").Page("Create Express Payment").PSFrame("Express Payment").WebElement("expressPmt_labelFILE_NAME")
	If .Exist(nMINWAIT) Then
		val=.GetROProperty("innertext")
		Call WriteToReport(micPass,"File Name label","is displayed",false) 
	else
		Call WriteToReport(micFAIL,"File Name Text box=:", "is not displayed",false)
	End If
End With 

'To check Filename textbox is present or not
With Browser("PeopleSoft Browser").Page("Create Express Payment").PSFrame("Express Payment").WebEdit("expressPmt_txtboxFILENAME")
	If .Exist(nMINWAIT) Then
		val=.GetROProperty("value")
		Call WriteToReport(micPass,"File Name Text box="&.GetROProperty("value"),"is displayed",false) 
	else
		Call WriteToReport(micFAIL,"File Name Text box=:", "is not displayed",false)
	End If
End With 

'To check LoadVoucher button is present or not
With Browser("PeopleSoft Browser").Page("Create Express Payment").PSFrame("Express Payment").WebButton("expressPmt_btnLoadVouchers")
	If .Exist(nMINWAIT) Then
		val=.GetROProperty("innertext")
		Call WriteToReport(micPass,"Load Voucher button","is displayed",false) 
	else
		Call WriteToReport(micFAIL,"Load Voucher button", "is not displayed",false)
	End If
End With 


End Function

'*********************************************************************************************************************************
''' <summary>  
''' AddSaveVoucherWithoutSubmit()|PayApproved() To Pay Only Approved
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "MainMenuSelection, businessunit, voucherID,invoiceNo,invoiceDate,SupplierID,Total,freight,Quantity,UnitPrice,dtAccount,Dept,salesTax,Classification"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'4.1.1


Public Function AddSaveVoucherWithoutSubmit()
	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	
	invoiceNo=GlobalDictionary("invoiceNo")&inVoiceNumberGeneration
	invoiceDate=GlobalDictionary("invoiceDate")
	supplierID=GlobalDictionary("SupplierID")
	Total=GlobalDictionary("Total")
	freight=GlobalDictionary("freight")
	Quantity=GlobalDictionary("Quantity")
	lineAmount=GlobalDictionary("UnitPrice")
	dtAccount=GlobalDictionary("dtAccount")
	Dept=GlobalDictionary("Dept")
	salesTax=GlobalDictionary("salesTax")
	Classification=GlobalDictionary("Classification")
	
	'wait for the ojects to get loaded
	app_SearchSync()
'	wait 3
	'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit : "&businessunit,"is present and entered as "&businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id :"&voucherID,"is present and entered as "&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		wait(5)
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()

	.WebEdit("invoiceNo").WaitProperty "visible",true,20000
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo
		Call WriteToReport(micPass,"invoiceNo :"&invoiceNo,"is present and entered as "&invoiceNo,false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date : "&invoiceDate,"is present and entered as "&invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	
	If .WebEdit("SupplierID").Exist(nMINWAIT) Then
		.WebEdit("SupplierID").Set supplierID
		Call WriteToReport(micPass,"Supplier ID : "&supplierID,"is present and entered as "&supplierIDs,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	If .WebEdit("lineAmount").Exist(nMINWAIT) Then
		.WebEdit("lineAmount").Set lineAmount
		Call WriteToReport(micPass,"lineAmount","is present",false)
		else
		Call WriteToReport(micFail,"lineAmount","is not present",True)
	End If
	
	wait 3 
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		wait 5
		.WebEdit("Total").Click
		.WebEdit("Total").Set Total
		Call WriteToReport(micPass,"Total : "&Total,"is present and entered as "&Total,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
'	wait 4
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebEdit("Account").Exist(nMINWAIT) Then
		.WebEdit("Account").Click
		wait(3)
		.WebEdit("Account").Set dtAccount
		Call WriteToReport(micPass,"Account "&Account,"is present and entered as "&vs,false)
		else
		Call WriteToReport(micFail,"Account","is not present",True)
	End If
	
	If .WebEdit("Dept").Exist(nMINWAIT) Then
		.WebEdit("Dept").Set Dept
		Call WriteToReport(micPass,"Dept "&Dept,"is present and entered as "&Dept,false)
		else
		Call WriteToReport(micFail,"Dept","is not present",True)
	End If

	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
	
'wait for the ojects to get loaded
	app_SearchSync()	

	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	

	If .WebElement("voucherID").Exist(nMINWAIT) Then
		appvoucherID=.WebElement("voucherID").GetROProperty("innertext")
		GlobalDictionary("voucherID")=appvoucherID
		Reporter.ReportEvent micPass,"THe voucehr ID","is"&appvoucherID
	End If
	
	If .WebTabStrip("tabSelection").Exist(10) Then
		.WebTabStrip("tabSelection").Select("Voucher Attributes")
		Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
	else
		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		appinvoiceNo=.WebEdit("invoiceNo").GetROProperty("value") 
		If StrComp(Trim(appinvoiceNo),trim(invoiceNo))=0 Then
			Call WriteToReport(micPass,"Voucher Attributes ","data is present",false)
			else
			Call WriteToReport(micFail,"Voucher Attributes","data is not present",True)
		End If
	End If
	End  With 
	
GlobalDictionary("SignInUser")=GlobalDictionary("Approver")

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


Public Function PayApproved()
'Navigate to below page
'Accounts Payable > Payments > Pay Cycle Processing > Payment Selection Criteria
SelectMainMenu1(GlobalDictionary("PayApproved"))

dtSearchCriteria=(GlobalDictionary("SearchBy"))
dtAddNewValue=(GlobalDictionary("AddNewValue")) & RandomAlphabetGeneration
dtBusinessUnit=(GlobalDictionary("businessunit"))
dtBank=(GlobalDictionary("Bank"))
dtAccount=(GlobalDictionary("Account"))

'Entet the Existing value and clickon Search button
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("TargetContent").WebEdit("PayCycle_SearchCriteria")
If .Exist(nMINWAIT) Then
	.Set dtSearchCriteria
	Reporter.ReportEvent micPass,"The Search criteria","is set with"&dtSearchCriteria
End If
End  With 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("TargetContent").WebButton("PayCycle_Search")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The search button is present and clicked","and naviagtedto Payment selection criteria page"
End If
End  With 

'Clic kon Add button
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCycle_Add")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The search button is present and clicked","and naviagtedto Paycycle page"
End If
End  With 

With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_AddNewValue")
If .Exist(nMINWAIT) Then
	.Set dtAddNewValue
	Reporter.ReportEvent micPass,"The new value","set is"&dtAddNewValue
End If
End  With 

With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCycle_AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Get the accountiung date and withholding date
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_AcctDate")
If .Exist(nMINWAIT) Then
	appAcctDate=.GetROProperty("value")
	Reporter.ReportEvent micPass,"The accounting date","is"&appAcctDate
End If
End  With 

WIth Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_WithholdingDate")
If .Exist(nMINWAIT) Then
	appWithholdingDate=.GetROProperty("value")
	Reporter.ReportEvent micPass,"The WIthholding date","is"&appWithholdingDate
End If
End  WIth

'CLicko n Source Tab
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebElement("PayCycle_SourceBU")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Get the calue of Source tran
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_SourceTrans")
If .Exist(nMINWAIT) Then
	appSourceTrans=.GetROProperty("value")
	Reporter.ReportEvent micPass,"The source Transcation","is"&appSourceTrans
End If
End  With 

'Enter the Business Unit
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_BusinessUnit")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Reporter.ReportEvent micPass,"The Business Unit","is"&dtBusinessUnit
End If
End  With 

'CLick on Bank 
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebElement("PayCycle_Bank/Method")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Bank tab is clicked ","and navigated"
End If
End  With 

With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_Bank")
If .Exist(nMINWAIT) Then
	.Set dtBank
	Reporter.ReportEvent micPass,"The Business Unit","is"&dtBusinessUnit
End If
End  With 

With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_Acct")
If .Exist(nMINWAIT) Then
	.Set dtAccount
	Reporter.ReportEvent micPass,"The Business Unit","is"&dtBusinessUnit
End If
End  With 

wait 3
'Click on Dates tab
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebElement("PayCycle_Dates")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

app_SearchSync()
'CLick on pay cylce manager
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").Link("PayCycle_PayCycleManager")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The pay cycle managerlink","is present and clicked:"
End If
End  With 

'Select the server anem
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebList("PayCycle_ServerName")
If .Exist(nMINWAIT) Then
	.Select 1
	appServerName=.GetROProperty("value")
	Reporter.ReportEvent micPass,"The server Name selected","is"&appServerName
End If
End  With 

With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_StepName")
If .Exist(nMINWAIT) Then
	appStep=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The Step Name present and value","is"&appStep
End If
End  With 

With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCycle_Process")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The process button is present","and clicked"
End If
End  With 

With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCYcle_Status")
If .Exist(nMINWAIT) Then
	While Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCYcle_Status").GetROProperty("innertext")<>"No work"
		Set oRefresh=Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh")
		If oRefresh.Exist(nMINWAIT) Then
			oRefresh.Click
		End If
		Set oRefresh=Nothing
	Wend
End If

appFinalStatus=.GetROProperty("innertext")
If appFinalStatus="No work" Then
	Reporter.ReportEvent micPass,"The status is","changed and is"&appFinalStatus
	Else
	Reporter.ReportEvent micFail,"The status is not","changed and is"&appFinalStatus
End If
End With


With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled")
If .Exist(nMINWAIT) Then
	appScheduledPayment=.GetROProperty("innertext")
	Reporter.ReportEvent micDone,"The scheduled payment","selected is"&appScheduledPayment
End If
End  With 


'Clicko n Process Monitor
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_ProcessMonitor")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebTable("ProcessTable_ProcessMonitor")
If .Exist(nMINWAIT) Then
	appProcessName=.GetCellData(2,5)
	Reporter.ReportEvent micPass,"The process Name","is"&appProcessName
End If
End  With 

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

Public Function RandomAlphabetGeneration()
Const LETTERS = "abcdefghijklmnopqrstuvwxyz0123456789"
 strLen=len(LETTERS)
 For i = 1 to 3
 str = str & Mid( LETTERS, RandomNumber( 1, Len( LETTERS ) ), 1 )
Next
RandomAlphabetGeneration= str
End Function

'*********************************************************************************************************************************
''' <summary>  
''' PostPayments4() To verify Payment Post is displayed
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "MainMenuSelection, dtRUnControlId, dtRequestID,processFreq,paymentOption,dtSetId,BankCode,BankAccount,PaymentMethod"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'4.1.2


Public Function PostPayments4()
'Navigate to below page
'Accounts Payable > Batch Processes > Payment > Payment Posting
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
dtRUnControlId=(GlobalDictionary("dtRUnControlId")) & RandomAlphabetGeneration
dtRequestID=(GlobalDictionary("dtRequestID"))
dtProcesFreq=(GlobalDIctionary("processFreq"))
dtPaymentOption=(GlobalDictionary("paymentOption"))
dtSetId=(GlobalDictionary("dtSetId"))
dtBankCode=(GlobalDictionary("BankCode"))
dtBankAccount=(GlobalDictionary("BankAccount"))
dtPaymentMethod=(GlobalDictionary("PaymentMethod"))
dtDescription=(GlobalDictionary("dtDescription"))

'CLick on Add new value
With Browser("PeopleSoft Browser").Page("Payment Posting").WebElement("Add New Value Tab")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"THe add new value","is present and clicekd"
End If
End  With 

'Enter the run control ID
With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Run Control Id")
If .Exist(nMINWAIT) Then
	.Set dtRUnControlId
	Reporter.ReportEvent micPass,"THe run contorl ID","is present and seti with"&dtRUnControlId
End If
End  With 

'Click on Add b utton
With Browser("PeopleSoft Browser").Page("Payment Posting").WebButton("Add Button")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'Enter request ID, description 
With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Request Id")
If .Exist(nMINWAIT) Then
	.Set dtRequestID
	Reporter.ReportEvent micPass,"THe request ID is present","and set with"&dtRequestID
End If
End  With 

With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Description")
If .Exist(nMINWAIT) Then
	.Set dtDescription
	Reporter.ReportEvent micPass,"THe Description is","set with"&dtDescription
End If
End  With 

'Enmter process frwq
With Browser("PeopleSoft Browser").Page("Payment Posting").WebList("Process Frequency")
If .Exist(nMINWAIT) Then
	.Select dtProcesFreq
	Reporter.ReportEvent micPass,"THe process freq is present","and set with"&dtProcesFreq
End If
End  With 

'Select payment option
With Browser("PeopleSoft Browser").Page("Payment Posting").WebList("Post Payment Option")
If .Exist(nMINWAIT) Then
	.Select dtPaymentOption
	Reporter.ReportEvent micPass,"THe Paymentoption is present","and set with"&dtPaymentOption
End If
End  With 

With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_SetId")
If .Exist(nMINWAIT) Then
	.Set dtSetId
End If
End  WIth 
dtBankCode=(GlobalDictionary("BankCode"))
dtBankAccount=(GlobalDictionary("BankAccount"))
dtPaymentMethod=(GlobalDictionary("PaymentMethod"))
'Enter the Bank details and payment methods
With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_BankCode")
If .Exist(nMINWAIT) Then
	.Set dtBankCode
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_BankAccount")
If .Exist(nMINWAIT) Then
	.Set dtBankAccount
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_PaymentMethod")
If .Exist(nMINWAIT) Then
	.Set dtPaymentMethod
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_PaymentReference")
If .Exist(nMINWAIT) Then
	With Browser("PeopleSoft Browser").Page("Payment Posting").Image("Payment_PaymentReferenceIMage")
	If .Exist(nMINWAIT) Then
		.Click
		app_SearchSync()
		With Browser("PeopleSoft Browser").Page("Payment Posting").PSFrame("LookUpReference_PaymentReference").WebTable("LookUp_ReferenceNumberResults")
		If .Exist(nMINWAIT) Then
			appPaymentReferenceNumber=.GetCellData(2,1)
			GlobalDictionary("PaymentReferenceNumber")=appPaymentReferenceNumber
			Reporter.ReportEvent micPass,"The referenece number selected","is"&appPaymentReferenceNumber
			Set oLink=.ChildItem(2,1,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
			End If
		End If
		End  With
	End If
	End  WIth 

End If
End  With 

'CLick on Ru nbutton
With Browser("PeopleSoft Browser").Page("Payment Posting").WebButton("Run Button")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

With Browser("PeopleSoft Browser").Page("Payment Posting").PSFrame("Process scheduler Request").WebTable("ProcessScheduler_ProcessName")
If .Exist(nMINWAIT) Then
	appProcessName=.GetCellData(2,3)
	Reporter.ReportEvent micPass,"The process Name is","is"&appProcessName
End If
End  With 

With Browser("PeopleSoft Browser").Page("Payment Posting").PSFrame("Process scheduler Request").WebButton("Ok Button")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Get the Process INstance Number
'Get the instance number present to validate in upcoming steps
appInstanceNumberWithoutTrim = Browser("creationtime:=0").Page("index:=1").WebElement("innertext:=Process Instance:.*", "index:=1").GetROProperty("innertext")
appInstanceNumber=Trim(Mid(appInstanceNumberWithoutTrim,18))
app_SearchSync()
GlobalDictionary("instanceNumber")=appInstanceNumber

With Browser("PeopleSoft Browser").Page("Payment Posting").Link("Process Monitor")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With

'Click o refresh button untill the status is sucess and posted
Call CheckProcessMontiorStatus (appProcessName)

'Navigate to below page to check the payment inquiry
'Accounts Payable  >Review Accounts Payable Info>  Payments  >Payment
SelectMainMenu1(GlobalDictionary("PaymentInquiry"))

'Enter the payment reference number which was set earlier
With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebEdit("PaymentInquiry_PaymentRef")
If .Exist(nMINWAIT) Then
	.Set (GlobalDictionary("PaymentReferenceNumber"))
	Reporter.ReportEvent micPass,"The Reference number","is present and set with"&(GlobalDictionary("PaymentReferenceNumber"))
End If
End  With 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebButton("PaymentInquiry_Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()


'Clicko n the ID link
With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebTable("PaymentInquiry_ActionsTable")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
		appRefNumber=.GetCellData(i,	3)
		If appRefNumber=(GlobalDictionary("PaymentReferenceNumber")) Then
			Set oLink=.ChildItem(i,3,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
			End If
		End If
	Next
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

Browser("PeopleSoft Browser").Sync

With Browser("PeopleSoft Browser").Page("Payment").PSFrame("Payment").WebTable("Payment_DetailsResult")
If .Exist(nMINWAIT) Then
	appVoucherID=.GetCellData(1,2)
	GlobalDictionary("appVoucherId")=appVoucherID
	Reporter.ReportEvent micPass,"The voucher ID","selected is"&appVoucherID
End If
End  With 

'Navigate to Below page
'Accounts Payable/ Review Accounts Payable Info/Vouchers/Accounting Entries
SelectMainMenu1(GlobalDictionary("AccountingEntries"))

'Enter voucehr ID
With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebEdit("VoucherID")
If .Exist(nMINWAIT) Then
	.Set (GlobalDictionary("appVoucherId"))
	Reporter.ReportEvent micPass,"The voucehr ID field","is present and set with"&(GlobalDictionary("appVoucherId"))
End If
End  With 

'CLicko n Search ubtton
With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Search button","is present and clicked"
End If
End  With 

With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebTable("AccountingInformation")
If .Exist(nMINWAIT) Then
	Reporter.ReportEvent micPass,"Voucher ENtry details","are displaeyd for paymentr"
End If
End  With 

End Function

'*********************************************************************************************************************************
''' <summary>  
''' PayCycleIncrementDates() To Pay Cycle Increment Dates
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "PayApproved, SearchBy, CHangePeriod,Number,BusUnit1,BusUnit2,BusUnit3,PaymentMethod1,PaymentMethod2,PaymentMethod3,dtBankName1,dtAcct1,dtBankName2,dtAcct2,dtBankName3,dtAcct3"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'4.1.3


Public Function PayCycleIncrementDates()
	'Navigate to below page
	'Accounts Payable > Payments > Pay Cycle Processing > Payment Selection Criteria
	SelectMainMenu1(GlobalDictionary("PayApproved"))
	
	dtSearchCriteria=(GlobalDictionary("SearchBy"))
	dtCHangePeriod=(GlobalDictionary("CHangePeriod"))
	dtNumber=(GlobalDictionary("Number"))
	dtBusUnit1=(GlobalDictionary("BusUnit1"))
	dtBusUnit2=(GlobalDictionary("BusUnit2"))
	dtBusUnit3=(GlobalDictionary("BusUnit3"))
	dtPaymentMethod1=(GLobalDictionary("PaymentMethod1"))
	dtPaymentMethod2=(GLobalDictionary("PaymentMethod2"))
	dtPaymentMethod3=(GLobalDictionary("PaymentMethod3"))
	dtBankName1=(GlobalDictionary("dtBankName1"))
	dtAcct1=(GlobalDictionary("dtAcct1"))
	dtBankName2=(GlobalDictionary("dtBankName2"))
	dtAcct2=(GlobalDictionary("dtAcct2"))
	dtBankName3=(GlobalDictionary("dtBankName3"))
	dtAcct3=(GlobalDictionary("dtAcct3"))
	
	'Entet the Existing value and clickon Search button
	With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("TargetContent").WebEdit("PayCycle_SearchCriteria")
	If .Exist(nMINWAIT) Then
	.Set dtSearchCriteria
	Reporter.ReportEvent micPass,"The Search criteria","is set with"&dtSearchCriteria
	End If
	End  With 
	
	'CLick on Search button
	With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("TargetContent").WebButton("PayCycle_Search")
	If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The search button is present and clicked","and naviagtedto Payment selection criteria page"
	End If
	End  With 
	
	'Sync application
	Browser("PeopleSoft Browser").Sync
	
	appPayFromDateBeforeIncrement=Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_PayFromDate").GetROProperty("value")
	appPayThroughDateBeforeIncrement=Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_PayThroughDate").GetROProperty("value")
	appPaymentDateBeforeIncrement=Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_PaymentDate").GetROProperty("value")
	appNextThroughDateBeforeIncrement=Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_NextPatThroughDate").GetROProperty("value")
	appNextPaymentBeforeIncrement=Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_NextPaymentDate").GetROProperty("value")
	
	'Set the values in the No of periods
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebList("PayCycle_ChangePeriod")
	If .Exist(nMINWAIT) Then
	.Select dtCHangePeriod
	Reporter.ReportEvent micPass,"THe mode of increment","is set as"&dtCHangePeriod
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_ChangePeriod")
	If .Exist(nMINWAIT) Then
	.Set dtNumber
	Reporter.ReportEvent micPass,"THe no of days/weeks/years","is incremented as"&dtNumber
	End If
	End  With 
	
	'CLick on INcrement button
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCycle_Increment")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With
	
	'After increment dates
	appPayFromDateAfterIncrement=Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_PayFromDate").GetROProperty("value")
	appPayThroughDateAfterIncrement=Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_PayThroughDate").GetROProperty("value")
	appPaymentDateAfterIncrement=Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_PaymentDate").GetROProperty("value")
	appNextThroughDateAfterIncrement=Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_NextPatThroughDate").GetROProperty("value")
	appNextPaymentAfterIncrement=Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_NextPaymentDate").GetROProperty("value")
	
	Select Case dtCHangePeriod
	Case "Day(s)"
	
	If CDATE(appPayFromDateAfterIncrement)=DateAdd("d",dtNumber,appPayFromDateBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Pay from date","is incremented corectly"
	End If
	
	If CDATE(appPayThroughDateAfterIncrement)=DateAdd("d",dtNumber,appPayThroughDateBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Pay Through date","is incremented corectly"
	End If
	
	If CDATE(appPaymentDateAfterIncrement)=DateAdd("d",dtNumber,appPaymentDateBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Payment date","is incremented corectly"
	End If
	
	If CDATE(appNextThroughDateAfterIncrement)=DateAdd("d",dtNumber,appNextThroughDateBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Next throughfrom date","is incremented corectly"
	End If
	
	If CDATE(appNextPaymentAfterIncrement)=DateAdd("d",dtNumber,appNextPaymentBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Next payment date","is incremented corectly"
	End If
	
	
	Case "Week(s)"
	If CDATE(appPayFromDateAfterIncrement)=DateAdd("ww",dtNumber,appPayFromDateBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Pay from date is incremented from"&appPayFromDateBeforeIncrement,"to"&appPayFromDateAfterIncrement
	End If
	
	If CDATE(appPayThroughDateAfterIncrement)=DateAdd("ww",dtNumber,appPayThroughDateBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Pay Through date is incremented from"&appPayThroughDateBeforeIncrement,"to"&appPayThroughDateAfterIncrement
	End If
	
	If CDATE(appPaymentDateAfterIncrement)=DateAdd("ww",dtNumber,appPaymentDateBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Payment date is incremented from"&appPaymentDateBeforeIncrement,"to"&appPaymentDateAfterIncrement
	End If
	
	If CDATE(appNextThroughDateAfterIncrement)=DateAdd("ww",dtNumber,appNextThroughDateBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Next throughfrom date is incremented from"&appNextThroughDateBeforeIncrement,"to"&appNextThroughDateAfterIncrement
	End If
	
	If CDATE(appNextPaymentAfterIncrement)=DateAdd("ww",dtNumber,appNextPaymentBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Next payment date in incremented from"&appNextPaymentBeforeIncrement,"to"&appNextPaymentAfterIncrement
	End If
	
	Case "Month(s)"
	If CDATE(appPayFromDateAfterIncrement)=DateAdd("m",dtNumber,appPayFromDateBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Pay from date is incremented from"&appPayFromDateBeforeIncrement,"to"&appPayFromDateAfterIncrement
	End If
	
	If CDATE(appPayThroughDateAfterIncrement)=DateAdd("m",dtNumber,appPayThroughDateBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Pay Through date","is incremented corectly"
	End If
	
	If CDATE(appPaymentDateAfterIncrement)=DateAdd("m",dtNumber,appPaymentDateBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Payment date","is incremented corectly"
	End If
	
	If CDATE(appNextThroughDateAfterIncrement)=DateAdd("m",dtNumber,appNextThroughDateBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Next throughfrom date","is incremented corectly"
	End If
	
	If CDATE(appNextPaymentAfterIncrement)=DateAdd("m",dtNumber,appNextPaymentBeforeIncrement) Then
	Reporter.ReportEvent micPass,"The Next payment date","is incremented corectly"
	End If
	
	End Select
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_AcctDate")
	If .Exist(nMINWAIT) Then
	.Set appPaymentDateAfterIncrement
	Reporter.ReportEvent micPass,"The accounting date is set with","with"&appPaymentDateAfterIncrement
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_WithholdingDate")
	If .Exist(nMINWAIT) Then
	.Set appPaymentDateAfterIncrement
	Reporter.ReportEvent micPass,"The WIthholding amount","is set with"&appPaymentDateAfterIncrement
	End If
	End  With
	
	'Clickon Source Tab
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebElement("PayCycle_SourceBU")
	If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micDone,"The Source BU","is present and clicked"
	End If
	End  With 
	
	'Enter the Business Units
	While Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_BusinessUnit2").Exist(nMINWAIT)="True"
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCYcle_DecementBusinessUnits")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").WebButton("PayCycle_DeleteBank_Ok")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With
	Wend
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_BusinessUnit")
	If .Exist(nMINWAIT) Then
	.Set dtBusUnit1
	Reporter.ReportEvent micPass,"The Business unit is","set with"&dtBusUnit1
	End If
	End  With
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCYcle_IncrementBusinessUnits")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  WIth 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_BusinessUnit2")
	If .Exist(nMINWAIT) Then
	.Set dtBusUnit2
	Reporter.ReportEvent micPass,"The Business unit2 is","set with"&dtBusUnit2
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCYcle_IncrementBusinessUnits")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  WIth 
	
	
	'CLick on Bank webelement
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebElement("PayCycle_Bank/Method")
	If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Bank Webelemt","is present and clicked"
	End If
	End  With 
	
	'Check for tyh weblist
	While Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebList("PayCycle_BankAcountsList").GetROProperty("disabled")="0"
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("-")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  WIth 
	
	'Wait for the obkjects to load
	app_SearchSync()
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").WebButton("PayCycle_DeleteBank_Ok")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  WIth 
	
	Wend
	
	'Enter the bank details
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_Bank")
	If .Exist(nMINWAIT) Then
	.Set dtBankName1
	End If
	End  With 
	
	WIth Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_Acct")
	If .Exist(nMINWAIT) Then
	.Set dtAcct1
	End If
	End  With 
	
	'ENter the second bank details
	'Click on INcrement button
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("+")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_Bank")
	If .Exist(nMINWAIT) Then
	.Set dtBankName2
	End If
	End  With 
	
	WIth Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_Acct")
	If .Exist(nMINWAIT) Then
	.Set dtAcct2
	End If
	End  With 
	
	'Entert the third abnk details
	'Click on INcrement button
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("+")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_Bank")
	If .Exist(nMINWAIT) Then
	.Set dtBankName3
	End If
	End  With 
	
	WIth Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_Acct")
	If .Exist(nMINWAIT) Then
	.Set dtAcct3
	End If
	End  With
	
	'Enter the Methods of each bank
	While Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebList("PayCYcle_PaymentMethods2").Exist(nMINWAIT)="True"
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("Paycycle_RemovePaymentMethod")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	'Wait for the applicaiton loload
	app_SearchSync()
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").WebButton("PayCycle_DeleteBank_Ok")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	Wend
	
	'Enter th first bank details
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebList("PayCycle_Paymethod")
	If .Exist(nMINWAIT) Then
	.Select dtPaymentMethod1
	End If
	End  With 
	
	'CLick on increment buron
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCYcle_AddPaymentMethod")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	'Add second Bak details
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebList("PayCYcle_PaymentMethods2")
	If .Exist(nMINWAIT) Then
	.Select dtPaymentMethod2
	End If
	End  With
	
	'CLick on increment buron
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCYcle_AddPaymentMethod")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	'Add second Bak details
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebList("PayCYcle_PaymentMethods2")
	If .Exist(nMINWAIT) Then
	.Select dtPaymentMethod3
	End If
	End  With
	
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCycle_Save")
	If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"All the changes are saved","SUcessfully"
	End If
	End  With
	

	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").WebButton("PayCYcle_Ok")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").WebButton("PayCYcle_Ok")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").WebButton("PayCYcle_Ok")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	
	End Function
	'*********************************************************************************************************************************
''' <summary>  
''' PayCycleCreation() To  Pay Cycle Creation
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "PayApproved, AddNewValue, Description,PayFromDate,PayThroughDate,PaymentDate,NextPatThroughDate.,NextPaymentDate,BusUnit,PayGroupCode,SetId,PaymentMethod2,PaymentMethod1,Account,BankName"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'4.1.5
'**********************************************************************************************************************************


Public Function PayCycleCreation()
	'Navigate to below page
	'Accounts Payble > Payments > Pay Cycle Processing > Payment Selection Criteria
	SelectMainMenu1(GlobalDictionary("PayApproved"))
	
	dtAddNewValue=(GlobalDictionary("AddNewValue")) & RandomAlphabetGeneration
	dtDescription=(GlobalDictionary("Description"))
	dtPayFromDate=(GlobalDictionary("PayFromDate"))
	dtPayThroughDate=(GlobalDictionary("PayThroughDate"))
	dtPaymentDate=(GlobalDictionary("PaymentDate"))
	dtNextPatThroughDate=(GlobalDictionary("NextPatThroughDate"))
	dtNextPaymentDate=(GlobalDictionary("NextPaymentDate"))
	dtBusUnit=(GlobalDictionary("BusUnit"))
	dtPayGroupCode=(GlobalDictionary("PayGroupCode"))
	dtSetId=(GlobalDictionary("SetId"))
	dtPaymentMethod2=(GlobalDictionary("PaymentMethod2"))
	dtPaymentMethod1=(GlobalDictionary("PaymentMethod1"))
	dtAccount=(GlobalDictionary("Account"))
	dtBankName=(GlobalDictionary("BankName"))
	
	
	'Clicko n Add New value
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebElement("Add New Value Tab")
	If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"THe Add new value","tab is present and clicked"
	End If
	End  WIth 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_AddNewValue")
	If .Exist(nMINWAIT) Then
	.Set dtAddNewValue
	Reporter.ReportEvent micPass,"The new value","set is"&dtAddNewValue
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCycle_AddNewValue")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_Description")
	If .Exist(nMINWAIT) Then
	.Set dtDescription
	Reporter.ReportEvent micPass,"The Description is present","and set with"&dtDescription
	End If
	End  With 
	
	
	'Enter the dates
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_PayFromDate")
	If .Exist(nMINWAIT) Then
	.Set dtPayFromDate
	Reporter.ReportEvent micPass,"The Pay from date","Text box is present and set with"&dtPayFromDate
	End If
	End  With 
	
	WIth Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_PayThroughDate")
	If .Exist(nMINWAIT) Then
	.Set dtPayThroughDate
	Reporter.ReportEvent micPass,"The Pay Through date","Text box is present and set with"&dtPayThroughDate
	End If
	End  With
	
	WIth Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_PaymentDate")
	If .Exist(nMINWAIT) Then
	.Set dtPaymentDate
	Reporter.ReportEvent micPass,"The Payment date","Text box is present and set with"&dtPaymentDate
	End If
	End  With
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_NextPatThroughDate")
	If .Exist(nMINWAIT) Then
	.Set dtNextPatThroughDate
	Reporter.ReportEvent micPass,"NextPatThroughDate","is present and set with"&dtNextPatThroughDate
	End If
	End  With
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_NextPaymentDate")
	If .Exist(nMINWAIT) Then
	.Set dtNextPaymentDate
	Reporter.ReportEvent micPass,"NextPaymentDate","is present and set with"&dtNextPaymentDate
	End If
	End  With
	
	'CLick on Preference ytab
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebElement("PayCycle_Preference")
	If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The user is sucessfully","naviugated to Preference tab"
	End If
	End  WIth
	
	'Check all the necessary checkboxes present in this page
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebCheckBox("PayCYcle_SuppPayGroup")
	If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
	.Click
	Reporter.ReportEvent micPass,"The Supp pay group checkbox","is checked"
	Else
	Reporter.ReportEvent micPass,"The Supp pay group checkbox","is already checked"
	End If	
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebCheckBox("PayCycle_EFT/ACH_PreNote")
	If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
	.Click
	Reporter.ReportEvent micPass,"The EFT/ACH_PreNote checkbox","is checked"
	Else
	Reporter.ReportEvent micPass,"The EFT/ACH_PreNote checkbox","is already checked"
	End If	
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebCheckBox("PayCycle_EmailPaymentAdvice")
	If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
	.Click
	Reporter.ReportEvent micPass,"The EmailPaymentAdvice checkbox","is checked"
	Else
	Reporter.ReportEvent micPass,"The EmailPaymentAdvice checkbox","is already checked"
	End If	
	End If
	End  With 
	
	'CLicko n SOurce tab
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebElement("PayCycle_SourceBU")
	If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The user is sucessfully","navigated to Source page"
	End If
	End  WIth 
	
	'dtBusUnit
	'Check for the business unit defaluted to 0010
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_BusinessUnit")
	If .Exist(nMINWAIT) Then
	appBusUnit=.GetROProperty("value")
	If appBusUnit=dtBusUnit Then
		Reporter.ReportEvent micPass,"The Business unit is","set by default as"&appBusUnit
	End If
	End If
	End  With 
	
	'Clicko n Bank Tab
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebElement("PayCycle_Bank/Method")
	If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The user is sucessfully","navigated to Bank/Method page"
	End If
	End  WIth
	
	'ENter the aAbnk details and payment method
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_Bank")
	If .Exist(nMINWAIT) Then
	.Set dtBankName
	Reporter.ReportEvent micPass,"The Bank name is present","and set with "&dtBankName
	End If
	End  WIth
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_Acct")
	If .Exist(nMINWAIT) Then
	.Set dtAccount
	Reporter.ReportEvent micPass,"The Account number is present","and set with "&dtAccount
	End If
	End  WIth
	
	'Select hte payment method
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebList("PayCycle_Paymethod")
	If .Exist(nMINWAIT) Then
	.Select dtPaymentMethod1
	Reporter.ReportEvent micPass,"The payment method list","is present and set with"&dtPaymentMethod1
	End If
	End  With
	
	'INcrement the payment method
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCYcle_AddPaymentMethod")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebList("PayCYcle_PaymentMethods2")
	If .Exist(nMINWAIT) Then
	.Select dtPaymentMethod2
	Reporter.ReportEvent micPass,"The payment method list","is present and set with"&dtPaymentMethod2
	End If
	End  With
	
	'CLicko n Pay group
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebElement("PayCycle_PayGroup/Netting")
	If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The user is sucessfully","navigated to Pay group page"
	End If
	End  With
	
	'Enter the Set id and Grup code ID
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_SetId")
	If .Exist(nMINWAIT) Then
	.Set dtSetId
	Reporter.ReportEvent micPass,"The Set Id is present and ","set with"&dtSetId
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_PayGroupCode")
	If .Exist(nMINWAIT) Then
	.Set dtPayGroupCode
	Reporter.ReportEvent micPass,"The Pay group code","is present and set with"&dtPayGroupCode
	End If
	End  With 
	
	'Check tye process button
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebCheckBox("PayCycle_PayGroupProcess")
	If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
		.Click
		Reporter.ReportEvent micPass,"The process button","is clicked"
	End If
	End If
	End  WIth 
	
	'CLick on Save butoon
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCycle_Save")
	If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The save button is present and clicked","and checges are saved sucessfully"
	End If
	End  With
	
	
	End Function
	
	'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


Public Function PayCycleRetest()
'Navigate to Below page	
'Accounts Payable > Payments > Pay Cycle Processing > Payment Selection Criteria
SelectMainMenu1(GlobalDictionary("PayApproved"))
appProcessName=(GlobalDictionary("appProcessName"))
dtSearchCriteria=(GlobalDictionary("SearchBy"))


'Entet the Existing value and clickon Search button
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("TargetContent").WebEdit("PayCycle_SearchCriteria")
If .Exist(nMINWAIT) Then
	.Set dtSearchCriteria
	Reporter.ReportEvent micPass,"The Search criteria","is set with"&dtSearchCriteria
End If
End  With 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("TargetContent").WebButton("PayCycle_Search")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The search button is present and clicked","and naviagtedto Payment selection criteria page"
End If
End  With

'Select the Pay from date
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_PayThroughDate")
If .Exist(nMINWAIT) Then
	appPaymentDate=.GetROProperty("value")
	appPayFromDate=Dateadd("m",-1,appPaymentDate)
End If
End With

With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_PayFromDate")
If .Exist(nMINWAIT) Then
	.Set appPayFromDate
End If
End  With 


'CLick on Paycycle manager
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").Link("PayCycle_PayCycleManager")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Pay cycle manager link","is present and clicked"
End If
End  With

'Select the server and click on Process button for the step name

'Select the server anem
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebList("PayCycle_ServerName")
If .Exist(nMINWAIT) Then
	.Select 1
	appServerName=.GetROProperty("value")
	Reporter.ReportEvent micPass,"The server Name selected","is"&appServerName
End If
End  With 

With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_StepName")
If .Exist(nMINWAIT) Then
	appStep=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The Step Name present and value","is"&appStep
End If
End  With 

With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCycle_Process")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The process button is present","and clicked"
End If
End  With 

With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCYcle_Status")
If .Exist(nMINWAIT) Then
	While Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCYcle_Status").GetROProperty("innertext")<>"Selected"
		Set oRefresh=Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh")
		If oRefresh.Exist(nMINWAIT) Then
			oRefresh.Click
			'wait for the ojects to get loaded
			app_SearchSync()
		End If
		Set oRefresh=Nothing
	Wend
End If


appFinalStatus=.GetROProperty("innertext")
If appFinalStatus="Selected" Then
	Reporter.ReportEvent micPass,"The status is","changed and is"&appFinalStatus
	Else
	Reporter.ReportEvent micFail,"The status is not","changed and is"&appFinalStatus
End If
End With

With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled")
If .Exist(nMINWAIT) Then
	appScheduledPayment=.GetROProperty("innertext")
	Reporter.ReportEvent micDone,"The scheduled payment","selected is"&appScheduledPayment
End If
End  With 

'Clicko on Process Monitopr
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_ProcessMonitor")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With

'Click o refresh button untill the status is sucess and posted
Call CheckProcessMontiorStatus (appProcessName)

With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").WebButton("PayCycle_BackToPayCycleManager")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth

'GO back to Pay cycle manager page

'CLickon reset button
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCycle_Reset")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The reset button is","present and clicked"
End If
End  With 

'Validate the message
With Browser("PeopleSoft Browser").Page("PayCycleManager").WebElement("PayCycle_ResetAlertMessage")
If .Exist(nMINWAIT) Then
	appAlertMessage=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The alert message","displayed is"&appAlertMessage
End If
End  WIth

'CLick on ok button
With Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'Clicko on Process Monitopr
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_ProcessMonitor")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With

'Click o refresh button untill the status is sucess and posted
Call CheckProcessMontiorStatus (appProcessName)

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

Public Function DiscountSuppliers()
'Navigate to below page
'Accounts Payble > Payments > Pay Cycle Processing > Payment Selection Criteria
SelectMainMenu1(GlobalDictionary("PayApproved"))
dtSearchCriteria=(GlobalDictionary("SearchBy"))

'Entet the Existing value and clickon Search button
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("TargetContent").WebEdit("PayCycle_SearchCriteria")
If .Exist(nMINWAIT) Then
	.Set dtSearchCriteria
	Reporter.ReportEvent micPass,"The Search criteria","is set with"&dtSearchCriteria
End If
End  With 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("TargetContent").WebButton("PayCycle_Search")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The search button is present and clicked","and naviagtedto Payment selection criteria page"
End If
End  With

'CLick on INcrement button
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebButton("PayCycle_Increment")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With

appPaymentDateAfterIncrement=Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_PaymentDate").GetROProperty("value")

With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_AcctDate")
If .Exist(nMINWAIT) Then
	.Set appPaymentDateAfterIncrement
	Reporter.ReportEvent micPass,"The accounting date is set with","with"&appPaymentDateAfterIncrement
End If
End  With 

With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_WithholdingDate")
If .Exist(nMINWAIT) Then
	.Set appPaymentDateAfterIncrement
	Reporter.ReportEvent micPass,"The WIthholding amount","is set with"&appPaymentDateAfterIncrement
End If
End  With

'Set the calue in App from date
appPayThroughDateAfterIncrement=Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCYcle_PayThroughDate").GetROProperty("value")
appPayFromDate=DateAdd("m",1,appPayThroughDateAfterIncrement)

With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebEdit("PayCycle_PayFromDate")
If .Exist(nMINWAIT) Then
	.Set appPayFromDate
End If
End  With

'CLickon Pay manager link
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").Link("PayCycle_PayCycleManager")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The pay cycle managerlink","is present and clicked:"
End If
End  With

'Select the server and run th eprocess
'Sarch for the pay ment and creation
With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent").WebTable("PayCycle_DetailsTable")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
		appStepName=.GetCellData(i,3)
		If appStepName="Payment Selection & Creation" Then
		Set oButton=.ChildItem(i,1,"WebButton",0)
		If oButton.exist(nMINWAIT) Then
			oButton.click
			Exit For
		End If
		End If
	Next
End If
End  With

With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCYcle_Status")
If .Exist(nMINWAIT) Then
	While Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCYcle_Status").GetROProperty("innertext")<>"Approved"
		Set oRefresh=Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh")
		If oRefresh.Exist(nMINWAIT) Then
			oRefresh.Click
			'wait for the ojects to get loaded
			app_SearchSync()
		End If
		Set oRefresh=Nothing
	Wend
End If


appFinalStatus=.GetROProperty("innertext")
If appFinalStatus="Approved" Then
	Reporter.ReportEvent micPass,"The status is","changed and is"&appFinalStatus
	Else
	Reporter.ReportEvent micFail,"The status is not","changed and is"&appFinalStatus
End If
End With




End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_ProcesstheInstanseinProcessMonitor() To procees the instances
'''Parameter1:	appProcessInstance.(pocess instance number)
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'AP_ProcesstheInstanse in Process Monitor
Function ap_ProcesstheInstanseinProcessMonitor(appProcessInstance)
Dim flag,nCount:flag=false
With Browser("PeopleSoft Browser").Page("Matching").PSFrame("ProcessMonitor")
	If .WebEdit("InstanceFrom").Exist(nMINWAIT) Then
		.WebEdit("InstanceFrom").Set appProcessInstance
		Call WriteToReport(micPass,"Instance from ","is present and entered as "&appProcessInstance,false)
	else
		Call WriteToReport(micFail,"Instance from","is not present",True)
	End If

	'Click on Refresh button
	If .WebButton("Refresh").Exist(nMINWAIT) Then
		.WebButton("Refresh").Click
	End If

	nCount=0
	'check the status of the Job 
	If .WebTable("ProcessList").Exist(nMINWAIT) Then
		While (StrComp(Trim(.WebTable("ProcessList").GetCellData(2,8)),"Success",1)<>0) and nCount<10
			app_SearchSync()
			nCount=nCount+1
			If .WebButton("Refresh").Exist(nMAXWAIT) Then
				.WebButton("Refresh").Click
			End If
		Wend
		nCount=0
		While (StrComp(Trim(.WebTable("ProcessList").GetCellData(2,9)),"Posted",1)<>0) and nCount<10
			app_SearchSync()
			nCount=nCount+1
			If .WebButton("Refresh").Exist(nMAXWAIT) Then
				.WebButton("Refresh").Click
			End If
		Wend
		flag=True
	End If
End With
ap_ProcesstheInstanseinProcessMonitor=flag
End Function

'*********************************************************************************************************************************
''' <summary>  
''' dropShipFlag() To drop ship, reaceived date,match exception link , Po activity summary  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "businessunit,supplierID"</note> 
''' </para>
''' </summary>
''' <author>gunasekaranS</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to open vouchers</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'AP_06_01_05 Drop Ship Flag
'AP_06_01_06 Received Date
'AP_06_01_07 Match Exceptions Link
'AP_06_01_09 Go to PO Activity Summary link and PO  Receiver link active in Display Only Mode
Function dropShipFlag()
	Dim businessunit,supplierID,VoucherID
	
	businessunit=GlobalDictionary("businessunit")
	supplierID=GlobalDictionary("SupplierID")

	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	'Craete a voucher with Copy PO
	VoucherID=ap_createVoucherWithCopyPO(businessunit,supplierID)
	If StrComp(VoucherID,"NEXT",1)<>0 Then
		'Accounts Payable --> Batch Processes --> Voucher --> Matching
		SelectMainMenu1(GlobalDictionary("VoucherMatchingSelection"))
		Dim strVar
		strVar=ap_matchingVoucher(businessunit,voucherID)
		If StrComp(strVar,"success",1)=0 Then
	'		Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
			SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
			
	'		Open a existing voucher(created voucher)
			Call ap_openExistingVoucher(businessunit,voucherID)	
			
			'wait for the ojects to get loaded
			app_SearchSync()

'*************
'SYSTEM TEST CASE: 6.1.9 Go to PO Activity Summary link and PO  Receiver link active in Display Only Mode
'*************
			with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
				If .WebTabStrip("tabSelection").Exist(nminwait) Then
					.WebTabStrip("tabSelection").Select("Invoice Information")
					Call WriteToReport(micPass,"Invoice Information tab","is present and selected",false)
				else
					Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
				End If
				If .Link("GotoPOActivitySummPage").Exist(nminwait) Then
					.Link("GotoPOActivitySummPage").Click
					Call WriteToReport(micPass,"Go to PO Activity Summ Page link under Purchase Order","is present,Active and clicked",false)
				else
					Call WriteToReport(micFail,"Go to PO Activity Summ Page link","is not present",True)
				End If
			end with
			'wait for the ojects to get loaded
			app_SearchSync()
			
				If Browser("PeopleSoft Browser NewTab").Page("ActivitySummary").PSFrame("POActivitySummary").WebElement("ActivitySummary").Exist(nminwait) Then
					Browser("PeopleSoft Browser NewTab").Close
					Call WriteToReport(micPass,"Activity Summary page opened","Activity Summary page is active and closed",false)
				else
					Call WriteToReport(micFail,"Activity Summary page","is not opened and active",True)
				End If

				'wait for the ojects to get loaded
			app_SearchSync()
'*************
'SYSTEM TEST CASE: 6.1.5 Drop Ship Flag
'*************			
			with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
				If .WebTabStrip("tabSelection").Exist(nminwait) Then
					.WebTabStrip("tabSelection").Select("Invoice Information")
					Call WriteToReport(micPass,"Invoice Information tab","is present and selected",false)
				else
					Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
				End If
				Dim appPONumber
				If .Link("PurchaseOrderViewEditSource").Exist(nminwait) Then
					appPONumber=.Link("PurchaseOrderViewEditSource").GetROProperty("innertext")
					Call WriteToReport(micPass,"View/Edit Source link under Purchase Order","is present and clicked on "&appPONumber,false)
					.Link("PurchaseOrderViewEditSource").Click
				else
					Call WriteToReport(micFail,"View/Edit Source link","is not present",True)
				End If
			end with
			'wait for the ojects to get loaded
			app_SearchSync()

			with Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("ViewSourcePOReceiverInfo")
				If .WebElement("DropShip").Exist(nminwait) Then
					appPONumber=.WebElement("DropShip").GetROProperty("innertext")
					Call WriteToReport(micPass,"Drop ship","Drop ship is present as "&appPONumber,True)
				else
					Call WriteToReport(micFail,"Drop ship ","is not present in View Source PO/Receiver Info tab",True)
				End If
				If .WebButton("OK").Exist(nminwait) Then
					.WebButton("OK").Click
				End If
			end with
			'wait for the ojects to get loaded
			app_SearchSync()
			
'*************
'SYSTEM TEST CASE: 6.1.6 Received Date
'*************			 
			with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
				If .WebTabStrip("tabSelection").Exist(nminwait) Then
					.WebTabStrip("tabSelection").Select("Invoice Information")
					Call WriteToReport(micPass,"Invoice Information tab","is present and selected",false)
				else
					Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
				End If
				If .Link("PurchaseOrderAssociateReceiver").Exist(nminwait) Then
					.Link("PurchaseOrderAssociateReceiver").Click
					Call WriteToReport(micPass,"Associate Receiver link under Purchase Order","is present and clicked ",false)
				else
					Call WriteToReport(micFail,"Associate Receiver link","is not present",True)
				End If
			end with
			'wait for the ojects to get loaded
			app_SearchSync()
			
			with Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("AssociateReceiver")
				If .WebElement("ReveivedDate").Exist(nminwait) Then
					appPONumber=.WebElement("ReveivedDate").GetROProperty("innertext")
					Call WriteToReport(micPass,"Reveived Date","Reveived Date is present as "&appPONumber,True)
				else
					Call WriteToReport(micFail,"Reveived Date ","is not present in Associate Receiver tab",True)
				End If
				If .WebButton("OK").Exist(nminwait) Then
					.WebButton("OK").Click
				End If
			end with
			'wait for the ojects to get loaded
			app_SearchSync()
			
'*************
'SYSTEM TEST CASE: 6.1.7 Match Exceptions Link
'*************			 
			with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
				If .WebTabStrip("tabSelection").Exist(nminwait) Then
					.WebTabStrip("tabSelection").Select("Error Summary")
					Call WriteToReport(micPass,"Error Summary tab","is present and selected",false)
				else
					Call WriteToReport(micFail,"Error Summary tab","is not present",True)
				End If
				If .Link("GotoActions").Exist(nminwait) Then
					.Link("GotoActions").Click
					Call WriteToReport(micPass,"Goto Actions link under InVoice Line Errors","is present and clicked ",false)
				else
					Call WriteToReport(micFail,"Goto Actions link","is not present",True)
					If .WebElement("VoucherhasNoError").Exist(nminwait) Then
						Call WriteToReport(micFail,"Voucher should have errors","Expected errors are not displayed, Actual is "&.WebElement("VoucherhasNoError").GetROProperty("innertext"),True)
					End If
				End If
			end with
			with Browser("PeopleSoft Browser").Page("Regular Entry")
				If .WebElement("MessageforDifference").Exist(nminwait) Then
					Call WriteToReport(micPass,"Expected pop up message exist","Expected message is displayed,as "&.WebElement("MessageforDifference").GetROProperty("innertext"),True)
				else
					Call WriteToReport(micFail,"Action message pop up doesn't displayed","Action message pop up doesn't displayed",false)
				End If
				If .WebButton("OK").Exist(nminwait) Then
					.WebButton("OK").Click
				End If
			end with 
			
		End If
	End If
	
End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_SearchPOInquery() To search the PO mnumber 
'''Parameter1:	businessunit,SupplierID,POStatus
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Guasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to open vouchers</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_Search the Purchase order with po status
Function ap_SearchPOInquery(businessunit,SupplierID,POStatus)
Dim appPOID
With Browser("PeopleSoft Browser").Page("PurchaseOrderInquery").PSFrame("PurchaseOrderInquery")
	If .WebEdit("Businessunit").Exist(nminwait) Then
		.WebEdit("Businessunit").Set businessunit
		Call WriteToReport(micPass,"Businessunit : "&businessunit,"Businessunit is present and enterred as "&businessunit,false)
	else
		Call WriteToReport(micFail,"Businessunit","doesn't present in the application",True)
	End If
	If .WebList("POStatus").Exist(niminwait) Then
		.WebList("POStatus").Select POStatus
		Call WriteToReport(micPass,"POStatus : "&POStatus,"POStatus is present and enterred as "&POStatus,false)
	else
		Call WriteToReport(micFail,"POStatus","doesn't present in the application",True)
	End If
	If .WebEdit("SuplierID").Exist(nminwait) Then
		.WebEdit("SuplierID").Set SupplierID
		Call WriteToReport(micPass,"SupplierID : "&SupplierID,"SupplierID is present and enterred as "&SupplierID,false)
	else
		Call WriteToReport(micFail,"SupplierID","doesn't present in the application",True)
	End If
	If .WebButton("Search").Exist(nminwait) Then
		.WebButton("Search").Click
		Call WriteToReport(micPass,"Search button clicked","Search button is present and clicked",false)
	else
		Call WriteToReport(micFail,"Search button","doesn't present in the application",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
		
	If .WebTable("SearchResults").Exist(nminwait) Then
		If .WebTable("SearchResults").RowCount>1 Then
			appPOID=.WebTable("SearchResults").GetCellData(2,2)
			Call WriteToReport(micpass,"Cancell status PO number seletced","Selecetd PO number is "&appPOID,false)
		else
			Call WriteToReport(micFail,"PO number not available ",businessunit&"-"&supplierID &"-"&POStatus&" is not present",True)
		End If
	End If
End With
	ap_SearchPOInquery=appPOID
End Function

'*********************************************************************************************************************************
''' <summary>  
''' matchStatusfieldgrayedoutonVoucherAttributesTab() To verify Match Action status and cancelled po
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "Businessunit,supplierID,VoucherID,PONumber,CopyFrom"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to open vouchers</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'AP_06_01_08 Match Status field grayed out on Voucher Attributes Tab
Function matchStatusfieldgrayedoutonVoucherAttributesTab()
	Dim businessunit,supplierID,VoucherID,PONumber,CopyFrom
	
	businessunit=GlobalDictionary("businessunit")
	supplierID=GlobalDictionary("SupplierID")
	POStatus=GlobalDictionary("POStatus")
	CopyFrom=GlobalDictionary("CopyFrom")
	
	
	'Navigate to Purchasing->Purchase Orders->Review PO Information->Purchase Orders
	SelectMainMenu1(GlobalDictionary("PurchaseOrderInquery"))
	
	PONumber=ap_SearchPOInquery(businessunit,supplierID,POStatus)
	
''	Open a existing voucher(created voucher)
'	Call ap_openExistingVoucher(businessunit,voucherID)	
	
	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	VoucherID=ap_createaVoucherWithMiscSalestaxFrieghtpaytermandwithoutCopyPO(businessunit,supplierID)
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	
		If .WebTabStrip("tabSelection").Exist(10) Then
			.WebTabStrip("tabSelection").Select("Voucher Attributes")
			Call WriteToReport(micPass,"Voucher Attributes tab","is present and clicked",false)
		else
			Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
		End If
		If .WebElement("MatchActionStatus").Exist(nminwait) Then
			appMatchActionStatus=.WebElement("MatchActionStatus").GetROProperty("innertext")
			Call WriteToReport(micPass,"Match Action Status","Match Action Status is displayed as "&appMatchActionStatus,false)
		else
			Call WriteToReport(micFail,"Match Action Status","Match Action Status doesn't displayed",TRue)
		End If
		If .WebTabStrip("tabSelection").Exist(nminwait) Then
			.WebTabStrip("tabSelection").Select("Invoice Information")
			Call WriteToReport(micPass,"Invoice Information tab","is present and selected",false)
		else
			Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
		End If
		
	End with 
	
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")		
		If .WebList("CopyFrom").Exist(nMINWAIT) Then
			.WebList("CopyFrom").Select CopyFrom
			Call WriteToReport(micPass,"CopyFrom","is present and selected "&CopyFrom,false)
			else
			Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
		End If
		
		If .Link("Go").Exist(nMINWAIT) Then
'			wait(3)
			.Link("Go").Click
			Call WriteToReport(micPass,"go link ","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Go link","is not present",True)
		End If
		
		If .WebEdit("POBusinessUnit").Exist(nMINWAIT) Then
			.WebEdit("POBusinessUnit").Set businessunit
			Call WriteToReport(micPass,"POBusinessUnit ","is present and entered as"&businessunit,false)
			else
			Call WriteToReport(micFail,"POBusinessUnit","is not present",True)
		End If
		If .WebEdit("PONumberFrom").Exist(nMINWAIT) Then
			.WebEdit("PONumberFrom").Set PONumber
			Call WriteToReport(micPass,"PONumberFrom ","is present and entered as"&PONumber,false)
			else
			Call WriteToReport(micFail,"PONumberFrom","is not present",True)
		End If
	end with
	with Browser("PeopleSoft Browser").Page("Regular Entry")
		If .WebElement("MessageforDifference").Exist(nminwait) Then
			Call WriteToReport(micPass,"Message for PO Number ","Message popup displayed as "&.WebElement("MessageforDifference").GetROProperty("innertext"), false)
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	end with
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
		If .WebButton("PONumberLookup").Exist(nMINWAIT) Then
			.WebButton("PONumberLookup").Click
			Call WriteToReport(micPass,"PO Number Lookup ","is present and clicked",false)
			else
			Call WriteToReport(micFail,"PO Number Lookup ","is not present",True)
		End If
	End with
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm")
		If .WebElement("NoMatchingValueFound").Exist(nminwait) Then
			appMatchActionStatus=.WebElement("NoMatchingValueFound").GetROProperty("innertext")
			Call WriteToReport(micPass,"Canceled PO shouldn't displayed","Canceled PO are not listed and Expected massage is displayed as "&appMatchActionStatus,false)
		else
			Call WriteToReport(micFail,"Canceled PO shouldn't displayed","Canceled PO is displayed",TRue)
		End If
		If .WebButton("Cancel").exist(nminwait) Then
			.WebButton("Cancel").Click
			Call WriteToReport(micPass,"Cancel button ","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Cancel button","is not present",True)
		End If
	end with 
End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_createaVoucherWithMiscSalestaxFrieghtpaytermandwithoutCopyPO() To create a  Voucher without copy po
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "voucherID,invoiceNo,Dept,Account,Quantity,freight,Payterm,invoiceDate,salesTax,Classification,lineAmount"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to create vouchers</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_Create a Voucher with Misc, Salestax,Frieght,payterm and without Copy PO
Function ap_createaVoucherWithMiscSalestaxFrieghtpaytermandwithoutCopyPO(businessunit,supplierID)
	Dim voucherID,invoiceNo,Dept,Account,Quantity,freight,Total,invoiceDate,appinvoiceNo,salesTax,Classification,lineAmount,i
	Dim PayTerm
	
	
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo")&inVoiceNumberGeneration
	invoiceDate=date-3'GlobalDictionary("invoiceDate")
	PayTerm=GlobalDictionary("PayTerm")
	Total=GlobalDictionary("Total")
	freight=GlobalDictionary("Fright")
	salesTax=GlobalDictionary("Salestax")
	Quantity=GlobalDictionary("Quantity")
	Misc=GlobalDictionary("Misc")
	lineAmount=GlobalDictionary("lineAmount")
	Account=GlobalDictionary("Account")
	Dept=GlobalDictionary("Dept")
	Classification=GlobalDictionary("Classification")
	
	'wait for the ojects to get loaded
	app_SearchSync()
'	wait 3
	
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
		.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
		If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
			.WebEdit("BusinessUnit").Set businessunit
			Call WriteToReport(micPass,"Business unit :"&businessunit,"is present and entered as"&businessunit,false)
			else
			Call WriteToReport(micFail,"Business unit","is not present",True)
		End If
		
		If .WebEdit("VoucherId").Exist(nMINWAIT) Then
			.WebEdit("VoucherId").Set voucherID
			Call WriteToReport(micPass,"Voucher Id :"&voucherID,"is present and entered as "&voucherID,false)
			else
			Call WriteToReport(micFail,"Voucher Id","is not present",True)
		End If
		
		If .WebButton("Add").Exist(nMINWAIT) Then
			wait(5)
			.WebButton("Add").Click
			Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
			else
			Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
		'enter invoice id and invoice date and save
		If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
			.WebEdit("invoiceNo").Set invoiceNo
			Call WriteToReport(micPass,"invoiceNo :"&invoiceNo," invoiceNo is present as "&invoiceNo,false)
			else
			Call WriteToReport(micFail,"invoiceNo","is not present",True)
		End If
		
		If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
			.WebEdit("invoiceDate").Set invoiceDate
			Call WriteToReport(micPass,"invoice Date "&invoiceDate,"is present and entered as "&invoiceDate,false)
			else
			Call WriteToReport(micFail,"invoice Date","is not present",True)
		End If
		
		If NOT IsEmpty(Payterm) AND (Payterm<>"") Then
			If (len(Payterm)=3) Then
				If .WebEdit("PayTerms").Exist(nMINWAIT) Then
					.WebEdit("PayTerms").Set PayTerm
					Call WriteToReport(micPass,"PayTerm ","is present and entered as"&PayTerm,false)
					else
					Call WriteToReport(micFail,"PayTerm","is not present",True)
				End If
			End If
		End If
		
End with	
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Exist(nMINWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Click
	End If

	If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Exist(nMINWAIT) Then
'		If InStr(supplierID,"...")<>0 Then
		Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Set Replace(supplierID,"...","")
		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Click
		End If

		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").Exist(nMINWAIT) Then
			If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").RowCount))>1 Then
				Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").ChildItem(2,1,"Link",0).click
			End If
		End If
'		else
'			Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID").Set Trim(supplierID)
'		End If
		Call WriteToReport(micPass,"Supplier ID","is present and value entered"&supplierID,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
	If .WebEdit("Account").Exist(nMINWAIT) Then
		.WebEdit("Account").Click
		wait(3)
		.WebEdit("Account").Set Account
		Call WriteToReport(micPass,"Account :"&Account,"is present and entered as"&Account,false)
		else
		Call WriteToReport(micFail,"Account","is not present",True)
	End If
	If .WebEdit("Dept").Exist(nMINWAIT) Then
		.WebEdit("Dept").Set Dept
		Call WriteToReport(micPass,"Dept :"&Dept,"is present and entered as "&Dept,false)
		else
		Call WriteToReport(micFail,"Dept","is not present",True)
	End If
	
	If .WebEdit("Classification").Exist(nMINWAIT) Then
		.WebEdit("Classification").Set Classification
		Call WriteToReport(micPass,"Classification :"&Classification,"is present and entered as "&Classification,false)
		else
		Call WriteToReport(micFail,"Classification","is not present",True)
	End If

	If NOT IsEmpty(freight) AND freight<>"" Then
		If  freight>0  Then
		If .WebEdit("freight").Exist(nMINWAIT) Then
			.WebEdit("freight").Set freight
			Call WriteToReport(micPass,"Fright ","is present and entered as"&Fright,false)
			else
			Call WriteToReport(micFail,"Fright","is not present",True)
		End If
		End If
	End If
	
	wait 3 
	If NOT IsEmpty(Salestax) AND Salestax<>"" Then
		If Salestax>0 Then
		If .WebEdit("salesTax").Exist(nMINWAIT) Then
			.WebEdit("salesTax").Set Salestax
			Call WriteToReport(micPass,"Salestax ","is present and entered as"&Salestax,false)
			else
			Call WriteToReport(micFail,"Salestax","is not present",True)
		End If
		End If
	End If
	wait 3 
	If NOT IsEmpty(Misc) AND Misc<>""  Then
		If Misc>0 Then
		If .WebEdit("MiscellaousAmount").Exist(nMINWAIT) Then
			.WebEdit("MiscellaousAmount").Set Misc
			Call WriteToReport(micPass,"MiscellaousAmount ","is present and entered as"&Misc,false)
			else
			Call WriteToReport(micFail,"MiscellaousAmount","is not present",True)
		End If
		End If
	End If
	
	If NOT IsEmpty(Quantity) AND Quantity<>"" Then
		If Quantity>0 Then
		If .WebEdit("Quantity").Exist(nMINWAIT) Then
			.WebEdit("Quantity").Set(Quantity)
			Call WriteToReport(micPass,"Quantity :"&Quantity ,"Unit price value enter as "&Quantity ,false)
			else
			Call WriteToReport(micFail,"Unitprice","is not present",True)
		End If
		End If
	End If
	app_SearchSync()
	If .WebEdit("lineAmount").Exist(nMINWAIT) Then
		.WebEdit("lineAmount").Set lineAmount
		Call WriteToReport(micPass,"lineAmount :"&lineAmount,"is present and entered as "&lineAmount,false)
		else
		Call WriteToReport(micFail,"lineAmount","is not present",True)
	End If
	If .WebButton("CalculateInvoiceLine").Exist(nMINWAIT) Then
		.WebButton("CalculateInvoiceLine").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If .WebElement("Difference").Exist(nMINWAIT) Then
		appDifference=.WebElement("Difference").GetROProperty("innertext")
		Call WriteToReport(micPass,"Deifference is captured","Captured from application as"&appDifference,false)
	End If
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		.WebEdit("Total").Click
		appDifference=cdbl(appDifference)+Cdbl(.WebEdit("Total").GetROProperty("value"))
		.WebEdit("Total").Set appDifference
		Call WriteToReport(micPass,"Total : "&appDifference,"is present and entered as "&appDifference,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked to get difeerence",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .WebElement("Difference").Exist(nMINWAIT) Then
		appDifference=.WebElement("Difference").GetROProperty("innertext")
		Call WriteToReport(micPass,"Deifference should be 0","Captured from application as"&appDifference,false)
	End If
	
	
	app_SearchSync()	
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
		If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
		End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	
	'wait for the ojects to get loaded
	app_SearchSync()
	'wait for the ojects to get loaded
	app_SearchSync()
'Voucher id generation validation	
	If .WebElement("voucherID").Exist(nMINWAIT) Then
		voucherID=.WebElement("voucherID").GetROProperty("innertext")
		If StrComp(voucherID,"NEXT",1)<>0 Then
			Call WriteToReport(micPass,"voucherID : "&voucherID,"is present and generated as "&voucherID,false)
			else
			Call WriteToReport(micFail,"voucherID","doesn't get generated",True)
		End If
	End If
	
ap_createaVoucherWithMiscSalestaxFrieghtpaytermandwithoutCopyPO=voucherID	
End with


End Function

'*********************************************************************************************************************************
''' <summary>  
''' accountDeferredProcessingoffforVoucherDistributionLine() To verify distribution line account and dept combination
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "businessunit,supplierID,VoucherID"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'AP_06_01_12 Account Deferred Processing off for Voucher Distribution Line
Function accountDeferredProcessingoffforVoucherDistributionLine()
	Dim businessunit,supplierID,VoucherID
	
	businessunit=GlobalDictionary("businessunit")
	supplierID=GlobalDictionary("SupplierID")
	
	
	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	VoucherID=ap_createaVoucherWithMiscSalestaxFrieghtpaytermandwithoutCopyPO(businessunit,supplierID)
	
	
End Function
'*********************************************************************************************************************************
''' <summary>  
''' PayCycleRestart() To Pay Cycle Restart
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "CheckRestart"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'4.1.7
'**********************************************************************************************************************************

Public Function PayCycleRestart()
'Navigate to below page
'Navigate to Below page	
'Accounts Payble > Payments > Pay Cycle Processing > Check Restart
SelectMainMenu1(GlobalDictionary("CheckRestart"))

'CLickon Pay Cycle look up window

End Function



'**********************************************************************************************************************************************************
''' <summary>  
''' POCopyscreen() To check whether "Freight Terms Code" column in Select PO table is displayed or not					
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "businessunit, PONumberFrom"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/24/2018</datecreated>
''' <startstate>Logged in as user that has right to pay vouchers</startstate>
''' <endstate>Freight Terms Code column is displayed in Select PO table</endstate>
'Change Control: 
'NA
'**********************************************************************************************************************************************************
'6.1.11

Public Function POCopyscreen()

strSQL="select top 2 P.PO_ID, P.PO_DT, P.PO_STATUS, P.VENDOR_ID, PYMNT_TERMS_CD,L.LINE_NBR, L.ITM_SETID, L.INV_ITEM_ID,S.SCHED_NBR, S.SHIPTO_ID, S.PRICE_PO, S.QTY_PO,RS.QTY_SH_ACCPT from PS_PO_HDR P, PS_PO_LINE L, PS_PO_LINE_SHIP S, PS_RECV_LN_SHIP RS where P.BUSINESS_UNIT = L.BUSINESS_UNIT and P.PO_ID = L.PO_ID and L.BUSINESS_UNIT = S.BUSINESS_UNIT and L.PO_ID = S.PO_ID and L.LINE_NBR = S.LINE_NBR and (P.PO_DT >= getdate()-60) and P.PO_STATUS = 'D' and S.CANCEL_STATUS <> 'X' and P.BUSINESS_UNIT = '00010' and (RS.BUSINESS_UNIT = P.BUSINESS_UNIT and RS.PO_ID = P.PO_ID) and S.QTY_PO > RS.QTY_SH_ACCPT order by  P.PO_ID desc"
sConnectionString="Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
sheetName=GlobalDictionary("sheetName")

Call dbGetSpecifiRecords(strSQL,sConnectionString,sheetName)

'wait for the ojects to get loaded
app_SearchSync()

'Printing the Queries
Reporter.ReportEvent micPass,"The Query Name","used for this script to get the Vendor ID is="&strSQL
Reporter.ReportEvent micPass,"The Provider Name","used for this script is="&sConnectionString


DataTable.GetSheet(sheetName).SetCurrentRow(1)

On error resume next
VENDOR_ID=Trim(DataTable.Value("VENDOR_ID",sheetName))
If err.number<>0 Then
	VENDOR_ID=Trim(DataTable.Value("VENDOR_ID",sheetName))
	err.clear
End If

voucherID=GlobalDictionary("voucherID")
invoiceNo=GlobalDictionary("invoiceNo")&inVoiceNumberGeneration
invoiceDate=date-3'GlobalDictionary("invoiceDate")
PayTerm=GlobalDictionary("PayTerm")


'Navigate to:  Accounts Payble > Vouchers > Add/Update > Regular Entry
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
dtbusinessunit=GlobalDictionary("businessunit")
dtPONumberFrom=GlobalDictionary("PONumberFrom")


'To Click on Add a new value tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucher_tabAddNewValue")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Add New value tab" ,"is selected",false)
	End If
End With

'Set the BU value
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("BusinessUnit")
	If .Exist(nMINWAIT) Then
		.Set dtbusinessunit
		Call WriteToReport(micPass,"BU is set=" &dtbusinessunit,"is displayed",false) 
	End If
End With


'To Click on Add button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Add")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Add button","is clicked",false) 
	End If
End With

		'wait for the ojects to get loaded
		app_SearchSync()
		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
		'enter invoice id and invoice date and save
		If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
			.WebEdit("invoiceNo").Set invoiceNo
			Call WriteToReport(micPass,"invoiceNo :"&invoiceNo," invoiceNo is present as "&invoiceNo,false)
			else
			Call WriteToReport(micFail,"invoiceNo","is not present",True)
		End If
		
		If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
			.WebEdit("invoiceDate").Set invoiceDate
			Call WriteToReport(micPass,"invoice Date "&invoiceDate,"is present and entered as "&invoiceDate,false)
			else
			Call WriteToReport(micFail,"invoice Date","is not present",True)
		End If
		
				If .WebEdit("PayTerms").Exist(nMINWAIT) Then
					.WebEdit("PayTerms").Set PayTerm
					Call WriteToReport(micPass,"PayTerm ","is present and entered as"&PayTerm,false)
					else
					Call WriteToReport(micFail,"PayTerm","is not present",True)
				End If
		
End with	
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Exist(nMINWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Click
	End If

	If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Exist(nMINWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Set Replace(supplierID,"...","")
		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Click
		End If

		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").Exist(nMINWAIT) Then
			If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").RowCount))>1 Then
				Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Set VENDOR_ID
				Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Click
				Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").ChildItem(2,1,"Link",0).click
			End If
		End If
		Call WriteToReport(micPass,"Supplier ID","is present and value entered="& VENDOR_ID,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'wait for the ojects to get loaded
	app_SearchSync()
	

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("POUnit")
If .Exist(nMINWAIT) Then
	.Set dtbusinessunit
	Call WriteToReport(micPass,"Businessunit","is present and value entered="&dtbusinessunit,false)
End If
End With
'Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PONUmber").Set 


'To Select Copy From drop-down
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebList("CopyFrom")
	If .Exist(nMINWAIT) Then
		.Select "Purchase Order Only"
	End If
End With

'To Click on Go button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").Link("Go")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End With

'To click PONumber Lookup
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
		If .WebButton("PONumberLookup").Exist(nMINWAIT) Then
			.WebButton("PONumberLookup").Click
			Call WriteToReport(micPass,"PO Number Lookup ","is present and clicked",false)
			else
			Call WriteToReport(micFail,"PO Number Lookup ","is not present",True)
		End If
End with

For i = 1 To 10 Step 1
If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").Exist(nMINWAIT) Then
Exit for
else
app_SearchSync()	
End If
Next

If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").Exist(nMINWAIT) Then
			If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").RowCount))>1 Then
				PoNum=Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").ChildItem(2,1,"Link",0).GetROProperty("innertext")
				Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").ChildItem(2,1,"Link",0).click
				Call WriteToReport(micPass,"PO Number Lookup ","is present and clicked=" &PoNum,false)
			else
			Call WriteToReport(micFail,"PO Number Lookup table ","does not contains any values",True)
			End If
		else
		Call WriteToReport(micFail,"PO Number Lookup table ","is not present",True)
End If

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("copyWsheet_txtPODate")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End With

'To click on Search button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("copyWsht_btnSearch")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End With

'To Display "Freight Terms Code" column in Select PO table
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebTable("tblMainInformation")
	If .Exist(nMINWAIT) Then
			val=.WebElement("headerFreightTermsCode").GetROProperty("outertext")
			Call WriteToReport(micPass,"Select PO lines grid table has=" &val," column and is displayed",false) 
		else
			Call WriteToReport(micFAIL,"Freight Terms Code" ,"is not displayed",true)
		End If
	
End With

Browser("PeopleSoft Browser").Page("Regular Entry").WebElement("My T&E Homepage").Click

'To click on Alert Message
With Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("No")
	If .Exist(nMINWAIT) Then
		.Click
	End If
End With


End Function


'**********************************************************************************************************************************************************
''' <summary>  
''' SummaryMetric() Will process payment of a Voucher					
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "PayCycle, SignInUser"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/20/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Pay Cycle Summary Metric Details Displayed</endstate>
'Change Control: 
'NA
'**********************************************************************************************************************************************************
'4.1.25


Public Function SummaryMetric()

'Navigate to:  Accounts Payable/ Review Accounts Payable Info/Payments
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
dtPayCycle=GlobalDictionary("PayCycle")
dtSignInUser=GlobalDictionary("SignInUser")

'To navigate to Summary metric
With Browser("PeopleSoft Browser").Page("Homepage").PSFrame("NavBar").Link("Summary Metric")
	If .Exist(nMINWAIT) Then
		.Click
	else
		Call WriteToReport(micPass,"Summary Metric menu" ,"is not present for the user id="&dtSignInUser, false)
	End If
End With

'To select the PayCycle value -XPC001
With Browser("PeopleSoft Browser").Page("Summary Metric").PSFrame("Pay Cycle Summary Metric").WebList("summaryMetric_listboxPAYCYCLE")
	If .Exist(nMINWAIT) Then
		.Select dtPayCycle
			Call WriteToReport(micPass,"Pay Cycle code =" &dtPayCycle," is selected",false) 
	else
			Call WriteToReport(micPass,"Pay Cycle code" ,"is not present",false)
	End If
End With

'To click on draw chart button
With Browser("PeopleSoft Browser").Page("Summary Metric").PSFrame("Pay Cycle Summary Metric").WebButton("summaryMetric_btnDrawChart")
	If .Exist(nMINWAIT) Then
		If .GetROProperty("disabled")=0 Then
			.Click
		else
			Call WriteToReport(micPass,"User="&dtSignInUser ,"doesnot have permission to view the summary metrics chart",false)
			Exit Function
		End If
	else
		Call WriteToReport(micFAIL,"Draw chart button","is not visible",true)
		Exit Function
	End If
End With

'To check the chart exist or not
With Browser("PeopleSoft Browser").Page("Summary Metric").PSFrame("Pay Cycle Summary Metric").WebElement("ChartSummaryMetrics")
	If .Exist(nMINWAIT) Then
			Call WriteToReport(micPass,"Pay cycle chart Summary Metrics"," is displayed",false) 
		else
			Call WriteToReport(micFAIL,"Pay cycle chart Summary Metrics" ,"is not displayed",true)
		End If
End With

End Function


'**********************************************************************************************************************************************************
''' <summary>  
''' postingvoucher() Account Date must be the same as the current date when posting voucher					
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "RunControlID, RequestID,Description,ProcessFrequency,PostVoucherOption,PrepaymentApplicationMethod"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/26/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>To display the status two jobs after Refresh</endstate>
'Change Control: 
'NA
'**********************************************************************************************************************************************************
'6.1.13

Public Function postingvoucher()

	dtControlID=(GlobalDictionary("RunControlID"))&inVoiceNumberGeneration
	dtRequestID=(GlobalDictionary("RequestID"))
	dtDescription=(GlobalDictionary("Description"))
	dtPostVoucherOption=(GlobalDictionary("PostVoucherOption"))
	dtPrepaymentApplicationMethod=(GlobalDictionary("PrepaymentApplicationMethod"))
	dtProcessFrequency=(GlobalDictionary("ProcessFrequency"))
	dtBusinessUnit=(GlobalDictionary("BusinessUnit"))
	dtVoucherID=(GlobalDictionary("VoucherID"))
	SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
	supplierID=(GlobalDictionary("supplierID"))
	'VoucherId=(GlobalDictionary("VoucherID"))
	VoucherId=ap_createVoucherWithCopyPO(dtBusinessUnit,supplierID)
	
	'To get the value of Post status before batch process
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("PostStatus")
	If .Exist(nMINWAIT) Then
		poststatus=.GetROProperty("innertext")
		Call WriteToReport(micPass,"The post status ","of the voucher before batch process is="&poststatus, false)	
	End If
	End  With 
	
	'Navigate to Following page
	'Accounts Payable / Batch Processes / Vouchers / Voucher Posting
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	
	'CLick on Add NEw value Tab
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebElement("AddNewValue")
	If .Exist(nMINWAIT) Then
		.Click

		'Enter the control ID
		With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("PRCSRUNCNTL_RUN_CNTL_ID")
		If .Exist(nMINWAIT) Then
			.Set dtControlID
			Call WriteToReport(micPass,"Control ID","Control ID is="&dtControlID,false)
		End If
		End WIth 
		
		'CLick on Add Button
		With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebButton("Add")
		If .Exist(nMINWAIT) Then
			.Click:Call WriteToReport(micPass,"Add button","is present and clicked",false)
		End If
		End With 

	End If
	End With 

	'Wait for the applicatoin load
	Browser("PeopleSoft Browser").Sync
	
	'Check if the adding nwe contorl page ois displayed
	If Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("RequestID").WaitProperty("visible",True,2000) Then
		
	'Enter the Run control IDF values in the Page
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("RequestID")
	If .Exist(nMINWAIT) Then
		.Set dtRequestID
		Call WriteToReport(micPass,"Request ID","Request ID is="&dtRequestID,false)
	End If
	End WIth 
	
	'Enter the description
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("Description")
	If .Exist(nMINWAIT) Then
		.Set dtDescription
		Call WriteToReport(micPass,"Description ID","Description ID is="&dtDescription,false)
	End If
	End WIth 
	
	'Select the voucher Posting option
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebList("PostVoucherOption")
	If .Exist(nMINWAIT) Then
		.Select dtPostVoucherOption
	End If
	End WIth 
	
	'Select the Prepamenty application
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebList("PrepaymentApplicationMethod")
	If .Exist(nMINWAIT) Then
		.Select dtPrepaymentApplicationMethod
	End If
	End With
	
	'Select the process frequency
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebList("ProcessFrequency")
	If .Exist(nMINWAIT) Then
		.Select dtProcessFrequency
	End If
	End With
	
	'ENter the Business UNit
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("BusinessUnit")
	If .Exist(nMINWAIT) Then
		.Set dtBusinessUnit
		Call WriteToReport(micPass,"BusinessUnit","BusinessUnit is="&dtBusinessUnit,false)
	End If
	End WIth 
	

	'Enter the Voucher ID
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebEdit("VoucherID")
	If .Exist(nMINWAIT) Then
		.Set VoucherId
		Call WriteToReport(micPass,"VoucherID","VoucherID is="&VoucherId,false)
	End If
	End WIth 
	
	'Click on Run button
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("TargetContent").WebButton("Run")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End WIth 
	
	app_SearchSync()
	app_SearchSync()
	
	'Selcet the post voucher and clickon Ok button
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("ProcessSchdeluerRequest").WebTable("ProcessList")
	If .Exist(nMINWAIT) Then
		For i=2 to .RowCount
			appDescription=.GetCellData(i,2)
			If appDescription="Post vouchers" Then
				appProcessName=.GetCellData(i,3)
				Set oVoucherLink=.ChildItem(i,1,"WebCheckBox",0)
				If oVoucherLink.exist(nMINWAIT) Then
					oVoucherLink.click
					Exit For
				End If
			End If
		Next
	End If
	End With 
End  If
	
	'Click on Ok button
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("ProcessSchdeluerRequest").WebButton("Ok")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End WIth 
	
	app_SearchSync()
	
	'Click on Process moonitor
	With Browser("PeopleSoft Browser").Page("Voucher Posting").PSFrame("VoucherPostingRequest").Link("Process Monitor")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End With 
	
	app_SearchSync()
	Call CheckProcessMontiorStatus (sProcessName)
	
With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Monitor").WebElement("RunDate")
If .Exist(nMINWAIT) Then
	runDate=.GetROProperty("innertext")
	rundat=split(runDate," ")
	postedDate=rundat(0)
	Call WriteToReport(micPass,"Voucher posted date is="&postedDate,"is displayed",false) 
End If
End With

Browser("PeopleSoft Browser").Sync

'Navigate toe Next page to check the status of the voucher and date
'Accounts Payable > Voucher > Add/Update > Regular entry
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
'To click on Find an Existing value tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucher_tabFindExistingValue")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'To enter BU
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("voucherFE_txtBUSINESS_UNIT")
If .Exist(nMINWAIT) Then
	.Set dtBusinessUnit
	Call WriteToReport(micPass,"BusinessUnit is="&dtBusinessUnit,"is displayed",false)
End If
End With 

'To enter voucher ID which we get from testcase 2.2.26
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("voucherFE_txtVOUCHER_ID")
If .Exist(nMINWAIT) Then
	.Set VoucherId
	Call WriteToReport(micPass,"VoucherId is="&VoucherId,"is displayed",false)
End If
End With

'To click on search
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("voucher_btnSearch")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'To click on Summary tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("Summary")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'To get the value of Post status
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("PostStatus")
If .Exist(nMINWAIT) Then
	poststatus=.GetROProperty("innertext")
	If poststatus="Posted" Then
	Call WriteToReport(micPass,"The post status ","of the voucher after batch process is="&poststatus, false)	
	else
	Call WriteToReport(micFail,"The post status ","is not in posted status", True)
	End If
End If
End  With 

'To click on invoice information tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucher_tabInvoice Information")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'To get the value of Accounting date
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("VOUCHER_ACCOUNTING_DT")
If .Exist(nMINWAIT) Then
	accountingDate=.GetROProperty("value")
	If accountingDate=postedDate Then
		Call WriteToReport(micPass,"Accounting Date","of the posted voucher is today's posted date="&accountingDate, false)
	else
		Call WriteToReport(micFail,"Accounting Date","is not today's date", True)
	End If
End If
End  With 


End Function



'*********************************************************************************************************************************
''' <summary>  
''' massReceiptClose() To close the receipts and error messages
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "businessunit,supplierID"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'6.1.12x
'AP_06_01_12x Mass Receipt Close
Function massReceiptClose()
	Dim businessunit,supplierID,appMessage,appPONumber
	
	businessunit=GlobalDictionary("businessunit")
	supplierID=GlobalDictionary("SupplierID")
	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Close Receipts
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	'wait for the ojects to get loaded
	app_SearchSync()
With Browser("PeopleSoft Browser").Page("CloseReceipts").PSFrame("MassCloseReceipts")
	If .WebEdit("BusinessUnit").Exist(nminwait) Then
		.WebEdit("BusinessUnit").Set businessunit
	End If
	If .WebButton("Search").Exist(nminwait) Then
		.WebButton("Search").Click
		Call WriteToReport(micPass,"Search button ","Search button is present and clicked",false)
		else
		Call WriteToReport(micFail,"Search button ","Search button is not present",True)
	End If
	
	app_SearchSync()
End With	
With Browser("PeopleSoft Browser").Page("CloseReceipts")
	If .WebElement("MessagePopup").Exist(nminwait) Then
		appMessage=.WebElement("MessagePopup").GetROProperty("innertext")
		If InStr(1,Trim(appMessage),"Enter More Search Criteria",1) <>0 Then
			Call WriteToReport(micPass,"Pop up message ","Pop up message is displayed as expected :"&appMessage ,false)
			else
			Call WriteToReport(micFail,"Pop up message ","Pop up message is not present",True)
		End If
	End If
	If .WebButton("OK").Exist(nminwait) Then
		.WebButton("OK").Click
		Call WriteToReport(micPass,"Ok button ","OK button is present and clicked",false)
		else
		Call WriteToReport(micFail,"OK button ","OK button is not present",True)
	End If
End With
With Browser("PeopleSoft Browser").Page("CloseReceipts").PSFrame("MassCloseReceipts")
	If .WebEdit("BusinessUnit").Exist(nminwait) Then
		.WebEdit("BusinessUnit").Set businessunit
	End If
	If .WebEdit("SupplierID").Exist(nminwait) Then
		.WebEdit("SupplierID").Set supplierID
		Call WriteToReport(micPass,"supplierID ","is present and entered as"&supplierID,false)
		else
		Call WriteToReport(micFail,"supplierID","is not present",True)
	End If
	If .WebButton("Search").Exist(nminwait) Then
		.WebButton("Search").Click
		Call WriteToReport(micPass,"Search button ","Search button is present and clicked",false)
		else
		Call WriteToReport(micFail,"Search button ","Search button is not present",True)
	End If
	
	app_SearchSync()
End With
With Browser("PeopleSoft Browser").Page("CloseReceipts")
	If .WebElement("MessagePopup").Exist(nminwait) Then
		appMessage=.WebElement("MessagePopup").GetROProperty("innertext")
		If InStr(1,Trim(appMessage),"Enter Receipt Date OR Thru Date when vendor id is selected",1) <>0 Then
			Call WriteToReport(micPass,"Pop up message ","Pop up message is displayed as expected :"&appMessage ,false)
			else
			Call WriteToReport(micFail,"Pop up message ","Pop up message is not present",True)
		End If
	End If
	If .WebButton("OK").Exist(nminwait) Then
		.WebButton("OK").Click
		Call WriteToReport(micPass,"Ok button ","OK button is present and clicked",false)
		else
		Call WriteToReport(micFail,"OK button ","OK button is not present",True)
	End If
End With
With Browser("PeopleSoft Browser").Page("CloseReceipts").PSFrame("MassCloseReceipts")
	If .WebEdit("SupplierID").Exist(nminwait) Then
		.WebEdit("SupplierID").Set ""
	End If
	If .WebEdit("ReceivedDate").Exist(nminwait) Then
		.WebEdit("ReceivedDate").Set Date-30
		Call WriteToReport(micPass,"ReceivedDate ","is present and entered as"&date-30,false)
		else
		Call WriteToReport(micFail,"ReceivedDate","is not present",True)
	End If
	If .WebEdit("ThroughDate").Exist(nminwait) Then
		.WebEdit("ThroughDate").Set Date+30
		Call WriteToReport(micPass,"ThroughDate ","is present and entered as"&dATE+30,false)
		else
		Call WriteToReport(micFail,"ThroughDate","is not present",True)
	End If
	If .WebButton("Search").Exist(nminwait) Then
		.WebButton("Search").Click
		Call WriteToReport(micPass,"Search button ","Search button is present and clicked",false)
		else
		Call WriteToReport(micFail,"Search button ","Search button is not present",True)
	End If
	
	app_SearchSync()
	
	If .WebTable("SearchResults").Exist(nminwait) Then
		If .WebTable("SearchResults").RowCount>1 Then
			appPONumber=Trim(.WebTable("SearchResults").GetCellData(2,3))
			lineNo=Trim(.WebTable("SearchResults").GetCellData(2,4))
			If StrComp(Trim(.WebTable("SearchResults").GetCellData(2,9)),"No Match",1)=0 Then
				Call WriteToReport(micPass,"Receipt match status","Receipt match status is captured from application, "&"No Match" ,false)
			End If
			.WebTable("SearchResults").childItem(2,11,"WebCheckBox",0).Set "ON":app_SearchSync()
			If StrComp(Trim(.WebTable("SearchResults").GetCellData(2,9)),"Matched",1)=0 Then
				Call WriteToReport(micPass,"Receipt match status","Receipt match status is changed to 'Matched' " ,false)
				else
				Call WriteToReport(micfail,"Receipt match status","Receipt match status is not changed to 'Matched'" ,True)
			End If 
			If StrComp(Trim(.WebTable("SearchResults").GetCellData(2,10)),Trim(.WebTable("SearchResults").childitem(2,12,"WebEdit",0).getroproperty("value")),1)=0 Then
				Call WriteToReport(micPass,"Close Qty is populated","Close Qty is displayed and it is matched with Receipt Qty" ,false)
				else
				Call WriteToReport(micfail,"Close Quality","Close Qty is displayed and it doesn't matched with Receipt Qty, Actual : "&.WebTable("SearchResults").GetCellData(2,12),true)
			End If
		End If
	End If
	If .WebButton("CloseGRNs").Exist(nminwait) Then
		.WebButton("CloseGRNs").Click
		Call WriteToReport(micPass,"CloseGRNs button ","CloseGRNs button is present and clicked",false)
		else
		Call WriteToReport(micFail,"CloseGRNs button ","CloseGRNs button is not present",True)
	End If
	app_SearchSync()
	If .WebTable("SearchResults").Exist(nminwait) Then
		If .WebTable("SearchResults").RowCount>1 Then
			If StrComp(appPONumber,Trim(.WebTable("SearchResults").GetCellData(2,3)),1)<>0 or StrComp(lineNo,Trim(.WebTable("SearchResults").GetCellData(2,4)),1)<>0 Then
				Call WriteToReport(micPass,"Receipt closed successfully",appPONumber&"Receipt is closed successfully " ,false)
				else
				Call WriteToReport(micfail,"Receipt isnot closed","Receipt doesn't closed , still exist in the search results " ,True)
			End If
		End If
	End If
End With




	
End Function

'*********************************************************************************************************************************
''' <summary>  
''' specificDate() To Zero Dollar Email (specific Date)
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "MainMenuSelection1, dtCDW_txtRunCntrlID, dtCDW_txtAsOfDate,dtCDW_txtRemitSetID"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************

'TestCase: 6.1.1 - AP_06_01_01_specificDeate


'********************************************************************************************************************************

Public Function specificDate()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
dttxtRunCntrlID=(GlobalDictionary("dtCDW_txtRunCntrlID")) & inVoiceNumberGeneration
dtCDW_txtAsOfDate=(GlobalDictionary("dtCDW_txtAsOfDate")) 
dtCDW_txtRemitSetID=(GlobalDictionary("dtCDW_txtRemitSetID")) 

' WAit for the application to load
app_SearchSync()

'click addnew tab
With Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("TargetContent").WebElement("CDW_tabAddNewValue")
If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"AddNewValue tab is present ","and clicked  ", false)
End If
End WIth 

'set runcontrol id
WIth Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("TargetContent").WebEdit("CDW_txtRunCntrlID")
If .Exist(nMINWAIT) Then
     .Set dttxtRunCntrlID
       	Call WriteToReport(micPass,"RunCntrlID is presnet ","and set with   "&dttxtRunCntrlID, false)
End If
End WIth

'click add button
With Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("TargetContent").WebButton("CDW_btnAdd")
If .Exist(nMINWAIT) Then
	.Click
		Call WriteToReport(micPass,"Add button is present ","and clicked  ", false)
End If
End WIth 

' WAit for the application to load
app_SearchSync()
WIth Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("TargetContent").WebEdit("CDW_txtAsOfDate")
If .Exist(nMINWAIT) Then
     .Set dtCDW_txtAsOfDate
       	Call WriteToReport(micPass,"AsOfDate is presnet ","and set with   "&dtCDW_txtAsOfDate, false)
End If
End WIth

'set remit id
WIth Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("TargetContent").WebEdit("CDW_txtRemitSetID")
If .Exist(nMINWAIT) Then
     .Set dtCDW_txtRemitSetID
     	Call WriteToReport(micPass,"RemitID is presnet ","and set with   "&dtCDW_txtRemitSetID, false)
End If
End WIth

'click run button
WIth Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("TargetContent").WebButton("CDW_btnRun")
If .Exist(nMINWAIT) Then
     .Click
     	Call WriteToReport(micPass,"Run Button is present ","and clicked  ", false)
End If
End WIth

' WAit for the application to load
app_SearchSync()

'To display run date
WITH Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("Process Scheduler Request")
If .WebEdit("PSR_txtRunDate").Exist(nminwait) Then
IF .WebCheckBox("PSR_chkboxSelect").Exist(nminwait) Then
 Call WriteToReport(micPass,"Run Date=" &.WebEdit("PSR_txtRunDate").GetROProperty("value"),"is displayed and Zero dollar email checkbox is checked", false)
End If
End If
END WITH 

'click ok button
WIth Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("Process Scheduler Request").WebButton("PSR_btnOk")
If .Exist(nMINWAIT) Then
     .Click
      Call WriteToReport(micPass,"OK button is present ","and clicked  ", false)
End If
End WIth

 ' WAit for the application to load
 app_SearchSync()

With Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("CDWZeroDollarEmailProgram").WebElement("CDW_labelProcessInst")
 If .Exist(nMINWAIT) Then
 	processInst=Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("CDWZeroDollarEmailProgram").WebElement("CDW_labelProcessInst").GetROProperty("innertext")
 	procInst=Split(processInst,":")
 	pNo=procInst(1)
 	 		Call WriteToReport(micPass,"Process Instance value is", "displayed successfully= [ " & pNo &"]",false)
		Else
		  	Call WriteToReport(micFail,"Process Instance value is", "not displayed successfully= [ " & pNo &"]",True)
 End If
End With

'click process monitor link
with Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("Status Bar").Link("Process Monitor")
If .Exist(nMINWAIT) Then
         .Click
         	Call WriteToReport(micPass,"Processmonitor link is present ","and clicked  ", false)
End If
End WIth

'Enter all the detail in the Process monitor screen
With Browser("PeopleSoft Browser").Page("Matching").PSFrame("ProcessMonitor")
	If .WebEdit("InstanceFrom").Exist(nMINWAIT) Then
		.WebEdit("InstanceFrom").Set pNo
	End If

'Click on Refresh button
	If .WebButton("Refresh").Exist(nMINWAIT) Then
		.WebButton("Refresh").Click
	End If
'check the status of the Job
	nCount=0
	If .WebTable("ProcessList").Exist(nMINWAIT) Then
		While (StrComp(Trim(.WebTable("ProcessList").GetCellData(2,8)),"Success",1)<>0) and nCount<10
			app_SearchSync()
			nCount=nCount+1
			If .WebButton("Refresh").Exist(nMAXWAIT) Then
				.WebButton("Refresh").Click
			End If
		Wend
	nCount=0
		While (StrComp(Trim(.WebTable("ProcessList").GetCellData(2,9)),"Posted",1)<>0) and nCount<10
			app_SearchSync()
			nCount=nCount+1
			If .WebButton("Refresh").Exist(nMAXWAIT) Then
				.WebButton("Refresh").Click
			End If
		Wend
	End If
End With

'click detail link in the table
with Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("Process Monitor").Link("PM_linkDetails")
If .Exist(nMINWAIT) Then
         .Click
         	Call WriteToReport(micPass,"Detail link is present ","and clicked  ", false)
End If
End WIth

'check whether process detail is exist with instance value and runcontrol id
With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Detail") 
	If .Exist(5) Then
			Call WriteToReport(micPass,"Process Detail", "Instance value="&.WebElement("PD_labelInstValue").GetROProperty("innertext")&" Run Control Id="&.WebElement("PD_labelRunCntrlID").GetROProperty("innertext")&" is displayed successfully",false)
	Else
			Call WriteToReport(micFail,"Process Detail","is not displayed successfully",True)
	End If
End With

'click ok button
With Browser("PeopleSoft Browser").Page("Process Monitor").PSFrame("Process Detail").WebButton("OK")
 If .Exist(5) Then
 	.Click
 		Call WriteToReport(micPass,"OK button is present ","and clicked  ", false)
 End If
End With

'navigate to previous page

With Browser("PeopleSoft Browser").Page("Process Monitor").WebButton("PM_btnBackZeroDollarEmail")
 If .Exist(5) Then
 	.Click
 End If
End With

With Browser("PeopleSoft Browser").Page("Process Monitor").WebElement("PM_alertmsg")
 If .Exist(5) Then
 	Browser("PeopleSoft Browser").Page("Process Monitor").WebButton("PM_btnNo").Click
 End If
End With

'click report manager link
With Browser("PeopleSoft Browser").Page("CDW Zero Dollar Email").PSFrame("CDWZeroDollarEmailProgram").Link("Report Manager")
If .Exist(5) Then
 	.Click
 	  Call WriteToReport(micPass,"Report Manager is present ","and clicked  ", false)
 End If
End With

'set frominstance
With Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Distribution Mgr").WebEdit("RM_txtFromInst")
 If .Exist(nMINWAIT) Then
 	.Set  pNo
 End If
End With

' WAit for the application to load
app_SearchSync()
With Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Distribution Mgr").WebButton("RM_btnRefresh")
 If .Exist(nMINWAIT) Then
 	.Click
 		Call WriteToReport(micPass,"Refresh button is present ","and clicked  ", false)
 End If
End With

'click CDWZERO link
With Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Distribution Mgr").Link("RM_linkCDWZERO")
 If .Exist(nMINWAIT) Then
 	.Click
 		Call WriteToReport(micPass,"CDWZERO link is present ","and clicked  ", false)
 End If
End With

 ' WAit for the application to load
app_SearchSync()

If Browser("PeopleSoft Browser").Page("Report List").Exist(5) then
		Call WriteToReport(micPass,"Report List", "is displayed successfully",false)
		Else
		Call WriteToReport(micFail,"Report List","is not displayed successfully",True)
End If

End Function

'*********************************************************************************************************************************
''' <summary>  
''' runPaymentSelectionHoldPayment() To process the paycycles
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "PayCycle,businessunit"</note> eg: PayCycle="MON;TUES;WED"
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to paycycle process</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_04_01_16 
Public Function runPaymentSelectionHoldPayment()
	Dim PayCycle,businessunit,appPaycycleStatus,flag,i,appVoucherCount
	Dim BU(),Vid(),RC,strSelection
	PayCycle=Split(GlobalDictionary("PayCycle"),";")
	
	businessunit=GlobalDictionary("businessunit")
	
	'Navigate to Account Payable --> Payments --> payment processing -> Pay Cycle Manager
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		
	For i = 0 To ubound(paycycle) Step 1
		
		app_SearchSync()
		
		'open a paycycle
		ap_openApaycycle(paycycle(i))
		
		app_SearchSync()
		
		appPaycycleStatus=ap_getPayCycleStatus()
		flag=0
		If InStr(1,appPaycycleStatus,"Selected",1)<>0 Then
			With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
				If .WebButton("PayCycle_Reset").Exist(nminwait) Then
					.WebButton("PayCycle_Reset").Click
				End If
			End With
			If Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Click
			End If
			ap_refreshTillStatuschaged(appPaycycleStatus)
			flag=1:Exit for
		ElseIf InStr(1,appPaycycleStatus,"running",1)<>0 Then
			ap_refreshTillStatuschaged(appPaycycleStatus)
			If InStr(1,appPaycycleStatus,"Selected",1)<>0 Then
				With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
					If .WebButton("PayCycle_Reset").Exist(nminwait) Then
						.WebButton("PayCycle_Reset").Click
					End If
				End With
				wait(3)
				If Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Exist(nminwait) Then
					Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Click
				End If
				ap_refreshTillStatuschaged(appPaycycleStatus)
				flag=1:Exit for
			else
				Call WriteToReport(micDone,"Pay Cycle "&paycycle(i),"Pay Cycle "&paycycle(i)&" has "&appPaycycleStatus&" status, Moving to Next pay cycle" ,false)
				'return to the paycycle Manager search
				If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Exist(nminwait) Then
					Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Click
				End If
			End If
		ElseIf InStr(1,appPaycycleStatus,"completed",1)<>0 or InStr(1,appPaycycleStatus,"reset",1)<>0 Then'or InStr(1,appPaycycleStatus,"No work",1)<>0 Then
			If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").Click
			End If
			flag=1:Exit for
		else
			Call WriteToReport(micDone,"Pay Cycle "&paycycle(i),"Pay Cycle "&paycycle(i)&" has "&appPaycycleStatus&" status, Moving to Next pay cycle" ,false)
			'return to the paycycle Manager search
			If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Click
			End If
		End If
	Next
	
	If flag Then
		With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
			If .Link("PayCycle_SelectionCriteria").Exist(nminwait) Then
				.Link("PayCycle_SelectionCriteria").Click
				Call WriteToReport(micPass,"Selection Criteria link","is present and clicked",false)
				else
				Call WriteToReport(micFail,"Selection Criteria link","is not present",True)
			End If
			
		End With
			'selection criteria added
			call ap_paymentSelectionCritiriSaveDates(GlobalDictionary("daysdIFF"),date)
			app_SearchSync()
			
		With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent")
			If .Link("PayCycle_PayCycleManager").Exist(nminwait) Then
				.Link("PayCycle_PayCycleManager").Click
				Call WriteToReport(micPass,"PayCycle Manager link","is present and clicked",false)
				else
				Call WriteToReport(micFail,"PayCycle Manager link","is not present",True)
			End If
		End With
		
		app_SearchSync()
		'get the current status from appliaction
		appPaycycleStatus=ap_getPayCycleStatus()
		
		With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
			If .WebButton("PayCycle_Process").Exist(nminwait) Then
				If .WebElement("PayCycle_StepName").Exist(nminwait) Then
					Call WriteToReport(micPass,"Process step name"," Selected step name "&.WebElement("PayCycle_StepName").GetROProperty("innertext"),false)
				End If
				.WebButton("PayCycle_Process").Click
				Call WriteToReport(micPass,"process button","is present and clicked",false)
				else
				Call WriteToReport(micFail,"Process button","is not present",True)
			End If
		End With
		
'refresh till the status is changed		
		ap_refreshTillStatuschaged(appPaycycleStatus)
		
		app_SearchSync()
		appPaycycleStatus=ap_getPayCycleStatus()
		
		If StrComp(Trim(appPaycycleStatus),"No Work",1)<>0 Then
			'validate the voucher count
			appVoucherCount=ap_scheduledPaymentSelectedCountValidation(2,GlobalDictionary("daysdIFF"),date)
			
			If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_Details").Exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_Details").Click
				Call WriteToReport(micPass,"Details link","is present and clicked",false)
				else
				Call WriteToReport(micFail,"Details link","is not present",True)
			End If
			
			app_SearchSync()
			ap_searchPayCycleDetails("")
			app_SearchSync()
	
			
			With Browser("PeopleSoft Browser").Page("PayCycleDetails").PSFrame("PayCyclesDetails")
				If .WebButton("ExcludeALL").Exist(nminwait) Then
					.WebButton("ExcludeALL").Click:app_SearchSync()
					Call WriteToReport(micPass,"Exclude all button","is present and clicked",false)
					wait(3):app_SearchSync():app_SearchSync():app_SearchSync()
				End If
				If .WebTable("PayCycleSearchResults").Exist(nminwait) Then
				
					If .WebTable("PayCycleSearchResults").RowCount>2 Then
						rc=2
					else
						RC=.WebTable("PayCycleSearchResults").RowCount
					End If
					For i = 1 To RC Step 1
						ReDim Preserve BU(i-1):BU(i-1)=.WebTable("PayCycleSearchResults").GetCellData(i,4)
						ReDim Preserve Vid(i-1):Vid(i-1)=.WebTable("PayCycleSearchResults").GetCellData(i,5)
						If (i mod 2) Then
							strSelection=(GlobalDictionary("PaymentActionSeparate"))'"Separate"
						else:strSelection=(GlobalDictionary("PaymentActionHold"))'"Hold"					
						End If
						.WebTable("PayCycleSearchResults").ChildItem(i,1,"WebList",0).select(strSelection)
						Call WriteToReport(micPass,"Payment action selected","Payment action is selected as "&strSelection&" for "&BU(i-1)&" - "&Vid(i-1),false)
						If StrComp(strSelection,"Hold",1)=0 Then
							.WebTable("PayCycleSearchResults").ChildItem(i,2,"WebEdit",0).set(GlobalDictionary("Holdreason"))
							Call WriteToReport(micDone,"Hold reason","is present and selected as : "&(GlobalDictionary("Holdreason")),false)
						End If
					Next
				End If
				
				If .WebButton("Save").Exist(nminwait) Then
					.WebButton("Save").Click
					Call WriteToReport(micPass,"process button","is present and clicked",false)
				End If
				app_SearchSync()
				If .WebButton("Save").Exist(nminwait) Then
					.WebButton("Save").Click
				End If
				For i = 1 To 15 Step 1
					app_SearchSync():wait(3)
				Next
				app_SearchSync()
				If .Link("PayCycleManager").Exist(nminwait) Then
					.Link("PayCycleManager").Click
					Call WriteToReport(micPass,"PayCycleManager link","is present and clicked",false)
				End If
			End With
			
			app_SearchSync()
			appPaycycleStatus=ap_getPayCycleStatus()
			
			With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
				If .WebButton("PayCycle_Process").Exist(nminwait) Then
					If .WebElement("PayCycle_StepName").Exist(nminwait) Then
						Call WriteToReport(micPass,"Process step name"," Selected step name "&.WebElement("PayCycle_StepName").GetROProperty("innertext"),false)
					End If
					.WebButton("PayCycle_Process").Click
					Call WriteToReport(micPass,"process button in Details","is present and clicked",false)
					else
					Call WriteToReport(micFail,"Process button in Details","is not present",True)
				End If
			End With
			
			'refresh till the status is changed		
			ap_refreshTillStatuschaged(appPaycycleStatus)
			
			'Process till results process get completed
			ap_processThePayCycleResults()
			
			
		
			For i = 0 To ubound(BU) Step 1
				
'				Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
				SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
				
'				Open a existing voucher(created voucher)
				Call ap_openExistingVoucher(BU(i),vID(i))	
				
				'wait for the ojects to get loaded
				app_SearchSync()
				
				'Validate hold and , separate payment
				If ((i+1) mod 2) Then
					ap_paymentOptionsinPaymentsTab("Separate")
				else
					ap_paymentOptionsinPaymentsTab("Hold")
				End If
			Next
		else
			Call WriteToReport(micfail,"Pay Cycle moved to No Work Status ","Pay Cycle moved to No Work Status " ,false)
		End If
			
	else
		Call WriteToReport(micfail,"All the Pay Cycles are non executable status ","All the Pay Cycles are non executable status" ,false)
	End If
	
End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_openApaycycle() To open a paycycle
'''Parameter1:	paycycleA. eg:paycycleA paycycle name
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'Ap_open a Pacycle
Public Function ap_openApaycycle(paycycleA)
	app_SearchSync()
	
	with Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("TargetContent")
		If .WebEdit("PayCycle_SearchManager").Exist(nminwait) Then
			.WebEdit("PayCycle_SearchManager").Set paycycleA
			Call WriteToReport(micPass,"Pay Cycle ","is present and entered as"&paycycleA,false)
			else
			Call WriteToReport(micFail,"Pay Cycle ","is not present",True)
		End If
		If .WebButton("PayCycle_Search").Exist(nminwait) Then
			.WebButton("PayCycle_Search").Click
			Call WriteToReport(micPass,"Search button ","Search button is present and clicked",false)
			else
			Call WriteToReport(micFail,"Search button ","Search button is not present",True)
		End If
	end with
	app_SearchSync()	
End Function

'*********************************************************************************************************************************
''' <summary>  
''' AP_paycycleStatus() To get the pay cycle status
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to pay cycle manager</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_paycycleStatus
Public Function ap_getPayCycleStatus()
	Dim appStatus
	app_SearchSync()
	With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
		If .WebElement("PayCYcle_Status").Exist(nminwait) Then
			appStatus=Trim(.WebElement("PayCYcle_Status").GetROProperty("innertext"))
		End If
	End With
	ap_getPayCycleStatus=appStatus
End Function 

'*********************************************************************************************************************************
''' <summary>  
''' ap_refreshTillStatuschaged() To status change
'''Parameter1:	currentStatus.(Pay cycle current status)
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_refresh till status change
Public Function ap_refreshTillStatuschaged(currentStatus)
	Dim appstatus,ncount,appStepname
	appstatus=ap_getPayCycleStatus()
	ncount=0
	do While (StrComp(appstatus,currentStatus,1)=0 OR StrComp(appstatus,"running",1)=0) AND ncount<1000 
		If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").exist(nminwait) Then
			Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").Click
		End If
		wait(2):ncount=ncount+1'app_SearchSync()
		appstatus=ap_getPayCycleStatus()
		If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_StepName").Exist(nminwait) Then
			appStepname=Trim(Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_StepName").GetROProperty("innertext"))
			If StrComp(appStepname,"Payment Selection",1)=0 Then
				Exit do
			End If
		End If
		If StrComp(Trim(appstatus),"No Work",1)=0 Then
			Exit do:Call WriteToReport(micPass,"Status changed successfully ","Status changed to ["&appstatus&"]" ,false)
		End If
	loop
	If StrComp(appstatus,currentStatus,1)<>0 Then
		Call WriteToReport(micPass,"Status changed successfully ","Status changed from "&currentStatus &" to "&appstatus ,false)
	End If
End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_paymentSelectionCritiriSaveDates() To save the dates in pay selection critria
'''Parameter1:	daysDiff.(days difference from currect date )
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_ payment selection critiria selection
Public Function ap_paymentSelectionCritiriSaveDates(daysDiff,paythroughdate)
	app_SearchSync()
	With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent")
		If .WebEdit("PayCycle_PayFromDate").Exist(nminwait) Then
			.WebEdit("PayCycle_PayFromDate").Set paythroughdate-daysDiff'date-daysDiff
			Call WriteToReport(micPass,"PayFromDate ","is present and entered as"&paythroughdate-daysDiff,false)'&date-daysDiff,false)
		else
			Call WriteToReport(micFail,"PayFromDate","is not present",True)
		End If
		If .WebEdit("PayCYcle_PayThroughDate").Exist(nminwait) Then
			.WebEdit("PayCYcle_PayThroughDate").Set paythroughdate'date+30
			Call WriteToReport(micPass,"PayThroughDate ","is present and entered as"&paythroughdate,false)'&date+daysDiff,false)
		else
			Call WriteToReport(micFail,"PayThroughDate","is not present",True)
		End If
		If .WebEdit("PayCYcle_PaymentDate").Exist(nminwait) Then
			.WebEdit("PayCYcle_PaymentDate").Set date
			Call WriteToReport(micPass,"PaymentDate ","is present and entered as"&date,false)
		else
			Call WriteToReport(micFail,"PaymentDate","is not present",True)
		End If
		If .WebEdit("PayCycle_AcctDate").Exist(nminwait) Then
			.WebEdit("PayCycle_AcctDate").Set date
			Call WriteToReport(micPass,"AcctDate ","is present and entered as"&date,false)
		else
			Call WriteToReport(micFail,"AcctDate","is not present",True)
		End If
		If .WebEdit("PayCycle_WithholdingDate").Exist(nminwait) Then
			.WebEdit("PayCycle_WithholdingDate").Set date
			Call WriteToReport(micPass,"WithholdingDate ","is present and entered as"&date,false)
		else
			Call WriteToReport(micFail,"WithholdingDate","is not present",True)
		End If
		If .WebEdit("PayCycle_NextPatThroughDate").Exist(nminwait) Then
			.WebEdit("PayCycle_NextPatThroughDate").Set paythroughdate+1'date+60
			Call WriteToReport(micPass,"NextPatThroughDate ","is present and entered as"&paythroughdate+1,false)
		else
			Call WriteToReport(micFail,"NextPatThroughDate","is not present",True)
		End If
		If .WebEdit("PayCYcle_NextPaymentDate").Exist(nminwait) Then
			.WebEdit("PayCYcle_NextPaymentDate").Set paythroughdate+30'date+60
			Call WriteToReport(micPass,"NextPaymentDate ","is present and entered as"&paythroughdate+daysDiff,false)
		else
			Call WriteToReport(micFail,"NextPaymentDate","is not present",True)
		End If
		If .WebButton("PayCycle_Save").Exist(nminwait) Then
			.WebButton("PayCycle_Save").Click
			Call WriteToReport(micPass,"Save button ","is present and clicked",false)
		else
			Call WriteToReport(micFail,"Save button","is not present",True)
		End If
	End With

End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_scheduledPaymentSelectedCountValidation() To scheduled paments count validation
'''Parameter1:	schedulCount,iDays.*(schedulCount- expected count, idays - days incerement in selection critria)
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_voucher count validation
Public Function ap_scheduledPaymentSelectedCountValidation(schedulCount,iDays,shecduledDate)
Dim appVoucherCount,appPaycycleStatus,i,maxlimit
	'validate the voucher count
	If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_SchedulePaymentSelected").Exist(nminwait) Then
		appVoucherCount=CDBL(Trim(Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_SchedulePaymentSelected").GetROProperty("innertext")))
		Call WriteToReport(micDone,"Schedule Payments Selected","Schedule Payments Selected is captured from application, as "&appVoucherCount,false)
	End If
	If isEmpty(appVoucherCount) or appVoucherCount="" Then
		appVoucherCount=0
	End If
	
	appPaycycleStatus=ap_getPayCycleStatus()
	
	i=2:maxlimit=10000
	If CDBL(appVoucherCount)<schedulCount or appVoucherCount > maxlimit Then
		While appVoucherCount < schedulCount or appVoucherCount > maxlimit
			i=i+1
			With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
				If .WebButton("PayCycle_Reset").Exist(nminwait) Then
					.WebButton("PayCycle_Reset").Click
				End If
			End With
			If Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Click
			End If
			
'			refresh until status get changed
			ap_refreshTillStatuschaged(appPaycycleStatus)
			
			With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
				If .Link("PayCycle_SelectionCriteria").Exist(nminwait) Then
					.Link("PayCycle_SelectionCriteria").Click
					Call WriteToReport(micPass,"Selection Criteria link","is present and clicked",false)
					else
					Call WriteToReport(micFail,"Selection Criteria link","is not present",True)
				End If
				
			End With
				'selection criteria added
				If appVoucherCount < schedulCount  Then
					call ap_paymentSelectionCritiriSaveDates(iDays*i,date+30)
				ElseIf appVoucherCount > maxlimit Then
					call ap_paymentSelectionCritiriSaveDates(iDays/i,date+30)
				End If
				
				app_SearchSync()
				
			With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent")
				If .Link("PayCycle_PayCycleManager").Exist(nminwait) Then
					.Link("PayCycle_PayCycleManager").Click
					Call WriteToReport(micPass,"PayCycle Manager link","is present and clicked",false)
					else
					Call WriteToReport(micFail,"PayCycle Manager link","is not present",True)
				End If
			End With
			
			app_SearchSync()
'			Get the status from app
			appPaycycleStatus=ap_getPayCycleStatus()
'			initiate the process
			With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
				If .WebButton("PayCycle_Process").Exist(nminwait) Then
					.WebButton("PayCycle_Process").Click
					If .WebElement("PayCycle_StepName").Exist(nminwait) Then
						Call WriteToReport(micPass,"Process step name"," Selected step name "&.WebElement("PayCycle_StepName").GetROProperty("innertext"),false)
					End If
					Call WriteToReport(micPass,"process button","is present and clicked",false)
					else
					Call WriteToReport(micFail,"Process button","is not present",True)
				End If
			End With
			
'			refresh the application untill status chaged
			ap_refreshTillStatuschaged(appPaycycleStatus)
			
'			get the voucher count from app
			If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_SchedulePaymentSelected").Exist(nminwait) Then
				appVoucherCount=CDBL(Trim(Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_SchedulePaymentSelected").GetROProperty("innertext")))
			End If
		Wend
		
	else
		If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").exist(nminwait) Then
			Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").Click
		End If
	End If

ap_scheduledPaymentSelectedCountValidation=appVoucherCount
End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_searchPayCycleDetails() To search PayCycle Details
'''Parameter1:	businessunit.
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'AP_Search details in Pay Cycle details
Public Function ap_searchPayCycleDetails(businessunit)

With Browser("PeopleSoft Browser").Page("PayCycleDetails").PSFrame("PayCyclesDetails")
	If .WebEdit("BusinessUnit").Exist(nminwait) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"BusinessUnit ","is present and entered as"&businessunit,false)
	else
		Call WriteToReport(micFail,"BusinessUnit","is not present",True)
	End If
	If .WebButton("Search").Exist(nminwait) Then
		.WebButton("Search").Click
		Call WriteToReport(micPass,"Search button ","is present and Clicked",false)
	else
		Call WriteToReport(micFail,"Search button","is not present",True)
	End If
	
	app_SearchSync()
	Dim ncount:ncount=0
	do While (.WebButton("ExcludeALL").GetROProperty("disabled")=1 and .WebButton("SeparateAll").GetROProperty("disabled")=1) AND ncount<50
		app_SearchSync():wait(2):ncount=ncount+1
		If (.WebButton("ExcludeALL").GetROProperty("disabled")=0 and .WebButton("SeparateAll").GetROProperty("disabled")=0) Then
			Exit do
		End If
		If Not(.WebButton("ExcludeALL").Exist(nminwait)) AND ncount>1 Then
				Call WriteToReport(micFail,"Application logged out ","Application signed out due to timeout",True):exitTest
		End If
	loop
End With

End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_paymentOptionsinPaymentsTab() To verisy payment Options in PaymentsTab
'''Parameter1:	strPay.(it should be "HOLD" or "Separate")
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_hold payment in Payments tab
Public Function ap_paymentOptionsinPaymentsTab(strPay)
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
		If .WebTabStrip("tabSelection").Exist(10) Then
			.WebTabStrip("tabSelection").Select("Payments")
			Call WriteToReport(micPass,"Payments tab","is present and selected",false)
		else
			Call WriteToReport(micFail,"Payments tab","is not present",True)
		End If
	end with
	wait(4):app_SearchSync()
	With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Payments")
		If StrComp(strPay,"Hold",1)=0 Then
			If .WebCheckBox("PayOp_HoldPaments").Exist(nminwait) Then
				If .WebCheckBox("PayOp_HoldPaments").GetROProperty("checked") Then
					Call WriteToReport(micPass,"Hold Payments checbox validation in Payments tab","Hold Payments checkbox is checked as expected",false)
				Else
					Call WriteToReport(micFail,"Hold Payments checbox validation in Payments tab","Hold Payments checkbox doesn't checked as expected",True)
				End If
			else
				Call WriteToReport(MicFail,"Hold Payments checbox validation in Payments tab","Hold Payments checkbox doesn't exit in application",false)
			End If
		ElseIf StrComp(strPay,"Separate",1)=0 Then
			If .WebCheckBox("PayOp_SeparatePaments").Exist(nminwait) Then
				If .WebCheckBox("PayOp_SeparatePaments").GetROProperty("checked") Then
					Call WriteToReport(micPass,"Separate Payments checbox validation in Payments tab","Separate Payments checkbox is checked as expected",false)
				Else
					Call WriteToReport(micFail,"Separate Payments checbox validation in Payments tab","Separate Payments checkbox doesn't checked as expected",True)
				End If
			else
				Call WriteToReport(MicFail,"Separate Payments checbox validation in Payments tab","Separate Payments checkbox doesn't exit in application",false)
			End If
		End If
	End With
	
End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_processThePayCycleResults() : to process all the process available in the paycycle list
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'AP_Process the pay Cycle Results
Public Function ap_processThePayCycleResults()
Dim rc,i,appPaycycleStatus
With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
	If .WebTable("PayCycleResultsFirst3Cols").Exist(nminwait) Then
		rc=.WebTable("PayCycleResultsFirst3Cols").RowCount
		For i = 1 To rc Step 1
			If .WebTable("PayCycleResultsLast6Cols").Exist(nminwait) Then
				If InStr(1,Trim(.WebTable("PayCycleResultsLast6Cols").GetCellData(i,5)),"web",1)>0 Then
					.WebTable("PayCycleResultsLast6Cols").ChildItem(i,5,"WebList",0).select("Web")
				End If
			End If
			While Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebTable("PayCycleResultsFirst3Cols").ChildItem(i,1,"WebButton",0).getroproperty("disabled")=0
				appPaycycleStatus=ap_getPayCycleStatus()
				Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebTable("PayCycleResultsFirst3Cols").ChildItem(i,1,"WebButton",0).click				
				Call WriteToReport(micPass,"process button in Pay cycle results ","is present and clicked for Account : "&Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebTable("PayCycleResultsFirst3Cols").GetCellData(i,3) ,false)
				app_SearchSync()
		'refresh till the status is changed		
				ap_refreshTillStatuschaged(appPaycycleStatus)
			Wend
		Next
	End If
End With
End Function

'*********************************************************************************************************************************
''' <summary>  
''' runPaymentSelectionNonInventory()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayCycle"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_04_01_13
Public Function runPaymentSelectionNonInventory()
	Dim PayCycle,businessunit,appPaycycleStatus,flag,i,appVoucherCount,ncount
	Dim BU(),Vid(),RC,strSelection
	PayCycle=Split(GlobalDictionary("PayCycle"),";")
	
	businessunit=GlobalDictionary("businessunit")
	
	'Navigate to Account Payable --> Payments --> payment processing -> Pay Cycle Manager
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		
	For i = 0 To ubound(paycycle) Step 1
		
		app_SearchSync()
		
		'open a paycycle
		ap_openApaycycle(paycycle(i))
		
		app_SearchSync()
		
		appPaycycleStatus=ap_getPayCycleStatus()
		flag=0
		If InStr(1,appPaycycleStatus,"Selected",1)<>0 Then
			With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
				If .WebButton("PayCycle_Reset").Exist(nminwait) Then
					.WebButton("PayCycle_Reset").Click
				End If
			End With
			If Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Click
			End If
			ap_refreshTillStatuschaged(appPaycycleStatus)
			flag=1:Exit for
		ElseIf InStr(1,appPaycycleStatus,"running",1)<>0 Then
			ap_refreshTillStatuschaged(appPaycycleStatus)
			If InStr(1,appPaycycleStatus,"Selected",1)<>0 Then
				With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
					If .WebButton("PayCycle_Reset").Exist(nminwait) Then
						.WebButton("PayCycle_Reset").Click
					End If
				End With
				wait(3)
				If Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Exist(nminwait) Then
					Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Click
				End If
				ap_refreshTillStatuschaged(appPaycycleStatus)
				flag=1:Exit for
			else
				Call WriteToReport(micDone,"Pay Cycle "&paycycle(i),"Pay Cycle "&paycycle(i)&" has "&appPaycycleStatus&" status, Moving to Next pay cycle" ,false)
				'return to the paycycle Manager search
				If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Exist(nminwait) Then
					Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Click
				End If
			End If
		ElseIf InStr(1,appPaycycleStatus,"completed",1)<>0 or InStr(1,appPaycycleStatus,"reset",1)<>0 or InStr(1,appPaycycleStatus,"No work",1)<>0 Then
			If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").Click
			End If
			flag=1:Exit for
		else
			Call WriteToReport(micDone,"Pay Cycle "&paycycle(i),"Pay Cycle "&paycycle(i)&" has "&appPaycycleStatus&" status, Moving to Next pay cycle" ,false)
			'return to the paycycle Manager search
			If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Click
			End If
		End If
	Next
	
	If flag Then
		With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
			If .Link("PayCycle_SelectionCriteria").Exist(nminwait) Then
				.Link("PayCycle_SelectionCriteria").Click
				Call WriteToReport(micPass,"Selection Criteria link","is present and clicked",false)
				else
				Call WriteToReport(micFail,"Selection Criteria link","is not present",True)
			End If
			
		End With
		
			'selection criteria added
			Dim strSQL, connectionString, sheetName
			businessUnit=GlobalDictionary("businessUnit")
			sheetName=GlobalDictionary("sheetName")
			connectionString = "Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
			
			strSQL="select TOP 3 SCHEDULED_PAY_DT from PS_PYMNT_VCHR_XREF where DUE_DT >= '01/01/2018' and BUSINESS_UNIT NOT IN ('00012', '00017') and PYMNT_ID = ' ' and PYMNT_GROUP_CD = '05' order by SCHEDULED_PAY_DT desc, BANK_CD, BANK_ACCT_KEY, PYMNT_METHOD, REMIT_SETID, REMIT_VENDOR"
			strSQL=GlobalDictionary("strSQL")
			If dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
				call ap_paymentSelectionCritiriSaveDates(GlobalDictionary("daysdIFF"),Cdate(Trim(DataTable.Value("SCHEDULED_PAY_DT",sheetName) )))
			End If
'			ap_paymentSelectionCritiriSaveDates(GlobalDictionary("daysdIFF"))
			app_SearchSync()
			
		With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent")
			If .Link("PayCycle_PayCycleManager").Exist(nminwait) Then
				.Link("PayCycle_PayCycleManager").Click
				Call WriteToReport(micPass,"PayCycle Manager link","is present and clicked",false)
				else
				Call WriteToReport(micFail,"PayCycle Manager link","is not present",True)
			End If
		End With
		
		app_SearchSync()
		'get the current status from appliaction
		appPaycycleStatus=ap_getPayCycleStatus()
		
		With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
			If .WebButton("PayCycle_Process").Exist(nminwait) Then
				If .WebElement("PayCycle_StepName").Exist(nminwait) Then
					Call WriteToReport(micPass,"Process step name"," Selected step name "&.WebElement("PayCycle_StepName").GetROProperty("innertext"),false)
				End If
				.WebButton("PayCycle_Process").Click
				Call WriteToReport(micPass,"process button","is present and clicked",false)
				else
				Call WriteToReport(micFail,"Process button","is not present",True)
			End If
		End With
		
'refresh till the status is changed		
		ap_refreshTillStatuschaged(appPaycycleStatus)
		
		app_SearchSync()
		appPaycycleStatus=ap_getPayCycleStatus()
		
		If StrComp(Trim(appPaycycleStatus),"No Work",1)<>0 Then
			'validate the voucher count
			appVoucherCount=ap_scheduledPaymentSelectedCountValidation(2,GlobalDictionary("daysdIFF"),Cdate(Trim(DataTable.Value("SCHEDULED_PAY_DT",sheetName) )))
			
			If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_Details").Exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_Details").Click
				Call WriteToReport(micPass,"Details link","is present and clicked",false)
				else
				Call WriteToReport(micFail,"Details link","is not present",True)
			End If
			
			app_SearchSync()
			ap_searchPayCycleDetails("")
			app_SearchSync()
	
			
			With Browser("PeopleSoft Browser").Page("PayCycleDetails").PSFrame("PayCyclesDetails")
				If .WebButton("ExcludeALL").Exist(nminwait) Then
					.WebButton("ExcludeALL").Click:app_SearchSync()
					Call WriteToReport(micPass,"Exclude all button","is present and clicked",false)
					wait(3):app_SearchSync():app_SearchSync():app_SearchSync():app_SearchSync()
				Else : ExitTest
				End If
				If .WebTable("PayCycleSearchResults").Exist(nminwait) Then
				
					If .WebTable("PayCycleSearchResults").RowCount>2 Then
						rc=2
					else
						RC=.WebTable("PayCycleSearchResults").RowCount
					End If
					For i = 1 To RC Step 1
						ReDim Preserve BU(i-1):BU(i-1)=.WebTable("PayCycleSearchResults").GetCellData(i,4)
						ReDim Preserve Vid(i-1):Vid(i-1)=.WebTable("PayCycleSearchResults").GetCellData(i,5)
						If (i mod 2) Then
							strSelection=(GlobalDictionary("PaymentActionSeparate"))'"Separate"
						else:strSelection=(GlobalDictionary("PaymentActionNone"))'"None"					
						End If
						.WebTable("PayCycleSearchResults").ChildItem(i,1,"WebList",0).select(strSelection)
						Call WriteToReport(micPass,"Payment action selected","Payment action is selected as "&strSelection&" for "&BU(i-1)&" - "&Vid(i-1),false)
						If StrComp(strSelection,"Hold",1)=0 Then
							.WebTable("PayCycleSearchResults").ChildItem(i,2,"WebEdit",0).set(GlobalDictionary("Holdreason"))
							Call WriteToReport(micDone,"Hold reason","is present and selected as : "&(GlobalDictionary("Holdreason")),false)
						End If
					Next
				
				End If
				
				If .WebButton("Save").Exist(nminwait) Then
					.WebButton("Save").Click
					Call WriteToReport(micPass,"process button","is present and clicked",false)
				End If
				app_SearchSync()
				If .WebButton("Save").Exist(nminwait) Then
					.WebButton("Save").Click
				End If:ncount=0
				do While ncount<15 
					app_SearchSync():wait(3):ncount=ncount+1
					If (RC=.WebTable("PayCycleSearchResults").RowCount) Then
						Exit do
					End If
				loop
				app_SearchSync()
				If .Link("PayCycleManager").Exist(nminwait) Then
					.Link("PayCycleManager").Click
					Call WriteToReport(micPass,"PayCycleManager link","is present and clicked",false)
				End If
			End With
			
			app_SearchSync()
			appPaycycleStatus=ap_getPayCycleStatus()
			
			With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
				If .WebButton("PayCycle_Process").Exist(nminwait) Then
					If .WebElement("PayCycle_StepName").Exist(nminwait) Then
						Call WriteToReport(micPass,"Process step name"," Selected step name "&.WebElement("PayCycle_StepName").GetROProperty("innertext"),false)
					End If
					.WebButton("PayCycle_Process").Click
					Call WriteToReport(micPass,"process button in Details","is present and clicked",false)
					else
					Call WriteToReport(micFail,"Process button in Details","is not present",True)
				End If
			End With
			
			'refresh till the status is changed		
			ap_refreshTillStatuschaged(appPaycycleStatus)
			
			'Process till results process get completed
			ap_processThePayCycleResults()
			
		else
			Call WriteToReport(micfail,"Pay Cycle moved to No Work Status ","Pay Cycle moved to No Work Status " ,false)
		End If
			
	else
		Call WriteToReport(micfail,"All the Pay Cycles are non executable status ","All the Pay Cycles are non executable status" ,false)
	End If
	

End Function

'*********************************************************************************************************************************
''' <summary>  
''' PayCycleReset() To Pay Cycle Reset
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "PayCycle, MainMenuSelection"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'4.1.6

'****************************************
Public Function PayCycleReset() 
	'Navigate to Below Page
	'Accounts Payable > Payments > Pay Cycle Processing > Payment Selection Criteria
	Dim PayCycle,appPaycycleStatus,flag,i,appVoucherCount
	            PayCycle=Split(GlobalDictionary("PayCycle"),";")
	            
	            'Navigate to Account Payable --> Payments --> payment processing -> Pay Cycle Manager
	            SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	                            
	            For i = 0 To ubound(paycycle) Step 1
	                            
	                            app_SearchSync()
	                            
	                            'open a paycycle
	                            ap_openApaycycle(paycycle(i))
	                            
	                            app_SearchSync()
	                          
	
	                            appPaycycleStatus=ap_getPayCycleStatus()
	                            flag=0
	                            If InStr(1,appPaycycleStatus,"Selected",1)<>0 Then
	                                            With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
	                                                            If .WebButton("PayCycle_Reset").Exist(nminwait) Then
	                                                                            .WebButton("PayCycle_Reset").Click
	                                                            End If
	                                            End With
	                                            If Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Exist(nminwait) Then
	                                            	appAlertMessage=Browser("PeopleSoft Browser").Page("PayCycleManager").WebElement("PayCycle_ResetAlertMessage").GetROProperty("innertext")
							Reporter.ReportEvent micPass,"The alert message","is present and displayed as"&appAlertMessage
							Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Click
	                                           End If
	                                            ap_refreshTillStatuschaged(appPaycycleStatus)
	                                            flag=1:Exit for
	                                            
	                                            ElseIf InStr(1,appPaycycleStatus,"completed",1)<>0 or InStr(1,appPaycycleStatus,"reset",1)<>0 or InStr(1,appPaycycleStatus,"No work",1)<>0 Then
	                                            If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").exist(nminwait) Then
	                                                            Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").Click
	                                            End If
	                                            flag=1:Exit for
	                                            ap_refreshTillStatuschaged(appPaycycleStatus)
	                                            flag=1:Exit for
	                                            
	                                                                           ElseIf InStr(1,appPaycycleStatus,"running",1)<>0 Then
	                                            ap_refreshTillStatuschaged(appPaycycleStatus)
	                                            If InStr(1,appPaycycleStatus,"Selected",1)<>0 Then
	                                                            With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
	                                                                            If .WebButton("PayCycle_Reset").Exist(nminwait) Then
	                                                                                            .WebButton("PayCycle_Reset").Click
	                                                                            End If
	                                                            End With
	                                                            wait(3)
	                                                            If Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Exist(nminwait) Then
	                                                                     appAlertMessage=Browser("PeopleSoft Browser").Page("PayCycleManager").WebElement("PayCycle_ResetAlertMessage").GetROProperty("innertext")
										Reporter.ReportEvent micPass,"The alert message","is present and displayed as"&appAlertMessage
	                                                                          Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Click
	                                                            End If
	                                                            ap_refreshTillStatuschaged(appPaycycleStatus)
	                                                            flag=1:Exit for
	                                            else
	                                                            Call WriteToReport(micDone,"Pay Cycle "&paycycle(i),"Pay Cycle "&paycycle(i)&" has "&appPaycycleStatus&" status, Moving to Next pay cycle" ,false)
	                                                            'return to the paycycle Manager search
	                                                            If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Exist(nminwait) Then
	                                                                            Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Click
	                                                            End If
	                                            End If
	                                            
	                                            
	                            else
	                                            Call WriteToReport(micDone,"Pay Cycle "&paycycle(i),"Pay Cycle "&paycycle(i)&" has "&appPaycycleStatus&" status, Moving to Next pay cycle" ,false)
	                                            'return to the paycycle Manager search
	                                            If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Exist(nminwait) Then
	                                                            Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Click
	                                            End If
	                            End If
	            Next
	      
	If flag Then
	                            With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
	                                            If .Link("PayCYcle_SelectionCriteria").Exist(nminwait) Then
	                                                            .Link("PayCYcle_SelectionCriteria").Click
	                                                            Call WriteToReport(micPass,"Selection Criteria link","is present and clicked",false)
	                                                            else
	                                                            Call WriteToReport(micFail,"Selection Criteria link","is not present",True)
	                                            End If
	                                         
	
	                            End With
	                                            'selection criteria added
	                                            call ap_paymentSelectionCritiriSaveDates(60,date+30)
	                                            app_SearchSync()
	                                            
	                            With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent")
	                                            If .Link("PayCycle_PayCycleManager").Exist(nminwait) Then
	                                                            .Link("PayCycle_PayCycleManager").Click
	                                                            Call WriteToReport(micPass,"PayCycle Manager link","is present and clicked",false)
	                                                            else
	                                                            Call WriteToReport(micFail,"PayCycle Manager link","is not present",True)
	                                            End If
	                            End With
	                            
	                            app_SearchSync()
	                            appPaycycleStatus=ap_getPayCycleStatus()
	                            
	                            With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
	                                            If .WebButton("PayCycle_Process").Exist(nminwait) Then
	                                            If .WebElement("PayCycle_StepName").Exist(nminwait) Then
	                                              Call WriteToReport(micPass,"Process step name"," Selected step name "&.WebElement("PayCycle_StepName").GetROProperty("innertext"),false)
	                                              End If
	                                               .WebButton("PayCycle_Process").Click
	                                                            
	                                               Call WriteToReport(micPass,"process button","is present and clicked",false)
	                                                  else
	                                               Call WriteToReport(micFail,"Process button","is not present",True)
	                                            End If
	                            End With
	                            
	                            ap_refreshTillStatuschaged(appPaycycleStatus)
	
	                            'validate the voucher count
	                            If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled").Exist(nminwait) Then
	                                            appVoucherCount=Trim(Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled").GetROProperty("innertext"))
	                                            Call WriteToReport(micPass,"Schedule Payments Selected","Schedule Payments Selected is captured from application, as "&appVoucherCount,false)
	                            End If
	                            
	                            appPaycycleStatus=ap_getPayCycleStatus()
	                            
	
	                            'CLickon Reset button
	                            With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCycle_Reset")
					If .Exist(nMINWAIT) Then
						.Click
						Reporter.ReportEvent micPass,"The Reset button","is presetna d clicekd"
					End If
					End  With 
					
					appAlertMessage=Browser("PeopleSoft Browser").Page("PayCycleManager").WebElement("PayCycle_ResetAlertMessage").GetROProperty("innertext")
					Reporter.ReportEvent micPass,"The alert message","is present and displayed as"&appAlertMessage
					
					If Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Exist(nminwait) Then
	                                    Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Click
	                                End If
	                                
	                                ap_refreshTillStatuschaged(appPaycycleStatus)
	
	
	                            'validate the voucher count
	                            If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled").Exist(nminwait) Then
	                                            appVoucherCount=Trim(Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled").GetROProperty("innertext"))
	                                            Call WriteToReport(micPass,"Schedule Payments Selected","Schedule Payments Selected is captured from application, as "&appVoucherCount,false)
	                            End If
					
	
	                            
	            else
	                            Call WriteToReport(micfail,"All the Pay Cycles are non executable status ","All the Pay Cycles are non executable status" ,false)
	            End If          
	                                          
	End  Function
	'*********************************************************************************************************************************
''' <summary>  
''' NoZeroPayments1()To Run PayCycle: No zero Payments
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "PayCycle, MainMenuSelection"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************

'4.1.9
'**********************************************

Public Function NoZeroPayments1()
	            Dim PayCycle,appPaycycleStatus,flag,i,appVoucherCount
	            PayCycle=Split(GlobalDictionary("PayCycle"),";")
	            
	            'Navigate to Account Payable --> Payments --> payment processing -> Pay Cycle Manager
	            SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	                            
	            For i = 0 To ubound(paycycle) Step 1
	                            
	                            app_SearchSync()
	                            
	                            'open a paycycle
	                            ap_openApaycycle(paycycle(i))
	                            
	                            app_SearchSync()
	                            
	                            appPaycycleStatus=ap_getPayCycleStatus()
	                            flag=0
	                            If InStr(1,appPaycycleStatus,"Selected",1)<>0 Then
	                                            With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
	                                                            If .WebButton("PayCycle_Reset").Exist(nminwait) Then
	                                                                            .WebButton("PayCycle_Reset").Click
	                                                            End If
	                                            End With
	                                            If Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Exist(nminwait) Then
	                                                            Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Click
	                                            End If
	                                            ap_refreshTillStatuschaged(appPaycycleStatus)
	                                            flag=1:Exit for
	                            ElseIf InStr(1,appPaycycleStatus,"running",1)<>0 Then
	                                            ap_refreshTillStatuschaged(appPaycycleStatus)
	                                            If InStr(1,appPaycycleStatus,"Selected",1)<>0 Then
	                                                            With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
	                                                                            If .WebButton("PayCycle_Reset").Exist(nminwait) Then
	                                                                                            .WebButton("PayCycle_Reset").Click
	                                                                            End If
	                                                            End With
	                                                            wait(3)
	                                                            If Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Exist(nminwait) Then
	                                                                            Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Click
	                                                            End If
	                                                            ap_refreshTillStatuschaged(appPaycycleStatus)
	                                                            flag=1:Exit for
	                                            else
	                                                            Call WriteToReport(micDone,"Pay Cycle "&paycycle(i),"Pay Cycle "&paycycle(i)&" has "&appPaycycleStatus&" status, Moving to Next pay cycle" ,false)
	                                                            'return to the paycycle Manager search
	                                                            If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Exist(nminwait) Then
	                                                                            Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Click
	                                                            End If
	                                            End If
	                            ElseIf InStr(1,appPaycycleStatus,"completed",1)<>0 or InStr(1,appPaycycleStatus,"reset",1)<>0 or InStr(1,appPaycycleStatus,"No work",1)<>0 Then
	                                            If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").exist(nminwait) Then
	                                                            Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").Click
	                                            End If
	                                            flag=1:Exit for
	                            else
	                                            Call WriteToReport(micDone,"Pay Cycle "&paycycle(i),"Pay Cycle "&paycycle(i)&" has "&appPaycycleStatus&" status, Moving to Next pay cycle" ,false)
	                                            'return to the paycycle Manager search
	                                            If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Exist(nminwait) Then
	                                                            Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Click
	                                            End If
	                            End If
	            Next
	           

	            If flag Then
	                            With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
	                                            If .Link("PayCYcle_SelectionCriteria").Exist(nminwait) Then
	                                                            .Link("PayCYcle_SelectionCriteria").Click
	                                                            Call WriteToReport(micPass,"Selection Criteria link","is present and clicked",false)
	                                                            else
	                                                            Call WriteToReport(micFail,"Selection Criteria link","is not present",True)
	                                            End If
	                                            
	                            End With
	                                            'selection criteria added
	                                            call ap_paymentSelectionCritiriSaveDates(60,date+30)
	                                            app_SearchSync()
	                                            
	                            With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent")
	                                            If .Link("PayCycle_PayCycleManager").Exist(nminwait) Then
	                                                            .Link("PayCycle_PayCycleManager").Click
	                                                            Call WriteToReport(micPass,"PayCycle Manager link","is present and clicked",false)
	                                                            else
	                                                            Call WriteToReport(micFail,"PayCycle Manager link","is not present",True)
	                                            End If
	                            End With
	                            
	                            app_SearchSync()
	                            appPaycycleStatus=ap_getPayCycleStatus()
	                            
	                            With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
	                                            If .WebButton("PayCycle_Process").Exist(nminwait) Then
	                                                 If .WebElement("PayCycle_StepName").Exist(nminwait) Then
	                                                        Call WriteToReport(micPass,"Process step name"," Selected step name "&.WebElement("PayCycle_StepName").GetROProperty("innertext"),false)
	                                                End If
	                                                    .WebButton("PayCycle_Process").Click
	                                                       
	                                                    Call WriteToReport(micPass,"process button","is present and clicked",false)
	                                                    else
	                                                    Call WriteToReport(micFail,"Process button","is not present",True)
	                                            End If
	                            End With
	                            
	                            ap_refreshTillStatuschaged(appPaycycleStatus)
	

	                            'validate the voucher count
	                            If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled").Exist(nminwait) Then
	                                            appVoucherCount=Trim(Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled").GetROProperty("innertext"))
	                                            Call WriteToReport(micPass,"Schedule Payments Selected","Schedule Payments Selected is captured from application, as "&appVoucherCount,false)
	                            End If
	
	                            
	            else
	                            Call WriteToReport(micfail,"All the Pay Cycles are non executable status ","All the Pay Cycles are non executable status" ,false)
	            End If
	            
	            'Check for the dstatus and no of Records
	            With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCYcle_Status")
	            If .Exist(nMINWAIT) Then
	            	If .GetROProperty("innertext")="Selected" Then
	            		appNoOfRows=Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled").GetROProperty("innertext")
	            	End If
	            End If
	            End  With 
	            
	            'Check if the row count is more than 5
	            If appNoOfRows>5 Then
	            	With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_Details")
				If .Exist(nMINWAIT) Then
					.Click
				End If
			End  WIth 
			End  If 
				
			'CLickon Searcbh button
			With Browser("PeopleSoft Browser").Page("DetailData").PSFrame("DetailsData").WebButton("DetailsData_Search")
			If .Exist(nMINWAIT) Then
				.Click
			End If
			End  With 
			
			'wait till buttons are enabled
			While Browser("PeopleSoft Browser").Page("DetailData").PSFrame("DetailsData").WebButton("DetailsData_ExcludeAll").GetROProperty("disabled")=1 or nCount>500
							
			'wait for the ojects to get loaded
			app_SearchSync()	
	
			nCount=nCount+1
			Wend
			
			'CLickon Exclude all button
			With Browser("PeopleSoft Browser").Page("DetailData").PSFrame("DetailsData").WebButton("DetailsData_ExcludeAll")
			If .Exist(nMINWAIT) Then
				.Click
			End If
			End  With
	
			'wait for the ojects to get loaded
			app_SearchSync()	
			
			'dtPaymentAction=GlobalDictionary("PaymentAction")
			'Get the details froim the tab;e
			With Browser("PeopleSoft Browser").Page("DetailData").PSFrame("DetailsData").WebTable("DetailsData_SearchTablle")
			If .Exist(nMINWAIT) Then
			If .RowCount>2 Then
				rc=2
				Else
				rc=.RowCount
			End If
			For i = 1 To rc Step 1
				ReDim Preserve BU(i-1):BU(i-1)=Browser("PeopleSoft Browser").Page("DetailData").PSFrame("DetailsData").WebTable("DetailsData_SearchTablle").GetCellData(i,4)
	                       ReDim Preserve Vid(i-1):Vid(i-1)=Browser("PeopleSoft Browser").Page("DetailData").PSFrame("DetailsData").WebTable("DetailsData_SearchTablle").GetCellData(i,5)
			If (i mod 2) Then
				strSelection="Separate"
				else:strSelection="None"
			End If
			Browser("PeopleSoft Browser").Page("DetailData").PSFrame("DetailsData").WebTable("DetailsData_SearchTablle").ChildItem(i,1,"WebList",0).select(strSelection)
			Next
			End  If
				
				
			End  With 	
		
	With Browser("PeopleSoft Browser").Page("DetailData").PSFrame("DetailsData").WebButton("DetailsData_Save")
	If .Exist(nMINWAIT) Then
	.Click
	End If		
	End  With 		
	 
	
	'Wait for the app to sync
	For i=0 to 25
		app_SearchSync()
	Next
	
	'CLickon Pay CYcle manager
	With Browser("PeopleSoft Browser").Page("DetailData").PSFrame("DetailsData").Link("DetailData_PayCYcleManager")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With
	
	'Get the no of rows selected
	With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled")
	If .Exist(nMINWAIT) Then
	appNoOfRows=.GetROProperty("innertext")
	End If
	End  With 
	
	'Get the status
	appPaycycleStatus=ap_getPayCycleStatus()
	
	'GEt th estap name and clickon Process button
	With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
	    If .WebButton("PayCycle_Process").Exist(nminwait) Then
	    If .WebElement("PayCycle_StepName").Exist(nminwait) Then
           Call WriteToReport(micPass,"Process step name"," Selected step name "&.WebElement("PayCycle_StepName").GetROProperty("innertext"),false)
           End If
         .WebButton("PayCycle_Process").Click
	     	  
	         Call WriteToReport(micPass,"process button","is present and clicked",false)
	             else
	 Call WriteToReport(micFail,"Process button","is not present",True)
	        End If
	        End With
	                            
	        ap_refreshTillStatuschaged(appPaycycleStatus)
	

	        'validate the voucher count
	        If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled").Exist(nminwait) Then
	                appVoucherCount=Trim(Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled").GetROProperty("innertext"))
	        Call WriteToReport(micPass,"Schedule Payments Selected","Schedule Payments Selected is captured from application, as "&appVoucherCount,false)
	        End If
	        
	        'GEt the Status
	       With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCYcle_Status")
	       If .Exist(nMINWAIT) Then
	       	appStatus=.GetROProperty("innertext")
	       	Reporter.ReportEvent micPass,"The Number of row selected is","is"&appStatus
	       End If
	       End  With 
	       
	       'Clickon Summary link
	       With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_Summary")
	       If .Exist(nMINWAIT) Then
	       	.Click
	       End If
	       End  WIth 
	       
	       'Check for the scheduled payments
	       With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebTable("Paycycle_PayCycleSummary")
		If .Exist(nMINWAIT) Then
		appSchdPayments=.GetCellData(1,3)
		Reporter.ReportEvent micPass,"The scheduled payments is","is"&appSchdPayments
		End If
		appGrossAmount=.GetCellData(1,5)
		Reporter.ReportEvent micPass,"The gorss amount is","is"&appGrossAmount
		appDIscountAmount=.GetCellData(1,6)
		Reporter.ReportEvent micPass,"The discount amout is","is"&appDIscountAmount
		End  With 
		
		'CLick on Pay cycle manahger l;ink
		With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_PayCYcleManager")
		If .Exist(nMINWAIT) Then
			.Click
		End If
		End  WIth 
		
		'CLick on Details link
		With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_Details")
		If .Exist(nMINWAIT) Then
			.Click
		End If
		End  WIth 
		
		'Click on Searh button
		With Browser("PeopleSoft Browser").Page("DetailData").PSFrame("DetailsData").WebButton("DetailsData_Search")
		If .Exist(nMINWAIT) Then
			.Click
		End If
		End  With 
		
		'Count the total
		With Browser("PeopleSoft Browser").Page("DetailData").PSFrame("DetailsData").WebTable("DetailsData_SearchTablle")
		If .Exist(nMINWAIT) Then
			appRowCount=.RowCount
			If instr(1,appRowCount,appSchdPayments)>0 Then
				Reporter.ReportEvent micPass,"The number of payments in the details","tab matches"
			End If
		End If
		End  With 
		
		With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCYcle_TotalGrossAmount")
		If .Exist(nMINWAIT) Then
			appGrossAmountDetails=.GetROProperty("innertext")
			If appGrossAmountDetails=appGrossAmount Then
				Reporter.ReportEvent micPass,"The amout is matching","in details tab"
			End If
		End If
		End  With 
	

	'CLick on Pay cycle manager
	With Browser("PeopleSoft Browser").Page("DetailData").PSFrame("DetailsData").Link("DetailData_PayCYcleManager")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  WIth 
	
	appPaycycleStatus=ap_getPayCycleStatus()
	
	'CLickon Process button in the Financial gatewayts
	With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebTable("PayCYcle_PayCycleResults")
	If .Exist(nMINWAIT) Then
		For i=1 to .RowCount
			appDesc=.GetCellData(i,2)
			If appDesc="Financial Gateway Electronic Payments" Then
				Set oProcessBtn=.ChildItem(i,1,"WebButton",0)
				IF oProcessBtn.exist(nMINWAIT) Then
				oProcessBtn.click
				Exit For
				End  If
			End If
		Next
	End If
	End  WIth 
	
	ap_refreshTillStatuschaged(appPaycycleStatus)
	
	'GEt the status and number of payments
	With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCYcle_Status")
	If .Exist(nMINWAIT) Then
		appStatus=.GetROProperty("innertext")
		Reporter.ReportEvent micPass,"The current status","is"&appStatus
	End If
	End  WIth 
	
	With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebElement("PayCycle_PaymentScheduled")
		If .Exist(nMINWAIT) Then
		appCount=.GetROProperty("innertext")
		Reporter.ReportEvent micPass,"The current payment scheduled is","is"&appCount
	End If
	End  WIth 
	
	End Function


'*********************************************************************************************************************************
''' <summary>  
''' pOInbound() 
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "strSQL, connectionString,businessUnit, sheetName,pOID"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_08_01_01- PO Inbound
Public Function pOInbound()
	Dim strSQL, connectionString,businessUnit, sheetName,pOID
	businessUnit=GlobalDictionary("businessUnit")
	sheetName=GlobalDictionary("sheetName")
	
	connectionString = "Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
	

	'strSQL= "SELECT TOP 10 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN'"
	strSQL= "SELECT Top 2 BUSINESS_UNIT,PO_ID,PO_DT,PO_REF,VENDOR_ID,PYMNT_TERMS_CD,BUYER_ID FROM PS_PO_HDR A WHERE BUSINESS_UNIT = '"&businessUnit&"' AND PO_ID IN (SELECT PO_STG_ID FROM PS_CDW_PO_HDR_STG B WHERE CDW_BATCH_ID IN (SELECT TOP 10 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN'))"
'	strSQL= "SELECT Top 2 * FROM  PS_CDW_PO_HDR_STG WHERE BUSINESS_UNIT = '"&businessUnit&"' AND PO_STG_ID IN (SELECT PO_STG_ID FROM PS_CDW_PO_HDR_STG B WHERE CDW_BATCH_ID IN (SELECT TOP 10 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN'))"
'	strSQL= "SELECT Top 2 * FROM  PS_CDW_PO_ITM_STG WHERE BUSINESS_UNIT = '"&businessUnit&"' AND PO_STG_ID IN (SELECT PO_STG_ID FROM PS_CDW_PO_HDR_STG B WHERE CDW_BATCH_ID IN (SELECT TOP 10 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN'))"

	If dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
		Call WriteToReport(micPass,"DB records ","SQL query["&strSQL&"] executed sucessfully " ,false)
		'Navigate to eProcurement --> Buyer Center --> Manage Purchase Orders
		SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		On error resume next
		pOID=DataTable.Value("PO_STG_ID",sheetName)
		If err.number<>0 Then
			pOID=DataTable.Value("PO_ID",sheetName)
			err.clear
		End If
		On error goto 0
		With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders")
			If .WebButton("Clear").Exist(nminwait) Then
				.WebButton("Clear").Click
				Call WriteToReport(micPass,"Clear button ","Clear button is present and clicked sucessfully " ,false)
			else
				Call WriteToReport(micFail,"Clear button","Clear button is not present " ,false)
			End If
			If .WebEdit("BusinessUnit").Exist(nminwait) Then
				.WebEdit("BusinessUnit").Set businessUnit
				Call WriteToReport(micPass,"BusinessUnit ","BusinessUnit text box is present and enter as "&businessUnit ,false)
			else
				Call WriteToReport(micFail,"BusinessUnit","BusinessUnit is not present " ,false)
			End If
			If .WebEdit("POID").Exist(nminwait) Then
				.WebEdit("POID").Set pOID
				Call WriteToReport(micPass,"PO ID ","PO ID text box is present and enter as "&pOID ,false)
			else
				Call WriteToReport(micFail,"PO ID","PO ID is not present " ,false)
			End If
			If .WebButton("Search").Exist(nminwait) Then
				.WebButton("Search").Click
				Call WriteToReport(micPass,"Search button ","Search button is present and clicked sucessfully " ,false)
			else
				Call WriteToReport(micFail,"Search button","Search button is not present " ,false)
			End If
		End With
			app_searchSync()
			If Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebTable("Searchresults").Exist(nminwait) Then
				If StrComp(Trim(Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebTable("Searchresults").GetCellData(1,1)),Trim(pOID),1)=0 Then
					Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebTable("Searchresults").ChildItem(1,1,"Link",0).click
					Call WriteToReport(micPass,"Click on the PO ID in Saerch results : "&pOID,"Clicked on the PO ID in the search results " ,false)
				End If
			End If
			app_searchSync()
			
			With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder")
				If .WebElement("Businessunit").Exist(nminwait) Then
					If StrComp(Trim(.WebElement("Businessunit").GetROProperty("innertext")),Trim(DataTable.Value("BUSINESS_UNIT",sheetName)),1)=0 Then
						Call WriteToReport(micPass,"Businessunit field ","Businessunit is present and matched sucessfully with DB data " &Trim(DataTable.Value("BUSINESS_UNIT",sheetName)),false)
					else
						Call WriteToReport(micFail,"Businessunit field","Businessunit is not matched with DB data" ,TRUE)
					End If
				else
					Call WriteToReport(micFail,"Businessunit field","Businessunit field is not present " ,TRUE)
				End If
				If .WebElement("PO_ID").Exist(nminwait) Then
					If StrComp(Trim(.WebElement("PO_ID").GetROProperty("innertext")),Trim(pOID),1)=0 Then
						Call WriteToReport(micPass,"PO_ID field ","PO_ID is present and matched sucessfully with DB data "&pOID ,false)
					else
						Call WriteToReport(micFail,"PO_ID field","PO_ID is not matched with DB data" ,TRUE)
					End If
				else
					Call WriteToReport(micFail,"PO_ID field","PO_ID field is not present " ,TRUE)
				End If
				If .WebEdit("Vendor_ID").Exist(nminwait) Then
					If StrComp(Trim(.WebEdit("Vendor_ID").GetROProperty("value")),Trim(DataTable.Value("VENDOR_ID",sheetName)),1)=0 Then
						Call WriteToReport(micPass,"Supplier ID field ","Supplier ID is present and matched sucessfully with DB data "&DataTable.Value("VENDOR_ID",sheetName) ,false)
					else
						Call WriteToReport(micFail,"Supplier ID field","Supplier ID is not matched with DB data" ,TRUE)
					End If
				else
					Call WriteToReport(micFail,"Supplier ID field","Supplier ID field is not present " ,TRUE)
				End If
				If .WebEdit("BUYER_ID").Exist(nminwait) Then
					If StrComp(Trim(.WebEdit("BUYER_ID").GetROProperty("value")),Trim(DataTable.Value("BUYER_ID",sheetName)),1)=0 Then
						Call WriteToReport(micPass,"BUYER_ID field ","BUYER ID is present and matched sucessfully with DB data "&DataTable.Value("BUYER_ID",sheetName) ,false)
					else
						Call WriteToReport(micFail,"BUYER ID field","BUYER ID is not matched with DB data" ,TRUE)
					End If
				else
					Call WriteToReport(micFail,"BUYER ID field","BUYER ID field is not present " ,TRUE)
				End If
				If .WebEdit("PO_REF").Exist(nminwait) Then
					If StrComp(Trim(.WebEdit("PO_REF").GetROProperty("value")),Trim(DataTable.Value("PO_REF",sheetName)),1)=0 Then
						Call WriteToReport(micPass,"PO Reference field ","PO Reference is present and matched sucessfully with DB data "&DataTable.Value("PO_REF",sheetName) ,false)
					else
						Call WriteToReport(micFail,"PO Reference field","PO Reference is not matched with DB data" ,TRUE)
					End If
				else
					Call WriteToReport(micFail,"PO Reference field","PO Reference field is not present " ,TRUE)
				End If
				If .WebEdit("PO_Date").Exist(nminwait) Then
					If StrComp(CDATE(Trim(.WebEdit("PO_Date").GetROProperty("value"))),FormatdateTime(Trim(DataTable.Value("PO_DT",sheetName)),2),1)=0 Then
						Call WriteToReport(micPass,"PO Date field ","PO Date is present and matched sucessfully with DB data "&FormatdateTime(Trim(DataTable.Value("PO_DT",sheetName)),2) ,false)
					else
						Call WriteToReport(micFail,"PO Date field","PO Date is not matched with DB data. Appliation date "&CDATE(.WebEdit("PO_Date").GetROProperty("value"))&" DB Data"& FormatdateTime(Trim(DataTable.Value("PO_DT",sheetName))) ,TRUE)
					End If
				else
					Call WriteToReport(micFail,"PO Date field","PO Date field is not present " ,TRUE)
				End If
			End With

			
	End If
	
	
	
End Function

'*********************************************************************************************************************************
''' <summary>  
''' pOChangeInboundLineAdded() 
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "strSQL, connectionString,businessUnit, sheetName,pOID"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'AP_08_01_02a Unit Test Script- PO Change Inbound
Public Function pOChangeInboundLineAdded()
	Dim strSQL, connectionString,businessUnit, sheetName,pOID
	businessUnit=GlobalDictionary("businessUnit")
	sheetName=GlobalDictionary("sheetName")
	
	connectionString = "Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
	

'strSQL="SELECT * FROM PS_CDW_PO_LINE_EC WHERE PO_ID=(SELECT TOP 1 PO_ID FROM PS_CDW_PO_HDR_EC ) AND CDW_BATCH_ID=(SELECT TOP 1 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN')"
strSQL="SELECT BUSINESS_UNIT,PO_ID,LINE_NBR,INV_ITEM_ID,DESCR254_MIXED,UNIT_OF_MEASURE,MFG_ID,MFG_ITM_ID FROM PS_CDW_PO_LINE_EC WHERE PO_ID=(SELECT TOP 1 PO_ID FROM PS_CDW_PO_HDR_EC ) AND CDW_BATCH_ID=(SELECT TOP 1 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN')"

	If dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
		Call WriteToReport(micPass,"DB records fetched successfully","SQL query executed sucessfully ["&strSQL&"]" ,false)
		
'		strSQL="SELECT * FROM PS_CDW_PO_LNSHP_EC WHERE PO_ID=(SELECT TOP 1 PO_ID FROM PS_CDW_PO_HDR_EC ) AND CDW_BATCH_ID=(SELECT TOP 1 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN')"
		strSQL="SELECT CDW_BATCH_ID,PRICE_PO,DUE_DT,SHIPTO_ID,QTY_PO,MERCHANDISE_AMT FROM PS_CDW_PO_LNSHP_EC WHERE PO_ID=(SELECT TOP 1 PO_ID FROM PS_CDW_PO_HDR_EC ) AND CDW_BATCH_ID=(SELECT TOP 1 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN')"
		If dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
			Call WriteToReport(micPass,"DB records fetched successfully","SQL query executed sucessfully ["&strSQL&"]" ,false)
			'Navigate to eProcurement --> Buyer Center --> Manage Purchase Orders
			SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
			On error resume next
			pOID=DataTable.Value("PO_STG_ID",sheetName)
			If err.number<>0 Then
				pOID=DataTable.Value("PO_ID",sheetName)
				err.clear
			End If
			On error goto 0
			With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders")
				If .WebButton("Clear").Exist(nminwait) Then
					.WebButton("Clear").Click
					Call WriteToReport(micPass,"Clear button ","Clear button is present and clicked sucessfully " ,false)
				else
					Call WriteToReport(micFail,"Clear button","Clear button is not present " ,false)
				End If
				If .WebEdit("BusinessUnit").Exist(nminwait) Then
					.WebEdit("BusinessUnit").Set businessUnit
					Call WriteToReport(micPass,"BusinessUnit ","BusinessUnit text box is present and enter as "&businessUnit ,false)
				else
					Call WriteToReport(micFail,"BusinessUnit","BusinessUnit is not present " ,false)
				End If
				If .WebEdit("POID").Exist(nminwait) Then
					.WebEdit("POID").Set pOID
					Call WriteToReport(micPass,"PO ID ","PO ID text box is present and enter as "&pOID ,false)
				else
					Call WriteToReport(micFail,"PO ID","PO ID is not present " ,false)
				End If
				If .WebButton("Search").Exist(nminwait) Then
					.WebButton("Search").Click
					Call WriteToReport(micPass,"Search button ","Search button is present and clicked sucessfully " ,false)
				else
					Call WriteToReport(micFail,"Search button","Search button is not present " ,false)
				End If
			End With
				app_searchSync()
				If Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebTable("Searchresults").Exist(nminwait) Then
					If StrComp(Trim(Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebTable("Searchresults").GetCellData(1,1)),Trim(pOID),1)=0 Then
						Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebTable("Searchresults").ChildItem(1,1,"Link",0).click
						Call WriteToReport(micPass,"Click on the PO ID in Saerch results : "&pOID,"Clicked on the PO ID in the search results " ,false)
					End If
				End If
				app_searchSync()
				
				With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder")
					If .WebElement("Businessunit").Exist(nminwait) Then
						If StrComp(Trim(.WebElement("Businessunit").GetROProperty("innertext")),Trim(DataTable.Value("BUSINESS_UNIT",sheetName)),1)=0 Then
							Call WriteToReport(micPass,"Businessunit field ","Businessunit is present and matched sucessfully with DB data " ,false)
						else
							Call WriteToReport(micFail,"Businessunit field","Businessunit is not matched with DB data" ,TRUE)
						End If
					else
						Call WriteToReport(micFail,"Businessunit field","Businessunit field is not present " ,TRUE)
					End If
					If .WebElement("PO_ID").Exist(nminwait) Then
						If StrComp(Trim(.WebElement("PO_ID").GetROProperty("innertext")),Trim(pOID),1)=0 Then
							Call WriteToReport(micPass,"PO_ID field ","PO_ID is present and matched sucessfully with DB data " ,false)
						else
							Call WriteToReport(micFail,"PO_ID field","PO_ID is not matched with DB data" ,TRUE)
						End If
					else
						Call WriteToReport(micFail,"PO_ID field","PO_ID field is not present " ,TRUE)
					End If
				End With

				Dim appRC1, appRC2, datasRC,objTable,i,strdata
				
				If Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesLeft3").Exist(nminwait) AND Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesRight12").Exist(nminwait) Then
					appRC1=Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesLeft3").RowCount
					appRC2=Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesRight12").RowCount
					Set objTable=DataTable.GetSheet(sheetName)
					datasRC=objTable.GetRowCount
					If (datasRC=appRC1) AND (datasRC=appRC2)Then
						For i = 1 To datasRC Step 1
							objTable.SetCurrentRow(i)
							'Details tab - rows validations
							'Line number validation
							Call WriteToReport(micDone,"Row validation "&i,"row data validation starts" ,TRUE)
							strdata=Trim(Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesLeft3").GetCellData(i,1))
							If StrComp(strdata,Trim(DataTable.Value("LINE_NBR",sheetName)),1)=0 Then
								Call WriteToReport(micPass,"Line Numebr matched ","Line number in row ("&i&") is present and matched sucessfully with DB data "&strdata ,false)
							else
								Call WriteToReport(micFail,"Line number doesn't Matched","Line number is not matched with DB data in row ("&i&") application data "&strdata &" and DB data is "&Trim(DataTable.Value("LINE_NBR",sheetName)) ,TRUE)
							End If
							
							'Item number 
							strdata=Trim(Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesLeft3").GetCellData(i,3))
							If StrComp(strdata,Trim(DataTable.Value("INV_ITEM_ID",sheetName)),1)=0 Then
								Call WriteToReport(micPass,"Item Numebr matched ","Item number in row ("&i&") is present and matched sucessfully with DB data "&strdata ,false)
							else
								Call WriteToReport(micFail,"Item number doesn't Matched","Item number is not matched with DB data in row ("&i&") application data "&strdata &" and DB data is "&Trim(DataTable.Value("INV_ITEM_ID",sheetName)) ,TRUE)
							End If
							
							'Item description 
							strdata=Trim(Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesLeft3").GetCellData(i,4))
							If StrComp(strdata,Trim(DataTable.Value("DESCR254_MIXED",sheetName)),1)=0 Then
								Call WriteToReport(micPass,"description matched ","description in row ("&i&") is present and matched sucessfully with DB data "&strdata ,false)
							else
								Call WriteToReport(micFail,"description doesn't Matched","description is not matched with DB data in row ("&i&") application data "&strdata &" and DB data is "&Trim(DataTable.Value("DESCR254_MIXED",sheetName)) ,TRUE)
							End If
							
							'PO Qty validation
							strdata=Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesRight12").childitem(i,2,"WebEdit",0).getroproperty("value")
							If StrComp(cdbl(strdata),cdbl(Trim(DataTable.Value("QTY_PO",sheetName))),1)=0 Then
								Call WriteToReport(micPass,"QTY_PO matched ","QTY_PO in row ("&i&") is present and matched sucessfully with DB data "&strdata ,false)
							else
								Call WriteToReport(micFail,"QTY_PO doesn't Matched","QTY_PO is not matched with DB data in row ("&i&") application data "&strdata &" and DB data is "&Trim(DataTable.Value("QTY_PO",sheetName)) ,TRUE)
							End If
							
							'Price validation
							strdata=Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesRight12").childitem(i,5,"WebEdit",0).getroproperty("value")
							If StrComp(cdbl(strdata),cdbl(Trim(DataTable.Value("PRICE_PO",sheetName))),1)=0 Then
								Call WriteToReport(micPass,"PRICE_PO matched ","PRICE_PO in row ("&i&") is present and matched sucessfully with DB data "&strdata ,false)
							else
								Call WriteToReport(micFail,"PRICE_PO doesn't Matched","PRICE_POr is not matched with DB data in row ("&i&") application data "&strdata &" and DB data is "&Trim(DataTable.Value("PRICE_PO",sheetName)) ,TRUE)
							End If
							
							'UOM validation
							strdata=Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesRight12").GetCellData(i,3)
							If StrComp((strdata),(Trim(DataTable.Value("UNIT_OF_MEASURE",sheetName))),1)=0 Then
								Call WriteToReport(micPass,"UOM matched ","UOM in row ("&i&") is present and matched sucessfully with DB data "&strdata ,false)
							else
								Call WriteToReport(micFail,"UOM doesn't Matched","UOM is not matched with DB data in row ("&i&") application data "&strdata &" and DB data is "&Trim(DataTable.Value("UNIT_OF_MEASURE",sheetName)) ,TRUE)
							End If
						Next
					else
						Call WriteToReport(micFail,"Lines details rows mismatched","Lines details rows are mismatched, application row count "&appRC1&", DB row count "&datasRC ,TRUE)
					End If
				else
					Call WriteToReport(micFail,"Lines details","Lines details table is not present " ,TRUE)
				End If	
		End If	
	End If
	
	
	
End Function

'*********************************************************************************************************************************
''' <summary>  
''' InterfacePOChangeLineCancel() 
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "strSQL, connectionString,businessUnit, sheetName,pOID"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'8.1.2b

'AP_08_01_02b Unit Test Script- PO Change Inbound
Public Function InterfacePOChangeLineCancel()
	Dim strSQL, connectionString,businessUnit, sheetName,pOID
	businessUnit=GlobalDictionary("businessUnit")
	sheetName=GlobalDictionary("sheetName")
	
	connectionString = "Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
	

'strSQL="SELECT * FROM PS_CDW_PO_LINE_EC WHERE PO_ID=(SELECT TOP 1 PO_ID FROM PS_CDW_PO_HDR_EC ) AND CDW_BATCH_ID=(SELECT TOP 1 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN')"
strSQL="SELECT BUSINESS_UNIT,PO_ID,LINE_NBR,INV_ITEM_ID,DESCR254_MIXED,UNIT_OF_MEASURE,MFG_ID,MFG_ITM_ID FROM PS_CDW_PO_LINE_EC WHERE PO_ID=(SELECT TOP 1 PO_ID FROM PS_CDW_PO_HDR_EC ) AND CDW_BATCH_ID=(SELECT TOP 1 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN')"

	If dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
		Call WriteToReport(micPass,"DB records fetched successfully","SQL query executed sucessfully ["&strSQL&"]" ,false)
		
'		strSQL="SELECT * FROM PS_CDW_PO_LNSHP_EC WHERE PO_ID=(SELECT TOP 1 PO_ID FROM PS_CDW_PO_HDR_EC ) AND CDW_BATCH_ID=(SELECT TOP 1 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN')"
		strSQL="SELECT CDW_BATCH_ID,PRICE_PO,DUE_DT,SHIPTO_ID,QTY_PO,MERCHANDISE_AMT FROM PS_CDW_PO_LNSHP_EC WHERE PO_ID=(SELECT TOP 1 PO_ID FROM PS_CDW_PO_HDR_EC ) AND CDW_BATCH_ID=(SELECT TOP 1 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN')"
		If dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
			Call WriteToReport(micPass,"DB records fetched successfully","SQL query executed sucessfully ["&strSQL&"]" ,false)
			'Navigate to eProcurement --> Buyer Center --> Manage Purchase Orders
			SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
			On error resume next
			pOID=DataTable.Value("PO_STG_ID",sheetName)
			If err.number<>0 Then
				pOID=DataTable.Value("PO_ID",sheetName)
				err.clear
			End If
			On error goto 0
			With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders")
				If .WebButton("Clear").Exist(nminwait) Then
					.WebButton("Clear").Click
					Call WriteToReport(micPass,"Clear button ","Clear button is present and clicked sucessfully " ,false)
				else
					Call WriteToReport(micFail,"Clear button","Clear button is not present " ,false)
				End If
				If .WebEdit("BusinessUnit").Exist(nminwait) Then
					.WebEdit("BusinessUnit").Set businessUnit
					Call WriteToReport(micPass,"BusinessUnit ","BusinessUnit text box is present and enter as "&businessUnit ,false)
				else
					Call WriteToReport(micFail,"BusinessUnit","BusinessUnit is not present " ,false)
				End If
				If .WebEdit("POID").Exist(nminwait) Then
					.WebEdit("POID").Set pOID
					Call WriteToReport(micPass,"PO ID ","PO ID text box is present and enter as "&pOID ,false)
				else
					Call WriteToReport(micFail,"PO ID","PO ID is not present " ,false)
				End If
				If .WebButton("Search").Exist(nminwait) Then
					.WebButton("Search").Click
					Call WriteToReport(micPass,"Search button ","Search button is present and clicked sucessfully " ,false)
				else
					Call WriteToReport(micFail,"Search button","Search button is not present " ,false)
				End If
			End With
				app_searchSync()
				If Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebTable("Searchresults").Exist(nminwait) Then
					If StrComp(Trim(Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebTable("Searchresults").GetCellData(1,1)),Trim(pOID),1)=0 Then
						Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("ManagePurchaseOrders").WebTable("Searchresults").ChildItem(1,1,"Link",0).click
						Call WriteToReport(micPass,"Click on the PO ID in Saerch results : "&pOID,"Clicked on the PO ID in the search results " ,false)
					End If
				End If
				app_searchSync()
				
				With Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder")
					If .WebElement("Businessunit").Exist(nminwait) Then
						If StrComp(Trim(.WebElement("Businessunit").GetROProperty("innertext")),Trim(DataTable.Value("BUSINESS_UNIT",sheetName)),1)=0 Then
							Call WriteToReport(micPass,"Businessunit field ","Businessunit is present and matched sucessfully with DB data " ,false)
						else
							Call WriteToReport(micFail,"Businessunit field","Businessunit is not matched with DB data" ,TRUE)
						End If
					else
						Call WriteToReport(micFail,"Businessunit field","Businessunit field is not present " ,TRUE)
					End If
					If .WebElement("PO_ID").Exist(nminwait) Then
						If StrComp(Trim(.WebElement("PO_ID").GetROProperty("innertext")),Trim(pOID),1)=0 Then
							Call WriteToReport(micPass,"PO_ID field ","PO_ID is present and matched sucessfully with DB data " ,false)
						else
							Call WriteToReport(micFail,"PO_ID field","PO_ID is not matched with DB data" ,TRUE)
						End If
					else
						Call WriteToReport(micFail,"PO_ID field","PO_ID field is not present " ,TRUE)
					End If
				End With

				Dim appRC1, appRC2, datasRC,objTable,i,strdata
				
				If Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesLeft3").Exist(nminwait) AND Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesRight12").Exist(nminwait) Then
					appRC1=Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesLeft3").RowCount
					appRC2=Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesRight12").RowCount
					Set objTable=DataTable.GetSheet(sheetName)
					datasRC=objTable.GetRowCount
					If (datasRC=appRC1) AND (datasRC=appRC2)Then
						For i = 1 To datasRC Step 1
							objTable.SetCurrentRow(i)
							'Details tab - rows validations
							'Line number validation
							Call WriteToReport(micDone,"Row validation "&i,"row data validation starts" ,TRUE)
							strdata=Trim(Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesLeft3").GetCellData(i,1))
							If StrComp(strdata,Trim(DataTable.Value("LINE_NBR",sheetName)),1)=0 Then
								Call WriteToReport(micPass,"Line Numebr matched ","Line number in row ("&i&") is present and matched sucessfully with DB data "&strdata ,false)
							else
								Call WriteToReport(micFail,"Line number doesn't Matched","Line number is not matched with DB data in row ("&i&") application data "&strdata &" and DB data is "&Trim(DataTable.Value("LINE_NBR",sheetName)) ,TRUE)
							End If
							
							'Item number 
							strdata=Trim(Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesLeft3").GetCellData(i,3))
							If StrComp(strdata,Trim(DataTable.Value("INV_ITEM_ID",sheetName)),1)=0 Then
								Call WriteToReport(micPass,"Item Numebr matched ","Item number in row ("&i&") is present and matched sucessfully with DB data "&strdata ,false)
							else
								Call WriteToReport(micFail,"Item number doesn't Matched","Item number is not matched with DB data in row ("&i&") application data "&strdata &" and DB data is "&Trim(DataTable.Value("INV_ITEM_ID",sheetName)) ,TRUE)
							End If
							
							'Item description 
							strdata=Trim(Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesLeft3").GetCellData(i,4))
							If StrComp(strdata,Trim(DataTable.Value("DESCR254_MIXED",sheetName)),1)=0 Then
								Call WriteToReport(micPass,"description matched ","description in row ("&i&") is present and matched sucessfully with DB data "&strdata ,false)
							else
								Call WriteToReport(micFail,"description doesn't Matched","description is not matched with DB data in row ("&i&") application data "&strdata &" and DB data is "&Trim(DataTable.Value("DESCR254_MIXED",sheetName)) ,TRUE)
							End If
							
							'PO Qty validation
							strdata=Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesRight12").childitem(i,2,"WebEdit",0).getroproperty("value")
							If StrComp(cdbl(strdata),cdbl(Trim(DataTable.Value("QTY_PO",sheetName))),1)=0 Then
								Call WriteToReport(micPass,"QTY_PO matched ","QTY_PO in row ("&i&") is present and matched sucessfully with DB data "&strdata ,false)
							else
								Call WriteToReport(micFail,"QTY_PO doesn't Matched","QTY_PO is not matched with DB data in row ("&i&") application data "&strdata &" and DB data is "&Trim(DataTable.Value("QTY_PO",sheetName)) ,TRUE)
							End If
							
							'Price validation
							strdata=Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesRight12").childitem(i,5,"WebEdit",0).getroproperty("value")
							If StrComp(cdbl(strdata),cdbl(Trim(DataTable.Value("PRICE_PO",sheetName))),1)=0 Then
								Call WriteToReport(micPass,"PRICE_PO matched ","PRICE_PO in row ("&i&") is present and matched sucessfully with DB data "&strdata ,false)
							else
								Call WriteToReport(micFail,"PRICE_PO doesn't Matched","PRICE_POr is not matched with DB data in row ("&i&") application data "&strdata &" and DB data is "&Trim(DataTable.Value("PRICE_PO",sheetName)) ,TRUE)
							End If
							
							'UOM validation
							strdata=Browser("PeopleSoft Browser").Page("ManagePurchaseOrders").PSFrame("MaintainPurchaseOrder").WebTable("LinesRight12").GetCellData(i,3)
							If StrComp((strdata),(Trim(DataTable.Value("UNIT_OF_MEASURE",sheetName))),1)=0 Then
								Call WriteToReport(micPass,"UOM matched ","UOM in row ("&i&") is present and matched sucessfully with DB data "&strdata ,false)
							else
								Call WriteToReport(micFail,"UOM doesn't Matched","UOM is not matched with DB data in row ("&i&") application data "&strdata &" and DB data is "&Trim(DataTable.Value("UNIT_OF_MEASURE",sheetName)) ,TRUE)
							End If
						Next
					else
						Call WriteToReport(micFail,"Lines details rows mismatched","Lines details rows are mismatched, application row count "&appRC1&", DB row count "&datasRC ,TRUE)
					End If
				else
					Call WriteToReport(micFail,"Lines details","Lines details table is not present " ,TRUE)
				End If	
		End If	
	End If
	
	
	
End Function

'*****************************************************************
'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'8.1.4

'Test case 8.1.4 Voucher Inbound

Public Function VoucherInboundQuery()
'strSQL=Trim(GlobalDictionary("strSQL"))
strSQL="SELECT TOP 10 CDW_BATCH_ID,BUSINESS_UNIT,VOUCHER_ID,INVOICE_ID,INVOICE_DT,VENDOR_ID,ACCOUNTING_DT,GROSS_AMT,PYMNT_TERMS_CD,MATCH_ACTION,PO_ID FROM  PS_CDW_VCHR_HDR_ST WHERE CDW_BATCH_ID = (SELECT TOP 1 CDW_BATCH_ID FROM PS_CDW_VCHR_HDR_ST)"
'sConnectionString=Trim(GlobalDictionary("sConnectionString"))
sConnectionString="Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
sheetName=GlobalDictionary("sheetName")

Call dbGetSpecifiRecords(strSQL,sConnectionString,sheetName)

'wait for the ojects to get loaded
app_SearchSync()

'Printig the Queries
Reporter.ReportEvent micPass,"The Query Name","used for this script is"&strSQL
Reporter.ReportEvent micPass,"The Provider Name","used for this scriupt is"&sConnectionString

'Login to application to verifythe details
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
Set oTable=DataTable.GetSheet(sheetName)
For i=0 to oTable.GetRowCount
oTable.SetCurrentRow(i+1)
Call ap_openExistingInvoice(DataTable.Value("BUSINESS_UNIT",sheetName),DataTable.Value("INVOICE_ID",sheetName))


With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("Summary")
	If .Exist(nMINWAIT) Then
		Exit For
	End If
End With
Next

'Validate teh details in applciation
'Invoice Date
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("InvoiceDate")
If .Exist(nMINWAIT) Then
	appInvoiceDate=.GetROProperty("innertext")
	If instr(1,appInvoiceDate,DataTable.Value("INVOICE_DT",sheetName))>0 Then
		Reporter.ReportEvent micPass,"The Invoice Date is","Present and matched with"&appInvoiceDate
	End If
End If
End  With 

WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("TotalAmount")
If .Exist(nMINWAIT) Then
	appTotalAmount=.GetROProperty("innertext")
	If instr(1,cdbl(appTotalAmount),DataTable.Value("GROSS_AMT",sheetName))>0 Then
		Reporter.ReportEvent micPass,"The total amount is","is present and matched with"&appTotalAmount
	End If
End If
End  With 

'Clickon Invoice INformastion tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("InvoiceInformation")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'CHeck the Details in the Invoice Information tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID")
If .Exist(nMINWAIT) Then
	appSuppID=.GetROProperty("value")
	If instr(1,appSuppID,DataTable.Value("VENDOR_ID",sheetName))>0 Then
		Reporter.ReportEvent micPass,"The Vendor ID is present","and it is matching with Database and value is"&appSuppID
	End If
End If
End  With 

'Validate the pay terms
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PayTerms")
If .Exist(nMINWAIT) Then
	appPayTerms=.GetROProperty("value")
	If instr(1,appPayTerms,DataTable.Value("PYMNT_TERMS_CD",sheetName))>0 Then
		Reporter.ReportEvent micPass,"The appPayTerms is present","and it is matching with Database and value is"&appPayTerms
	End If
End If
End  With

'Validate the PO ID 
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PONUmber")
If .Exist(nMINWAIT) Then
	PONUmber=.GetROProperty("value")
	If instr(1,PONUmber,DataTable.Value("PO_ID",sheetName))>0 Then
		Reporter.ReportEvent micPass,"The appPayTerms is present","and it is matching with Database and value is"&PO_ID
	End If
End If
End  With
	
End Function

'*********************************************************************************************************************************
''' <summary>  
''' ap_openExistingInvoice() To pen existing invoice
'''Parameter1:	businessunit,InvoiceNumber.
''' <para>
''' <note>Required Testcase Inputs are "NA"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'********************************************************************************
'AP_openExisting Voucher
Public Function ap_openExistingInvoice(businessunit,InvoiceNumber)

		
		'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
		
		.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
		If .WebTabStrip("tabSelectionMain").Exist(nMINWAIT) Then
			.WebTabStrip("tabSelectionMain").Select("Find an Existing Value")
			Call WriteToReport(micPass,"Find an existing Value tab ","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Find an existing Value tab","is not present",True)
		End If
	
		.WebEdit("BusinessUnitFEV").WaitProperty "visible",True,20000
		If .WebEdit("BusinessUnitFEV").Exist(nMINWAIT) Then
			.WebEdit("BusinessUnitFEV").Set businessunit
			Call WriteToReport(micPass,"Business unit ","is present and entered as "&businessunit,false)
			else
			Call WriteToReport(micFail,"Business unit","is not present",True)
		End If

		
		If .WebEdit("FinExistingValue_InvoiceNumber").Exist(nMINWAIT) Then
			.WebEdit("FinExistingValue_InvoiceNumber").Set Trim(InvoiceNumber)
			Call WriteToReport(micPass,"Invoice Id ","is present and entered as "&InvoiceNumber,false)
			else
			Call WriteToReport(micFail,"Invoice Id","is not present",True)
		End If
		
		If .WebButton("Search").Exist(nMINWAIT) Then
			.WebButton("Search").Click
			Call WriteToReport(micPass,"Search button to Search the voucher","is present",false)
			else
			Call WriteToReport(micFail,"Search button to Search the voucher","is not present",True)
		End If
		
		'wait for the ojects to get loaded
		For i=0 to 4
			app_SearchSync()
		Next
		
	End with 	

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'*******************************************************************************************************************
Public Function DropShipPO()
'Create the Drop ship vouher
businessunit=(GlobalDictionary("businessunit"))
supplierID=(GlobalDictionary("supplierID"))

SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

 appVoucherID=ap_createVoucherWithCopyPO(businessunit,supplierID)
 
 
 'strSQL=Trim(GlobalDictionary("strSQL"))
strSQL="SELECT TOP 10 * FROM PS_CDW_DROP_SH_STG"
'sConnectionString=Trim(GlobalDictionary("sConnectionString"))
sConnectionString="Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
sheetName=GlobalDictionary("sheetName")

Call dbGetSpecifiRecords(strSQL,sConnectionString,sheetName)

'wait for the ojects to get loaded
app_SearchSync()

'Printig the Queries
Reporter.ReportEvent micPass,"The Query Name","used for this script is"&strSQL
Reporter.ReportEvent micPass,"The Provider Name","used for this scriupt is"&sConnectionString

Set oTable=DataTable.GetSheet(sheetName)
For i=0 to oTable.GetRowCount
oTable.SetCurrentRow(i+1)
If instr(1,Datatable.Value("VOUCHER_ID",sheetName),appVoucherID)>0 Then
	Reporter.ReportEvent micPass,"The Voucher ID created","is present"
	Exit For
End If
Next

i=0

'Validate whether only Drop ship PO are created
For i=0 to  oTable.GetRowCount
oTable.SetCurrentRow(i+1)
If DataTable.Value("PO_ID",sheetName)=" " Then
	Reporter.ReportEvent micFail,"All the values","present are not from Drop ship"
	Exit For
End If
Next

End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'*************************************************************************************************
'TC Name:-  5.1.3  Load Recycle Ran Delete
Public Function LoadRecycleRanDelete
'Navigate to Below page
'Accounts Payable -->Vouchers-->Maintain-->Voucher Mass Maintenace
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
appReqId=GlobalDictionary("appReqId") & RandomNumberGeneraionInvSupplier & Day(Date)
appDescription=GlobalDictionary("appDescription")
appActionName=GlobalDictionary("appActionName")

'ENter the Filie Name
'FileName=

'Set th efile name
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebEdit("VoucherMain_FileName")
If .Exist(nMINWAIT) Then
	.Set FileName
	Reporter.ReportEvent micPass,"The file naem set is","Is"&FileName
End If
End  With 

'Click on Load Voucher Button
WIth Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebButton("VoucherMain_LoadVouchers")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 


'wait for the ojects to get loaded
app_SearchSync()

'Count the Total Number of Vouchers present
WIth Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebTable("VoucherMaint_SearchResults")
If .Exist(nMINWAIT) Then
	appNoOfROws=.RowCount
	Reporter.ReportEvent micPass,"The total number of Vouchers","present in the Application is"&appNoOfROws
End If
End  With 

'Get the Vouchers NUmber to be selected and display vouchers
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebTable("VoucherMaint_SearchResults")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
		appVoucherID=.GetCellData(i,4)
		Reporter.ReportEvent micPass,"The voucher ID"," displayed are"&appVoucherID
	Next
End If
End  WIth 

'Click on Delete Button
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebButton("VoucherMaint_Delete")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'Wait for the Delete page to display

'wait for the ojects to get loaded
app_SearchSync()

'Set the req ID and Description
'appReqId
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMain_Delete").WebEdit("VoucherDelete_ReqID")
If .Exist(nMINWAIT) Then
	.Set appReqId
	Reporter.ReportEvent micPass,"The Request ID","given is"&appReqId
End If
End  With 

'Set the description
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMain_Delete").WebEdit("VoucherDel_Description")
If .Exist(nMINWAIT) Then
	.Set appDescription
	Reporter.ReportEvent micPass,"The Request ID","given is"&appDescription
End If
End  With 

'Select the action
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMain_Delete").WebList("VoucherDelete_ActionSelect")
If .Exist(nMINWAIT) Then
	.Select 1
	Reporter.ReportEvent micPass,"The action name","selected is"&.GetROProperty("value")
End If
End  With 

'CLick on RUn button
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMain_Delete").WebButton("VoucehrDel_Run")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Search for the Web table
While Not(Browser("PeopleSoft Browser NewTab").Page("MassMaintennce_ApplicationResult").WebTable("AppResult_SearchResults").Exist(nMINWAIT)) 
'wait for the objects to get loaded
app_SearchSync()
Wend

'Get the status
With Browser("PeopleSoft Browser NewTab").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_RunStatus")
If .Exist(nMINWAIT) Then
appRunStatus=Browser("PeopleSoft Browser NewTab").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_RunStatus").GetROProperty("innertext")
If appRunStatus="Success" Then
	Reporter.ReportEvent micPass,"The run status","of the Application is"&appRunStatus
End If
End If
End  With 

'Report IDF
With Browser("PeopleSoft Browser NewTab").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_ReportID")
If .Exist(nMINWAIT) Then
	appReportID=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The App report ID","is"&appReportID
End If
End  With 

'Report Name
With Browser("PeopleSoft Browser NewTab").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_ReportName")
If .Exist(nMINWAIT) Then
	appReportName=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The Report Name","is"&appReportName
End If
End  With 

'GEt the Proces instance
With Browser("PeopleSoft Browser NewTab").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_ProcessInstance")
If .Exist(nMINWAIT) Then
	appProcessIns=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The Process Insance is","is"&appProcessIns
End If
End  With 

'Get the File Name
With Browser("PeopleSoft Browser NewTab").Page("MassMaintennce_ApplicationResult").WebTable("AppResult_SearchResults")
If .Exist(nMINWAIT) Then
	For i=2 to .RowCount
		appFIleName=.GetCellData(i,1)
		appSize=.GetCellData(i,2)
		Reporter.ReportEvent micPass,"The file name","is"&appFIleName
		Reporter.ReportEvent micPass,"The file size is","is"&appSize
	Next
End If
End  With 

'CLose the broweser
Browser("PeopleSoft Browser NewTab").Close

End Function


Public Function PaymentPostAfterPayment()
Call runPaymentSelectionHoldPayment()

'Navigate to below page
'Accounts Payable > Batch Processes > Payment > Payment Posting
SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
dtRUnControlId=(GlobalDictionary("dtRUnControlId")) & RandomAlphabetGeneration
dtRequestID=(GlobalDictionary("dtRequestID"))
dtProcesFreq=(GlobalDIctionary("processFreq"))
dtPaymentOption=(GlobalDictionary("paymentOption"))
dtSetId=(GlobalDictionary("dtSetId"))
dtBankCode=(GlobalDictionary("BankCode"))
dtBankAccount=(GlobalDictionary("BankAccount"))
dtPaymentMethod=(GlobalDictionary("PaymentMethod"))

'CLick on Add new value
With Browser("PeopleSoft Browser").Page("Payment Posting").WebElement("Add New Value Tab")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"THe add new value","is present and clicekd"
End If
End  With 

'Enter the run control ID
With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Run Control Id")
If .Exist(nMINWAIT) Then
	.Set dtRUnControlId
	Reporter.ReportEvent micPass,"THe run contorl ID","is present and seti with"&dtRUnControlId
End If
End  With 

'Click on Add b utton
With Browser("PeopleSoft Browser").Page("Payment Posting").WebButton("Add Button")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'Enter request ID, description 
With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Request Id")
If .Exist(nMINWAIT) Then
	.Set dtRequestID
	Reporter.ReportEvent micPass,"THe request ID is present","and set with"&dtRequestID
End If
End  With 

With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Description")
If .Exist(nMINWAIT) Then
	.Set dtDescription
	Reporter.ReportEvent micPass,"THe Description is","set with"&dtDescription
End If
End  With 

'Enmter process frwq
With Browser("PeopleSoft Browser").Page("Payment Posting").WebList("Process Frequency")
If .Exist(nMINWAIT) Then
	.Select dtProcesFreq
	Reporter.ReportEvent micPass,"THe process freq is present","and set with"&dtProcesFreq
End If
End  With 

'Select payment option
With Browser("PeopleSoft Browser").Page("Payment Posting").WebList("Post Payment Option")
If .Exist(nMINWAIT) Then
	.Select dtPaymentOption
	Reporter.ReportEvent micPass,"THe Paymentoption is present","and set with"&dtPaymentOption
End If
End  With 

With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_SetId")
If .Exist(nMINWAIT) Then
	.Set dtSetId
End If
End  WIth 
'dtBankCode=(GlobalDictionary("BankCode"))
'dtBankAccount=(GlobalDictionary("BankAccount"))
dtPaymentMethod=(GlobalDictionary("PaymentMethod"))
'Enter the Bank details and payment methods
With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_BankCode")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appBankName")
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_BankAccount")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appBankAcctNumber")
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_PaymentMethod")
If .Exist(nMINWAIT) Then
	.Set dtPaymentMethod
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_PaymentReference")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appPaymentReference")
End If
End  With 

'CLick on Ru nbutton
With Browser("PeopleSoft Browser").Page("Payment Posting").WebButton("Run Button")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

With Browser("PeopleSoft Browser").Page("Payment Posting").PSFrame("Process scheduler Request").WebTable("ProcessScheduler_ProcessName")
If .Exist(nMINWAIT) Then
	appProcessName=.GetCellData(2,3)
	Reporter.ReportEvent micPass,"The process Name is","is"&appProcessName
End If
End  With 

With Browser("PeopleSoft Browser").Page("Payment Posting").PSFrame("Process scheduler Request").WebButton("Ok Button")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Get the Process INstance Number
'Get the instance number present to validate in upcoming steps
appInstanceNumberWithoutTrim = Browser("creationtime:=0").Page("index:=1").WebElement("innertext:=Process Instance:.*", "index:=1").GetROProperty("innertext")
appInstanceNumber=Trim(Mid(appInstanceNumberWithoutTrim,18))
app_SearchSync()
GlobalDictionary("instanceNumber")=appInstanceNumber

With Browser("PeopleSoft Browser").Page("Payment Posting").Link("Process Monitor")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With

'Click o refresh button untill the status is sucess and posted
Call CheckProcessMontiorStatus (appProcessName)

'Navigate to below page to check the payment inquiry
'Accounts Payable  >Review Accounts Payable Info>  Payments  >Payment
SelectMainMenu1(GlobalDictionary("PaymentInquiry"))

'Enter the payment reference number which was set earlier
With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebEdit("PaymentInquiry_PaymentRef")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appPaymentReference")
	Reporter.ReportEvent micPass,"The Reference number","is present and set with"&(GlobalDictionary("PaymentReferenceNumber"))
End If
End  With 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebButton("PaymentInquiry_Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()


'Clicko n the ID link
With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebTable("PaymentInquiry_ActionsTable")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
		appRefNumber=.GetCellData(i,	3)
		If appRefNumber=GlobalDictionary("appPaymentReference") Then
			Set oLink=.ChildItem(i,3,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
			End If
		End If
	Next
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

Browser("PeopleSoft Browser").Sync

With Browser("PeopleSoft Browser").Page("Payment").PSFrame("Payment").WebTable("Payment_DetailsResult")
If .Exist(nMINWAIT) Then
	appVoucherID=.GetCellData(1,2)
	GlobalDictionary("appVoucherId")=appVoucherID
	Reporter.ReportEvent micPass,"The voucher ID","selected is"&appVoucherID
End If
End  With 

'Navigate to Below page
'Accounts Payable/ Review Accounts Payable Info/Vouchers/Accounting Entries
SelectMainMenu1(GlobalDictionary("AccountingEntries"))

'Enter voucehr ID
With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebEdit("VoucherID")
If .Exist(nMINWAIT) Then
	.Set (GlobalDictionary("appVoucherId"))
	Reporter.ReportEvent micPass,"The voucehr ID field","is present and set with"&(GlobalDictionary("appVoucherId"))
End If
End  With 

'CLicko n Search ubtton
With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The Search button","is present and clicked"
End If
End  With 

With Browser("PeopleSoft Browser").Page("VoucehrAccountingEntries").PSFrame("AccountingEntries").WebTable("AccountingInformation")
If .Exist(nMINWAIT) Then
	Reporter.ReportEvent micPass,"Voucher ENtry details","are displaeyd for paymentr"
End If
End  With 



End Function

'1.27
Public Function ServiceSupplierForm()
'Navigate to Below page
'Suppliers > Supplier Registration > Supplier Forms > Inventory Supplier Form
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

dtSubject=(GlobalDictionary("dtSubject"))
dtSupplierName=(GlobalDictionary("dtSupplierName"))
dtDBAName=(GlobalDictionary("dtDBAName"))
dtMinorityBusiness=(GlobalDictionary("dtMinorityBusiness"))
dtPaymentCapability=(GlobalDictionary("dtPaymentCapability"))
dtNotificationEmail=(GlobalDictionary("dtNotificationEmail"))
dtZip=(GlobalDictionary("dtZip"))
dtState=(GlobalDictionary("dtState"))
dtCity=(GlobalDictionary("dtCity"))
dtAddressLine1=(GlobalDictionary("dtAddressLine1"))
dtCountry=(GlobalDictionary("dtCountry"))
dtCorporatePostal=(GlobalDictionary("dtCorporatePostal"))
dtCorporateState=(GlobalDictionary("dtCorporateState"))
dtCorporateCity=(GlobalDictionary("dtCorporateCity"))
dtCorporateAddress1=(GlobalDictionary("dtCorporateAddress1"))
dtCorporateCountry=(GlobalDictionary("dtCorporateCountry"))
dtAcctContName=(GlobalDictionary("dtAcctContName"))
dtDepartment=(GlobalDictionary("dtDepartment"))
dtRequestorPhone=(GlobalDictionary("dtRequestorPhone"))
dtRequestorName=(GlobalDictionary("dtRequestorName"))
dtBusinessPhone=(GlobalDictionary("dtBusinessPhone"))
dtContactEmail=(GlobalDictionary("dtContactEmail"))
Approver1=(GlobalDictionary("Approver1"))
dtFromName=(GlobalDictionary("dtFromName"))
dtFromName2=(GlobalDictionary("dtFromName2"))
dtComments=(GlobalDictionary("dtComments"))
Approver2=(GlobalDictionary("Approver2"))
APPaymentPerson=(GlobalDictionary("APPaymentPerson"))
Approver3=(GlobalDictionary("Approver3"))
dtFrom3=(GlobalDictionary("dtFrom3"))
dtFrom4=(GlobalDictionary("dtFrom4"))
dtFilePath=(GlobalDictionary("dtFilePath"))


'CLick on Add NEw Value
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Add NEw value is ","is present and clicked", false)
	Else
	Call WriteToReport(micFail,"Add NEw value is ","is not present and clicked", True)
End If
End  With 

' 'wait for the ojects to get loaded
 app_SearchSync()
 
 'Enter all the detasil in the Form
 With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("Fill a Form_Subject")
If .Exist(nMINWAIT) Then
	.Set dtSubject
	Call WriteToReport(micPass,"Subject Field  is presnet ","and set with "&dtSubject, false)
End If
End  With 

'ENter the supplier namr and DBAname
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_SupplierName")
If .Exist(nMINWAIT) Then
	.Set dtSupplierName
	Call WriteToReport(micPass,"upplierName Field  is presnet ","and set with "&dtSupplierName, false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_DBAName")
If .Exist(nMINWAIT) Then
	.Set dtDBAName
	Call WriteToReport(micPass,"DBAName Field  is presnet ","and set with "&dtDBAName, false)
End If
End  With

'Check all the checkbnox if not selected
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_SmallBusinessEnterprise_Supplier")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
		.Click
		Call WriteToReport(micPass,"SmallBusinessEnterprise   is presnet ","and set  ", false)
	End If
End If
End  With 


With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_WomanOwned_Supplier")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
		.Click
		Call WriteToReport(micPass,"WomanOwned   is presnet ","and set  ", false)
	End If
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_DIsabledOwned_Supplier")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
		.Click
		Call WriteToReport(micPass,"DIsabledOwned   is presnet ","and set  ", false)
	End If
End If
End  With 

'With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_NonProfit")
'If .Exist(nMINWAIT) Then
'	If .GetROProperty("checked")="0" Then
'		.Click
'		Call WriteToReport(micPass,"NonProfit   is presnet ","and set  ", false)
'	End If
'End If
'End  With 
'
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_VeteranOwned_Supplier")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
		.Click
		Call WriteToReport(micPass,"VeteranOwned   is presnet ","and set  ", false)
	End If
End If
End  With

'Select the Minority
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebList("FillaForm_MinorityBusiness_Supplier")
If .Exist(nMINWAIT) Then
	.Select dtMinorityBusiness
	Call WriteToReport(micPass,"Minority business   is presnet ","and set with   "&dtMinorityBusiness, false)
End If
End  With 

'Enter all the deail in the Payment capability
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebList("FillaForm_PaymentMethod_Supplier")
If .Exist(nMINWAIT) Then
	.Select dtPaymentCapability
	Call WriteToReport(micPass,"Payment methond   is presnet ","and set with   "&dtPaymentCapability, false)
End If
End  WIth 

'Enter th enotification EMail
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FilaForm_NotificationEmail_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtNotificationEmail
	Call WriteToReport(micPass,"Notification Email   is presnet ","and set with   "&dtNotificationEmail, false)
End If
End  With 

'Enter all the details in Remittance Address
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Country_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtCountry
	Call WriteToReport(micPass,"Country   is presnet ","and set with   "&dtCountry, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_AddressLine1_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtAddressLine1
	Call WriteToReport(micPass,"Address1   is presnet ","and set with   "&dtAddressLine1, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_City_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtCity
	Call WriteToReport(micPass,"City   is presnet ","and set with   "&dtCity, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_State_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtState
	Call WriteToReport(micPass,"State   is presnet ","and set with   "&dtState, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Zip_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtZip
	Call WriteToReport(micPass,"Zip   is presnet ","and set with   "&dtZip, false)
End If
End  With

'ENtert the address of Offcice
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Corporate_Country_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtCorporateCountry
	Call WriteToReport(micPass,"CorporateCountry   is presnet ","and set with   "&dtCorporateCountry, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Corporate_Address1_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtCorporateAddress1
	Call WriteToReport(micPass,"CorporatAddress   is presnet ","and set with   "&dtCorporateAddress1, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Corporate_City_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtCorporateCity
	Call WriteToReport(micPass,"City   is presnet ","and set with   "&dtCorporateCity, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Corporate_State_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtCorporateState
	Call WriteToReport(micPass,"State   is presnet ","and set with   "&dtCorporateState, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Corporate_Postal_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtCorporatePostal
	Call WriteToReport(micPass,"Zip   is presnet ","and set with   "&dtCorporatePostal, false)
End If
End  With

'Enter te Accounting contact ndetails
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_AcctContName_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtAcctContName:Call WriteToReport(micPass,"Account name   is presnet ","and set with   "&dtAcctContName, false)
End If
End  With 

'Enter the REmail
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_ContactEmail_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtContactEmail:Call WriteToReport(micPass,"Contact email   is presnet ","and set with   "&dtContactEmail, false)
End If
End  With 

'Phoinr no
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_BusinessPhone_Supplier")
If .Exist(nMINWAIT) Then
	.Set dtBusinessPhone:Call WriteToReport(micPass,"BusinessPhone   is presnet ","and set with   "&dtBusinessPhone, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_RequestorName")
If .Exist(nMINWAIT) Then
	.Set dtRequestorName:Call WriteToReport(micPass,"RequestorName is presnet ","and set with   "&dtRequestorName, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_RequestorPhone")
If .Exist(nMINWAIT) Then
	.Set dtRequestorPhone:Call WriteToReport(micPass,"RequestorPhone is presnet ","and set with   "&dtRequestorPhone, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Department")
If .Exist(nMINWAIT) Then
	.Set dtDepartment:Call WriteToReport(micPass,"Department is presnet ","and set with   "&dtDepartment, false)
End If
End  With 

'Check the attachedmtn checkbox
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_DocumentsAttached")
If .Exist(nMINWAIT) Then
	.Click:Call WriteToReport(micPass,"DocumentsAttached is present ","and clicked  ", false)
End If
End  WIth 

'Save trge page
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FillaForm_Save")
If .Exist(nMINWAIT) Then
	.Click:Call WriteToReport(micPass,"Save is present ","and clicked  ", false)
End If
End  WIth

'Get the sequence Number
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("FillaFormSeqenceNumber")
If .Exist(nMINWAIT) Then
	appSequenceNumber=.GetROProperty("innertext")
	GlobalDictionary("SequenceNumber")=appSequenceNumber
	Reporter.ReportEvent micPass,"The form is saved","and the sequence numbewr is"&appSequenceNumber
End If
End  With 

 'wait for the ojects to get loaded
 app_SearchSync()

'Click on Instrauction tab
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").Link("FillaForm_Instructions")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Instruction link is present ","and clicked  ", false)
End If
End  WIth

 'wait for the ojects to get loaded
 app_SearchSync()

'Validate the detail ni Instruiction tab
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("Fillaform_InstructionPage_Supplier")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"Instruction page is displayed ","and validated", false)
End If
End  WIth

'CLick on Attachemnt link
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").Link("FillaForm_Attachments")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Attachments link is present ","and clicked  ", false)
End If
End  With 

 'wait for the ojects to get loaded
 app_SearchSync()
 
 'CLick on Attach button
 With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FillaForm_Attach")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Attachments button is present ","and clicked  ", false)
End If
End  With

 'wait for the ojects to get loaded
 app_SearchSync()
 
  'wait for the ojects to get loaded
 app_SearchSync()
 


'Up;poad the file
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("FileAttachment").WebFile("fillaForm_AttachDocs")
If .Exist(nMINWAIT) Then
	.Set dtFilePath
End If
End  With

For i=0 to 3
	 'wait for the ojects to get loaded
 app_SearchSync()
 
Next

'CLickon Upload Button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("FileAttachment").WebButton("FillAttachment_Upload")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Attachments button is present ","and clicked  ", false)
End If
End  With

 'wait for the ojects to get loaded
 app_SearchSync()
 
 
  'wait for the ojects to get loaded
 app_SearchSync()
 

'To capture the file name
 
'dtFilePath="C:\2.2.1_TestScript.docx"
docNameSplit=split(dtFilePath,"\")
docName=docNameSplit(UBound(docNameSplit))

With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").PSFrame("TargetContent").WebTable("table_attachments")
	If .Exist(nMINWAIT) Then
		fileName=.GetCellData(1,2)
	End If
End With

fileNameSplit=split(fileName,".")
fileNameUpdate=fileNameSplit(LBound(fileNameSplit))

'fileName=Browser("PeopleSoft Browser").Page("Search/Fill in a Form").PSFrame("TargetContent").WebTable("table_attachments").GetCellData(1,2)

If docName=fileNameUpdate Then
	Call WriteToReport(micPass,"Attachments are uploaded successfully","and the file uploaded is=" &fileName,false)
End If

GlobalDictionary("docFileName")=fileName

 'wait for the ojects to get loaded
 app_SearchSync()

'click on FOrm LInk
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").Link("FillaForm_Form")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Form link is present ","and clicked  ", false)
End If
End  With


With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FillaForm_Submit")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Submit button is present ","and clicked  ", false)
End If
End  With

'CLick on Ok buttonm
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FilaForm_Submit_Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'Set the GLobal dictionary of Usert id to MICHBER
GlobalDictionary("SignInUser")=(GlobalDictionary("Approver1"))

End Function


'1.27 Continuation
Public Function InventorySupplierFormApproval1DenyFlow()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
Call WriteToReport(micPass,"Now following user is loggedin="&(GlobalDIctionary("Approver1")),"to Deny the sequence", false)
dtFromName2=(GlobalDictionary("dtFromName"))
dtComments=(GlobalDictionary("dtComments"))
If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If
'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=.RowCount to 1 step-1
	appFrom2=.GetCellData(i,1)
	If instr(1,appFrom2,dtFromName2 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'Enter the comments
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebEdit("CommentBox")
If .Exist(nMINWAIT) Then
	.Set dtComments
End If
End  WIth 

'CLickon Deny button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Deny")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Deny button ","is present and clicked", false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Deny")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The form is Denied ","and Red tick is displayed in the approval flow ", false)
End If
End  WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("SignInUser1"))

'Log out of applciation

End  Function


'*********************************************************************************************************************************
''' <summary>  
''' PaymentCancellation() To Payment Cancellation
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "PayCycle, MainMenuSelection"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'**********************************************************************************************************************************
'4.1.8
Public Function PaymentCancellation()

'Run the pay cycle to get reference  nuber
Call runPaymentSelectionHoldPayment()
	
'	'Navigat eto berloe page to get the Payment reference umber
'	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
'	
'	'CLickon Find existing value
'	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucher_tabFindExistingValue")
'	If .Exist(nMINWAIT) Then
'		.Click
'	End If
'	End  With 
'	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("voucherFE_txtVOUCHER_ID")
'	If .Exist(nMINWAIT) Then
'		.Set GlobalDIctionary("appVoucherId")
'	End If
'	End  With 
'	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Search")
'	If .Exist(nMINWAIT) Then
'		.Click
'	End If
'	End  With 
'	
'	'wait for the applicatoni to sync
'	app_SearchSync()
'	
'	'CLick on Payment tab
'	WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("tabPayments")
'		If .Exist(nMINWAIT) Then
'		.Click
'	End If
'	End  With 
'	
'	'Get the reference number
'	With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Payments").WebEdit("Reference")
'	If .Exist(nMINWAIT) Then
'		appReferenceNumber=.GetROProperty("value")
'	End If
'	End  With 
'	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Payments").WebEdit("Payments_BankCode")
'		If .Exist(nMINWAIT) Then
'		appBankCode=.GetROProperty("value")
'	End If
'	End  With 
'	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Payments").WebEdit("Payments_Account")
'		If .Exist(nMINWAIT) Then
'		appBankAccount=.GetROProperty("value")
'	End If	
'	End With
'	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Payments").WebEdit("Method")
'	If .Exist(nMINWAIT) Then
'		appPayMethod=.GetROProperty("value")
'	End If		
'	End With

	
	'Navigate to cancel the payments
	 SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
	 
	 'Set the values in cancellation window
	With Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebEdit("PayCancel_BankCode")
	If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appBankName")
	End If
	End  WIth 
	
	With Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebEdit("PayCancel_BankAcct")
	If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appBankAcctNumber")
	End If
	End  WIth
	
	With Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebEdit("PayCancel_PayReference")
	If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appPaymentReference")
	End If
	End  WIth
	
	'CLick on SAearch button
	With Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebButton("PayCancel_Search")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  WIth
	
	'GEt the payment status
	WIth Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebElement("Payment_CancelPostStatus")
	If .Exist(nMINWAIT) Then
		appCancelStatus=.GetROProperty("innertext")
		Reporter.ReportEvent micPass,"The current status of the payment is","is"&appCancelStatus
	End If
	End  With 
	
	'Value in the date cnacellted
	WIth Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebEdit("Payments_DateCancelled")
	If .Exist(nMINWAIT) Then
		appDateCancelled=.GetROProperty("value")
		Reporter.ReportEvent micPass,"The Date canclled of the payment is","is"&appDateCancelled
	End If
	End  With 
	dtDescription=(GlobalDictionary("dtDescription"))
	
	'enter description
	WIth Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebEdit("Payments_Description")
		If .Exist(nMINWAIT) Then
		.Set dtDescription
		Reporter.ReportEvent micPass,"The Date canclled of the payment is","is"&appDateCancelled
	End If
	End  With 
	
	'Clickon save button
	With Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebButton("Payments_Save")
		If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With 
	
	For i=1 to 4
		app_SearchSync()
	Next
	
	With Browser("PeopleSoft Browser").Page("PageCancellation").WebElement("PayCancle_WarningMessage")
	If .Exist(nMINWAIT) Then
		appWarningMess=.GetROProperty("innertext")
		Reporter.ReportEvent micPass,"The following warning message","is displayed in"&appWarningMess
	End If
	End  WIth 
	
	WIth Browser("PeopleSoft Browser").Page("PageCancellation").WebButton("Ok")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With 
	
	WIth Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebElement("Payment_CancelPostStatus")
	If .Exist(nMINWAIT) Then
		appCancelStatusAfterSave=.GetROProperty("innertext")
		Reporter.ReportEvent micPass,"The current status of the payment is","is"&appCancelStatusAfterSave
	End If
	End  With 
	
	'Navigate to Post paymnts to pay the cancelled payments
	'Navigate to below page
	'Accounts Payable > Batch Processes > Payment > Payment Posting
	SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))
	dtRUnControlId=(GlobalDictionary("dtRUnControlId")) & RandomAlphabetGeneration
	dtRequestID=(GlobalDictionary("dtRequestID"))
	dtProcesFreq=(GlobalDIctionary("processFreq"))
	dtPaymentOption=(GlobalDictionary("paymentOption"))
	dtSetId=(GlobalDictionary("dtSetId"))
	
	
	'CLick on Add new value
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebElement("Add New Value Tab")
	If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"THe add new value","is present and clicekd"
	End If
	End  With 
	
	'Enter the run control ID
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Run Control Id")
	If .Exist(nMINWAIT) Then
	.Set dtRUnControlId
	Reporter.ReportEvent micPass,"THe run contorl ID","is present and seti with"&dtRUnControlId
	End If
	End  With 
	
	'Click on Add b utton
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebButton("Add Button")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  WIth 
	
	'Enter request ID, description 
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Request Id")
	If .Exist(nMINWAIT) Then
	.Set dtRequestID
	Reporter.ReportEvent micPass,"THe request ID is present","and set with"&dtRequestID
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Description")
	If .Exist(nMINWAIT) Then
	.Set dtDescription
	Reporter.ReportEvent micPass,"THe Description is","set with"&dtDescription
	End If
	End  With 
	
	'Enmter process frwq
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebList("Process Frequency")
	If .Exist(nMINWAIT) Then
	.Select dtProcesFreq
	Reporter.ReportEvent micPass,"THe process freq is present","and set with"&dtProcesFreq
	End If
	End  With 
	
	'Select payment option
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebList("Post Payment Option")
	If .Exist(nMINWAIT) Then
	.Select dtPaymentOption
	Reporter.ReportEvent micPass,"THe Paymentoption is present","and set with"&dtPaymentOption
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_SetId")
	If .Exist(nMINWAIT) Then
	.Set dtSetId
	End If
	End  WIth 
	
	dtBankCode=appBankCode
	dtBankAccount=appBankAccount
	dtPaymentMethod=appPayMethod
	dtReferenceNumber=appReferenceNumber
	
	'Enter the Bank details and payment methods
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_BankCode")
	If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appBankName")
	End If
	End  WIth 
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_BankAccount")
	If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appBankAcctNumber")
	End If
	End  WIth 
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_PaymentMethod")
	If .Exist(nMINWAIT) Then
	.Set dtPaymentMethod
	End If
	End  WIth 
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_PaymentReference")
	If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appPaymentReference")
	End  If 
	End  With 
	
	'CLick on Ru nbutton
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebButton("Run Button")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").PSFrame("Process scheduler Request").WebTable("ProcessScheduler_ProcessName")
	If .Exist(nMINWAIT) Then
	appProcessName=.GetCellData(2,3)
	Reporter.ReportEvent micPass,"The process Name is","is"&appProcessName
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").PSFrame("Process scheduler Request").WebButton("Ok Button")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	'Get the Process INstance Number
	'Get the instance number present to validate in upcoming steps
	appInstanceNumberWithoutTrim = Browser("creationtime:=0").Page("index:=1").WebElement("innertext:=Process Instance:.*", "index:=1").GetROProperty("innertext")
	appInstanceNumber=Trim(Mid(appInstanceNumberWithoutTrim,18))
	app_SearchSync()
	GlobalDictionary("instanceNumber")=appInstanceNumber
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").Link("Process Monitor")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With
	
	'Click o refresh button untill the status is sucess and posted
	Call CheckProcessMontiorStatus (appProcessName)
	
	'Navigate to below page to check the payment inquiry
'Accounts Payable  >Review Accounts Payable Info>  Payments  >Payment
SelectMainMenu1(GlobalDictionary("PaymentInquiry"))

'Enter the payment reference number which was set earlier
With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebEdit("PaymentInquiry_PaymentRef")
If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appPaymentReference")
	Reporter.ReportEvent micPass,"The Reference number","is present and set with"&(GlobalDictionary("PaymentReferenceNumber"))
End If
End  With 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebButton("PaymentInquiry_Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()


'Clicko n the ID link
With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebTable("PaymentInquiry_ActionsTable")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
		appRefNumber=.GetCellData(i,	3)
		If appRefNumber=GlobalDictionary("appPaymentReference") Then
			Set oLink=.ChildItem(i,3,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
			End If
		End If
	Next
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

Browser("PeopleSoft Browser").Sync

With Browser("PeopleSoft Browser").Page("Payment").PSFrame("Payment").WebTable("Payment_DetailsResult")
If .Exist(nMINWAIT) Then
	appVoucherID=.GetCellData(1,2)
	GlobalDictionary("appVoucherId")=appVoucherID
	Reporter.ReportEvent micPass,"The voucher ID","selected is"&appVoucherID
End If
End  With
	
	'Navigatye to following to check the status
	'Accounts Payble > Vouchers > Add/Update > Regular Entry
	'Navigat eto berloe page to get the Payment reference umber
	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	
	'CLickon Find existing value
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucher_tabFindExistingValue")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("voucherFE_txtVOUCHER_ID")
	If .Exist(nMINWAIT) Then
		.Set GlobalDIctionary("appVoucherId")
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Search")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("tabPayments")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With
	
	'Check for the status'
	With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Payments").WebList("Action1")
	If .Exist(nMINWAIT) Then
		appStatus1=.GetROProperty("value")
		Reporter.ReportEvent micPass,"The current status","is"&appStatus1
	End If
	End  With 
	
	'Check the status of the second
	With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Payments").WebList("Action2")
		If .Exist(nMINWAIT) Then
		appStatus2=.GetROProperty("value")
		Reporter.ReportEvent micPass,"The current status","is"&appStatus2
		Reporter.ReportEvent micPass,"The Voucher","is repayable"
	End If
	End  With 
	
	

End  Function



'*********************************************************************************************************************************
''' <summary>  
''' runMatchingforallBUand1Voucher() To match the one BU - one Voucher and one BU - All Vouchers
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "2 businessunit,supplierID"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to Create Voucher and able to do Matching</startstate>
''' <endstate>Voucher will changed from Ready status to Exceptions or Matched</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_07_01_01_BU_Voucher
Public Function runMatchingforallBUand1Voucher()
	Dim businessunit,supplierID
	
	businessunit=GlobalDictionary("businessunit")
	supplierID=GlobalDictionary("SupplierID")
	
'One BU 0000 ine voucher exception validation
Call oneBUoneVoucherException(businessunit,supplierID)
	
	businessunit=GlobalDictionary("businessunit1")
	supplierID=GlobalDictionary("SupplierID1")
'	
''One BU 0000 ine voucher exception validation
'Call oneBUoneVoucherException(businessunit,supplierID)

'Call openReadyMatchStatusandProcessforExcetion(businessunit)
businessunit=GlobalDictionary("businessunit2")

Call processBUandverifyMatched(businessunit)
End Function


'*********************************************************************************************************************************
''' <summary>  
''' oneBUoneVoucherException() To match the One BU one Voucher 
'''Parameter1:	businessunit,supplierID
''' <para>
''' <note>Required Testcase Inputs are "businessunit,supplierID"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to Match vouchers</startstate>
''' <endstate>Voucher match status will changed from Ready status</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

Public Function oneBUoneVoucherException(Byref businessunit,Byref supplierID)
Dim VoucherID
	

	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	'Craete a voucher with Copy PO
	VoucherID=ap_createVoucherWithCopyPO(businessunit,supplierID)
	If StrComp(VoucherID,"NEXT",1)<>0 Then
		'Accounts Payable --> Batch Processes --> Voucher --> Matching
		SelectMainMenu1(GlobalDictionary("VoucherMatchingSelection"))
		Dim strVar
		strVar=ap_matchingVoucher(businessunit,voucherID)
		If StrComp(strVar,"success",1)=0 Then
	'		Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
			SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
			
	'		Open a existing voucher(created voucher)
			Call ap_openExistingVoucher(businessunit,voucherID)	
			
			'wait for the ojects to get loaded
			app_SearchSync()
			
	'		verify the match status of the voucher
			Call ap_verifyMatchstatusofVoucher("Exceptions","Click")
			
	'		Match rule validation
'			Call ap_matchRuleValidations("RULE_R600,RULE_R900,RULE_R950")
		End If
	End If
		'wait for the ojects to get loaded
		app_SearchSync()
		
		
	With Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchWorkBenchExceptions")
		If .WebTable("MatchRules").Exist(nminwait) Then
			rc=.WebTable("MatchRules").RowCount()
			If Cint(Trim(rc))>1 Then
				For i = 1 To rc-1 Step 1
					If StrComp(Trim(.WebTable("MatchRules").GetCellData(i,3)),"No receipts found",1)=0 Then
						Call WriteToReport(micPass,"MatchRules : "&"No receipts found","is present and displayed as "&"No receipts found",false)
					End If
				Next
			else
				Call WriteToReport(micFail,"MatchRules","doesn't get generated to No receipts found status",True)
			End If
			Browser("PeopleSoft Browser NewTab").Close
		End If
	End With
	
End Function

'*********************************************************************************************************************************
''' <summary>  
''' processBUandverifyMatched() To Match the One Bu and All Vouchers
'''Parameter1:	businessunit
''' <para>
''' <note>Required Testcase Inputs are "Desciption,ProcessFrequency,MatchActions,Options,RunControlID,MatchStatus,Setid"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to match vouchers</startstate>
''' <endstate>No Voucher to available in the search results</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


Public Function processBUandverifyMatched(Byref businessunit)
	
'	Dim businessunit,supplierID
	Dim voucherID,approvalStatus,Total,i,MatchStatus
	Dim rc,nCount,appProcessInstance,appProcess,Desciption,ProcessFrequency,MatchActions,Options,RunControlID,temp
	

		'Accounts Payable --> Batch Processes --> Voucher --> Matching
		SelectMainMenu1(GlobalDictionary("VoucherMatchingSelection"))
		
		RunControlID=GlobalDictionary("RunControlID")
	'Voucher matching
	With Browser("PeopleSoft Browser").Page("Matching").PSFrame("MatchRequest")
		If .WebElement("AddaNewValue").Exist(nminwait) Then
			.WebElement("AddaNewValue").Click
			Call WriteToReport(micPass,"Add new Value tab selected","Add New Value tab is present and clicked",false)
		else
			Call WriteToReport(micFail,"Add New value tab","doesn't present in the application",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
		If .WebEdit("RunControlID").Exist(nminwait) Then
			.WebEdit("RunControlID").Set RunControlID&inVoiceNumberGeneration
			Call WriteToReport(micPass,"Run Control ID : "&RunControlID,"RunControlID is present and enterred as "&RunControlID,false)
		else
			Call WriteToReport(micFail,"RunControlID","doesn't present in the application",True)
		End If
		If .WebButton("Add").Exist(nminwait) Then
			.WebButton("Add").Click
			Call WriteToReport(micPass,"Add button clicked","Add button is present and clicked",false)
		else
			Call WriteToReport(micFail,"Add button","doesn't present in the application",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
	
		Desciption=GlobalDictionary("Desciption1")
		ProcessFrequency=GlobalDictionary("ProcessFrequency")
		MatchActions=GlobalDictionary("MatchActions")
		Options=GlobalDictionary("Options1")
		MatchStatus=GlobalDictionary("MatchStatus")
		Setid=GlobalDictionary("setID")
	'enter Run Control parameters values
		If .WebEdit("Description").Exist(nminwait) Then
			.WebEdit("Description").Set Desciption
			Call WriteToReport(micPass,"Description : "&Desciption,"Description is present and enterred as "&Desciption,false)
		else
			Call WriteToReport(micFail,"Description","doesn't present in the application",True)
		End If
		If .WebList("ProcessFrequency").Exist(nminwait) Then
			.WebList("ProcessFrequency").Select ProcessFrequency
			Call WriteToReport(micPass,"ProcessFrequency : "&ProcessFrequency,"ProcessFrequency is present and enterred as "&ProcessFrequency,false)
		else
			Call WriteToReport(micFail,"ProcessFrequency","doesn't present in the application",True)
		End If
		If .WebList("MatchActions").Exist(nminwait) Then
			.WebList("MatchActions").Select MatchActions
			Call WriteToReport(micPass,"MatchActions : "&MatchActions,"MatchActions is present and enterred as "&MatchActions,false)
		else
			Call WriteToReport(micFail,"MatchActions","doesn't present in the application",True)
		End If
		If .WebList("Options").Exist(nminwait) Then
			.WebList("Options").Select Options
			Call WriteToReport(micPass,"Options : "&Options,"Options is present and enterred as "&Options,false)
		else
			Call WriteToReport(micFail,"Options","doesn't present in the application",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
	'Enter Voucher details
		If .WebEdit("BusinessUnitforBU").Exist(nminwait) Then
			.WebEdit("BusinessUnitforBU").Set businessunit
			Call WriteToReport(micPass,"BusinessUnit : "&businessunit,"BusinessUnit is present and enterred as "&businessunit,false)
		else
			Call WriteToReport(micFail,"BusinessUnit","doesn't present in the application",True)
		End If
		If .WebButton("Run").Exist(nminwait) Then
			.WebButton("Run").Click
			Call WriteToReport(micPass,"Run button clicked","Run button is present and clicked",false)
		else
			Call WriteToReport(micFail,"Run button","doesn't present in the application",True)
		End If
	End with
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
	'Enter values in Process scheduler request
	
	With Browser("PeopleSoft Browser").Page("Matching").PSFrame("ProcessSchedularrequest")
		If .WebTable("ProcessList").Exist(nminwait) Then
			If Cint(trim(.WebTable("ProcessList").RowCount))>1 Then
				.WebTable("ProcessList").ChildItem(2,1,"WebCheckBox",0).set "ON"
				appProcess=.WebTable("ProcessList").GetCellData(2,3)
				Call WriteToReport(micPass,"Process : "&appProcess," Process is present and selected as "& appProcess ,false)
			End If
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End with 

	
	
	'wait for the ojects to get loaded
	app_SearchSync()

			
		with Browser("PeopleSoft Browser").Page("Matching").PSFrame("MatchRequest")
			If .WebElement("ProcessInstance").Exist(nminwait) Then
				appProcessInstance=.WebElement("ProcessInstance").GetROProperty("innertext")
				appProcessInstance=Trim(Split(appProcessInstance,":")(1))
				Call WriteToReport(micPass,"ProcessInstance : "&appProcessInstance,"is present and generated as "&appProcessInstance,false)
			else
				Call WriteToReport(micFail,"ProcessInstance","doesn't get generated",True)
			End If
			If .Link("ProcessMonitor").Exist(nminwait) Then
				.Link("ProcessMonitor").Click
			End If
		
		End with 

'Enter all the detail in the Process monitor screen
		With Browser("PeopleSoft Browser").Page("Matching").PSFrame("ProcessMonitor")
			If .WebEdit("InstanceFrom").Exist(nMINWAIT) Then
			.WebEdit("InstanceFrom").Set appProcessInstance
			End If
		
			'Click on Refresh button
			If .WebButton("Refresh").Exist(nMINWAIT) Then
				.WebButton("Refresh").Click
			End If
		
		
			'check the status of the Job 
			If .WebTable("ProcessList").Exist(nMINWAIT) Then
				While (StrComp(Trim(.WebTable("ProcessList").GetCellData(2,8)),"Success",1)<>0) and nCount<10
					app_SearchSync()
					nCount=nCount+1
					If .WebButton("Refresh").Exist(nMAXWAIT) Then
						.WebButton("Refresh").Click
					End If
				Wend
				temp=3
			End If
			If .Link("GoBackToMatchRequest").Exist(nminwait) Then
				.Link("GoBackToMatchRequest").Click
			End If
		End With
				
		app_SearchSync()
		If Browser("PeopleSoft Browser").Page("Matching").WebButton("No").Exist(nminwait) Then
			Browser("PeopleSoft Browser").Page("Matching").WebButton("No").Click
		End If
		app_SearchSync()
		
		
If temp=3 Then
	If Browser("PeopleSoft Browser").Page("Matching").PSFrame("MatchRequest").Link("MatchWorkBench").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("Matching").PSFrame("MatchRequest").Link("MatchWorkBench").Click
	End If
	
		app_SearchSync()
With Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchWorkBench")
	If .WebEdit("BusinessUnit").Exist(nminwait) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"BusinessUnit :"&businessunit,"businessunit is present and entered as "&businessunit,false)
		else
			Call WriteToReport(micFail,"businessunit","doesn't present in the application",True)
	End If
	wait(4)
	If .WebList("MatchStatus").Exist(nminwait) Then
		.WebList("MatchStatus").Select MatchStatus
		Call WriteToReport(micPass,"MatchStatus : "&MatchStatus,"MatchStatus is present and selected as "&MatchStatus,false)
		else
			Call WriteToReport(micFail,"MatchStatus","doesn't present in the application",True)
	End If:wait(4)
	If .WebEdit("SetID").Exist(nminwait) Then
		.WebEdit("SetID").Set Setid
		Call WriteToReport(micPass,"Setid : "&Setid,"Setid is present and entered"&Setid,false)
		else
			Call WriteToReport(micFail,"Setid","doesn't present in the application",True)
	End If:wait(4)
	If .WebButton("Search").Exist(nminwait) Then
		.WebButton("Search").Click
		Call WriteToReport(micPass,"Search button "," is present and clicked",false)
		else
			Call WriteToReport(micFail,"Search button","doesn't present in the application",True)
	End If
End With	
	If Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchWorkBench").WebButton("Search").Exist(nminwait) Then
'		Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").Sync
		wait 5
	End If

	If Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").WebButton("OK").Exist(nminwait) Then
		Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").WebButton("OK").Click
		Call WriteToReport(micPass,"All vouchers are matched ","All vouchers matched",false)
		else
			Call WriteToReport(micFail,"All vouchers doesn't matched ","All vouchers are not atched",True)
	End If

	If Browser("PeopleSoft Browser NewTab").Exist(nminwait) Then
		Browser("PeopleSoft Browser NewTab").Close
	End If



End If

End Function

'*********************************************************************************************************************************
''' <summary>  
''' matchingforPOwNoReceipt() To Match the Voucher with PO and No receipts
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "businessunit,supplierID"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to Match vouchers</startstate>
''' <endstate>Voucher will changed from ready status</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_07_01_03_POw_NoReceipt
Public Function matchingforPOwNoReceipt()
		Dim businessunit,supplierID
	
	sheetName=GlobalDictionary("sheetName")
	connectionString = "Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
	

strSQL=GlobalDictionary("strSQL")
	If NOT dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
		Call WriteToReport(micFail, "Verifying the Record from Database", "No Record Exist for SQL: [" & strSQL & "]",true)
	else
		Call WriteToReport(micPass,"DB records fetched successfully","SQL query executed sucessfully ["&strSQL&"]" ,false)
		Set table=DataTable.GetSheet(sheetName)
		table.SetCurrentRow(1)
		
		GlobalDictionary("PONumberFrom")=DataTable.Value("PO_ID",sheetName)
		GlobalDictionary("businessunit")=DataTable.Value("BUSINESS_UNIT",sheetName)
		GlobalDictionary("SupplierID")=DataTable.Value("VENDOR_ID",sheetName)
		GlobalDictionary("PayTerm")=DataTable.Value("PYMNT_TERMS_CD",sheetName)
		GlobalDictionary("Quantity")=1'DataTable.Value("QTY_PO",sheetName)
		businessunit=GlobalDictionary("businessunit")
		supplierID=GlobalDictionary("SupplierID")
		Call WriteToReport(micDone,"PO number selected from DB","PO number - "&GlobalDictionary("PONumberFrom")&"Supplier ID - "&GlobalDictionary("SupplierID")&"Pay Term - "&GlobalDictionary("PayTerm")&"Quantity - "&GlobalDictionary("Quantity"),false)
	
	
		'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
		SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		
		'Craete a voucher with Copy PO
		VoucherID=ap_createVoucherWithCopyPO(businessunit,supplierID)
		If StrComp(VoucherID,"NEXT",1)<>0 Then
			'Accounts Payable --> Batch Processes --> Voucher --> Matching
			SelectMainMenu1(GlobalDictionary("VoucherMatchingSelection"))
			Dim strVar
			strVar=ap_matchingVoucher(businessunit,voucherID)
			If StrComp(strVar,"success",1)=0 Then
		'		Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
				SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
				
		'		Open a existing voucher(created voucher)
				Call ap_openExistingVoucher(businessunit,voucherID)	
				
				'wait for the ojects to get loaded
				app_SearchSync()
				
		'		verify the match status of the voucher
				Call ap_verifyMatchstatusofVoucher("Exceptions","Click")
				
		'		Match rule validation
'				Call ap_matchRuleValidations("RULE_R600,RULE_R900,RULE_R950")
			End If
		End If
		
'			If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").Link("Exceptions").Exist(nminwait) Then
'				Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").Link("Exceptions").Click
'			End If
'		Dim MatchRule	
'			If Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchWorkBenchExceptions").Image("NoreciptsFound").Exist(minwait) Then
'				Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchWorkBenchExceptions").Image("NoreciptsFound").Click
'			End If
'		
'		wait(3)
'		With Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchRuledetails")
'			If .WebElement("MatchRule").Exist(nminwait) Then
'				MatchRule=.WebElement("MatchRule").GetROProperty("innertext")
'				Call WriteToReport(micPass,"MatchRules : "&MatchRule,"is present and displayed as "&MatchRule,false)
'		'	else
'		'		Call WriteToReport(micFail,"MatchRules","doesn't get generated to No receipts found status",True)
'			End If
'			If .WebButton("Return").Exist(nminwait) Then
'				.WebButton("Return").Click
'			End If
'		End With
'			
'		If Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").Exist(nminwait) Then
'			Browser("PeopleSoft Browser NewTab").Close
'		End If
		With Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchWorkBenchExceptions")
			If .WebTable("MatchRules").Exist(nminwait) Then
				rc=.WebTable("MatchRules").RowCount()
				If Cint(Trim(rc))>1 Then
					For i = 1 To rc-1 Step 1
						If StrComp(Trim(.WebTable("MatchRules").GetCellData(i,3)),"No receipts found",1)=0 Then
							Call WriteToReport(micPass,"MatchRules : "&"No receipts found","is present and displayed as "&"No receipts found",false)
						End If
					Next
				else
					Call WriteToReport(micFail,"MatchRules","doesn't get generated to No receipts found status",True)
				End If
				Browser("PeopleSoft Browser NewTab").Close
			End If
		End With
	End If
End Function


'*********************************************************************************************************************************
''' <summary>  
''' matchingforPOwdifferentPaymentTerms() To Matching for PO w/different Payment Terms Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "RunControlID,ExceptionType"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to match exceptions</startstate>
''' <endstate>Report should be generated</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'AP_07_01_04  Matching for PO w/different Payment Terms
Public Function matchingforPOwdifferentPaymentTerms()
Dim businessunit,supplierID,VouchersID(1)
	sheetName=GlobalDictionary("sheetName")
	connectionString = "Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
	

'strSQL="SELECT * FROM PS_CDW_PO_LINE_EC WHERE PO_ID=(SELECT TOP 1 PO_ID FROM PS_CDW_PO_HDR_EC ) AND CDW_BATCH_ID=(SELECT TOP 1 CDW_BATCH_ID FROM PS_CDW_INTFACE_CTL WHERE CDW_INTERFACE_NAME = 'PO_IN')"
'strSQL="select DISTINCT TOP 10 P.BUSINESS_UNIT, P.PO_ID, P.VENDOR_ID, PYMNT_TERMS_CD, L.INV_ITEM_ID from PS_PO_HDR P, PS_PO_LINE L, PS_PO_LINE_SHIP S where P.BUSINESS_UNIT = L.BUSINESS_UNIT and P.PO_ID = L.PO_ID and L.BUSINESS_UNIT = S.BUSINESS_UNIT and L.PO_ID = S.PO_ID and L.LINE_NBR = S.LINE_NBR and (P.PO_DT >= '08/01/2018' and P.PO_DT <= '10/31/2018') and P.PO_STATUS = 'D' and S.CANCEL_STATUS <> 'X' and P.BUSINESS_UNIT = '00010' and not exists (select 'X' from PS_VOUCHER_LINE V where V.BUSINESS_UNIT = P.BUSINESS_UNIT and V.PO_ID = P.PO_ID) order by P.BUSINESS_UNIT, P.PO_ID desc"
strSQL=GlobalDictionary("strSQL")
	If NOT dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
		Call WriteToReport(micFail, "Verifying the Record from Database", "No Record Exist for SQL: [" & strSQL & "]",true)
	else
		Call WriteToReport(micPass,"DB records fetched successfully","SQL query executed sucessfully ["&strSQL&"]" ,false)
		Set table=DataTable.GetSheet(sheetName)
		table.SetCurrentRow(1)
		
		GlobalDictionary("PONumberFrom")=DataTable.Value("PO_ID",sheetName)
		GlobalDictionary("businessunit")=DataTable.Value("BUSINESS_UNIT",sheetName)
		GlobalDictionary("SupplierID")=DataTable.Value("VENDOR_ID",sheetName)
		GlobalDictionary("PayTerm")=DataTable.Value("PYMNT_TERMS_CD",sheetName)
		On error resume next
		GlobalDictionary("ItemID")=DataTable.Value("INV_ITEM_ID",sheetName)
		businessunit=GlobalDictionary("businessunit")
		supplierID=GlobalDictionary("SupplierID")
		If err.number=0 Then
			Call WriteToReport(micDone,"PO number selected from DB","PO number - "&GlobalDictionary("PONumberFrom")&"Supplier ID - "&GlobalDictionary("SupplierID")&"Pay Term - "&GlobalDictionary("PayTerm")&"Item ID - "&GlobalDictionary("ItemID"),false)
		else
			Call WriteToReport(micDone,"PO number selected from DB","PO number - "&GlobalDictionary("PONumberFrom")&"Supplier ID - "&GlobalDictionary("SupplierID")&"Pay Term - "&GlobalDictionary("PayTerm"),false)
		End If
	
	
	'	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
		SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		
	'Craete a voucher with Copy PO
		VouchersID(0)=ap_createVoucherWithCopyPO(businessunit,supplierID)
		
		For i = 2 To table.GetRowCount Step 1
			table.SetCurrentRow(i)
			If InStr(1,Environment.Value("TestName"),"PayTerm",1)<>0 Then
				If StrComp(Trim(GlobalDictionary("PayTerm")),Trim(DataTable.Value("PYMNT_TERMS_CD",sheetName)))<>0 Then
					Exit for
				End If
			elseIf InStr(1,Environment.Value("TestName"),"Item",1)<>0 Then
				If StrComp(Trim(GlobalDictionary("ItemID")),Trim(DataTable.Value("INV_ITEM_ID",sheetName)))<>0 Then
					Exit for
				End If
			elseIf InStr(1,Environment.Value("TestName"),"Vendor",1)<>0 Then
				If StrComp(Trim(GlobalDictionary("SupplierID")),Trim(DataTable.Value("VENDOR_ID",sheetName)))<>0 Then
					Exit for
				End If
			End If
		Next
		
		
		GlobalDictionary("PONumberFrom")=DataTable.Value("PO_ID",sheetName)
		GlobalDictionary("businessunit")=DataTable.Value("BUSINESS_UNIT",sheetName)
		GlobalDictionary("SupplierID")=DataTable.Value("VENDOR_ID",sheetName)
		GlobalDictionary("PayTerm")=DataTable.Value("PYMNT_TERMS_CD",sheetName)
		GlobalDictionary("ItemID")=DataTable.Value("INV_ITEM_ID",sheetName)
		businessunit=GlobalDictionary("businessunit")
		supplierID=GlobalDictionary("SupplierID")
	
		If err.number=0 Then
			Call WriteToReport(micDone,"PO number selected from DB","PO number - "&GlobalDictionary("PONumberFrom")&"Supplier ID - "&GlobalDictionary("SupplierID")&"Pay Term - "&GlobalDictionary("PayTerm")&"Item ID - "&GlobalDictionary("ItemID"),false)
		else
			Call WriteToReport(micDone,"PO number selected from DB","PO number - "&GlobalDictionary("PONumberFrom")&"Supplier ID - "&GlobalDictionary("SupplierID")&"Pay Term - "&GlobalDictionary("PayTerm"),false)
		End If
		err.clear
		On error goto 0
	'	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
		SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		
		VouchersID(1)=ap_createVoucherWithCopyPO(businessunit,supplierID)
		
	'match the multiple vouchers
		Dim Desciption,ProcessFrequency,MatchActions,Options,RunControlID,appProcessInstance,appProcess
		
			'Accounts Payable --> Batch Processes --> Voucher --> Matching
			SelectMainMenu1(GlobalDictionary("VoucherMatchingSelection"))
			
			RunControlID=GlobalDictionary("RunControlID")&inVoiceNumberGeneration
		'Voucher matching
		With Browser("PeopleSoft Browser").Page("Matching").PSFrame("MatchRequest")
			If .WebElement("AddaNewValue").Exist(nminwait) Then
				.WebElement("AddaNewValue").Click
				Call WriteToReport(micPass,"Add new Value tab selected","Add New Value tab is present and clicked",false)
			else
				Call WriteToReport(micFail,"Add New value tab","doesn't present in the application",True)
			End If
			
			'wait for the ojects to get loaded
			app_SearchSync()
			
			If .WebEdit("RunControlID").Exist(nminwait) Then
				.WebEdit("RunControlID").Set RunControlID
				Call WriteToReport(micPass,"Run Control ID : "&RunControlID,"RunControlID is present and enterred as "&RunControlID,false)
			else
				Call WriteToReport(micFail,"RunControlID","doesn't present in the application",True)
			End If
			If .WebButton("Add").Exist(nminwait) Then
				.WebButton("Add").Click
				Call WriteToReport(micPass,"Add button clicked","Add button is present and clicked",false)
			else
				Call WriteToReport(micFail,"Add button","doesn't present in the application",True)
			End If
			
			'wait for the ojects to get loaded
			app_SearchSync()
			
		
			Desciption=GlobalDictionary("Desciption")
			ProcessFrequency=GlobalDictionary("ProcessFrequency")
			MatchActions=GlobalDictionary("MatchActions")
			Options=GlobalDictionary("Options")
		'enter Run Control parameters values
			If .WebEdit("Description").Exist(nminwait) Then
				.WebEdit("Description").Set Desciption
				Call WriteToReport(micPass,"Description : "&Desciption,"Description is present and enterred as "&Desciption,false)
			else
				Call WriteToReport(micFail,"Description","doesn't present in the application",True)
			End If
			If .WebList("ProcessFrequency").Exist(nminwait) Then
				.WebList("ProcessFrequency").Select ProcessFrequency
				Call WriteToReport(micPass,"ProcessFrequency : "&ProcessFrequency,"ProcessFrequency is present and enterred as "&ProcessFrequency,false)
			else
				Call WriteToReport(micFail,"ProcessFrequency","doesn't present in the application",True)
			End If
			If .WebList("MatchActions").Exist(nminwait) Then
				.WebList("MatchActions").Select MatchActions
				Call WriteToReport(micPass,"MatchActions : "&MatchActions,"MatchActions is present and enterred as "&MatchActions,false)
			else
				Call WriteToReport(micFail,"MatchActions","doesn't present in the application",True)
			End If
			If .WebList("Options").Exist(nminwait) Then
				.WebList("Options").Select Options
				Call WriteToReport(micPass,"Options : "&Options,"Options is present and enterred as "&Options,false)
			else
				Call WriteToReport(micFail,"Options","doesn't present in the application",True)
			End If
			
			'wait for the ojects to get loaded
			app_SearchSync()
			
		'Enter Voucher details
			If .WebButton("AddNewRow").Exist(nminwait) Then
				.WebButton("AddNewRow").Click
				Call WriteToReport(micPass,"Add new row","Add new row button exist and clicked to add new row",false)
			End If
			If .WebEdit("BusinessUnit").Exist(nminwait) Then
				.WebEdit("BusinessUnit").Set businessunit
				Call WriteToReport(micPass,"BusinessUnit : "&businessunit,"BusinessUnit is present and enterred as "&businessunit,false)
			else
				Call WriteToReport(micFail,"BusinessUnit","doesn't present in the application",True)
			End If
			If .WebEdit("VoucherID").Exist(nminwait) Then
				.WebEdit("VoucherID").Set vouchersID(0)
				Call WriteToReport(micPass,"voucher ID : "&vouchersID(0),"voucherID is present and enterred as "&vouchersID(0),false)
			else
				Call WriteToReport(micFail,"voucher ID","doesn't present in the application",True)
			End If
			
			app_SearchSync()
			
			'enter a values in 2nd row
			If .WebEdit("BusinessUnit2ndRow").Exist(nminwait) Then
				.WebEdit("BusinessUnit2ndRow").Set businessunit
				Call WriteToReport(micPass,"BusinessUnit : "&businessunit,"BusinessUnit is present and enterred as "&businessunit,false)
			else
				Call WriteToReport(micFail,"BusinessUnit","doesn't present in the application",True)
			End If
			If .WebEdit("VoucherID2ndRow").Exist(nminwait) Then
				.WebEdit("VoucherID2ndRow").Set vouchersID(1)
				Call WriteToReport(micPass,"voucher ID : "&vouchersID(1),"voucherID is present and enterred as "&vouchersID(1),false)
			else
				Call WriteToReport(micFail,"voucher ID","doesn't present in the application",True)
			End If
			If .WebButton("Run").Exist(nminwait) Then
				.WebButton("Run").Click
				Call WriteToReport(micPass,"Run button clicked","Run button is present and clicked",false)
			else
				Call WriteToReport(micFail,"Run button","doesn't present in the application",True)
			End If
		End with
			
			'wait for the ojects to get loaded
			app_SearchSync()
			
		'Enter values in Process scheduler request
		
		With Browser("PeopleSoft Browser").Page("Matching").PSFrame("ProcessSchedularrequest")
			If .WebTable("ProcessList").Exist(nminwait) Then
				If Cint(trim(.WebTable("ProcessList").RowCount))>1 Then
					.WebTable("ProcessList").ChildItem(2,1,"WebCheckBox",0).set "ON"
					appProcess=.WebTable("ProcessList").GetCellData(2,3)
					Call WriteToReport(micPass,"Process : "&appProcess," Process is present and selected as "& appProcess ,false)
				End If
			End If
			If .WebButton("OK").Exist(nminwait) Then
				.WebButton("OK").Click
			End If
		End with 
	
		
		
		'wait for the ojects to get loaded
		app_SearchSync()
	
				
			with Browser("PeopleSoft Browser").Page("Matching").PSFrame("MatchRequest")
				If .WebElement("ProcessInstance").Exist(nminwait) Then
					appProcessInstance=.WebElement("ProcessInstance").GetROProperty("innertext")
					appProcessInstance=Trim(Split(appProcessInstance,":")(1))
					Call WriteToReport(micPass,"ProcessInstance : "&appProcessInstance,"is present and generated as "&appProcessInstance,false)
				else
					Call WriteToReport(micFail,"ProcessInstance","doesn't get generated",True)
				End If
				If .Link("ProcessMonitor").Exist(nminwait) Then
					.Link("ProcessMonitor").Click
				End If
			
			End with 
	
	'Enter all the detail in the Process monitor screen
			With Browser("PeopleSoft Browser").Page("Matching").PSFrame("ProcessMonitor")
				If .WebEdit("InstanceFrom").Exist(nMINWAIT) Then
				.WebEdit("InstanceFrom").Set appProcessInstance
				End If
			
				'Click on Refresh button
				If .WebButton("Refresh").Exist(nMINWAIT) Then
					.WebButton("Refresh").Click
				End If
			
				nCount=0
				'check the status of the Job 
				If .WebTable("ProcessList").Exist(nMINWAIT) Then
					While (StrComp(Trim(.WebTable("ProcessList").GetCellData(2,8)),"Success",1)<>0) and nCount<100
						app_SearchSync()
						nCount=nCount+1
						If .WebButton("Refresh").Exist(nMAXWAIT) Then
							.WebButton("Refresh").Click
						End If
					Wend
					nCount=0
					While (StrComp(Trim(.WebTable("ProcessList").GetCellData(2,9)),"Posted",1)<>0) and nCount<10
						app_SearchSync()
						nCount=nCount+1
						If .WebButton("Refresh").Exist(nMAXWAIT) Then
							.WebButton("Refresh").Click
						End If
					Wend
					temp=3
				End If
			End With
		If temp=3 Then
		
	'		Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
			SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
			
	'		Open a existing voucher(created voucher)
			Call ap_openExistingVoucher(businessunit,vouchersID(0))	
			
			'wait for the ojects to get loaded
			app_SearchSync()
			
	'		verify the match status of the voucher
			Call ap_verifyMatchstatusofVoucher("Exceptions/Matched","") 
			
			
	'		Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
			SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
			
	'		Open a existing voucher(created voucher)		
			Call ap_openExistingVoucher(businessunit,vouchersID(1))	
			
			'wait for the ojects to get loaded
			app_SearchSync()
			
	'		verify the match status of the voucher
			Call ap_verifyMatchstatusofVoucher("Exceptions/Matched","")
		else
			Call WriteToReport(micFail,"Matching process","doesn't get succeed and posted",True)
		End If	

	End If
	
End Function

'*********************************************************************************************************************************
''' <summary>  
''' multipleRowsRunControl() To match more than one Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "businessunit,supplierID"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to add & match vouchers</startstate>
''' <endstate>Voucher Matched</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_07.01.15 Multiple Rows - Run Control
Public Function multipleRowsRunControl()
	Dim businessunit,supplierID,VouchersID(1)
	
	businessunit=GlobalDictionary("businessunit")
	supplierID=GlobalDictionary("SupplierID")

'	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
'Craete a voucher with Copy PO
	VouchersID(0)=ap_createVoucherWithCopyPO(businessunit,supplierID)
	
'	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	VouchersID(1)=ap_createVoucherWithCopyPO(businessunit,supplierID)
	
'match the multiple vouchers
	Dim Desciption,ProcessFrequency,MatchActions,Options,RunControlID,appProcessInstance,appProcess
	
		'Accounts Payable --> Batch Processes --> Voucher --> Matching
		SelectMainMenu1(GlobalDictionary("VoucherMatchingSelection"))
		
		RunControlID=GlobalDictionary("RunControlID")
	'Voucher matching
	With Browser("PeopleSoft Browser").Page("Matching").PSFrame("MatchRequest")
		If .WebElement("AddaNewValue").Exist(nminwait) Then
			.WebElement("AddaNewValue").Click
			Call WriteToReport(micPass,"Add new Value tab selected","Add New Value tab is present and clicked",false)
		else
			Call WriteToReport(micFail,"Add New value tab","doesn't present in the application",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
		If .WebEdit("RunControlID").Exist(nminwait) Then
			.WebEdit("RunControlID").Set RunControlID&inVoiceNumberGeneration
			Call WriteToReport(micPass,"Run Control ID : "&RunControlID,"RunControlID is present and enterred as "&RunControlID,false)
		else
			Call WriteToReport(micFail,"RunControlID","doesn't present in the application",True)
		End If
		If .WebButton("Add").Exist(nminwait) Then
			.WebButton("Add").Click
			Call WriteToReport(micPass,"Add button clicked","Add button is present and clicked",false)
		else
			Call WriteToReport(micFail,"Add button","doesn't present in the application",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
	
		Desciption=GlobalDictionary("Desciption")
		ProcessFrequency=GlobalDictionary("ProcessFrequency")
		MatchActions=GlobalDictionary("MatchActions")
		Options=GlobalDictionary("Options")
	'enter Run Control parameters values
		If .WebEdit("Description").Exist(nminwait) Then
			.WebEdit("Description").Set Desciption
			Call WriteToReport(micPass,"Description : "&Desciption,"Description is present and enterred as "&Desciption,false)
		else
			Call WriteToReport(micFail,"Description","doesn't present in the application",True)
		End If
		If .WebList("ProcessFrequency").Exist(nminwait) Then
			.WebList("ProcessFrequency").Select ProcessFrequency
			Call WriteToReport(micPass,"ProcessFrequency : "&ProcessFrequency,"ProcessFrequency is present and enterred as "&ProcessFrequency,false)
		else
			Call WriteToReport(micFail,"ProcessFrequency","doesn't present in the application",True)
		End If
		If .WebList("MatchActions").Exist(nminwait) Then
			.WebList("MatchActions").Select MatchActions
			Call WriteToReport(micPass,"MatchActions : "&MatchActions,"MatchActions is present and enterred as "&MatchActions,false)
		else
			Call WriteToReport(micFail,"MatchActions","doesn't present in the application",True)
		End If
		If .WebList("Options").Exist(nminwait) Then
			.WebList("Options").Select Options
			Call WriteToReport(micPass,"Options : "&Options,"Options is present and enterred as "&Options,false)
		else
			Call WriteToReport(micFail,"Options","doesn't present in the application",True)
		End If
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
	'Enter Voucher details
		If .WebButton("AddNewRow").Exist(nminwait) Then
			.WebButton("AddNewRow").Click
			Call WriteToReport(micPass,"Add new row","Add new row button exist and clicked to add new row",false)
		End If
		If .WebEdit("BusinessUnit").Exist(nminwait) Then
			.WebEdit("BusinessUnit").Set businessunit
			Call WriteToReport(micPass,"BusinessUnit : "&businessunit,"BusinessUnit is present and enterred as "&businessunit,false)
		else
			Call WriteToReport(micFail,"BusinessUnit","doesn't present in the application",True)
		End If
		If .WebEdit("VoucherID").Exist(nminwait) Then
			.WebEdit("VoucherID").Set vouchersID(0)
			Call WriteToReport(micPass,"voucher ID : "&vouchersID(0),"voucherID is present and enterred as "&vouchersID(0),false)
		else
			Call WriteToReport(micFail,"voucher ID","doesn't present in the application",True)
		End If
		
		app_SearchSync()
		
		'enter a values in 2nd row
		If .WebEdit("BusinessUnit2ndRow").Exist(nminwait) Then
			.WebEdit("BusinessUnit2ndRow").Set businessunit
			Call WriteToReport(micPass,"BusinessUnit : "&businessunit,"BusinessUnit is present and enterred as "&businessunit,false)
		else
			Call WriteToReport(micFail,"BusinessUnit","doesn't present in the application",True)
		End If
		If .WebEdit("VoucherID2ndRow").Exist(nminwait) Then
			.WebEdit("VoucherID2ndRow").Set vouchersID(1)
			Call WriteToReport(micPass,"voucher ID : "&vouchersID(1),"voucherID is present and enterred as "&vouchersID(1),false)
		else
			Call WriteToReport(micFail,"voucher ID","doesn't present in the application",True)
		End If
		If .WebButton("Run").Exist(nminwait) Then
			.WebButton("Run").Click
			Call WriteToReport(micPass,"Run button clicked","Run button is present and clicked",false)
		else
			Call WriteToReport(micFail,"Run button","doesn't present in the application",True)
		End If
	End with
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
	'Enter values in Process scheduler request
	
	With Browser("PeopleSoft Browser").Page("Matching").PSFrame("ProcessSchedularrequest")
		If .WebTable("ProcessList").Exist(nminwait) Then
			If Cint(trim(.WebTable("ProcessList").RowCount))>1 Then
				.WebTable("ProcessList").ChildItem(2,1,"WebCheckBox",0).set "ON"
				appProcess=.WebTable("ProcessList").GetCellData(2,3)
				Call WriteToReport(micPass,"Process : "&appProcess," Process is present and selected as "& appProcess ,false)
			End If
		End If
		If .WebButton("OK").Exist(nminwait) Then
			.WebButton("OK").Click
		End If
	End with 

	
	
	'wait for the ojects to get loaded
	app_SearchSync()

			
		with Browser("PeopleSoft Browser").Page("Matching").PSFrame("MatchRequest")
			If .WebElement("ProcessInstance").Exist(nminwait) Then
				appProcessInstance=.WebElement("ProcessInstance").GetROProperty("innertext")
				appProcessInstance=Trim(Split(appProcessInstance,":")(1))
				Call WriteToReport(micPass,"ProcessInstance : "&appProcessInstance,"is present and generated as "&appProcessInstance,false)
			else
				Call WriteToReport(micFail,"ProcessInstance","doesn't get generated",True)
			End If
			If .Link("ProcessMonitor").Exist(nminwait) Then
				.Link("ProcessMonitor").Click
			End If
		
		End with 

'Enter all the detail in the Process monitor screen
		With Browser("PeopleSoft Browser").Page("Matching").PSFrame("ProcessMonitor")
			If .WebEdit("InstanceFrom").Exist(nMINWAIT) Then
			.WebEdit("InstanceFrom").Set appProcessInstance
			End If
		
			'Click on Refresh button
			If .WebButton("Refresh").Exist(nMINWAIT) Then
				.WebButton("Refresh").Click
			End If
		
		
			'check the status of the Job 
			If .WebTable("ProcessList").Exist(nMINWAIT) Then
				While (StrComp(Trim(.WebTable("ProcessList").GetCellData(2,8)),"Success",1)<>0) and nCount<10
					app_SearchSync()
					nCount=nCount+1
					If .WebButton("Refresh").Exist(nMAXWAIT) Then
						.WebButton("Refresh").Click
					End If
				Wend
				While (StrComp(Trim(.WebTable("ProcessList").GetCellData(2,9)),"Posted",1)<>0) and nCount<10
					app_SearchSync()
					nCount=nCount+1
					If .WebButton("Refresh").Exist(nMAXWAIT) Then
						.WebButton("Refresh").Click
					End If
				Wend
				temp=3
			End If
		End With
	If temp=3 Then
	
'		Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
		SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		
'		Open a existing voucher(created voucher)
		Call ap_openExistingVoucher(businessunit,vouchersID(0))	
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
'		verify the match status of the voucher
		Call ap_verifyMatchstatusofVoucher("Exceptions","") 
		
		
'		Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
		SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		
'		Open a existing voucher(created voucher)		
		Call ap_openExistingVoucher(businessunit,vouchersID(1))	
		
		'wait for the ojects to get loaded
		app_SearchSync()
		
'		verify the match status of the voucher
		Call ap_verifyMatchstatusofVoucher("Exceptions","")
	else
		Call WriteToReport(micFail,"Matching process","doesn't get succeed and posted",True)
	End If	
End Function


'*********************************************************************************************************************************
''' <summary>  
''' matchingforServiceRelatedPO() To match the  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "businessunit,supplierID"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to match vouchers</startstate>
''' <endstate>Matched Voucher</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************


'AP_07.01.02 Matching for Service Related PO
Public Function matchingforServiceRelatedPO()
	Dim businessunit,supplierID,VoucherID
	
	businessunit=GlobalDictionary("businessunit")
	supplierID=GlobalDictionary("SupplierID")

	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	'Craete a voucher with Copy PO
	VoucherID=ap_createVoucherWithCopyPO(businessunit,supplierID)
	If StrComp(VoucherID,"NEXT",1)<>0 Then
		'Accounts Payable --> Batch Processes --> Voucher --> Matching
		SelectMainMenu1(GlobalDictionary("VoucherMatchingSelection"))
		Dim strVar
		strVar=ap_matchingVoucher(businessunit,voucherID)
		If StrComp(strVar,"success",1)=0 Then
	'		Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
			SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
			
	'		Open a existing voucher(created voucher)
			Call ap_openExistingVoucher(businessunit,voucherID)	
			
			'wait for the ojects to get loaded
			app_SearchSync()
			
	'		verify the match status of the voucher
			Call ap_verifyMatchstatusofVoucher("Matched","") 
		End If
	End If
	
End Function

'*********************************************************************************************************************************
''' <summary>  
''' matchingforPOwReceiptsthatwillcauseR600() To match the  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "businessunit,supplierID"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to match vouchers</startstate>
''' <endstate>exception Voucher</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_07_01_07 Matching for PO w/Receipts that will cause R600
Public Function matchingforPOwReceiptsthatwillcauseR600()
	Dim businessunit,supplierID,VoucherID
	sheetName=GlobalDictionary("sheetName")
	connectionString = "Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
	

strSQL=GlobalDictionary("strSQL")
	If NOT dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
		Call WriteToReport(micFail, "Verifying the Record from Database", "No Record Exist for SQL: [" & strSQL & "]",true)
	else
		Call WriteToReport(micPass,"DB records fetched successfully","SQL query executed sucessfully ["&strSQL&"]" ,false)
		Set table=DataTable.GetSheet(sheetName)
		table.SetCurrentRow(1)
		
		GlobalDictionary("PONumberFrom")=DataTable.Value("PO_ID",sheetName)
		GlobalDictionary("businessunit")=DataTable.Value("BUSINESS_UNIT",sheetName)
		GlobalDictionary("SupplierID")=DataTable.Value("VENDOR_ID",sheetName)
		GlobalDictionary("PayTerm")=DataTable.Value("PYMNT_TERMS_CD",sheetName)
		GlobalDictionary("Quantity")=DataTable.Value("QTY_PO",sheetName)
		businessunit=GlobalDictionary("businessunit")
		supplierID=GlobalDictionary("SupplierID")
		Call WriteToReport(micDone,"PO number selected from DB","PO number - "&GlobalDictionary("PONumberFrom")&"Supplier ID - "&GlobalDictionary("SupplierID")&"Pay Term - "&GlobalDictionary("PayTerm")&"Quantity - "&GlobalDictionary("Quantity"),false)
		

			'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
			SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
			
			'Craete a voucher with Copy PO
			VoucherID=ap_createVoucherWithCopyPO(businessunit,supplierID)
			If StrComp(VoucherID,"NEXT",1)<>0 Then
				'Accounts Payable --> Batch Processes --> Voucher --> Matching
				SelectMainMenu1(GlobalDictionary("VoucherMatchingSelection"))
				Dim strVar
				strVar=ap_matchingVoucher(businessunit,voucherID)
				If StrComp(strVar,"success",1)=0 Then
			'		Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
					SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
					
			'		Open a existing voucher(created voucher)
					Call ap_openExistingVoucher(businessunit,voucherID)	
					
					'wait for the ojects to get loaded
					app_SearchSync()
					
			'		verify the match status of the voucher
					Call ap_verifyMatchstatusofVoucher("Exceptions","Click")
					
			'		Match rule validation
'					Call ap_matchRuleValidations("RULE_R500,RULE_R600,RULE_R900,RULE_R950")
					
					With Browser("PeopleSoft Browser NewTab").Page("MatchWorkbenchExceptions").PSFrame("MatchWorkBenchExceptions")
						If .WebTable("MatchRules").Exist(nminwait) Then
							rc=.WebTable("MatchRules").RowCount()
							If Cint(Trim(rc))>1 Then
								For i = 1 To rc-1 Step 1
									If StrComp(Trim(.WebTable("MatchRules").GetCellData(i,3)),"No receipts found",1)=0 Then
										Call WriteToReport(micPass,"MatchRules : "&"No receipts found","is present and displayed as "&"No receipts found",false)
									End If
								Next
							else
								Call WriteToReport(micFail,"MatchRules","doesn't get generated to No receipts found status",True)
							End If
							Browser("PeopleSoft Browser NewTab").Close
						End If
					End With
					
				End If
			End If
		End If
End Function


'*****************************************************************
'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>


''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'8.1.3

'Test case 8.1.3 Receipts Inbound

Public Function ReceiptsInbound()

strSQL="SELECT Top 2 BUSINESS_UNIT,SHIPTO_ID,VENDOR_ID,BILL_OF_LADING,RECEIPT_DTTM,QTY,INV_ITEM_ID,UNIT_OF_MEASURE FROM PS_CDW_RI_STG order by RECEIPT_DTTM DESC"
sConnectionString="Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
sheetName=GlobalDictionary("sheetName")

Call dbGetSpecifiRecords(strSQL,sConnectionString,sheetName)

'wait for the ojects to get loaded
app_SearchSync()

'Printig the Queries
Reporter.ReportEvent micPass,"The Query Name","used for this script is"&strSQL
Reporter.ReportEvent micPass,"The Provider Name","used for this script is"&sConnectionString

'Login to application to verify the details
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

With Browser("PeopleSoft Browser").Page("Add/Update Receipts").PSFrame("TargetContent").WebElement("tab_Find an Existing Value")
	If .Exist(nminwait) Then
		.Click
	End If
End With

DataTable.GetSheet(sheetName).SetCurrentRow(1)

On error resume next
bUnit=DataTable.Value("BUSINESS_UNIT",sheetName)
If err.number<>0 Then
	bUnit=DataTable.Value("BUSINESS_UNIT",sheetName)
	err.clear
End If

ItemId =DataTable.Value("INV_ITEM_ID",sheetName)
If err.number<>0 Then
	ItemId =DataTable.Value("INV_ITEM_ID",sheetName)
	err.clear
End If

billOfLading=DataTable.Value("BILL_OF_LADING",sheetName)
If err.number<>0 Then
	billOfLading=DataTable.Value("BILL_OF_LADING",sheetName)
	err.clear
End If

VendorId =DataTable.Value("VENDOR_ID",sheetName)
If err.number<>0 Then
	VendorId =DataTable.Value("VENDOR_ID",sheetName)
	err.clear
End If

shipTo =DataTable.Value("SHIPTO_ID",sheetName)
If err.number<>0 Then
	shipTo =DataTable.Value("SHIPTO_ID",sheetName)
	err.clear
End If

receivedDate =DataTable.Value("RECEIPT_DTTM",sheetName)
If err.number<>0 Then
	receivedDate =DataTable.Value("RECEIPT_DTTM",sheetName)
	err.clear
End If

On error goto 0
	
With Browser("PeopleSoft Browser").Page("Add/Update Receipts").PSFrame("TargetContent")
				If .WebEdit("RECV_PO_SRCH_BUSINESS_UNIT").Exist(nminwait) Then
					.WebEdit("RECV_PO_SRCH_BUSINESS_UNIT").Set bUnit
					Call WriteToReport(micPass,"BusinessUnit ","BusinessUnit text box is present and enter as= "&bUnit ,false)
				else
					Call WriteToReport(micFail,"BusinessUnit","BusinessUnit is not present " ,false)
				End If
				If .WebEdit("RECV_PO_SRCH_INV_ITEM_ID").Exist(nminwait) Then
					.WebEdit("RECV_PO_SRCH_INV_ITEM_ID").Set ItemId
					Call WriteToReport(micPass,"ITEM ID ","ITEM ID text box is present and enter as= "&ItemId ,false)
				else
					Call WriteToReport(micFail,"ITEM ID","ITEM ID is not present " ,false)
				End If
				If .WebEdit("RECV_PO_SRCH_BILL_OF_LADING").Exist(nminwait) Then
					.WebEdit("RECV_PO_SRCH_BILL_OF_LADING").Set billOfLading
					Call WriteToReport(micPass,"BillOfLading ","BillOfLading  text box is present and enter as= "&billOfLading ,false)
				else
					Call WriteToReport(micFail,"BillOfLading ","BillOfLading  is not present " ,false)
				End If
				If .WebEdit("RECV_PO_SRCH_VENDOR_ID").Exist(nminwait) Then
					.WebEdit("RECV_PO_SRCH_VENDOR_ID").Set VendorId
					Call WriteToReport(micPass,"Vendor ID ","Vendor ID text box is present and enter as= "&VendorId ,false)
				else
					Call WriteToReport(micFail,"Vendor ID","Vendor ID is not present " ,false)
				End If
				If .WebEdit("RECV_PO_SRCH_SHIPTO_ID").Exist(nminwait) Then
					.WebEdit("RECV_PO_SRCH_SHIPTO_ID").Set shipTo
					Call WriteToReport(micPass,"shipTo ","shipTo text box is present and enter as= "&shipTo ,false)
				else
					Call WriteToReport(micFail,"shipTo ","shipTo is not present " ,false)
				End If

				If .WebEdit("RECV_PO_SRCH_RECEIPT_DT").Exist(nminwait) Then
					.WebEdit("RECV_PO_SRCH_RECEIPT_DT").Set receivedDate
					Call WriteToReport(micPass,"Recieved date ","Recieved date text box is present and enter as= "&receivedDate ,false)
				else
					Call WriteToReport(micFail,"Recieved date ","Recieved date is not present " ,false)
				End If
				If .WebButton("Search").Exist(nminwait) Then
					.WebButton("Search").Click
					Call WriteToReport(micPass,"Search button ","Search button is present and clicked sucessfully " ,false)
				else
					Call WriteToReport(micFail,"Search button","Search button is not present " ,false)
				End If
			End With
				app_searchSync()
				

		With Browser("PeopleSoft Browser").Page("Add/Update Receipts").PSFrame("TargetContent").Link("Header Details")
			If .Exist(nminwait) Then
				.Click
			End If
		End  With
		wait(2)

		With Browser("PeopleSoft Browser").Page("Add/Update Receipts").PSFrame("Header Details")
		'BU
			If .WebElement("RECV_HDR_BUSINESS_UNIT").Exist(nminwait) Then
					If StrComp(Trim(.WebElement("RECV_HDR_BUSINESS_UNIT").GetROProperty("innertext")),Trim(DataTable.Value("BUSINESS_UNIT",sheetName)),1)=0 Then
							Call WriteToReport(micPass,"Businessunit field ","Businessunit is present and matched sucessfully with DB data " ,false)
						else
							Call WriteToReport(micFail,"Businessunit field","Businessunit is not matched with DB data" ,TRUE)
						End If
					else
						Call WriteToReport(micFail,"Businessunit field","Businessunit field is not present " ,TRUE)
			End If
					
			'Bill of lading
			If .WebEdit("RECV_HDR_BILL_OF_LADING").Exist(nminwait) Then
						If StrComp(Trim(.WebEdit("RECV_HDR_BILL_OF_LADING").GetROProperty("value")),Trim(DataTable.Value("BILL_OF_LADING",sheetName)),1)=0 Then
							Call WriteToReport(micPass,"BILL_OF_LADING field ","BILL_OF_LADING is present and matched sucessfully with DB data " ,false)
						else
							Call WriteToReport(micFail,"BILL_OF_LADING field","BILL_OF_LADING is not matched with DB data" ,TRUE)
						End If
					else
						Call WriteToReport(micFail,"BILL_OF_LADING field","BILL_OF_LADING field is not present " ,TRUE)
			End If
					
			'Receipt date
			If .WebEdit("RECV_HDR_RECEIPT_DT").Exist(nminwait) Then
						If StrComp(Trim(CDate(.WebEdit("RECV_HDR_RECEIPT_DT").GetROProperty("value"))),Trim(DataTable.Value("RECEIPT_DTTM",sheetName)),1)=0 Then
							Call WriteToReport(micPass,"Recieved_Date field ","Recieved_Date is present and matched sucessfully with DB data " ,false)
						else
							Call WriteToReport(micFail,"Recieved_Date field","Recieved_Date is not matched with DB data" ,TRUE)
						End If
					else
						Call WriteToReport(micFail,"Recieved_Date field","Recieved_Date field is not present " ,TRUE)
			End If
					
			'Ship to
			If .WebEdit("RECV_HDR_SHIPTO_ID").Exist(nminwait) Then
						If StrComp(Trim(.WebEdit("RECV_HDR_SHIPTO_ID").GetROProperty("value")),Trim(DataTable.Value("SHIPTO_ID",sheetName)),1)=0 Then
							Call WriteToReport(micPass,"SHIPTO field ","RECV_HDR_SHIPTO_ID is present and matched sucessfully with DB data " ,false)
						else
							Call WriteToReport(micFail,"SHIPTO field","SHIPTO is not matched with DB data" ,TRUE)
						End If
					else
						Call WriteToReport(micFail,"SHIPTO field","SHIPTO field is not present " ,TRUE)
			End If
			
			'Vendor id
			If .WebEdit("RECV_HDR_VENDOR_ID").Exist(nminwait) Then
						If StrComp(Trim(.WebEdit("RECV_HDR_VENDOR_ID").GetROProperty("value")),Trim(DataTable.Value("VENDOR_ID",sheetName)),1)=0 Then
							Call WriteToReport(micPass,"VENDOR_ID field ","VENDOR_ID is present and matched sucessfully with DB data " ,false)
						else
							Call WriteToReport(micFail,"VENDOR_ID field","VENDOR_ID is not matched with DB data" ,TRUE)
						End If
					else
						Call WriteToReport(micFail,"VENDOR_ID field","VENDOR_ID field is not present " ,TRUE)
			End If
					
					
End  With

'To click ok
With Browser("PeopleSoft Browser").Page("Add/Update Receipts").PSFrame("Header Details").WebButton("OK")
	If .Exist(nminwait) Then
		.Click
	End If
End  With


			If Browser("PeopleSoft Browser").Page("Add/Update Receipts").PSFrame("TargetContent").WebTable("table_ItemId").Exist(nminwait) Then
					If StrComp(Trim(Browser("PeopleSoft Browser").Page("Add/Update Receipts").PSFrame("TargetContent").WebTable("table_ItemId").GetCellData(1,3)),Trim(ItemId),1)=0 Then
						Call WriteToReport(micPass,"ItemID field ","ItemID is present and matched sucessfully with DB data " ,false)
					else
						Call WriteToReport(micFail,"ItemID field","ItemID is not matched with DB data" ,TRUE)
					End If
				End If
				
			UOM=DataTable.Value("UNIT_OF_MEASURE",sheetName)
				
			If Browser("PeopleSoft Browser").Page("Add/Update Receipts").PSFrame("TargetContent").WebTable("table_UOM").Exist(nminwait) Then
			
					If StrComp(Trim(Browser("PeopleSoft Browser").Page("Add/Update Receipts").PSFrame("TargetContent").WebTable("table_UOM").GetCellData(1,3)),Trim(UOM),1)=0 Then
						Call WriteToReport(micPass,"Unit Of Measure field is ="&UOM,"Unit Of Measure is present and matched sucessfully with DB data" ,false)
					else
						Call WriteToReport(micFail,"Unit Of Measure field="&UOM,"Unit Of Measure is not matched with DB data" ,TRUE)
					End If
			End If
	
End Function


Public Function PaycancellationInQuery()
'strSQL=Trim(GlobalDictionary("strSQL"))
'strSQL="SELECT TOP 10 CDW_BATCH_ID,BUSINESS_UNIT,VOUCHER_ID,INVOICE_ID,INVOICE_DT,VENDOR_ID,ACCOUNTING_DT,GROSS_AMT,PYMNT_TERMS_CD,MATCH_ACTION,PO_ID FROM  PS_CDW_VCHR_HDR_ST WHERE CDW_BATCH_ID = (SELECT TOP 1 CDW_BATCH_ID FROM PS_CDW_VCHR_HDR_ST)"
strSQL="(select top 50 PYMNT_ID, PYMNT_ID_REF, BANK_SETID, BANK_CD,  BANK_ACCT_KEY, BANK_ACCOUNT_NUM, PYMNT_DT, PYMNT_METHOD, PYMNT_STATUS, POST_STATUS_AP from PS_PAYMENT_TBL where PYMNT_DT > '01/01/2019' and PYMNT_STATUS <> 'X' and PYMNT_STATUS = 'P' and POST_STATUS_AP = 'P' and BANK_CD NOT IN ('00012','00017') and BANK_ACCT_KEY NOT IN ('0303', 'AP03') and PYMNT_METHOD = 'CHK' and SOURCE_TXN = 'VCHR')"
strSQL1="(select top 50 PYMNT_ID, PYMNT_ID_REF, BANK_SETID, BANK_CD,  BANK_ACCT_KEY, BANK_ACCOUNT_NUM, PYMNT_DT, PYMNT_METHOD, PYMNT_STATUS, POST_STATUS_AP from PS_PAYMENT_TBL where PYMNT_DT > '01/01/2019' and PYMNT_STATUS <> 'X' and PYMNT_STATUS = 'P' and POST_STATUS_AP = 'P' and BANK_CD NOT IN ('00012','00017') and PYMNT_METHOD = 'CHK')"

'sConnectionString=Trim(GlobalDictionary("sConnectionString"))
sConnectionString="Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
sheetName=GlobalDictionary("sheetName")

Reporter.ReportEvent micDone,"The query name to be","executed is"&strSQL

On Error Resume Next
Call dbGetSpecifiRecords(strSQL1,sConnectionString,sheetName)
If Err.Number>0 Then
	Reporter.ReportEvent micFail,"The Query DId"&strSQL&"did not execute sucessfully"
	Err.Clear
	ExitTest
End If
On Error goto 0


Set oTable=DataTable.GetSheet(sheetName)
oTable.SetCurrentRow(1)

On Error resume next
dtPaymentReferenceId=Datatable.Value("PYMNT_ID_REF",sheetName)
GlobalDIctionary("paymentReference")=dtPaymentReferenceId
Reporter.ReportEvent micPass,"The payment Reference number from the quert table","is"&dtPaymentReferenceId
On ERROR GOTO 0

'Navigate to cancel the payments
	 SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
	 
	 'Set the values in cancellation window
	With Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebEdit("PayCancel_BankCode")
	If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appBankName")
	End If
	End  WIth 
	
	With Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebEdit("PayCancel_BankAcct")
	If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appBankAcctNumber")
	End If
	End  WIth
	
	paymentReferenceNumberafter=Left(GlobalDIctionary("paymentReference"),6)
	
	With Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebEdit("PayCancel_PayReference")
	If .Exist(nMINWAIT) Then
	.Set "%"&paymentReferenceNumberafter
	End If
	End  WIth
	
	On Error Resume Next
	'CLick on SAearch button
	With Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebButton("PayCancel_Search")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  WIth
	If Err.Number>0 Then
		Reporter.ReportEvent micFail,"The payment Reference number","is not present in the Application"
		Err.Clear
		Exittest
	End If
	On Error Goto 0
	
	
	With Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebTable("SearchResults")
	If .Exist(nMINWAIT) Then
		On Error Resume next
		Set oPayLink=.ChildItem(2,4,"Link",0)
		PaymentRefFromLink=oPayLink.GetRoProperty("innertext")
		GlobalDIctionary("paymentReference")=PaymentRefFromLink
		oPayLink.click
		If err.number=0 Then
			Reporter.ReportEvent micPass,"The Payment reference number","is present and clicked"&PaymentRefFromLink
			Else
			Reporter.ReportEvent micFail,"The payment refernce number","is not present"
			Exittest
		End If
		On Error Goto 0
	End If
	End  With 
	
	For i= 0 To 2
		app_searchSync()
	Next
	
	'GEt the payment status
	WIth Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebElement("Payment_CancelPostStatus")
	If .Exist(nMINWAIT) Then
		appCancelStatus=.GetROProperty("innertext")
		Reporter.ReportEvent micPass,"The current status of the payment is","is"&appCancelStatus
	End If
	End  With 
	
	'Value in the date cnacellted
	WIth Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebEdit("Payments_DateCancelled")
	If .Exist(nMINWAIT) Then
		appDateCancelled=.GetROProperty("value")
		Reporter.ReportEvent micPass,"The Date canclled of the payment is","is"&appDateCancelled
	End If
	End  With 
	dtDescription=(GlobalDictionary("dtDescription"))
	
	'enter description
	WIth Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebEdit("Payments_Description")
		If .Exist(nMINWAIT) Then
		.Set dtDescription
		Reporter.ReportEvent micPass,"The Date canclled of the payment is","is"&appDateCancelled
	End If
	End  With 
	
	'Clickon save button
	With Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebButton("Payments_Save")
		If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With 
	
	For i=1 to 4
		app_SearchSync()
	Next
	
	With Browser("PeopleSoft Browser").Page("PageCancellation").WebElement("PayCancle_WarningMessage")
	If .Exist(nMINWAIT) Then
		appWarningMess=.GetROProperty("innertext")
		Reporter.ReportEvent micPass,"The following warning message","is displayed in"&appWarningMess
	End If
	End  WIth 
	
	WIth Browser("PeopleSoft Browser").Page("PageCancellation").WebButton("Ok")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With 
	
	WIth Browser("PeopleSoft Browser").Page("PageCancellation").PSFrame("PaymentCancellation").WebElement("Payment_CancelPostStatus")
	If .Exist(nMINWAIT) Then
		appCancelStatusAfterSave=.GetROProperty("innertext")
		Reporter.ReportEvent micPass,"The current status of the payment is","is"&appCancelStatusAfterSave
	End If
	End  With
	
	'Navigate to Post paymnts to pay the cancelled payments
	'Navigate to below page
	'Accounts Payable > Batch Processes > Payment > Payment Posting
	SelectMainMenu1(GlobalDictionary("MainMenuSelection3"))
	dtRUnControlId=(GlobalDictionary("dtRUnControlId")) & RandomAlphabetGeneration
	dtRequestID=(GlobalDictionary("dtRequestID"))
	dtProcesFreq=(GlobalDIctionary("processFreq"))
	dtPaymentOption=(GlobalDictionary("paymentOption"))
	dtSetId=(GlobalDictionary("dtSetId"))
	
	
	'CLick on Add new value
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebElement("Add New Value Tab")
	If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"THe add new value","is present and clicekd"
	End If
	End  With 
	
	'Enter the run control ID
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Run Control Id")
	If .Exist(nMINWAIT) Then
	.Set dtRUnControlId
	Reporter.ReportEvent micPass,"THe run contorl ID","is present and seti with"&dtRUnControlId
	End If
	End  With 
	
	'Click on Add b utton
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebButton("Add Button")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  WIth 
	
	'Enter request ID, description 
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Request Id")
	If .Exist(nMINWAIT) Then
	.Set dtRequestID
	Reporter.ReportEvent micPass,"THe request ID is present","and set with"&dtRequestID
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Description")
	If .Exist(nMINWAIT) Then
	.Set dtDescription
	Reporter.ReportEvent micPass,"THe Description is","set with"&dtDescription
	End If
	End  With 
	
	'Enmter process frwq
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebList("Process Frequency")
	If .Exist(nMINWAIT) Then
	.Select dtProcesFreq
	Reporter.ReportEvent micPass,"THe process freq is present","and set with"&dtProcesFreq
	End If
	End  With 
	
	'Select payment option
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebList("Post Payment Option")
	If .Exist(nMINWAIT) Then
	.Select dtPaymentOption
	Reporter.ReportEvent micPass,"THe Paymentoption is present","and set with"&dtPaymentOption
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_SetId")
	If .Exist(nMINWAIT) Then
	.Set dtSetId
	End If
	End  WIth 
	
	dtBankCode=appBankCode
	dtBankAccount=appBankAccount
	dtPaymentMethod=appPayMethod
	dtReferenceNumber=appReferenceNumber
	
	'Enter the Bank details and payment methods
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_BankCode")
	If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appBankName")
	End If
	End  WIth 
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_BankAccount")
	If .Exist(nMINWAIT) Then
	.Set GlobalDictionary("appBankAcctNumber")
	End If
	End  WIth 
	
	dtPaymentMethod=GlobalDictionary("PaymentMethod")
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_PaymentMethod")
	If .Exist(nMINWAIT) Then
	.Set dtPaymentMethod
	End If
	End  WIth 
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebEdit("Payment_PaymentReference")
	If .Exist(nMINWAIT) Then
	.Set GlobalDIctionary("paymentReference")
	End  If 
	End  With 
	
	'CLick on Ru nbutton
	With Browser("PeopleSoft Browser").Page("Payment Posting").WebButton("Run Button")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	For i=0 to 2
		app_SearchSync()
	Next
	
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").PSFrame("Process scheduler Request").WebTable("ProcessScheduler_ProcessName")
	If .Exist(nMINWAIT) Then
	appProcessName=.GetCellData(2,3)
	Reporter.ReportEvent micPass,"The process Name is","is"&appProcessName
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").PSFrame("Process scheduler Request").WebButton("Ok Button")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With 
	
	For i=0 to 3
		app_SearchSync()
	Next
	
	'Get the Process INstance Number
	'Get the instance number present to validate in upcoming steps
	appInstanceNumberWithoutTrim = Browser("creationtime:=0").Page("index:=1").WebElement("innertext:=Process Instance:.*", "index:=1").GetROProperty("innertext")
	appInstanceNumber=Trim(Mid(appInstanceNumberWithoutTrim,18))
	app_SearchSync()
	GlobalDictionary("instanceNumber")=appInstanceNumber
	
	With Browser("PeopleSoft Browser").Page("Payment Posting").Link("Process Monitor")
	If .Exist(nMINWAIT) Then
	.Click
	End If
	End  With
	
	'Click o refresh button untill the status is sucess and posted
	Call CheckProcessMontiorStatus (appProcessName)
	
	app_SearchSync()
	
	'Navigate to below page to check the payment inquiry
'Accounts Payable  >Review Accounts Payable Info>  Payments  >Payment
SelectMainMenu1(GlobalDictionary("PaymentInquiry"))

app_SearchSync()

'Enter the payment reference number which was set earlier
With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebEdit("PaymentInquiry_PaymentRef")
If .Exist(nMINWAIT) Then
	.Set GlobalDIctionary("paymentReference")
	Reporter.ReportEvent micPass,"The Reference number","is present and set with"&(GlobalDictionary("PaymentReferenceNumber"))
End If
End  With 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebButton("PaymentInquiry_Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
For i=0 to 2
	app_SearchSync()
Next




'Clicko n the ID link
With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebTable("PaymentInquiry_ActionsTable")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
		appRefNumber=.GetCellData(i,	3)
		If appRefNumber=GlobalDIctionary("paymentReference") Then
			Set oLink=.ChildItem(i,3,"Link",0)
			With Browser("PeopleSoft Browser").Page("PaymentInquiry").PSFrame("PaymentInquiry").WebTable("PaymentInquiry_PaymentResult")
			If .Exist(nMINWAIT) Then
				appPaymentStatus=.GetCellData(i,6)
				appReconcilationstatus=.GetCellData(i,7)
				Reporter.ReportEvent micPass,"The payment status","is"&appPaymentStatus
				Reporter.ReportEvent micDone,"The reconcilation status is","is"&appReconcilationstatus
			End If
			End  With 
			If oLink.exist(nMINWAIT) Then
				oLink.click
			End If
		End If
	Next
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

Browser("PeopleSoft Browser").Sync

With Browser("PeopleSoft Browser").Page("Payment").PSFrame("Payment").WebTable("Payment_DetailsResult")
If .Exist(nMINWAIT) Then
	appVoucherID=.GetCellData(1,2)
	GlobalDictionary("appVoucherId")=appVoucherID
	Reporter.ReportEvent micPass,"The voucher ID","selected is"&appVoucherID
End If
End  With

With Browser("PeopleSoft Browser").Page("Payment").PSFrame("Payment").WebElement("Payment_PaymentClearDate")
If .Exist(nMINWAIT) Then
	appPaymentClearDate=.GetROProperty("innertext")
	Reporter.ReportEvent micDone,"The payment clear date","is"&appPaymentClearDate
End If
End  With 
	
End  Function
	

'TC Name:-  5.1.3  Load Recycle Ran Delete
Public Function LoadRecycleRanDelete


Dim PostStatus,EntryStatus,fromBu,toBU,filePath,BUs(),VoucherIDs()
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	PostStatus=GlobalDictionary("PostStatus")
	EntryStatus=GlobalDictionary("EntryStatus")
	fromBu=GlobalDictionary("businessUnit")
	toBU=GlobalDictionary("businessUnit")
	filePath=GlobalDictionary("filePath")
	filePath=getVoucherandSavetoCSVfile(PostStatus,EntryStatus,fromBu,toBU,filePath)

'Navigate to Below page
'Accounts Payable -->Vouchers-->Maintain-->Voucher Mass Maintenace
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
appReqId=GlobalDictionary("appReqId") & RandomNumberGeneraionInvSupplier & Day(Date)
appDescription=GlobalDictionary("appDescription")
appActionName=GlobalDictionary("appActionName")

'ENter the Filie Name
'FileName=

'Set th efile name
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebEdit("VoucherMain_FileName")
If .Exist(nMINWAIT) Then
	.Set filePath
	Reporter.ReportEvent micPass,"The file naem set is","Is"&FileName
End If
End  With 

'Click on Load Voucher Button
WIth Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebButton("VoucherMain_LoadVouchers")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 


'wait for the ojects to get loaded
app_SearchSync()

'Count the Total Number of Vouchers present
WIth Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebTable("VoucherMaint_SearchResults")
If .Exist(nMINWAIT) Then
	appNoOfROws=.RowCount
	Reporter.ReportEvent micPass,"The total number of Vouchers","present in the Application is"&appNoOfROws
End If
End  With 

'Get the Vouchers NUmber to be selected and display vouchers
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebTable("VoucherMaint_SearchResults")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
		appVoucherID=.GetCellData(i,4)
		Reporter.ReportEvent micPass,"The voucher ID"," displayed are"&appVoucherID
	Next
End If
End  WIth 

If GlobalDictionary("RecycleData")="Yes" Then
	Else
	With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebTable("VoucherMain_SearchResults_SecondColumn")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
		appStyle=Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebTable("VoucherMain_SearchResults_SecondColumn").GetCellData(i,1)
		If appStyle="Regular Voucher" Then
				Set CheckBox=Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebTable("VoucherMaint_SearchResults").ChildItem(i,2,"WebCheckBox",0)
				If CheckBox.exist(nMINWAIT) Then
					CheckBox.click
				End  If
		End If
	Next
End If
End  WIth
End If
 

'With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebTable("VoucherMain_SearchResults_SecondColumn")
'If .Exist(nMINWAIT) Then
'	For i =0 to .RowCount
'		appGrossAmt=.GetCellData(i,5)
'		appMinus="-"
'		If instr(1,appGrossAmt,appMinus)>0 Then
'			Set CheckBox=Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebTable("VoucherMaint_SearchResults").ChildItem(i,2,"WebCheckBox",0)
'			If CheckBox.exist(nMINWAIT) Then
'				CheckBox.click
'			End  If
'		End If
'	Next
'End If
'End  WIth 


'Click on Delete Button
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebButton("VoucherMaint_Delete")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'Wait for the Delete page to display

'wait for the ojects to get loaded
app_SearchSync()

'Set the req ID and Description
'appReqId
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMain_Delete").WebEdit("VoucherDelete_ReqID")
If .Exist(nMINWAIT) Then
	.Set appReqId
	Reporter.ReportEvent micPass,"The Request ID","given is"&appReqId
End If
End  With 

'Set the description
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMain_Delete").WebEdit("VoucherDel_Description")
If .Exist(nMINWAIT) Then
	.Set appDescription
	Reporter.ReportEvent micPass,"The Request ID","given is"&appDescription
End If
End  With 

'Select the action
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMain_Delete").WebList("VoucherDelete_ActionSelect")
If .Exist(nMINWAIT) Then
	.Select 1
	Reporter.ReportEvent micPass,"The action name","selected is"&.GetROProperty("value")
End If
End  With 




'CLick on RUn button
With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMain_Delete").WebButton("VoucehrDel_Run")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Search for the Web table
'While Not(Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebTable("AppResult_SearchResults").Exist(nMINWAIT)) 
''wait for the objects to get loaded
'app_SearchSync()
'Wend

For i=1 to 7
	app_SearchSync()
Next

'Get the status
With Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_RunStatus")
If .Exist(nMINWAIT) Then
appRunStatus=Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_RunStatus").GetROProperty("innertext")
If appRunStatus="Success" Then
	Reporter.ReportEvent micPass,"The run status","of the Application is"&appRunStatus
End If
End If
End  With 

'Report IDF
With Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_ReportID")
If .Exist(nMINWAIT) Then
	appReportID=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The App report ID","is"&appReportID
End If
End  With 

'Report Name
With Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_ReportName")
If .Exist(nMINWAIT) Then
	appReportName=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The Report Name","is"&appReportName
End If
End  With 

'GEt the Proces instance
With Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_ProcessInstance")
If .Exist(nMINWAIT) Then
	appProcessIns=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The Process Insance is","is"&appProcessIns
End If
End  With 

'Get the File Name
With Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebTable("AppResult_SearchResults")
If .Exist(nMINWAIT) Then
	For i=2 to .RowCount
		appFIleName=.GetCellData(i,1)
		appSize=.GetCellData(i,2)
		Reporter.ReportEvent micPass,"The file name","is"&appFIleName
		Reporter.ReportEvent micPass,"The file size is","is"&appSize
	Next
End If
End  With 

'CLose the broweser
Browser("MassMaintenance_ApplicationResult").Close

End Function

Public Function loadpostedRanUnpost()
	Dim PostStatus,EntryStatus,fromBu,toBU,filePath,BUs(),VoucherIDs()
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	PostStatus=GlobalDictionary("PostStatus")
	EntryStatus=GlobalDictionary("EntryStatus")
	fromBu=GlobalDictionary("businessUnit")
	toBU=GlobalDictionary("businessUnit")
	filePath=GlobalDictionary("filePath")
	filePath=getVoucherandSavetoCSVfile(PostStatus,EntryStatus,fromBu,toBU,filePath)
	
	'Accounts Payable -->Vouchers-->Maintain-->Voucher Mass Maintenace
	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	app_SearchSync()

	With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance")
		If .WebEdit("VoucherMain_FileName").Exist(nminwait) Then
			.WebEdit("VoucherMain_FileName").Set filePath
			Call WriteToReport(micPass," enter File name/path for the csv file","is present and entered as"&filepath ,false)
			else
			Call WriteToReport(micFail,"enter File name/path for the csv file","is not present",True)
		End If
		app_SearchSync()
		If .WebButton("VoucherMain_LoadVouchers").Exist(nminwait) Then
			.WebButton("VoucherMain_LoadVouchers").Click
			 Call WriteToReport(micPass,"LoadVouchers button","is present and Clicked" ,false)
			else
			Call WriteToReport(micFail,"LoadVouchers button","is not present",True)
		End If
		Dim rc
		If .WebTable("VoucherMaint_SearchResults").Exist(nminwait) Then
			rc=.WebTable("VoucherMaint_SearchResults").RowCount
			If rc>5 Then
				rc=5
			End If
			For i = 1 To rc Step 1
				ReDim Preserve BUs(i-1):BUs(i-1)=.WebTable("VoucherMaint_SearchResults").GetCellData(i,3)
				ReDim Preserve VoucherIDs(i-1):VoucherIDs(i-1)=.WebTable("VoucherMaint_SearchResults").GetCellData(i,5)
			Next
		End If
		If .WebButton("VoucherMaint_UnPost").Exist(nminwait) Then
			.WebButton("VoucherMaint_UnPost").Click
			 Call WriteToReport(micPass,"UnPost button","is present and Clicked" ,false)
			else
			Call WriteToReport(micFail,"Unpost button","is not present",True)
		End If
		app_SearchSync()
	End With
	
	If Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").WebElement("ErrorMessage").Exist(nminwait) Then
		Call WriteToReport(micPass,"Expected pop up ,error message displayed","Expected message is displayed as "&Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").WebElement("ErrorMessage").GetROProperty("innertext") ,false)
	End If
	If Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").WebButton("OK").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").WebButton("OK").Click
		Call WriteToReport(micPass,"OK button","is present and clicked" ,false)
	End If
app_SearchSync()

	With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMain_UnPost")
	Dim strVariable
		If .WebEdit("VoucehrUnpost_ReqID").Exist(nminwait) Then
			strVariable= inVoiceNumberGeneration()
			.WebEdit("VoucehrUnpost_ReqID").Set strVariable
			Call WriteToReport(micPass,"Request ID ","is present and Entered"&strVariable ,false)
			else
			Call WriteToReport(micFail,"Request ID","is not present",True)
		End If
		If .WebEdit("VoucehrUnpost_Description").Exist(nminwait) Then
			strVariable="test "&now:.WebEdit("VoucehrUnpost_Description").Set strVariable
			Call WriteToReport(micPass,"Description","is present and Entered"&strVariable ,false)
			else
			Call WriteToReport(micFail,"Description","is not present",True)
		End If
		If .WebList("VoucehrUnpost_ActionSelect").Exist(nminwait) Then
			strVariable=Split(.WebList("VoucehrUnpost_ActionSelect").getROProperty("all Items") ,";")(1):.WebList("VoucehrUnpost_ActionSelect").Select(strVariable)
			Call WriteToReport(micPass,"Action list","is present and selected as"&strVariable ,false)
			else
			Call WriteToReport(micFail,"Action list","is not present",True)
		End If
		If .WebButton("VoucehrUnpost_Run").Exist(nminwait) Then
			.WebButton("VoucehrUnpost_Run").Click
			Call WriteToReport(micPass,"Run ","is present and clicked" ,false)
			else
			Call WriteToReport(micFail,"Run","is not present",True)
		End If
	End With
	
'	Search for the Web table
While Not(Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebTable("AppResult_SearchResults").Exist(nMINWAIT)) 
'wait for the objects to get loaded
app_SearchSync()
Wend

'Get the status
With Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_RunStatus")
If .Exist(nMINWAIT) Then
appRunStatus=Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_RunStatus").GetROProperty("innertext")
If appRunStatus="Success" Then
	Reporter.ReportEvent micPass,"The run status","of the Application is"&appRunStatus
End If
End If
End  With 

'Report IDF
With Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_ReportID")
If .Exist(nMINWAIT) Then
	appReportID=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The App report ID","is"&appReportID
End If
End  With 

'Report Name
With Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_ReportName")
If .Exist(nMINWAIT) Then
	appReportName=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The Report Name","is"&appReportName
End If
End  With 

'GEt the Proces instance
With Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebElement("AppResult_ProcessInstance")
If .Exist(nMINWAIT) Then
	appProcessIns=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"The Process Insance is","is"&appProcessIns
End If
End  With 

'Get the File Name
With Browser("MassMaintenance_ApplicationResult").Page("MassMaintennce_ApplicationResult").WebTable("AppResult_SearchResults")
If .Exist(nMINWAIT) Then
	For i=2 to .RowCount
		appFIleName=.GetCellData(i,1)
		appSize=.GetCellData(i,2)
		Reporter.ReportEvent micPass,"The file name","is"&appFIleName
		Reporter.ReportEvent micPass,"The file size is","is"&appSize
	Next
End If
End  With 

'CLose the broweser
Browser("MassMaintenance_ApplicationResult").Close
End Function

Public Function getVoucherandSavetoCSVfile(PostStatus,EntryStatus,fromBu,toBU,filePath)
Dim filename,i,k,rc
with Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry")

                If .WebEdit("vouInquiry_txtFromBU").Exist(nminwait) Then
                            .WebEdit("vouInquiry_txtFromBU").Set fromBu
                            Call WriteToReport(micPass,"From BU","is present and entered as "&fromBu ,false)
			else
			Call WriteToReport(micFail,"From BU","is not present",True)
                End If
                
                If .WebEdit("vouInquiry_txtToBU").Exist(nminwait) Then
                                .WebEdit("vouInquiry_txtToBU").Set toBU
                                Call WriteToReport(micPass,"To BU","is present and entered as "&toBU,false)
			else
			Call WriteToReport(micFail,"To BU","is not present",True)
                End If
                
                If .WebList("vouInquiry_AmtRule").Exist(nMINWAIT) Then
              	  .WebList("vouInquiry_AmtRule").Select 2
                End  If
                
                If .WebEdit("vouINquiry_Amt").Exist(nMINWAIT) Then
                	.WebEdit("vouINquiry_Amt").Set "0"
                End  If
                
                If .WebEdit("vouInquiry_Currency").Exist(nMINWAIT) Then
                	 .WebEdit("vouInquiry_Currency").Set "USD"
		End  If


                If EntryStatus<>"" Then
                                If .WebList("EntryStatus").Exist(nminwait) Then
                                                .WebList("EntryStatus").Select EntryStatus
                                                Call WriteToReport(micPass,"Entry status of the voucher","is present and entered as "&EntryStatus,false)
						else
						Call WriteToReport(micFail,"Entry status of the voucher","is not present",True)
                                End If
                End If
                If PostStatus<>"" Then
                                If .WebList("PostStatus").Exist(nminwait) Then
                                                .WebList("PostStatus").Select PostStatus
                                                Call WriteToReport(micPass,"Post status of the voucher","is present and value entered as "&PostStatus,false)
						else
						Call WriteToReport(micFail,"Post status of the voucher","is not present",True)
                                End If
                End If
                
                wait(10)
                
                If .WebButton("vouInquiry_btnSearch").Exist(nminwait) Then
                                .WebButton("vouInquiry_btnSearch").Click
                                Call WriteToReport(micPass,"Search button to Search the voucher","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Search button to Search the voucher","is not present",True)
                End If
end with              
                app_searchSync():app_searchSync():app_searchSync()
                with Browser("PeopleSoft Browser").Page("Voucher")
                If .WebButton("OK").Exist(nminwait) Then
                                Reporter.ReportEvent micPass," Message popup","Message displayed as"&.WebElement("MessageforDifference").GetROProperty("innertext")
                                .WebButton("OK").Click
                                  Call WriteToReport(micPass,"Ok button ","is present and clicked",false)
                End If
                end with
                app_searchSync():app_searchSync():app_searchSync()
                
                filename=Replace(date,"/","")&"emx"
                filePath= filePath&"\"&filename&".csv" 
                Set fso = CreateObject("Scripting.FileSystemObject")
                If (fso.FileExists(filePath)) Then
                                fso.DeleteFile(filePath)
                End If
                Set fso = nothing
                
                
                
               Set obj = createobject("Excel.Application")  'Creating an Excel Object
               obj.visible=false                                    'Making an Excel Object visible
               obj.DisplayAlerts=false
               Set obj12 = obj.Workbooks.Add()       'Adding a Workbook to Excel Sheet
               On error resume next
               Set obj1=obj12.Sheets("Sheet2")
               If err.number<>0 Then
               	obj1.delete
               	err.clear
               End If
               Set obj1=obj12.Sheets("Sheet3")
                If err.number<>0 Then
               	obj1.delete
               	err.clear
               End If
               On error goto 0
               Set obj1=obj12.Sheets("Sheet1")
                If Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").WebTable("vouInquiry_tblSearchVoucher").Exist(nminwait) Then
                                rc=Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").WebTable("vouInquiry_tblSearchVoucher").RowCount
                                If rc>5 Then
                                                rc=5
                                End If
                else
                                rc=0
                                reporter.ReportEvent micFail,"No voucher available","No voucher available"
                End If
                Set fso = CreateObject("Scripting.FileSystemObject")
'                Set objCSVFile = fso.CreateTextFile(filePath,2, True)
                for i=1 to rc
                		Reporter.ReportEvent micdone,"value captured for row "&i,"value captured from application "
                                for k=1 to 2
'                                               obj1.Cells(i,k).Value="'"&Trim(Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").WebTable("vouInquiry_tblSearchVoucher").GetCellData(i,k+1))
                                                strVal=Browser("PeopleSoft Browser").Page("Voucher").PSFrame("AP Voucher Inquiry").WebTable("vouInquiry_tblSearchVoucher").GetCellData(i,k+1)
                                               obj1.Cells(i,k).Value="'"&Trim(strVal)
'                                                objCSVFile.Write Trim(strVal)
                                                reporter.ReportEvent micPass,"value captured","value captured from application as "&strVal
'                                                If k=1 Then
'                                                                objCSVFile.Write ","
'                                                End If
                                Next
'                              objCSVFile.Writeline
                next
'                objCSVFile.close
'                Set objFSO = nothing
'                Set objCSVFile = nothing              
               obj1.Name=filename
               obj12.Save
               obj12.SaveAs  filePath,6 'Saving a Workbook
               obj12.Close                                             'Closing a Workbook
               obj.Quit                                                  'Exit from Excel Application
               Set obj1=Nothing                                 'Releasing Workbook object
               Set obj=Nothing  
getVoucherandSavetoCSVfile=filePath
End Function

'**********************************************************************************************************************************************************
''' <summary>  
''' AddNewSupplier() To add the new supplier
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "Entry Status"</note> 
''' </para>
''' </summary>
''' <author>Karthik</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to perform Mass voucher Maintenance</startstate>
''' <endstate>Error message displayed upon unposting </endstate>
'Change Control: 
'   NA
'   Date of Change          Author                Description of change
'************************************************************************************************************************************************************


Public Function LoadRecycleRanUnPost()
Dim PostStatus,EntryStatus,fromBu,toBU,filePath,BUs(),VoucherIDs()
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	PostStatus=GlobalDictionary("PostStatus")
	EntryStatus=GlobalDictionary("EntryStatus")
	fromBu=GlobalDictionary("businessUnit")
	toBU=GlobalDictionary("businessUnit")
	filePath=GlobalDictionary("filePath")
	filePath=getVoucherandSavetoCSVfile(PostStatus,EntryStatus,fromBu,toBU,filePath)
	
	'Accounts Payable -->Vouchers-->Maintain-->Voucher Mass Maintenace
	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	app_SearchSync()

	With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance")
		If .WebEdit("VoucherMain_FileName").Exist(nminwait) Then
			.WebEdit("VoucherMain_FileName").Set filePath
			Call WriteToReport(micPass," enter File name/path for the csv file","is present and entered as"&filepath ,false)
			else
			Call WriteToReport(micFail,"enter File name/path for the csv file","is not present",True)
		End If
		app_SearchSync()
		If .WebButton("VoucherMain_LoadVouchers").Exist(nminwait) Then
			.WebButton("VoucherMain_LoadVouchers").Click
			 Call WriteToReport(micPass,"LoadVouchers button","is present and Clicked" ,false)
			else
			Call WriteToReport(micFail,"LoadVouchers button","is not present",True)
		End If
		Dim rc
		If .WebTable("VoucherMaint_SearchResults").Exist(nminwait) Then
			rc=.WebTable("VoucherMaint_SearchResults").RowCount
			If rc>5 Then
				rc=5
			End If
			For i = 1 To rc Step 1
				ReDim Preserve BUs(i-1):BUs(i-1)=.WebTable("VoucherMaint_SearchResults").GetCellData(i,3)
				ReDim Preserve VoucherIDs(i-1):VoucherIDs(i-1)=.WebTable("VoucherMaint_SearchResults").GetCellData(i,5)
			Next
		End If
		If .WebButton("VoucherMaint_UnPost").Exist(nminwait) Then
			.WebButton("VoucherMaint_UnPost").Click
			 Call WriteToReport(micPass,"UnPost button","is present and Clicked" ,false)
			else
			Call WriteToReport(micFail,"Unpost button","is not present",True)
		End If
		app_SearchSync()
	End With	
	
	For i=0 to 3
		app_SearchSync()
	Next
	
	With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").WebElement("ErrorMessage")
	If .Exist(nMINWAIT) Then
		appMessage=.GetROProperty("innertext")
		Reporter.ReportEvent micPass,"The Following pop up meesage is","displayed upon Deleting the Unposting the Recycled voucher"&appMessage
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").WebButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With 
	


End Function

Public Function LoadPostedRanDelete()
Dim PostStatus,EntryStatus,fromBu,toBU,filePath,BUs(),VoucherIDs()
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	PostStatus=GlobalDictionary("PostStatus")
	EntryStatus=GlobalDictionary("EntryStatus")
	fromBu=GlobalDictionary("businessUnit")
	toBU=GlobalDictionary("businessUnit")
	filePath=GlobalDictionary("filePath")
	filePath=getVoucherandSavetoCSVfile(PostStatus,EntryStatus,fromBu,toBU,filePath)
	
	'Accounts Payable -->Vouchers-->Maintain-->Voucher Mass Maintenace
	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	app_SearchSync()

	With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance")
		If .WebEdit("VoucherMain_FileName").Exist(nminwait) Then
			.WebEdit("VoucherMain_FileName").Set filePath
			Call WriteToReport(micPass," enter File name/path for the csv file","is present and entered as"&filepath ,false)
			else
			Call WriteToReport(micFail,"enter File name/path for the csv file","is not present",True)
		End If
		app_SearchSync()
		If .WebButton("VoucherMain_LoadVouchers").Exist(nminwait) Then
			.WebButton("VoucherMain_LoadVouchers").Click
			 Call WriteToReport(micPass,"LoadVouchers button","is present and Clicked" ,false)
			else
			Call WriteToReport(micFail,"LoadVouchers button","is not present",True)
		End If
		Dim rc
		If .WebTable("VoucherMaint_SearchResults").Exist(nminwait) Then
			rc=.WebTable("VoucherMaint_SearchResults").RowCount
			If rc>5 Then
				rc=5
			End If
			For i = 1 To rc Step 1
				ReDim Preserve BUs(i-1):BUs(i-1)=.WebTable("VoucherMaint_SearchResults").GetCellData(i,3)
				ReDim Preserve VoucherIDs(i-1):VoucherIDs(i-1)=.WebTable("VoucherMaint_SearchResults").GetCellData(i,5)
			Next
		End If
		End  WIth 
		
		With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance").WebButton("VoucherMaint_Delete")
		If .Exist(nMINWAIT) Then
			.Click
		End If
		End  WIth
		
	With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").WebElement("ErrorMessage")
	If .Exist(nMINWAIT) Then
		appMessage=.GetROProperty("innertext")
		Reporter.ReportEvent micPass,"The Following pop up meesage is","displayed upon Deleting the Unposting the Recycled voucher"&appMessage
	End If
	End  With 
	
	With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").WebButton("OK")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  With 
			
End Function

Public Function loadUnpostedRanUnpost()
	Dim PostStatus,EntryStatus,fromBu,toBU,filePath,BUs(),VoucherIDs()
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	PostStatus=GlobalDictionary("PostStatus")
	EntryStatus=GlobalDictionary("EntryStatus")
	fromBu=GlobalDictionary("businessUnit")
	toBU=GlobalDictionary("businessUnit")
	filePath=GlobalDictionary("filePath")
	filePath=getVoucherandSavetoCSVfile(PostStatus,EntryStatus,fromBu,toBU,filePath)
	
	'Accounts Payable -->Vouchers-->Maintain-->Voucher Mass Maintenace
	SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
	app_SearchSync()

	With Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").PSFrame("VoucherMassMaintenance")
		If .WebEdit("VoucherMain_FileName").Exist(nminwait) Then
			.WebEdit("VoucherMain_FileName").Set filePath
			Call WriteToReport(micPass," enter File name/path for the csv file","is present and entered as"&filepath ,false)
			else
			Call WriteToReport(micFail,"enter File name/path for the csv file","is not present",True)
		End If
		app_SearchSync()
		If .WebButton("VoucherMain_LoadVouchers").Exist(nminwait) Then
			.WebButton("VoucherMain_LoadVouchers").Click
			 Call WriteToReport(micPass,"LoadVouchers button","is present and Clicked" ,false)
			else
			Call WriteToReport(micFail,"LoadVouchers button","is not present",True)
		End If
		Dim rc
		If .WebTable("VoucherMaint_SearchResults").Exist(nminwait) Then
			rc=.WebTable("VoucherMaint_SearchResults").RowCount
			If rc>5 Then
				rc=5
			End If
			For i = 1 To rc Step 1
				ReDim Preserve BUs(i-1):BUs(i-1)=.WebTable("VoucherMaint_SearchResults").GetCellData(i,3)
				ReDim Preserve VoucherIDs(i-1):VoucherIDs(i-1)=.WebTable("VoucherMaint_SearchResults").GetCellData(i,5)
			Next
		End If
		If .WebButton("VoucherMaint_UnPost").Exist(nminwait) Then
			.WebButton("VoucherMaint_UnPost").Click
			 Call WriteToReport(micPass,"UnPost button","is present and Clicked" ,false)
			else
			Call WriteToReport(micFail,"Unpost button","is not present",True)
		End If
		app_SearchSync()
	End With
	
	If Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").WebElement("ErrorMessage").Exist(nminwait) Then
		Call WriteToReport(micPass,"Expected pop up ,error message displayed","Expected message is displayed as "&Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").WebElement("ErrorMessage").GetROProperty("innertext") ,false)
	End If
	If Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").WebButton("OK").Exist(nminwait) Then
		Browser("PeopleSoft Browser").Page("VoucherMassMaintenance").WebButton("OK").Click
		Call WriteToReport(micPass,"OK button","is present and clicked" ,false)
	End If
app_SearchSync()

	
End Function


Public Function VerifyAttachments()
SelectMainMenu1(GlobalDictionary("MainMenuAttachment"))
dtsetId=GlobalDictionary("setID")
vendorId=GlobalDictionary("SupplierIdCreated")

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("SetID")
If .Exist(nMINWAIT) Then
	.Set dtsetId
	Call WriteToReport(micPass,"The set ID ","is entered="&dtsetId, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("FindExistingValue_VendorID")
If .Exist(nMINWAIT) Then
	.Set vendorId
	Call WriteToReport(micPass,"The Supplier ID ","is entered="&vendorId, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"The Search button","is clicked", false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("IdentifyingInformation")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Identifying Information tab","is selected", false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").Link("Attachments")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"The Attachment is","present and clicked", false)
	wait(1)
	setFileName=GlobalDictionary("docFileName")
	getFileName=Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Supplier Attachment").WebTable("SupplierAttachment").GetCellData(1,2)
	If setFileName=getFileName Then
		Call WriteToReport(micPass,"Attachments","are verified and the attachement is=" &getFileName, false)
	else
		Call WriteToReport(micFail,"The Attachment","is not present",True)
	End If
	Browser("PeopleSoft Browser").Page("Supplier").PSFrame("Supplier Attachment").WebButton("OK").Click
else
	Call WriteToReport(micFail,"The Attachment","is not present",True)
End If
End  With

End Function



















'*********************************************************************************************************************************
''' <summary>  
''' voucher() To create vouchers with different BussinessUnit and Total amounts
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "businessunit,vouherID,SupplierID,VoucherStyle"</note> 
''' </para>
''' </summary>
''' <author>Vijay Aanand</author>
''' <datecreated>05/02/2019</datecreated>
''' <startstate></startstate>
''' <endstate></endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
Public Function vouchercan
	Dim businessunit,supplierID,VoucherID,PONumber,CopyFrom	,temp,SignInUser
    temp=false
	
	SignInUser=GlobalDictionary("SignInUser")
	businessunit=GlobalDictionary("businessunit")
	dtvoucherID=GlobalDictionary("voucherID")
	supplierID=GlobalDictionary("SupplierID")
	dtVoucherStyle=GlobalDictionary("VoucherStyle")
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	ApproverLimit=GlobalDictionary("ApproverLimit")
	lineAmount=GlobalDictionary("lineAmount")
	
'enter bu	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("BusinessUnit")
		If .Exist(nMINWAIT) Then
			.Set businessunit
			 Call WriteToReport(micPass,"Business unit="&businessunit,"is set",false)
		End If
	End With

'enter voucher id
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("VoucherId")
		If .Exist(nMINWAIT) Then
			.Set dtvoucherID
			Call WriteToReport(micPass,"VoucherId="&dtvoucherID,"is displayed",false)
		End If
	End With

'set voucherstyle
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebList("dropdown_VOUCHER_STYLE")
		If .Exist(nMINWAIT) Then
			.Select dtVoucherStyle
			Call WriteToReport(micPass,"Voucher Style="&dtVoucherStyle,"is displayed",false)
		End If
	End With

'click add button
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Add")
		If .Exist(nMINWAIT) Then
			.Click
			Call WriteToReport(micPass,"Add Button","is clicked",false)
		End If
	End With
		
	GlobalDictionary("voucherID")=apCanada_createaVoucherWithMiscSalestaxFrieghtpaytermandwithoutCopyPO(businessunit,supplierID)
	
	
'cLICK ON summary Tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("Summary")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Summary tab is displayed", "and clicked",False)
	Else
	Call WriteToReport(micFail,"Summary tab is not displayed", "and not able to verify the deails",True)
End If
End With

'validate approver status as pending
'With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("ApproveStatus")
'If .Exist(nMINWAIT) Then
'	If StrComp(.GetROProperty("innertext"),"Pending",1)=0 Then
'		Call WriteToReport(micPass,"ApproveStatus is displayed", "and status is "&.GetROProperty("innertext") ,False)
'		Else
'		Call WriteToReport(micFail,"ApproveStatus isn't displayed", "as pending , Actual is "&.GetROProperty("innertext")  ,True)
'	End If
'Else
'	Call WriteToReport(micFail,"ApproveStatus isn't displayed", "DOESN'T DISPLAYED IN THE APPLICATION",True)
'End If
'End With

'validate approver status as pending
'With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("approvalStatus")
'If .Exist(nMINWAIT) Then
'	If StrComp(.GetROProperty("innertext"),"Pending",1)=0 AND (Cdbl(Trim(ApproverLimit))<cdbl(Trim(abs(lineAmount)))) Then
'		Call WriteToReport(micPass,"ApproveStatus is displayed", "and status is "&.GetROProperty("innertext") ,False)
'		temp=true
'	ElseIf StrComp(.GetROProperty("innertext"),"Approved",1)=0 AND (Cdbl(Trim(ApproverLimit))>cdbl(Trim(abs(lineAmount)))) Then
'		Call WriteToReport(micPass,"ApproveStatus is displayed", "and status is "&.GetROProperty("innertext") ,False)
'	Else
' 		Call WriteToReport(micFail,"Expected ApproveStatus isn't displayed", "ApproverLimit "&ApproverLimit&",lineAmount"&lineAmount&" and status is "&.GetROProperty("innertext") ,true)
'	End If
'Else
'	Call WriteToReport(micFail,"ApproveStatus isn't displayed", "DOESN'T DISPLAYED IN THE APPLICATION",True)
'End If
'End With

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("approvalStatus")
If .Exist(nMINWAIT) Then
	If StrComp(.GetROProperty("innertext"),"Approved",1)=0 AND StrComp(trim(GlobalDictionary("VoucherStyle")),"Regular Voucher",1)=0 AND (Cdbl(Trim(ApproverLimit))>cdbl(Trim(abs(lineAmount)))) Then
		Call WriteToReport(micPass,"ApproveStatus is displayed", "and status is "&.GetROProperty("innertext") ,False)
	ElseIf StrComp(.GetROProperty("innertext"),"Pending",1)=0 Then 
		Call WriteToReport(micPass,"ApproveStatus is displayed", "and status is "&.GetROProperty("innertext") ,False)
		If  StrComp(trim(GlobalDictionary("VoucherStyle")),"Regular Voucher",1)=0 AND (Cdbl(Trim(ApproverLimit))<cdbl(Trim(abs(lineAmount)))) Then
			temp=true
		ElseIf StrComp(trim(GlobalDictionary("VoucherStyle")),"Adjustments",1)=0 Then
		     temp=true
		else
			
		End If
	else
 		Call WriteToReport(micfail,"Expected ApproveStatus isn't displayed", "ApproverLimit "&ApproverLimit&",lineAmount"&lineAmount&" and status is "&.GetROProperty("innertext") ,true)
	End If
Else
	Call WriteToReport(micFail,"ApproveStatus isn't displayed", "DOESN'T DISPLAYED IN THE APPLICATION",True)
End If
End With



If temp Then
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").Link("Approval History")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Approval History link is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Approval History link is not displayed", "and not clicked",True)
	End If
	End With
	
	app_SearchSync()

	
	Call retrieveUsername()
	

	
	'assign approver as sign in user
	'GlobalDictionary("SignInUser")=GlobalDictionary("Approver1")
	
	'user login function
	UserSignIn 
	
	'approve the Voucher in worklist
	WorklistApprovalFlow
	
	'as sign in user
	GlobalDictionary("SignInUser")=SignInUser
	
	'user login function
	UserSignIn 
	
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
dtvoucherID=GlobalDictionary("voucherID")
dtbusinessunit=GlobalDictionary("businessunit")

'To click on Find an Existing value tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucher_tabFindExistingValue")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'To enter BU
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("voucherFE_txtBUSINESS_UNIT")
If .Exist(nMINWAIT) Then
	.Set dtbusinessunit
	Call WriteToReport(micPass,"BusinessUnit is="&dtbusinessunit,"is displayed",false)
End If
End With 

'To enter voucher ID 
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("voucherFE_txtVOUCHER_ID")
If .Exist(nMINWAIT) Then
	.Set dtvoucherID
	Call WriteToReport(micPass,"VoucherId is="&dtvoucherID,"is displayed",false)
End If
End With

'To click on search
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("voucher_btnSearch")
If .Exist(nMINWAIT) Then
	.Click
End If
End With 

'cLICK ON summary Tab
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("Summary")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Summary tab is displayed", "and clicked",False)
	Else
	Call WriteToReport(micFail,"Summary tab is not displayed", "and not able to verify the deails",True)
End If
End With


'To check the approval status 
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("approvalStatus")
If .Exist(nMINWAIT) Then
    Call WriteToReport(micPass,"Approval Status is displayed", "and the status="&.GetROProperty("innertext") ,False)
	Else
	Call WriteToReport(micFail,"ApproveStatus isn't displayed", "DOESN'T DISPLAYED IN THE APPLICATION",True)
End If
End With

	
End If

End Function

public Function retrieveUsername()
j=1
Set obj=Description.Create
obj("micclass").value="Link"
obj("html tag").value="A"
Set listd=Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Approval History").WebTable("Voucher Adj Approval (Pos)").ChildObjects(obj)
For i = 0 To listd.count()-1 Step 1
                userId=listd.item(i).getroproperty("innertext")
                listd.item(i).click
                userId=Browser("PeopleSoft Browser NewTab").Page("Page").WebElement("Approver1").GetROProperty("innertext")
                GlobalDictionary("user" & j)=userId

Browser("PeopleSoft Browser NewTab").Close
wait(2)
Call WriteToReport(micPass,"The approver"&j,"in the list is ="&userId, false)
j=j+1
Next
'j-1 - number of approvers
GlobalDictionary("TotalUsers")=j
coun=j-1
Call WriteToReport(micPass,"Total number of approvers","in the list is ="&coun, false)

	With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Approval History").WebButton("Return")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Return button is displayed", "and clicked",False)
		Else
		Call WriteToReport(micFail,"Return button is not displayed", "and not clicked",True)
	End If
	End With

call retrieveUserID()
End Function

 

public Function retrieveUserID()
count=GlobalDictionary("TotalUsers")
m=1
'Navigate to below page to get the user id
'UserProfileSelection="PeopleTools > Security > User Profiles > User Profiles "
SelectMainMenu1(GlobalDictionary("UserProfileSelection"))
For k = 1 To count-1 Step 1
   ' MsgBox GlobalDictionary("user"&k)
appSuppName=GlobalDictionary("user"&k)
appLatName=split(appSuppName," ")
'Select the Type
dtSearchBy="Description"
With Browser("PeopleSoft Browser").Page("UserProfiles_Security").Frame("Target Content_Security").WebList("SearchBy")
If .Exist(nMINWAIT) Then
                .Select dtSearchBy
End If
End  With
'Enter the User ID
With Browser("PeopleSoft Browser").Page("UserProfiles_Security").Frame("Target Content_Security").WebEdit("txt_search")
If .Exist(nMINWAIT) Then
                .Set "%"&appLatName(0)&"%"
End If
End  With

'CLick on Search button
With Browser("PeopleSoft Browser").Page("UserProfiles_Security").Frame("Target Content_Security").WebButton("user_Search")
If .Exist(nMINWAIT) Then
                .Click
End If
End  With

with Browser("PeopleSoft Browser").Page("UserProfiles_Security").Frame("Target Content_Security").WebButton("Return to Search")
If .Exist(nMINWAIT) Then
                .Click
End If
End  With
Dim rUserID,rDes

With Browser("PeopleSoft Browser").Page("UserProfiles_Security").Frame("Target Content_Security").WebList("SearchBy")
If .Exist(nMINWAIT) Then
        If StrComp(Trim(.GetROProperty("Selection")),"User ID",1)=0 Then
        	rUserID=1
        	rDes=2
        else
        	rUserID=2
        	rDes=1
        End If  
	
End If
End  With


Browser("PeopleSoft Browser").Sync
With Browser("PeopleSoft Browser").Page("UserProfiles_Security").Frame("Target Content_Security").WebTable("View All").Link("View All")
If .Exist(nMINWAIT) Then
                .Click
End If
End With
With Browser("PeopleSoft Browser").Page("UserProfiles_Security").Frame("Target Content_Security").WebTable("table_userprofile")
If .Exist(nMINWAIT) Then
                For i=1 to .RowCount
                                appName=.GetCellData(i,rDes)
                                If StrComp(Trim(appName),Join(appLatName," "),1)=0 Then
                                                appSupUserId=.GetCellData(i,rUserID)
                                                wait(2)
                                                GlobalDictionary("userID" & m)=appSupUserId
                                                Call WriteToReport(micPass,"The corresponding " &appName,"userId is="&appSupUserId, false)
                                                Exit for
                                                'Else
                                'Call WriteToReport(micFail,"UserID","is not present",True)
                                End If   
                Next
End If
End With
m=m+1
Next
GlobalDictionary("SignInUser")=GlobalDictionary("userID1")

End Function



'AP_Create a Voucher with Misc, Salestax,Frieght,payterm and without Copy PO
Function apCanada_createaVoucherWithMiscSalestaxFrieghtpaytermandwithoutCopyPO(businessunit,supplierID)
	Dim voucherID,invoiceNo,Dept,Account,Quantity,freight,Total,invoiceDate,appinvoiceNo,salesTax,Classification,lineAmount,i
	Dim PayTerm
	
	
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo")&inVoiceNumberGeneration
	invoiceDate=date'-3
	'GlobalDictionary("invoiceDate")=invoiceDate
	PayTerm=GlobalDictionary("PayTerm")
	Total=GlobalDictionary("Total")
	freight=GlobalDictionary("Fright")
	salesTax=GlobalDictionary("Salestax")
	Quantity=GlobalDictionary("Quantity")
	Misc=GlobalDictionary("Misc")
	lineAmount=GlobalDictionary("lineAmount")
	Account=GlobalDictionary("Account")
	Dept=GlobalDictionary("Dept")
	Classification=GlobalDictionary("Classification")
	
	'wait for the ojects to get loaded
	app_SearchSync()
'	wait 3
	
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
		'.WebEdit("BusinessUnit").WaitProperty "visible",True,20000

		'enter invoice id and invoice date and save
		If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
			.WebEdit("invoiceNo").Set invoiceNo
			Call WriteToReport(micPass,"invoiceNo :"&invoiceNo," invoiceNo is present as "&invoiceNo,false)
			else
			Call WriteToReport(micFail,"invoiceNo","is not present",True)
		End If
		
		If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
			.WebEdit("invoiceDate").Set invoiceDate
			Call WriteToReport(micPass,"invoice Date "&invoiceDate,"is present and entered as "&invoiceDate,false)
			else
			Call WriteToReport(micFail,"invoice Date","is not present",True)
		End If
		
		If NOT IsEmpty(Payterm) AND (Payterm<>"") Then
			If (len(Payterm)=3) Then
				If .WebEdit("PayTerms").Exist(nMINWAIT) Then
					.WebEdit("PayTerms").Set PayTerm
					Call WriteToReport(micPass,"PayTerm ","is present and entered as"&PayTerm,false)
					else
					Call WriteToReport(micFail,"PayTerm","is not present",True)
				End If
			End If
		End If
		
End with	
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Exist(nMINWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Click
	End If

	If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Exist(nMINWAIT) Then
'		If InStr(supplierID,"...")<>0 Then
		Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Set Replace(supplierID,"...","")
		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Click
		End If

		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").Exist(nMINWAIT) Then
			If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").RowCount))>1 Then
				Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").ChildItem(2,1,"Link",0).click
			End If
		End If
'		else
'			Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID").Set Trim(supplierID)
'		End If
		Call WriteToReport(micPass,"Supplier ID","is present and value entered"&supplierID,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
	If .WebEdit("Account").Exist(nMINWAIT) Then
		.WebEdit("Account").Click
		wait(3)
		.WebEdit("Account").Set Account
		Call WriteToReport(micPass,"Account :"&Account,"is present and entered as"&Account,false)
		else
		Call WriteToReport(micFail,"Account","is not present",True)
	End If
	If .WebEdit("Dept").Exist(nMINWAIT) Then
		.WebEdit("Dept").Set Dept
		Call WriteToReport(micPass,"Dept :"&Dept,"is present and entered as "&Dept,false)
		else
		Call WriteToReport(micFail,"Dept","is not present",True)
	End If
	
	If .WebEdit("Classification").Exist(nMINWAIT) Then
		.WebEdit("Classification").Set Classification
		Call WriteToReport(micPass,"Classification :"&Classification,"is present and entered as "&Classification,false)
		else
		Call WriteToReport(micFail,"Classification","is not present",True)
	End If

	If NOT IsEmpty(freight) AND freight<>"" Then
		If  freight>0  Then
		If .WebEdit("freight").Exist(nMINWAIT) Then
			.WebEdit("freight").Set freight
			Call WriteToReport(micPass,"Freight ","is present and entered as"&Fright,false)
			else
			Call WriteToReport(micFail,"Freight","is not present",True)
		End If
		End If
	End If
	
	wait 3 
	If NOT IsEmpty(Salestax) AND Salestax<>"" Then
		If Salestax>0 Then
		If .WebEdit("salesTax").Exist(nMINWAIT) Then
			.WebEdit("salesTax").Set Salestax
			Call WriteToReport(micPass,"Salestax ","is present and entered as"&Salestax,false)
			else
			Call WriteToReport(micFail,"Salestax","is not present",True)
		End If
		End If
	End If
	wait 3 
	If NOT IsEmpty(Misc) AND Misc<>""  Then
		If Misc>0 Then
		If .WebEdit("MiscellaousAmount").Exist(nMINWAIT) Then
			.WebEdit("MiscellaousAmount").Set Misc
			Call WriteToReport(micPass,"MiscellaousAmount ","is present and entered as"&Misc,false)
			else
			Call WriteToReport(micFail,"MiscellaousAmount","is not present",True)
		End If
		End If
	End If
	
	If NOT IsEmpty(Quantity) AND Quantity<>"" Then
		If Quantity>0 Then
		If .WebEdit("Quantity").Exist(nMINWAIT) Then
			.WebEdit("Quantity").Set(Quantity)
			Call WriteToReport(micPass,"Quantity :"&Quantity ,"Unit price value enter as "&Quantity ,false)
			else
			Call WriteToReport(micFail,"Unitprice","is not present",True)
		End If
		End If
	End If
	app_SearchSync()
	If .WebEdit("lineAmount").Exist(nMINWAIT) Then
		.WebEdit("lineAmount").Set lineAmount
		Call WriteToReport(micPass,"lineAmount :"&lineAmount,"is present and entered as "&lineAmount,false)
		else
		Call WriteToReport(micFail,"lineAmount","is not present",True)
	End If
	If .WebButton("CalculateInvoiceLine").Exist(nMINWAIT) Then
		.WebButton("CalculateInvoiceLine").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If .WebElement("Difference").Exist(nMINWAIT) Then
		appDifference=.WebElement("Difference").GetROProperty("innertext")
		Call WriteToReport(micPass,"Deifference is captured","Captured from application as"&appDifference,false)
	End If
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		.WebEdit("Total").Click
		appDifference=cdbl(appDifference)+Cdbl(.WebEdit("Total").GetROProperty("value"))
		.WebEdit("Total").Set appDifference
		Call WriteToReport(micPass,"Total : "&appDifference,"is present and entered as "&appDifference,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked to get difeerence",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .WebElement("Difference").Exist(nMINWAIT) Then
		appDifference=.WebElement("Difference").GetROProperty("innertext")
		Call WriteToReport(micPass,"Difference should be 0","Captured from application as"&appDifference,false)
	End If
	
	
	app_SearchSync()	
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
		If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
		End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	
	'wait for the ojects to get loaded
	app_SearchSync()
	'wait for the ojects to get loaded
	app_SearchSync()
'Voucher id generation validation	
	If .WebElement("voucherID").Exist(nMINWAIT) Then
		voucherID=.WebElement("voucherID").GetROProperty("innertext")
		If StrComp(voucherID,"NEXT",1)<>0 Then
			Call WriteToReport(micPass,"voucherID : "&voucherID,"is present and generated as "&voucherID,false)
			else
			Call WriteToReport(micFail,"voucherID","doesn't get generated",True)
		End If
	End If
End with

'to check the tax exempt check box
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebCheckBox("chkboxTAXEXEMPT")
		If .Exist(nMINWAIT) Then
					Call WriteToReport(micPass,"Checkbox TAXEXEMPT","is displayed",false)
		End If
End With

'CLick on Ok button if exists
With Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
	Else
	Call WriteToReport(micPass,"No error message displayed", "and changes are saved sucessfully",False)
End If
End With


'Click on SUbmit for Approcal page
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SubmitApproval")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Submit Approval button","is clicked",False)
	Else
	Call WriteToReport(micFail,"Submit Approval button","is not present",True)
End If
End With

'Enter the addition details and click on Ok button
With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("ApprovalComments_VoucherAttribute").WebEdit("AdditionalComments")
If .Exist(nMINWAIT) Then
	.Set dtAdditionalComments
	Call WriteToReport(micPass,"Additional comments","is present and set",False)
else
	Call WriteToReport(micPass,"Additional comments","is not present and set",False)
End If
End With

'CLick on Ok button
With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("ApprovalComments_VoucherAttribute").WebButton("Ok")
If .Exist(nMINWAIT) Then
	.Click
	wait(1)
	Call WriteToReport(micPass,"OK button", "is clicked",False)
End If
End With


'

apCanada_createaVoucherWithMiscSalestaxFrieghtpaytermandwithoutCopyPO=voucherID
End Function

Public Function WorklistApprovalFlow
dtvoucherID=GlobalDictionary("voucherID")
dtbusinessunit=GlobalDictionary("businessunit")
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	appDate=.GetCellData(2,2)
	k=0
	invoiceDate=CDate(date)
	While instr(1,CDate(appDate),invoiceDate)=0 and k<10
  		Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable").ChildItem(1,2,"Link",0).Click
  		wait(1)
  		appDate=Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable").GetCellData(2,2)
  		k=k+1
   	Wend
End If
End  With 


'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount
	'appFrom=.GetCellData(i,1)
	'If instr(1,appFrom,dtFromName )>0 Then
		appDate=.GetCellData(i,2)
		vouNo=.GetCellData(i,6)
'		instr(1,CDate(appDate),GlobalDictionary("invoiceDate"))
		If instr(1,vouNo,GlobalDictionary("voucherID")) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	Next
End If
End  With 


'CLick on Approve button
With Browser("PeopleSoft Browser").Page("Approval Framework - Vouchers").PSFrame("Voucher Approval Process").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve button is present ","and clicked  ", false)
End If
End  With 

'validate approved status
With Browser("PeopleSoft Browser").Page("Approval Framework - Vouchers").PSFrame("Voucher Approval Process").WebTable("ApprovedStatuswithVCHRID")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The form is approved ","and green tick is displayed in the approval flow ", false)
End If
End WIth 

End Function


'*********************************************************************************************************************************
''' <summary>  
'''  InventorySupplierForm() To verify vendor record created successfully.
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "businessunit,vouherID,SupplierID,VoucherStyle,dtFormValue,dtSubject,dtDate,dtDesc,dtCompanyName,dtDBAName,dtPaymentCapability,dtNotificationEmail,dtCountry,dtAddressLine1,dtCity,dtProvince,dtZip,dtAcctContName
''',dtContactEmail,dtAccPhone,dtAccFax,dtRequestorName,dtRequestorPhone,dtDepartment,dtReqDate,Approver1,dtFromName,dtFromName2,dtComments,Approver2,APPaymentPerson,dtFrom3
''',dtFilePath,dtSupplierId,dtShortName,dtSupplierType,dtSuppPayGrp,dtExcepUser"</note> 
''' </para>
''' </summary>
''' <author>Vijay anandan</author>
''' <datecreated>05/02/2019</datecreated>
''' <startstate></startstate>
''' <endstate></endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'17420-Inventory
'****************************
Public Function InventorySupplierFormCanada()
'Navigate to Below page
'Suppliers > Supplier Registration > Supplier Forms > Inventory Supplier Form
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
dtFormValue=(GlobalDictionary("dtFormValue"))
dtSubject=(GlobalDictionary("dtSubject"))
dtDate=(GlobalDictionary("dtDate"))
dtDesc=(GlobalDictionary("dtDesc"))
dtCompanyName=(GlobalDictionary("dtCompanyName"))
dtDBAName=(GlobalDictionary("dtDBAName"))
dtPaymentCapability=(GlobalDictionary("dtPaymentCapability"))
dtNotificationEmail=(GlobalDictionary("dtNotificationEmail"))
dtCountry=(GlobalDictionary("dtCountry"))
dtAddressLine1=(GlobalDictionary("dtAddressLine1"))
dtCity=(GlobalDictionary("dtCity"))
dtProvince=(GlobalDictionary("dtProvince"))
dtZip=(GlobalDictionary("dtZip"))
dtAcctContName=(GlobalDictionary("dtAcctContName"))
dtContactEmail=(GlobalDictionary("dtContactEmail"))
dtAccPhone=(GlobalDictionary("dtAccPhone"))
dtAccFax=(GlobalDictionary("dtAccFax"))
dtRequestorName=(GlobalDictionary("dtRequestorName"))
dtRequestorPhone=(GlobalDictionary("dtRequestorPhone"))
dtDepartment=(GlobalDictionary("dtDepartment"))
dtReqDate=(GlobalDictionary("dtReqDate"))

Approver1=(GlobalDictionary("Approver1"))
dtFromName=(GlobalDictionary("dtFromName"))
dtFromName2=(GlobalDictionary("dtFromName2"))
dtComments=(GlobalDictionary("dtComments"))
Approver2=(GlobalDictionary("Approver2"))
APPaymentPerson=(GlobalDictionary("APPaymentPerson"))
dtFrom3=(GlobalDictionary("dtFrom3"))
dtFilePath=(GlobalDictionary("dtFilePath"))


'CLick on Add New Value
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Add New value is ","is present and clicked", false)
	Else
	Call WriteToReport(micFail,"Add New value is ","is not present and clicked", True)
End If
End  With

'enter add value field
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("AddValueToForm")
If .Exist(nMINWAIT) Then
	.Set dtFormValue
	Call WriteToReport(micPass,"AddValueToForm Field  is present ","and set with="&dtFormValue, false)
End If
End  With 

'click add button
With  Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("AddButton")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"AddButton ","is present and clicked", false)
	Else
	Call WriteToReport(micFail,"AddButton ","is not present and clicked", True)
End If
End with 

'wait for the ojects to get loaded
 app_SearchSync()
 
 'Enter all the detasil in the Form
 With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("Fill a Form_Subject")
If .Exist(nMINWAIT) Then
	.Set dtSubject
	Call WriteToReport(micPass,"Subject Field  is present ","and set with="&dtSubject, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_Date")
If .Exist(nMINWAIT) Then
	.Set dtDate
	Call WriteToReport(micPass,"dtDate Field  is present ","and set with="&dtDate, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebList("FillaForm_DescDrpdown")
If .Exist(nMINWAIT) Then
	.Select dtDesc
	Call WriteToReport(micPass,"FillaForm_DescDrpdown  is present ","and set with="&dtDesc, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_CompanyName")
If .Exist(nMINWAIT) Then
	.Set dtCompanyName
	Call WriteToReport(micPass,"FillaForm_CompanyName Field  is present ","and set with="&dtCompanyName, false)
End If
End  With
 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FillaForm_DBAName")
If .Exist(nMINWAIT) Then
	.Set dtDBAName
	Call WriteToReport(micPass,"DBAName Field  is present ","and set with="&dtDBAName, false)
End If
End  With

'Enter all the deail in the Payment capability
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebList("FillaForm_PaymentMethod")
If .Exist(nMINWAIT) Then
	.Select dtPaymentCapability
	Call WriteToReport(micPass,"Payment methond   is present ","and set with="&dtPaymentCapability, false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("FillaForm_SndNotifyEmailchkbox")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")="0" Then
		.Click
		Call WriteToReport(micPass,"FillaForm_SndNotifyEmailchkbox checkbox is present ","and checked  ", false)
	End If
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("FilaForm_NotificationEmail")
If .Exist(nMINWAIT) Then
	.Set dtNotificationEmail
	Call WriteToReport(micPass,"Notification Email   is present ","and set with="&dtNotificationEmail, false)
End If
End  With 

'Enter all the details in Remittance Address
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("RemittanceCountry")
If .Exist(nMINWAIT) Then
	.Set dtCountry
	Call WriteToReport(micPass,"Country   is present ","and set with="&dtCountry, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("RemittanceAddress1")
If .Exist(nMINWAIT) Then
	.Set dtAddressLine1
	Call WriteToReport(micPass,"Address1   is present ","and set with="&dtAddressLine1, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("RemittanceCity")
If .Exist(nMINWAIT) Then
	.Set dtCity
	Call WriteToReport(micPass,"City   is present ","and set with="&dtCity, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("RemittanceProvince")
If .Exist(nMINWAIT) Then
	.Set dtProvince
	Call WriteToReport(micPass,"Province  is present ","and set with="&dtProvince, false)
End If
End  With

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("RemittanceZip")
If .Exist(nMINWAIT) Then
	.Set dtZip
	Call WriteToReport(micPass,"Zip   is present ","and set with="&dtZip, false)
End If
End  With

'Enter te Accounting contact ndetails
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("AccContactName")
If .Exist(nMINWAIT) Then
	.Set dtAcctContName:Call WriteToReport(micPass,"Account name is present ","and set with="&dtAcctContName, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("AccContactEmail")
If .Exist(nMINWAIT) Then
	.Set dtContactEmail:Call WriteToReport(micPass,"Contact email is present ","and set with="&dtContactEmail, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("AccContactPhone")
If .Exist(nMINWAIT) Then
	.Set dtAccPhone:Call WriteToReport(micPass,"AccContactPhone is present ","and set with="&dtAccPhone, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("AccContactFax")
If .Exist(nMINWAIT) Then
	.Set dtAccFax:Call WriteToReport(micPass,"AccContactFax is present ","and set with="&dtAccFax, false)
End If
End  With

'enter requestor details
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("RequestorName")
If .Exist(nMINWAIT) Then
	.Set dtRequestorName:Call WriteToReport(micPass,"RequestorName is present ","and set with ="&dtRequestorName, false)
End If
End  With 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("RequestorPhone")
If .Exist(nMINWAIT) Then
	.Set dtRequestorPhone:Call WriteToReport(micPass,"RequestorPhone is present ","and set with="&dtRequestorPhone, false)
End If
End  With 


With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("RequestorDeptName")
If .Exist(nMINWAIT) Then
	.Set dtDepartment:Call WriteToReport(micPass,"Department is present ","and set with="&dtDepartment, false)
End If
End  With 


With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebEdit("RequestorDate")
If .Exist(nMINWAIT) Then
.Set dtReqDate
	Call WriteToReport(micPass,"RequestorDate Field  is present ","and set with="&dtReqDate, false)
End If
End  With


'Check the attachedmtn checkbox
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebCheckBox("RequestorVerification_Chkbox")
If .Exist(nMINWAIT) Then
	.Click:Call WriteToReport(micPass,"DocumentsAttached is present ","and clicked  ", false)
End If
End  WIth 

'Save trge page
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FillaForm_Save")
If .Exist(nMINWAIT) Then
	.Click:Call WriteToReport(micPass,"Save is present ","and clicked  ", false)
End If
End  WIth

'Get the sequence Number
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("FillaFormSeqenceNumber")
If .Exist(nMINWAIT) Then
	appSequenceNumber=.GetROProperty("innertext")
	GlobalDictionary("SequenceNumber")=appSequenceNumber
	Reporter.ReportEvent micPass,"The form is saved","and the sequence number is="&appSequenceNumber
End If
End  With 

 'wait for the ojects to get loaded
 app_SearchSync()

'Click on Instruction tab
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").Link("FillaForm_Instructions")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Instruction link is present ","and clicked  ", false)
End If
End  WIth

 'wait for the ojects to get loaded
 app_SearchSync()

'Validate the detail ni Instruiction tab
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("Fillaform_InstructionPage")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"Instruction page is displayed ","and validated", false)
End If
End  WIth

'CLick on Attachemnt link
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").Link("FillaForm_Attachments")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Attachments link is present ","and clicked  ", false)
End If
End  With 

 'wait for the ojects to get loaded
 app_SearchSync()


 'CLick on Attach button
 With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FillaForm_Attach")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Attachments button is present ","and clicked  ", false)
End If
End  With


'Upload the file
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("FileAttachment").WebFile("fillaForm_AttachDocs")
If .Exist(nMINWAIT) Then
	.Set dtFilePath
End If
End  With 

wait 3
'CLick on Upload Button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("FileAttachment").WebButton("FillAttachment_Upload")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Attachments button is present ","and clicked  ", false)
End If
End  With

 'wait for the ojects to get loaded
 app_SearchSync()

docNameSplit=split(dtFilePath,"\")
docName=docNameSplit(UBound(docNameSplit))

With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").PSFrame("TargetContent").WebTable("table_attachments")
	If .Exist(nMINWAIT) Then
		fileName=.GetCellData(1,2)
	End If
End With

fileNameSplit=split(fileName,".")
fileNameUpdate=fileNameSplit(LBound(fileNameSplit))

'fileName=Browser("PeopleSoft Browser").Page("Search/Fill in a Form").PSFrame("TargetContent").WebTable("table_attachments").GetCellData(1,2)

If InStr(docName,fileNameUpdate)>0 Then
	Call WriteToReport(micPass,"Attachments are uploaded successfully","and the file uploaded is=" &fileName,false)
End If

GlobalDictionary("docFileName")=fileName

'click on FOrm LInk
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").Link("FillaForm_Form")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Form link is present ","and clicked  ", false)
End If
End  With

'Click submit button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FillaForm_Submit")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Submit button is present ","and clicked  ", false)
End If
End  With

'CLick on Ok button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebButton("FilaForm_Submit_Ok")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'Set the GLobal dictionary of Usert id to MICHPER
GlobalDictionary("SignInUser")=(GlobalDictionary("Approver1"))

End Function

Public Function InventorySupplierFormApproval1ApproveFlowCanada()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
dtFromName=(GlobalDictionary("dtFromName"))
dtSupplierId=(GlobalDictionary("dtSupplierId"))&Replace(Replace(replace(Time,":","")," ",""),"/","")
GlobalDictionary("SupplierIdCreated")=dtSupplierId
dtShortName=(GlobalDictionary("dtShortName"))
dtSupplierType=(GlobalDictionary("dtSupplierType"))
dtSuppPayGrp=(GlobalDictionary("dtSuppPayGrp"))
dtExcepUser=(GlobalDictionary("dtExcepUser"))

With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	appDate=.GetCellData(2,2)
	k=0
	invoiceDate=CDate(date)
  		Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable").ChildItem(1,2,"Link",0).Click
  		wait(3)
  		Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable").ChildItem(1,2,"Link",0).Click

End If
End  With 

'Chck the worklist table and search for the name
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=2 to .RowCount
	appFrom4=.GetCellData(i,1)
	If instr(1,appFrom4,dtName2,1 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber"),1) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'Click goto form button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("GoToForm")
	If .Exist(nMINWAIT) Then
	 .Click
End If
End  WIth

'wait for the ojects to get loaded
		app_SearchSync()
		
'Look for supplier ID

If Len(dtSupplierId)>10 Then
	dtSupplierId=Mid(dtSupplierId,1,2)&Replace(Replace(replace(Time,":","")," ",""),"/","")
	wait(10)
	GlobalDictionary("SupplierIdCreated")=dtSupplierId
End If

'Enter all the supplier details in the form
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Form").WebEdit("Form_SupplierId")
		If .Exist(nMINWAIT) Then
			.Set dtSupplierId
			Reporter.ReportEvent micPass,"The Form_SupplierId field is present and","set with="&dtSupplierId
			Else
			Reporter.ReportEvent micFail,"The Form_SupplierId field is not","present"
		End If
		End  WIth 
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Form").WebEdit("Form_SupplierShortName")
		If .Exist(nMINWAIT) Then
			.Set dtShortName
			Reporter.ReportEvent micPass,"The supplier name is present and","set with="&dtShortName
			Else
			Reporter.ReportEvent micFail,"The suppleir name is not","present"
		End If
		End  WIth 
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Form").WebList("Form_SupplierTypeDrpDwn")
		If .Exist(nMINWAIT) Then
			.Select dtSupplierType
			Reporter.ReportEvent micPass,"The supplier type is present and","set with="&dtSupplierType
			Else
			Reporter.ReportEvent micFail,"The supplier type is not","present"
		End If
		End  WIth
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Form").WebEdit("Form_SupplierPayGroup")
		If .Exist(nMINWAIT) Then
			.Set dtSuppPayGrp
			Reporter.ReportEvent micPass,"The Form_SupplierPayGroup is present and","set with="&dtSuppPayGrp
			Else
			Reporter.ReportEvent micFail,"The Form_SupplierPayGroup is not","present"
		End If
		End  WIth 
		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Form").WebEdit("Form_MatchExceptionUser")
		If .Exist(nMINWAIT) Then
			.Set dtExcepUser
			Reporter.ReportEvent micPass,"The supplier Form_MatchExceptionUser is present and","set with="&dtExcepUser
			Else
			Reporter.ReportEvent micFail,"The suppleir Form_MatchExceptionUser is not","present"
		End If
		End  WIth 
	
	'wait for the ojects to get loaded
		app_SearchSync()

'click ok button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Form").WebButton("Form_OK")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"OK button is present ","and clicked  ", false)
End If
End  WIth 

'CLick on Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve buttion ","is present and clicked", false)
End If
End  WIth 

'validate approved status
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The form is Approved ","aand Green tick is displayed in the approval flow ", false)
End If
End  WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("Approver2"))

'Sign out of application

End Function


Public Function InventorySupplierFormApproval2ApproveFlowCanada()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
Call WriteToReport(micPass,"Now following user is loggedin "&(GlobalDIctionary("Approver2")),"to Approve the sequence", false)
dtFromName1=(GlobalDictionary("dtFromName1"))
dtComments=(GlobalDictionary("dtComments"))

With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	appDate=.GetCellData(2,2)
	k=0
	invoiceDate=CDate(date)
  		Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable").ChildItem(1,2,"Link",0).Click
  		wait(3)
  		Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable").ChildItem(1,2,"Link",0).Click

End If
End  With 

'Chck the worklist table and search for the name
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=2 to .RowCount
	appFrom4=.GetCellData(i,1)
	If instr(1,appFrom4,dtName2,1 )>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber"),1) Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

''enter the comments
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebEdit("CommentBox")
If .Exist(nMINWAIT) Then
	.Set dtComments1
End If
End  WIth 

'CLickon Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve button ","is present and clicked", false)
End If
End  WIth 

With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved2")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The status is approved ","and able to see the green tick", false)
End If
End  WIth

'click goto form btton
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("GoToForm")
	If .Exist(nMINWAIT) Then
	 .Click
End If
End  WIth

'click save and post button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm").WebButton("Approve_SaveAndPost")
If .Exist(nMINWAIT) Then
	 .Click
End If
End  WIth

'click ok
With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").WebElement("alertbutton")
If .Exist(nMINWAIT) Then
	 .Click
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").WebElement("alertMsg")
If .Exist(nMINWAIT) Then
    Browser("PeopleSoft Browser").Page("Search/Fill in a Form").WebElement("alertbutton").click
	Call WriteToReport(micPass,"alertMsg is present and displayed as "," The form / has been successfully posted to the transaction table ", false)
End If
End  WIth 

'click close 
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").WebElement("Form_close")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"close button is present ","and clicked  ", false)
End If
End  WIth

 
GlobalDictionary("SignInUser")=(GlobalDIctionary("APPaymentPerson"))
'Log out of applciation

End  Function



'*********************************************************************************************************************************
''' <summary>  
''' runPaymentSelectionNonInventory()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayCycle"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_07_01_04b
Public Function runPaycycleJobsandApprovewithapprover()
	Dim PayCycle,businessunit,appPaycycleStatus,flag,i,appVoucherCount
	Dim BU(),Vid(),RC,strSelection
	PayCycle=Split(GlobalDictionary("PayCycle"),";")
	
	businessunit=GlobalDictionary("businessunit")
	
	'Navigate to Account Payable --> Payments --> payment processing -> Pay Cycle Manager
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		
	For i = 0 To ubound(paycycle) Step 1
		
		app_SearchSync()
		
		'open a paycycle
		ap_openApaycycle(paycycle(i))
		
		app_SearchSync()
		
		appPaycycleStatus=ap_getPayCycleStatus()
		flag=0
		If InStr(1,appPaycycleStatus,"Selected",1)<>0 Then
			With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
				If .WebButton("PayCycle_Reset").Exist(nminwait) Then
					.WebButton("PayCycle_Reset").Click
				End If
			End With
			If Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Click
			End If
			ap_refreshTillStatuschaged(appPaycycleStatus):GlobalDictionary(cycleNO)=i
			flag=1:Exit for
		ElseIf InStr(1,appPaycycleStatus,"running",1)<>0 Then
			ap_refreshTillStatuschaged(appPaycycleStatus)
			If InStr(1,appPaycycleStatus,"Selected",1)<>0 Then
				With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
					If .WebButton("PayCycle_Reset").Exist(nminwait) Then
						.WebButton("PayCycle_Reset").Click
					End If
				End With
				wait(3)
				If Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Exist(nminwait) Then
					Browser("PeopleSoft Browser").Page("PayCycleManager").WebButton("PayCycle_Alert_Ok").Click
				End If
				ap_refreshTillStatuschaged(appPaycycleStatus):GlobalDictionary(cycleNO)=i
				flag=1:Exit for
			else
				Call WriteToReport(micDone,"Pay Cycle "&paycycle(i),"Pay Cycle "&paycycle(i)&" has "&appPaycycleStatus&" status, Moving to Next pay cycle" ,false)
				'return to the paycycle Manager search
				If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Exist(nminwait) Then
					Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Click
				End If
			End If
		ElseIf InStr(1,appPaycycleStatus,"completed",1)<>0 or InStr(1,appPaycycleStatus,"reset",1)<>0 or InStr(1,appPaycycleStatus,"No work",1)<>0 Then
			If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_Refresh").Click
			End If
			GlobalDictionary(cycleNO)=i
			flag=1:Exit for
		else
			Call WriteToReport(micDone,"Pay Cycle "&paycycle(i),"Pay Cycle "&paycycle(i)&" has "&appPaycycleStatus&" status, Moving to Next pay cycle" ,false)
			'return to the paycycle Manager search
			If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebButton("PayCYcle_ReturntoSearch").Click
			End If
		End If
	Next
	
	If flag Then
		With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
			If .Link("PayCycle_SelectionCriteria").Exist(nminwait) Then
				.Link("PayCycle_SelectionCriteria").Click
				Call WriteToReport(micPass,"Selection Criteria link","is present and clicked",false)
				else
				Call WriteToReport(micFail,"Selection Criteria link","is not present",True)
			End If
			
		End With
		
		'selection criteria added
		Dim strSQL, connectionString, sheetName
		businessUnit=GlobalDictionary("businessUnit")
		sheetName=GlobalDictionary("sheetName")
		connectionString = "Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
			
'			strSQL="select TOP 3 SCHEDULED_PAY_DT from PS_PYMNT_VCHR_XREF where DUE_DT >= '01/01/2018' and BUSINESS_UNIT NOT IN ('00012', '00017') and PYMNT_ID = ' ' and PYMNT_GROUP_CD = '05' order by SCHEDULED_PAY_DT desc, BANK_CD, BANK_ACCT_KEY, PYMNT_METHOD, REMIT_SETID, REMIT_VENDOR"
		strSQL=GlobalDictionary("strSQL")
		If dbGetAllRecords(strSQL, connectionString, sheetName) Then
			Call WriteToReport(micPass,"Query executed successfully","Executed query is ["&strSQL&"]",false)
			call ap_paymentSelectionCritiriSaveDates(GlobalDictionary("daysdIFF"),Cdate(Trim(DataTable.Value("SCHEDULED_PAY_DT",sheetName) )))

'			ap_paymentSelectionCritiriSaveDates(GlobalDictionary("daysdIFF"))
			app_SearchSync()
				
			With Browser("PeopleSoft Browser").Page("PaymentSelectionCriteria").PSFrame("TargetContent")
				If .Link("PayCycle_PayCycleManager").Exist(nminwait) Then
					.Link("PayCycle_PayCycleManager").Click
					Call WriteToReport(micPass,"PayCycle Manager link","is present and clicked",false)
					else
					Call WriteToReport(micFail,"PayCycle Manager link","is not present",True)
				End If
			End With
			
			app_SearchSync()
			'get the current status from appliaction
			appPaycycleStatus=ap_getPayCycleStatus()
			
			With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
				If .WebButton("PayCycle_Process").Exist(nminwait) Then
					If .WebElement("PayCycle_StepName").Exist(nminwait) Then
						Call WriteToReport(micPass,"Process step name"," Selected step name "&.WebElement("PayCycle_StepName").GetROProperty("innertext"),false)
					End If
					.WebButton("PayCycle_Process").Click
					Call WriteToReport(micPass,"process button","is present and clicked",false)
					else
					Call WriteToReport(micFail,"Process button","is not present",True)
				End If
			End With
			
	'refresh till the status is changed		
			ap_refreshTillStatuschaged(appPaycycleStatus)
			
			app_SearchSync()
			If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_ProcessMonitor").Exist(nminwait) Then
				Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_ProcessMonitor").Click
				wait 2:Call WriteToReport(micPass,"process Monitor link","is present and clicked",false)
			End If

			'capture the process instance number
			ap_captureProcessDetailsinProcessMonitorPage()
			
			'open a paycycle
			ap_openApaycycle(paycycle(GlobalDictionary(cycleNO)))
			
			app_SearchSync()
			'capture teh pay cycle status
			appPaycycleStatus=ap_getPayCycleStatus()
			
			If StrComp(Trim(appPaycycleStatus),"No Work",1)<>0 Then
				'validate the voucher count
				appVoucherCount=ap_scheduledPaymentSelectedCountValidation(2,GlobalDictionary("daysdIFF"))
				
				If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_Details").Exist(nminwait) Then
					Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_Details").Click
					Call WriteToReport(micPass,"Details link","is present and clicked",false)
					else
					Call WriteToReport(micFail,"Details link","is not present",True)
				End If
				
				app_SearchSync()
				ap_searchPayCycleDetails(businessUnit)
				app_SearchSync()
		
				
				With Browser("PeopleSoft Browser").Page("PayCycleDetails").PSFrame("PayCyclesDetails")
					If .WebButton("ExcludeALL").Exist(nminwait) Then
						.WebButton("ExcludeALL").Click:app_SearchSync()
						Call WriteToReport(micPass,"Exclude all button","is present and clicked",false)
						wait(3):app_SearchSync():app_SearchSync():app_SearchSync():app_SearchSync()
					End If
					If .WebTable("PayCycleSearchResults").Exist(nminwait) Then
					
						If .WebTable("PayCycleSearchResults").RowCount>2 Then
							rc=2
						else
							RC=.WebTable("PayCycleSearchResults").RowCount
						End If
						For i = 1 To RC Step 1
							ReDim Preserve BU(i-1):BU(i-1)=.WebTable("PayCycleSearchResults").GetCellData(i,4)
							ReDim Preserve Vid(i-1):Vid(i-1)=.WebTable("PayCycleSearchResults").GetCellData(i,5)
							If (i mod 2) Then
								strSelection=(GlobalDictionary("PaymentActionSeparate"))'"Separate"
							else:strSelection=(GlobalDictionary("PaymentActionNone"))'"None"					
							End If
							.WebTable("PayCycleSearchResults").ChildItem(i,1,"WebList",0).select(strSelection)
							Call WriteToReport(micPass,"Payment action selected","Payment action is selected as "&strSelection&" for "&BU(i-1)&" - "&Vid(i-1),false)
							If StrComp(strSelection,"Hold",1)=0 Then
								.WebTable("PayCycleSearchResults").ChildItem(i,2,"WebEdit",0).set(GlobalDictionary("Holdreason"))
								Call WriteToReport(micDone,"Hold reason","is present and selected as : "&(GlobalDictionary("Holdreason")),false)
							End If
						Next
					End If
					
					If .WebButton("Save").Exist(nminwait) Then
						.WebButton("Save").Click
						Call WriteToReport(micPass,"process button","is present and clicked",false)
					End If
					app_SearchSync()
					If .WebButton("Save").Exist(nminwait) Then
						.WebButton("Save").Click
					End If
					For i = 1 To 15 Step 1
						app_SearchSync():wait(3)
					Next
					app_SearchSync()
					If .Link("PayCycleManager").Exist(nminwait) Then
						.Link("PayCycleManager").Click
						Call WriteToReport(micPass,"PayCycleManager link","is present and clicked",false)
					End If
				End With
				
				app_SearchSync()
				appPaycycleStatus=ap_getPayCycleStatus()
				
				With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
					If .WebButton("PayCycle_Process").Exist(nminwait) Then
						If .WebElement("PayCycle_StepName").Exist(nminwait) Then
							Call WriteToReport(micPass,"Process step name"," Selected step name "&.WebElement("PayCycle_StepName").GetROProperty("innertext"),false)
						End If
						.WebButton("PayCycle_Process").Click
						Call WriteToReport(micPass,"process button in Details","is present and clicked",false)
						else
						Call WriteToReport(micFail,"Process button in Details","is not present",True)
					End If
				End With
				
				'refresh till the status is changed		
				ap_refreshTillStatuschaged(appPaycycleStatus)
				app_SearchSync()
				
				If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_ProcessMonitor").Exist(nminwait) Then
					Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_ProcessMonitor").Click
					wait 2:Call WriteToReport(micPass,"process Monitor link","is present and clicked",false)
				End If
				'capture the process instance number
				ap_captureProcessDetailsinProcessMonitorPage()

				app_SearchSync()
				
				'logout the application
				PSFinLogout()
				
				GlobalDictionary("User")=GlobalDictionary("SignInUser")
				GlobalDictionary("SignInUser")=GlobalDictionary("SignInApprover")
				
				'login as approver
				UserSignIn()
				
				'Navigate to Account Payable --> Payments --> payment processing -> Pay Cycle Manager
				SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
				
				'open the paycyle
				ap_openApaycycle(paycycle(GlobalDictionary(cycleNO)))
				
				With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
					If .Link("PayCycle_Approve").Exist(nminwait) Then
						.Link("PayCycle_Approve").Click
						Call WriteToReport(micpass,"Click on Approve link ","Approve link is present and clicked" ,false)
					End If
				End With

				With Browser("PeopleSoft Browser").Page("PayCycleApproval").PSFrame("PayCycleApproval")
					If .WebButton("Approve").Exist(nminwait) Then
						.WebButton("Approve").Click
						Call WriteToReport(micpass,"Click on Approve button ","Approve button is present and clicked" ,false)
					End If
					If .Link("PayCycle_PayCYcleManager").Exist(nminwait) Then
						.Link("PayCycle_PayCYcleManager").Click
						Call WriteToReport(micpass,"Click on Pay CYcle Manager link ","Pay CYcle Manager link is present and clicked" ,false)
					End If
				End With
				
				app_SearchSync()
				'logout the application
				PSFinLogout()
				
				GlobalDictionary("SignInUser")=GlobalDictionary("User")
				
				'login as approver
				UserSignIn()
				
				'Navigate to Account Payable --> Payments --> payment processing -> Pay Cycle Manager
				SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
				
				'open the paycyle
				ap_openApaycycle(paycycle(GlobalDictionary(cycleNO)))

				'Process once
				With Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager")
					If .WebTable("PayCycleResultsFirst3Cols").Exist(nminwait) Then
						rc=.WebTable("PayCycleResultsFirst3Cols").RowCount
						For i = 1 To rc Step 1
							If StrComp(Trim(.WebTable("PayCycleResultsLast6Cols").GetCellData(i,3)),"Approved",1)=0 Then
							
								If .WebTable("PayCycleResultsLast6Cols").Exist(nminwait) Then
									If InStr(1,Trim(.WebTable("PayCycleResultsLast6Cols").GetCellData(i,5)),"web",1)>0 Then
										.WebTable("PayCycleResultsLast6Cols").ChildItem(i,5,"WebList",0).select("Web")
									End If
									If InStr(1,Trim(.WebTable("PayCycleResultsLast6Cols").GetCellData(i,4)),"PSNT1",1)>0 Then
										.WebTable("PayCycleResultsLast6Cols").ChildItem(i,4,"WebList",0).select("PSNT1")
									End If
								End If
	'							Do While Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebTable("PayCycleResultsFirst3Cols").ChildItem(i,1,"WebButton",0).getroproperty("disabled")=0
									appPaycycleStatus=ap_getPayCycleStatus()
									Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebTable("PayCycleResultsFirst3Cols").ChildItem(i,1,"WebButton",0).click				
									Call WriteToReport(micPass,"process button in Pay cycle results ","is present and clicked for Account : "&Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").WebTable("PayCycleResultsFirst3Cols").GetCellData(i,3) ,false)
									app_SearchSync()
									'refresh till the status is changed		
									ap_refreshTillStatuschaged(appPaycycleStatus)
									app_SearchSync()
									
									If Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_ProcessMonitor").Exist(nminwait) Then
										Browser("PeopleSoft Browser").Page("PayCycleManager").PSFrame("PayCycleManager").Link("PayCycle_ProcessMonitor").Click
										wait 2:Call WriteToReport(micPass,"process Monitor link","is present and clicked",false)
									End If
					
									'capture the process instance number
									ap_captureProcessDetailsinProcessMonitorPage()
									
									'open a paycycle
									ap_openApaycycle(paycycle(GlobalDictionary(cycleNO)))
									
									app_SearchSync()
									Exit for
'								loop
							End If
						Next
					End If
				End With
				
				'Navigate to Reporting Tools --> Report manager
				SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))
				
				
				'Navigate to Account Payable --> Payments --> payment processing -> Pay Cycle Manager
				SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
				
				'open the paycyle
				ap_openApaycycle(paycycle(GlobalDictionary(cycleNO)))
				
				'Process till results process get completed
				ap_processThePayCycleResults()
				
				
			else
				Call WriteToReport(micfail,"Pay Cycle moved to No Work Status ","Pay Cycle moved to No Work Status " ,false)
			End If
		End If	
	else
		Call WriteToReport(micfail,"All the Pay Cycles are non executable status ","All the Pay Cycles are non executable status" ,false)
	End If
	

End Function
'
''' <summary>  
''' NonInventorySupplierForm() To  Non-Inventory Supplier Form
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "MainMenuSelection,setID,businessunit,dtSubject,dtSupplierName,dtDBAName,dtMinorityBusiness,dtPaymentCapability,dtNotificationEmail,dtZip,dtState,dtCity,dtAddressLine1,dtCountry,dtCorporatePostal,dtCorporateState,dtCorporateCity,dtCorporateAddress1,dtCorporateCountry,dtAcctContName,dtDepartment,dtRequestorPhone,dtRequestorName,dtBusinessPhon,dtContactEmail,Approver1,dtFromName,dtFromName2,dtComments,Approver2,APPaymentPerson,Approver3,dtFrom3,dtFrom4,dtFilePath,MainMenuSelection3,MainMenuSelection1,dtSupplierId,dtSupplierType,dtShortName,dtPayTerms,dtSubjectTo,dtVendorGroup,dtCompanyType,dtTaxId,dtMatchException,dtBankName,dtTransitNumber,dtDFIQualifier,dtAccountType,MainMenuSelection5,AccountNumber,InvDescription,WorkList"</note> 
''' </para>
''' </summary>
''' <author>Keerthana</author>
''' <datecreated>01/19/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'1.26

Public Function NonInventorySupplierFormCanada()
'Navigate to below page
'Suppliers > Supplier Registration > Supplier Non-Inventory
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

'Section 1
dtSubject=(GlobalDictionary("dtSubject"))
dtDate_Completed=(GlobalDictionary("Date_Completed"))
dtBusinessDescription=(GlobalDictionary("BusinessDescription"))
dtCompany_Name=(GlobalDictionary("Company_Name"))
dtDBAName=(GlobalDictionary("DBA_Name"))

'purchase contact info
dtPurContactName=(GlobalDictionary("purContactName"))
dtPurEmailAddress=(GlobalDictionary("purEmailAddress"))
dtPurTelephone=(GlobalDictionary("PurTelephone"))
dtPurFax=(GlobalDictionary("PurFax"))

'Accounting Contact info
dtAccContactName=(GlobalDictionary("AccContactName"))
dtAccEmailAddress=(GlobalDictionary("AccEmailAddress"))
dtAccTelephone=(GlobalDictionary("AccTelephone"))
dtAccFax=(GlobalDictionary("AccFax"))

'Remittance Address
dtRemittanceCountry=(GlobalDictionary("RemittanceCountry"))
dtAddressLine=(GlobalDictionary("RemiAddressLine"))
dtRemittanceCity=(GlobalDictionary("RemittanceCity"))
dtRemittanceProvince=(GlobalDictionary("RemittanceProvince"))
dtRemittancePostalCode=(GlobalDictionary("RemittancePostalCode"))

'Payment via EFT and Wire
dtPaymentMethod=(GlobalDictionary("dtPaymentMethod"))
dtNotificationEmail=(GlobalDictionary("dtNotificationEmail"))

'Accounting contact information 
dtContactName=(GlobalDictionary("ContactName"))
dtAccountEmail=(GlobalDictionary("AccountEmail"))
dtDepartmentNameAccount=(GlobalDictionary("DepartmentName"))
dtAccountTelephone=(GlobalDictionary("AccountTelephone"))
dtAccountFax=(GlobalDictionary("AccountFax"))

'Section II CDW Requestor Completion
dtRequestorName=(GlobalDictionary("dtRequestorName"))
dtRequestorPhone=(GlobalDictionary("dtRequestorPhone"))
dtDepartmentName=(GlobalDictionary("dtDepartmentName"))
dtVendorAccountDate=(GlobalDictionary("dtVendorAccountDate"))



'Click on Add New value
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("Target Content").WebElement("AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Add new value tab","is present and clicked"
End If
End  WIth

''Section 1
'ENter the subject
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_Subject")
If .Exist(nMINWAIT) Then
	.Set dtSubject
	Reporter.ReportEvent micPass,"Subject is present","and set with="&dtSubject
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Date_Completed")
If .Exist(nMINWAIT) Then
	.Set dtDate_Completed
	Reporter.ReportEvent micPass,"Date Completed is present","and set with="&dtDate_Completed
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebList("BusinessDescription")
If .Exist(nMINWAIT) Then
	.Select dtBusinessDescription
	Reporter.ReportEvent micPass,"Business Description is present","and Select with="&dtBusinessDescription
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Company Name")
If .Exist(nMINWAIT) Then
	.Set dtCompany_Name
	Reporter.ReportEvent micPass,"Compnay Name is present","and set with="&dtCompany_Name
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_DBAName_Can")
If .Exist(nMINWAIT) Then
	.Set dtDBAName
	Reporter.ReportEvent micPass,"Compnay Name is present","and set with="&dtCompany_Name
End If
End  WIth


'purchase contact info
'With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Purchase ContactName_can")
'If .Exist(nMINWAIT) Then
'	.Set dtPurContactName
'	Reporter.ReportEvent micPass,"Purchase contact name is present","and set with="&dtPurContactName
'End If
'End  WIth
'
'With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Purchase Email_can")
'If .Exist(nMINWAIT) Then
'	.Set dtPurEmailAddress
'	Reporter.ReportEvent micPass,"Purchase Email is present","and set with="&dtPurEmailAddress
'End If
'End  WIth
'
'With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Purchase Telephone_can")
'If .Exist(nMINWAIT) Then
'	.Set dtPurTelephone
'	Reporter.ReportEvent micPass,"Purchase Telephone is present","and set with="&dtPurTelephone
'End If
'End  WIth
'
'With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Purchase Fx_can")
'If .Exist(nMINWAIT) Then
'	.Set dtPurFax
'	Reporter.ReportEvent micPass,"purchase Fax is present","and set with="&dtPurFax
'End If
'End  WIth


'Accounting Contact info
'With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Acc ContactName_can")
'If .Exist(nMINWAIT) Then
'	.Set dtAccContactName
'	Reporter.ReportEvent micPass,"Accounting contact name is present","and set with="&dtAccContactName
'End If
'End  WIth
'
'With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Acc Email_can")
'If .Exist(nMINWAIT) Then
'	.Set dtAccEmailAddress
'	Reporter.ReportEvent micPass,"Accounting Email Address is present","and set with="&dtCompany_Name
'End If
'End  WIth
'
'With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Acc Telephone_can")
'If .Exist(nMINWAIT) Then
'	.Set dtAccTelephone
'	Reporter.ReportEvent micPass,"Accounting Telephone is present","and set with="&dtCompany_Name
'End If
'End  WIth
'
'With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Acc Fx_can")
'If .Exist(nMINWAIT) Then
'	.Set dtAccFax
'	Reporter.ReportEvent micPass,"Accounting is present","and set with="&dtCompany_Name
'End If
'End  WIth
'

'Remittance Address 

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RemittanceCountry_Can")
If .Exist(nMINWAIT) Then
	.Set dtRemittanceCountry
	Reporter.ReportEvent micPass,"Remittance Country is present","and set with="&dtRemittanceCountry
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RemittanceAddress_Can")
If .Exist(nMINWAIT) Then
	.Set dtAddressLine
	Reporter.ReportEvent micPass,"Address Line is present","and set with="&dtAddressLine
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RemittanceCity_Can")
If .Exist(nMINWAIT) Then
	.Set dtRemittanceCity
	Reporter.ReportEvent micPass,"Remittance City is present","and set with="&dtRemittanceCity
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RemittanceProvince_Can")
If .Exist(nMINWAIT) Then
	.Set dtRemittanceProvince
	Reporter.ReportEvent micPass,"Remittance Province is present","and set with="&dtRemittanceProvince
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("NonInv_RemittancePostal_Can")
If .Exist(nMINWAIT) Then
	.Set dtRemittancePostalCode
	Reporter.ReportEvent micPass,"Remittance Postal Code is present","and set with="&dtRemittancePostalCode
End If
End  WIth

'Payment / Invoicing Capability
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebList("Payment_method_Can")
If .Exist(nMINWAIT) Then
	.Select dtPaymentMethod
	Reporter.ReportEvent micPass,"Payment Method  is present","and Select with="&dtPaymentMethod
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Notification_Email_Can")
If .Exist(nMINWAIT) Then
	.Set dtNotificationEmail
	Reporter.ReportEvent micPass,"Notifiction Email  is present","and set with="&dtNotificationEmail
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebCheckBox("EmailNotification_Send_Can")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")=0 Then
		.Click
		End If
	Reporter.ReportEvent micPass,"Send Email Remittance Notification? Checkbox  is present","and Selected "
End If
End  WIth


'Accounting Contact Info:
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("ConcatcName_canada")
If .Exist(nMINWAIT) Then
	.Set dtContactName
	Reporter.ReportEvent micPass,"Contact Name is present","and set with="&dtContactName
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("DepartmentName_canada")
If .Exist(nMINWAIT) Then
	.Set dtDepartmentNameAccount
	Reporter.ReportEvent micPass,"Accounting Department  is present","and set with="&dtDepartmentNameAccount
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Email_Accounting_canada")
If .Exist(nMINWAIT) Then
	.Set dtAccountEmail
	Reporter.ReportEvent micPass,"Accounting Email is present","and set with="&dtAccountEmail
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("TelePhone_Accounting_canada")
If .Exist(nMINWAIT) Then
	.Set dtAccountTelephone
	Reporter.ReportEvent micPass,"Accounting Telephone is present","and set with="&dtAccountTelephone
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Fax_Accounting_canada")
If .Exist(nMINWAIT) Then
	.Set dtAccountFax
	Reporter.ReportEvent micPass,"Accounting Fax is present","and set with="&dtAccountFax
End If
End  WIth

'SECTION II ÃƒÆ’Ã†â€™Ãƒâ€šÃ‚Â¢ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡Ãƒâ€šÃ‚Â¬ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â‚¬Å¡Ã‚Â¬Ãƒâ€¦Ã¢â‚¬Å“ CDW REQUESTOR COMPLETION

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("RequestorName_Can")
If .Exist(nMINWAIT) Then
	.Set dtRequestorName
	Reporter.ReportEvent micPass,"Requestor Name is present","and set with="&dtRequestorName
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("RequestorPhone_Can")
If .Exist(nMINWAIT) Then
	.Set dtRequestorPhone
	Reporter.ReportEvent micPass,"RequestorPhone  is present","and set with="&dtRequestorPhone
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("DepartmentName_Can")
If .Exist(nMINWAIT) Then
	.Set dtDepartmentName
	Reporter.ReportEvent micPass,"Department Name  is present","and set with="&dtDepartmentName
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebEdit("Vendor_AccDate_Can")
If .Exist(nMINWAIT) Then
	.Set dtVendorAccountDate
	Reporter.ReportEvent micPass,"Vendor Accounting Date is present","and set with="&dtVendorAccountDate
End If
End  WIth

With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebCheckBox("VerifyCheckBox_Can")
If .Exist(nMINWAIT) Then
	If .GetROProperty("checked")=0 Then
		.Click
		End If
	Reporter.ReportEvent micPass,"Send Email Remittance Notification? Checkbox  is present","and Selected "
End If
End  WIth


wait(5)

'CLick on Save button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebButton("NonInv_Save")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Form is saved","sucessfully"
End If
End  WIth




'Get the sequence NUmber
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebElement("NonInv_SequenceNumber")
If .Exist(nMINWAIT) Then
	appSeqNo=.GetROProperty("innertext")
	GlobalDictionary("SequenceNumber")=appSeqNo
	Reporter.ReportEvent micPass,"The form Sequence number","is="&appSeqNo
End If
End  WIth 



'CLick on Instruction link
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebElement("NonInv_Instructions")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Vertify the instruction page
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebElement("NonInv_InstrusctionPage")
If .Exist(nMINWAIT) Then
	Reporter.ReportEvent micPass,"The user is navigaed","to INstruction page"
End If
End  With 

'Click on Attachemts tab
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebElement("NonInv_Attachments")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Click on Attachments link
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebButton("NonInv_Attach")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Upload the file
dtFilePath=(GlobalDictionary("dtFilePath"))
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("FileAttachment").WebFile("fillaForm_AttachDocs")
If .Exist(nMINWAIT) Then
	.Set dtFilePath
End If
End  With 
 
 'wait for the ojects to get loaded
 app_SearchSync()

'CLick on Upload Button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("FileAttachment").WebButton("FillAttachment_Upload")
 If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Attachments button is present ","and clicked  ", false)
End If
End  With

 'wait for the ojects to get loaded
 app_SearchSync()
 
 docNameSplit=split(dtFilePath,"\")
docName=docNameSplit(UBound(docNameSplit))

With Browser("PeopleSoft Browser").Page("Search/Fill in a Form").PSFrame("TargetContent").WebTable("table_attachments")
	If .Exist(nMINWAIT) Then
		fileName=.GetCellData(1,2)
	End If
End With

fileNameSplit=split(fileName,".")
fileNameUpdate=fileNameSplit(LBound(fileNameSplit))

'fileName=Browser("PeopleSoft Browser").Page("Search/Fill in a Form").PSFrame("TargetContent").WebTable("table_attachments").GetCellData(1,2)

If InStr(docName,fileNameUpdate)>0 Then
	Call WriteToReport(micPass,"Attachments are uploaded successfully","and the file uploaded is=" &fileName,false)
End If

GlobalDictionary("docFileName")=fileName
 
 
 'Navigate back to form
 With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebElement("NonInv_Forms")
 If .Exist(nMINWAIT) Then
 	.Click
 End If
 End  With 
 
  'wait for the ojects to get loaded
Browser("PeopleSoft Browser").Sync

'Click on Submit button
With Browser("PeopleSoft Browser").Page("Search/Fill a Form").PSFrame("TargetContent_NonInventory").WebButton("NonInv_Submit")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"THe application","is submitted sucessfully"
End If
End  With 

GlobalDictionary("SignInUser")=(GlobalDIctionary("Approver1"))

End Function


Public Function NonInventorySupplierFormApproval1ReApproveFlowCanada()
'Navigate to below page
'Worklist > worklist
SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

Call WriteToReport(micPass,"Now following user is loggedin "&(GlobalDictionary("Approver1")),"to Approve the sequence", false)

dtFromName2=(GlobalDictionary("dtFromName"))
dtComments=(GlobalDictionary("dtComments"))
dtSupplierId=(GlobalDictionary("dtSupplierId")) & RandomNumberGeneraion & Day(Date)
GlobalDictionary("SupplierIdCreated")=dtSupplierId
dtSupplierType=(GlobalDictionary("dtSupplierType"))
' -Cloud
dtShortName=(GlobalDictionary("dtShortName"))
dtPayTerms=(GlobalDictionary("dtPayTerms"))
dtBankCountry=(GlobalDictionary("dtBankCount"))

'000
dtSubjectTo=(GlobalDictionary("dtSubjectTo"))
'- Yes
dtVendorGroup=(GlobalDictionary("dtVendorGroup"))
'- 01
dtCompanyType=(GlobalDictionary("dtCompanyType"))
'-Customer
dtTaxId=(GlobalDictionary("dtTaxId"))

'- 0003365541
dtMatchException=(GlobalDictionary("dtMatchException"))
'- AIDESEG
dtBankName=(GlobalDictionary("dtBankName"))
dtTransitNumber=(GlobalDictionary("dtTransitNumber"))
dtDFIQualifier=(GlobalDictionary("dtDFIQualifier"))
'- Transit Number
dtAccountType=(GlobalDictionary("dtAccountType"))
'- Checking Account
'dtAccountNumber="00133698514"
If Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").Exist then
		Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("New Worklist panel for").Link("View All").click
		wait(2)
End If

With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	appDate=.GetCellData(2,2)
	k=0
	invoiceDate=CDate(date)
  		Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable").ChildItem(1,2,"Link",0).Click
  		wait(3)
  		Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable").ChildItem(1,2,"Link",0).Click

End If
End  With 

'Search for the name in the table
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").WebTable("Worklist_WorklistTable")
If .Exist(nMINWAIT) Then
	For i=1 to .RowCount step 1
	appFrom2=.GetCellData(i,1)
	If instr(1,appFrom2,dtFromName2)>0 Then
		appDate=.GetCellData(i,2)
		seqNo=.GetCellData(i,6)
		If instr(1,seqNo,GlobalDictionary("SequenceNumber"))>0 Then
			Set oLink=.ChildItem(i,6,"Link",0)
			If oLink.exist(nMINWAIT) Then
				oLink.click
				Exit For
			End If
		End If
	End If	
	Next
End If
End  With 

'CLick on GO to Form
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("GoToForm")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"THe Go to FOrm is present and","clicked"
	
		'wait for the ojects to get loaded
		app_SearchSync()
		
		Browser("PeopleSoft Browser").Sync
		
		'Enter all the details in the form
		'Enter supplier ID
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_SuppId_can")
		If .Exist(nMINWAIT) Then
			.Set dtSupplierId
			Reporter.ReportEvent micPass,"The supplier field is present and","set with="&dtSupplierId
			Else
			Reporter.ReportEvent micFail,"The suppleir field is not","present"
		End If
		End  WIth 
		
		'Set the short namre
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_SuppShortName_can")
		If .Exist(nMINWAIT) Then
			.Set dtShortName
			Reporter.ReportEvent micPass,"The supplier name is present and","set with="&dtShortName
			Else
			Reporter.ReportEvent micFail,"The suppleir name is not","present"
		End If
		End  WIth 
		
		'Set SupplierType
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebList("Approve_NonInv_SuppType_can")
		If .Exist(nMINWAIT) Then
			.Select dtSupplierType
			Reporter.ReportEvent micPass,"The supplier type is present and","set with="&dtSupplierType
			Else
			Reporter.ReportEvent micFail,"The suppleir type is not","present"
		End If
		End  WIth
		

		'To set payterms
'		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_PayTerms")
'		If .Exist(nMINWAIT) Then
'			.Set dtPayTerms
'			Reporter.ReportEvent micPass,"The PayTerms is present and","set with="&dtPayTerms
'			Else
'			Reporter.ReportEvent micFail,"The payterms is not","present"
'		End If
'		End  WIth
'		
'		
'		'To set Company type
'		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_CompanyType")
'		If .Exist(nMINWAIT) Then
'			.Set dtCompanyType
'			Reporter.ReportEvent micPass,"The CompanyType is present and","set with="&dtCompanyType
'			Else
'			Reporter.ReportEvent micFail,"The CompanyType is not","present"
'		End If
'		End  WIth
			
		'To set Payment Group
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_PaymentGroup_can")
		If .Exist(nMINWAIT) Then
			.Set dtVendorGroup
			Reporter.ReportEvent micPass,"The VendorGroup is present and","set with="&dtVendorGroup
			Else
			Reporter.ReportEvent micFail,"The VendorGroup is not","present"
		End If
		End  WIth
		

		'To set Exception opgrid
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Form").WebEdit("NonInv_ExceptionOpgrid_can")
		If .Exist(nMINWAIT) Then
			.Set dtMatchException
			Reporter.ReportEvent micPass,"The Exception  is present and","set with="&dtMatchException
			Else
			Reporter.ReportEvent micFail,"The Match Exception is not","present"
		End If
		End  WIth
		
		
		'To select Subject To		
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approe_NonInv_SupplierSetId_can")
		If .Exist(nMINWAIT) Then
			.Set GlobalDictionary("setID")
			Reporter.ReportEvent micPass,"The Set Id is present and","set with="&GlobalDictionary("setID")
			Else
			Reporter.ReportEvent micFail,"The Set Id is not","present"
		End If
		End  WIth
		
'		'To set Tax Id
'		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_TaxPayerId")
'		If .Exist(nMINWAIT) Then
'			.Set dtTaxId
'			Reporter.ReportEvent micPass,"The TaxId is present and","set with="&dtTaxId
'			Else
'			Reporter.ReportEvent micFail,"The TaxId is not","present"
'		End If
'		End  With
'		
'		'To set Match Exception
'		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_ExceptionUser")
'		If .Exist(nMINWAIT) Then
'			.Set dtMatchException
'			Reporter.ReportEvent micPass,"The MatchException is present and","set with="&dtMatchException
'			Else
'			Reporter.ReportEvent micFail,"The MatchException is not","present"
'		End If
'		End  WIth

'With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_BankCountry_can")
'		If .Exist(nMINWAIT) Then
'			.Set dtBankCountry
'			Reporter.ReportEvent micPass,"The Bank name is present and","set with="&dtBankName
'			Else
'			Reporter.ReportEvent micFail,"The Bank name is not","present"
'		End If
'		End  WIth
'		
'		'Enter the bank details
'		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NonInv_BankName_can")
'		If .Exist(nMINWAIT) Then
'			.Set dtBankName
'			Reporter.ReportEvent micPass,"The Bank name is present and","set with="&dtBankName
'			Else
'			Reporter.ReportEvent micFail,"The Bank name is not","present"
'		End If
'		End  WIth
'		
'		'To select Account type
'		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebList("Approve_NonInv_AcctType_can")
'		If .Exist(nMINWAIT) Then
'			.Select dtAccountType
'			Reporter.ReportEvent micPass,"The AccountType is present and","set with="&dtAccountType
'			Else
'			Reporter.ReportEvent micFail,"The AccountType i is not","present"
'		End If
'		End  WIth
'		
'		'To set account number
'		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebEdit("Approve_NOnInv_BankAcctNumber_can")
'		If .Exist(nMINWAIT) Then
'			.Set (GlobalDictionary("AccountNumber"))
'		End If
'		End  With 
'		
'			
'		'To select dfi qualifier
'		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebList("Approver_NonInv_DFIQualifier_can")
'		If .Exist(nMINWAIT) Then
'			.Select dtDFIQualifier
'			Reporter.ReportEvent micPass,"The DFI Qualifier is present and","set with="&dtDFIQualifier
'			Else
'			Reporter.ReportEvent micFail,"The DFI Qualifier is not","present"
'		End If
'		End  WIth
		
		
		'Click on Ok button
		With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("Approve_FillaForm_NonInventory").WebButton("Approve_NOnInv_Ok")
		If .Exist(nMINWAIT) Then
			.Click
			Reporter.ReportEvent micPass,"The Ok button is present and","clicked and able to save all the changes"
			Else
			Reporter.ReportEvent micFail,"The Ok button is not","present"
		End If
		End  WIth	
	Else
	Reporter.ReportEvent micFail,"The Go to Link is","Not present and not able to fill the details"
End If
End  With


'Enter the comments
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebEdit("CommentBox")
If .Exist(nMINWAIT) Then
	.Set dtComments
End If
End  WIth 


'CLick on Approve button
With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").WebButton("Approve")
If .Exist(nMINWAIT) Then
	.Click
	Call WriteToReport(micPass,"Approve button ","is present and clicked", false)
End If
End  WIth 


With Browser("PeopleSoft Browser").Page("Approve/ReviewForm").PSFrame("TargetContent").Image("Approved")
If .Exist(nMINWAIT) Then
	Call WriteToReport(micPass,"The form is Approved ","and Green tick is displayed in the approval flow ", false)
End If
End  WIth 

GlobalDictionary("SignInUser")=(GlobalDIctionary("Approver2"))

'Log out of applciation

End  Function



Public Function SearchExistingMatchExceptionVoucher(ActionStatus)
'CLick on Advanced srqarch link
	WIth Browser("PeopleSoft Browser").Page("MatchExceptions").PSFrame("MatchExceptions").Link("MatchExp_AdvancedSearch")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Advanced search link","is present and clicked",false)
				else
	 	Call WriteToReport(micFail,"Advanced search link","is not present",True)
	End If
	End  With 
	
	'ENter the Action status and Voucehr ID
	With Browser("PeopleSoft Browser").Page("MatchExceptions").PSFrame("MatchExceptions").WebList("MatchExp_ActionStatus")
	If .Exist(nMINWAIT) Then
		.Select dtActionStatus
	End If
	End  With 
	
	dtVoucherID=GlobalDIctionary("dtVoucherIDFromExcel")
	'Enter the Voucher ID
	With Browser("PeopleSoft Browser").Page("MatchExceptions").PSFrame("MatchExceptions").WebEdit("MatchExp_VoucherId")
	If .Exist(nMINWAIT) Then
		.Set dtVoucherID
	End If
	End  With
	
	'Click on Search button
	With Browser("PeopleSoft Browser").Page("MatchExceptions").PSFrame("MatchExceptions").WebButton("MatchExp_Search")
	If .Exist(nMINWAIT) Then
		.Click
	End If
	End  WIth	
End Function

Public Function APMatchExceptionActions()
	'Navigate to belwo navigation
	'Accounts Payable --> Vouchers --> AP Match Exceptions Actions
	SelectMainMenu1(GlobalDictionary("MatchExceptionActions"))
	
	dtActionStatus=GlobalDictionary("ActionStatusOpen") 'Open
	dtVoucherID=GlobalDIctionary("dtVoucherIDFromExcel")
	dtBusinessUnit=(GlobalDictionary("businessunit"))
	
	'Set all the mandatory details in the page
	Call SearchExistingMatchExceptionVoucher(dtActionStatus)
	
	'Get the Purchase order Unit price
	With Browser("PeopleSoft Browser").Page("MatchExceptions").PSFrame("MatchExceptions").WebElement("MatchExp_POAmt")
	If .Exist(nMINWAIT) Then
		appPOAmount=cdbl(.GetROProperty("innertext"))
		Reporter.ReportEvent micPass,"The Purchase order amount is","is"&appPOAmount
	End If
	End  With 
	
	'Check for the variance amount
	With Browser("PeopleSoft Browser").Page("MatchExceptions").PSFrame("MatchExceptions").WebElement("MatchExp_VariAmt")
	If .Exist(nMINWAIT) Then
	varAmt=.GetROProperty("innertext")
	GlobalDictionary("VarAmt")=varAmt
	Call WriteToReport(micPass,"Valiance amt is present","and value is"&varAmt,false)
		else
	Call WriteToReport(micFail,"Valiance amt is present","is not present",True)
	End If
	End  With 
	
	'CHeck for the variance amout whether it is positive or negative
	If Cint(varAmt)>0 Then
		InvoiceAmount="DecreaseInvoiceAmount"
		GlobalDictionary("InvoiceAmount")=InvoiceAmount
		Call WriteToReport(micPass,"Valiance amt is positive","and we need to decrease the Invoice Amount",false)
		Else
		InvoiceAmount="IncreaseInvoiceAmount"
		GlobalDictionary("InvoiceAmount")=InvoiceAmount
		Call WriteToReport(micPass,"Valiance amt is negative","and we need to increase the Invoice Amount",false)
	End If
	
	'Navighate toe below regualr entry page to correct the erros
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	'wait for tha applicatio to load
	For i=0 to 2 
		app_SearchSync()
	Next
	
	'Open the existing vouchjer
	Call ap_openExistingVoucher(dtbusinessunit,dtVoucherID)
	
	
	'wait for tha applicatio to load
	For i=0 to 2 
		app_SearchSync()
	Next
	
	'Click on Invoice information tab
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("InvoiceInformation")
	If .Exist(nMINWAIT) Then
		.Click
		Call WriteToReport(micPass,"Invoice information button is  ","is present and clicked",false)
	End If
	End  With 
	
	app_SearchSync()
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("unitPrice")
		If .Exist(nMINWAIT) Then
			.Set appPOAmount
			Reporter.ReportEvent micPass,"The Unit proce is p[resent","and set with"&appPOAmount
		End If
	End With
	
''Depending upon the varaince amount adjust the Invpoice amount
''GlobalDictionary("InvoiceAmount")="DecreaseInvoiceAmount"
''GlobalDictionary("VarAmt")="-1348.28"
'	WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Quantity_1")
'	If .Exist(nMINWAIT) Then
'		appQuantityAmt=Cint(.GetROProperty("value"))
'	End If
'	End  With 
'	
'	If appQuantityAmt>1 Then
'	appUnitPrice=Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("unitPrice").GetROProperty("value")
'	appUnitTotalPrice=appQuantityAmt * appUnitPrice
'	FinalUnitPrice=Cdbl(appUnitTotalPrice) + Cdbl(GlobalDictionary("VarAmt"))
'		
'	WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Quantity_1")
'	If .Exist(nMINWAIT) Then
'		.Set "1"
'	End If
'	End  With 
'		
'	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("unitPrice")
'		If .Exist(nMINWAIT) Then
'			.Set FinalUnitPrice
'		End If
'	End With
'	
'	'CHange the quaqntitie in associate receiver
'	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").Link("PurchaseOrderAssociateReceiver")
'	If .Exist(nMINWAIT) Then
'		.Click
'	End If
'	End  With 
'	
'	app_SearchSync()
'	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("AssociateReceiver").WebEdit("AssociateRec_Quantity")
'	If .Exist(nMINWAIT) Then
'		.Set "1"
'	End If
'	End  With 
'	
'	With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("AssociateReceiver").WebButton("OK")
'	If .Exist(nMINWAIT) Then
'		.Click
'	End If
'	End  With 
'	
'	app_SearchSync()
'
'			
'		Else
'		appUnitPrice=Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("unitPrice").GetROProperty("value")
'		FinalUnitPrice=Cdbl(appUnitTotalPrice) + Cdbl(GlobalDictionary("VarAmt"))
'		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("unitPrice")
'		If .Exist(nMINWAIT) Then
'				.Set FinalUnitPrice
'		End If
'		End With
'	End If
		
'Clicko n Calculate Button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("CalculateInvoiceLine")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Adjust the Mail total price to save the voucher
'Click on Calcualte button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Calculate")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

app_SearchSync()

'Get the value from difference
WIth Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("Difference")
If .Exist(nMINWAIT) Then
	appDiff=.GetROProperty("innertext")
End If
End  With 

'ENter the final total amount
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total")
	If .Exist(nMINWAIT) Then
		finalTotalAmount=cdbl(Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Total").GetROProperty("value")) + cdbl(appDiff)
		.Set finalTotalAmount
	End If
End With

'Clicko n Calculate button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Calculate")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

app_SearchSync()

'CLick on save button
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The save button is","present and clicked"
End If
End  With 

'Capture the warning message
With Browser("PeopleSoft Browser").Page("Regular Entry").WebElement("MessageforDifference")
If .Exist(nMINWAIT) Then
	appWarningMess=.GetROProperty("innertext")
	Call WriteToReport(micPass,"The warning message is ","is gettin displayed as expected anmd message is"&appWarningMess,false)
End If
End  With 

'CLick on Ok btton
With Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Capture the warning message
With Browser("PeopleSoft Browser").Page("Regular Entry").WebElement("MessageforDifference")
If .Exist(nMINWAIT) Then
	appWarningMess=.GetROProperty("innertext")
	Call WriteToReport(micPass,"The warning message is ","is gettin displayed as expected anmd message is"&appWarningMess,false)
End If
End  With 

'CLick on Ok btton
With Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With

dtvoucherID=GlobalDIctionary("dtVoucherIDFromExcel")
'Navigate to Matching page to perform the matching
strValue=ap_matchingVoucher(dtbusinessunit,dtvoucherID)

If strValue="success" Then
	'naviogate to below to check the matching is sucessfull
	'Accounts Payable --> Vouchers --> AP Match Exceptions Actions
	SelectMainMenu1(GlobalDictionary("MatchExceptionActions"))
	dtActionStatus=GlobalDictionary("ActionStatusOpen") 'Open
	'dtVoucherID=(GlobalDictionary("VoucherID"))
	dtBusinessUnit=(GlobalDictionary("businessunit"))
	
	'Set all the mandatory details in the page
	Call SearchExistingMatchExceptionVoucher(dtActionStatus,dtVoucherID)
	
	'Check for the variance amount
	With Browser("PeopleSoft Browser").Page("MatchExceptions").PSFrame("MatchExceptions").WebElement("MatchExp_VariAmt")
	If .Exist(nMINWAIT) Then
	varAmt=.GetROProperty("innertext")
	If Cint(varAmt)="0" Then
		Reporter.ReportEvent micPass,"The varaince amount is","0 and is sucesfully matched"
	End If
	End If
	End  With
	
	'Navigate to regulae entry to check the status
	'Navighate toe below regualr entry page to correct the erros
	'Accounts Payble > Vouchers > Add Update > Regular Entry
	
	SelectMainMenu1(GlobalDictionary("RegularEntry"))
	
	'wait for tha application to load
	For i=0 to 2 
		app_SearchSync()
	Next
	
	dtVoucherID=GlobalDIctionary("dtVoucherIDFromExcel")
	'Open the existing vouchjer
	Call ap_openExistingVoucher(dtbusinessunit,dtVoucherID)
	
	strMatchStatus=GlobalDictionary("MatchStatus")
	
	'to validate the match status of the voucehr
	Call ap_verifyMatchstatusofVoucher(strMatchStatus,strOption)	
	
	Else
	Reporter.ReportEvent micFail,"The matching","did not happen sucessfully"
End If
	
End Function

Public Function AutoMatchExceptionReport()
'Navigate to Below path
'Accounts Payable --> CDW AP Reprots --> AP Automatch Exception Report
SelectMainMenu1(GlobalDictionary("AutomatchExceptionReport"))

dtRunControlID=GlobalDictionary("RunControlID")&inVoiceNumberGeneration

'Click on Add new value button
With Browser("PeopleSoft Browser").Page("AutomatchExceptionReport").PSFrame("AutomatchExceptionreport").WebElement("AutomatchException_AddNewValue")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Enter the RUn control ID
With Browser("PeopleSoft Browser").Page("AutomatchExceptionReport").PSFrame("AutomatchExceptionreport").WebEdit("RunControlID")
If .Exist(nMINWAIT) Then
	.Set dtRunControlID
End If
End  With 

'Click on Add button
With Browser("PeopleSoft Browser").Page("AutomatchExceptionReport").PSFrame("AutomatchExceptionreport").WebButton("Add")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Click on Exceptoin type
With Browser("PeopleSoft Browser").Page("AutomatchExceptionReport").PSFrame("AutomatchExceptionreport").WebCheckBox("AllExceptionType")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'Enter the sign iun user
WIth Browser("PeopleSoft Browser").Page("AutomatchExceptionReport").PSFrame("AutomatchExceptionreport").WebEdit("Automatch_AllUsers")
If .Exist(nMINWAIT) Then
	.Set (GlobalDictionary("SignInUser"))
	Reporter.ReportEvent micPass,"The All users text box","is presetna nd set with"&(GlobalDictionary("SignInUser"))
End If
End  With 

'Click on Run button
With Browser("PeopleSoft Browser").Page("AutomatchExceptionReport").PSFrame("AutomatchExceptionreport").WebButton("Run")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

app_SearchSync()

'Get the process name froim the repot
With Browser("PeopleSoft Browser").Page("AutomatchExceptionReport").PSFrame("ProcessSchedulerRequest").WebTable("ProcessList")
If .Exist(nMINWAIT) Then
	appProcessName=.GetCellData(2,3)
	Reporter.ReportEvent micPass,"The Process name is","is"&appProcessName
End If
End  With 

'CLick on Ok button
With Browser("PeopleSoft Browser").Page("AutomatchExceptionReport").PSFrame("ProcessSchedulerRequest").WebButton("OK")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

app_SearchSync()

With Browser("PeopleSoft Browser").Page("AutomatchExceptionReport").PSFrame("AutomatchExceptionreport").WebElement("ProcessInstance")
If .Exist(nMINWAIT) Then
	appProcessIns=.GetROProperty("innertext")
	appProcessinssplit=split(appProcessIns,";")
	finalProcessins=appProcessinssplit(UBound(appProcessinssplit))
	GlobalDictionary("finalProcessins")=finalProcessins
End If
End  With 

'Click on Process monitor screen
With Browser("PeopleSoft Browser").Page("AutomatchExceptionReport").PSFrame("AutomatchExceptionreport").Link("ProcessMonitor")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"The process monitor screen is present","and clicked"
End If
End  With 

'Check the process monitor to check for Sucess and posted
Call CheckProcessMontiorStatus (appProcessName)

'Navigate to report manager and exteract the excel sheet and get the voucher number
Call ReportManagerExcelFileGeneretion(GlobalDictionary("nProcessInstance"))

'
End Function


Public Function ReportManagerExcelFileGeneretion(ProcessInstance)
'Navigate to following path to check for the document
'Reporting Tools ÃƒÆ’Ã†â€™Ãƒâ€šÃ‚Â¢ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â€šÂ¬Ã…Â¡Ãƒâ€šÃ‚Â¬ÃƒÆ’Ã‚Â¢ÃƒÂ¢Ã¢â‚¬Å¡Ã‚Â¬Ãƒâ€¦Ã¢â‚¬Å“ Report Manager
SelectMainMenu1(GlobalDictionary("ReportManager"))

'wait for the ojects to get loaded
app_SearchSync()

'Enter the professinstance and click on process button
WIth Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Distribution Mgr").WebEdit("RM_txtFromInst")
If .Exist(nMINWAIT) Then
	.Set ProcessInstance
	Reporter.ReportEvent micPass,"The process intance is set and","set with"&ProcessInstance
End If
End  With 

With Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Distribution Mgr").WebButton("RM_btnRefresh")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

'Click on attahcemtn link present int he grid
With Browser("PeopleSoft Browser").Page("Report Manager").PSFrame("Report Distribution Mgr").WebTable("RM_ReportTable")
If .Exist(nMINWAIT) Then
	Set oDocLink=.ChildItem(2,2,"Link",0)
	If oDocLink.exist(nMINWAIT) Then
		oDocName=.GetROProperty("innertext")
		GlobalDIctionary("DocName")=oDocName
		oDocLink.click
	End If
End If
End  With 

With Browser("PeopleSoft Browser").Page("Report Index").PSFrame("Report Index").Link("FileName")
If .Exist(nMINWAIT) Then
	strFileUrl=.GetROProperty("url")
End If
End  With 

' Path of the file you want to download
'strFileUrl ="https://psfnapwbregvh1.corp.cdw.com:444/psreports/fnreg/9415497/CDW_APR032B.xlsx" 


'Local drive's path where you want to save the file
strSaveFileTo ="C:\AutoSource_Prod\PSFINUFT\Reports\CDW_APR032B.xlsx"

'DOwnload the file from the Page
Call downloadAfilefromURL(strFileUrl,strSaveFileTo) 

'Get the vouhcer ID from the sheet 
dtVoucherIDFromExcel=DownloadFromExcel(strSaveFileTo)
GlobalDIctionary("dtVoucherIDFromExcel")=dtVoucherIDFromExcel

End Function


Public Function OpenExistingExcelSheet(strSaveFileTo)
Set obj = Createobject("Excel.Application")
obj.Visible=True
Set obj1=obj.Workbooks.Open(strSaveFileTo)
Set obj2=obj1.Worksheets("Sheet1")

	
End Function

'download a file from url
Public Function downloadAfilefromURL(Byref strFileUrl,Byref strSaveFileTo)
	
' Path of the file you want to download
'strFileUrl = "https://psfnapwbregvh1.corp.cdw.com:444/psreports/fnreg/8458446/CDW_APR032B.xlsx" 

'Local drive's path where you want to save the file
'strSaveFileTo = "C:\AutoSource_Prod\PSFINUFT\Reports\CDW_APR032B.xlsx"


' create a XMLHTTP object
Set oHTTP = CreateObject("MSXML2.XMLHTTP")

oHTTP.open "GET", strFileUrl, False
oHTTP.send

'create FSO object
Set oFSO = CreateObject("Scripting.FileSystemObject")

'If  strSaveFileTo file already exist, delete it
If oFSO.FileExists(strSaveFileTo) Then
  oFSO.DeleteFile(strSaveFileTo)
End If

If oHTTP.Status = 200 Then
  Dim oADOStream
  Set oADOStream = CreateObject("ADODB.Stream")
  With oADOStream
    .Type = 1
    .Open
    .Write oHTTP.ResponseBody
    .SaveToFile strSaveFileTo
    .Close
  End With
  set oADOStream = Nothing
End If

If oFSO.FileExists(strSaveFileTo) Then
  Call WriteToReport(micPass,"File has been downloaded successfully ", "File has been downloaded successfully and save to  " & strSaveFileTo,false)
 else
  Call WriteToReport(micFAIL,"File Doesn't downloaded ", "File doesn't downloaded",false)
End If
End Function

Public Function DownloadFromExcel(strSaveFileTo)
Set obj=Createobject("Excel.Application")
Set obj1=obj.Workbooks.Open(strSaveFileTo)
Set obj2=obj1.Worksheets("Sheet1")
columncount=obj2.usedrange.columns.count
rowcount=obj2.usedrange.rows.count
For i=1 to  columncount
	columnName=obj2.cells(3,i).value
	If Trim(columnName)="Exception Descr" Then
		For j=3 to rowcount
			rowName=obj2.cells(j,i).value
			If Trim(rowName)="Vchr line <> tolerance amt" Then
				VoucherID=obj2.cells(j,i+3).value
				'GlobalDictionary("VoucherIDFromExcel")=VoucherID
				Exit For
			End If
		Next
	End If
Next
obj1.Close
Set obj1=Nothing
Set obj2=Nothing
Set obj=Nothing
DownloadFromExcel=VoucherID
End Function

Public Function PriceExceptionsCanada()
'Create the voucher with Difference in amount in PO and Unit price
'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
SelectMainMenu1(GlobalDictionary("MainMenuSelection"))

businessunit=(GlobalDictionary("businessunit"))
supplierID=(GlobalDictionary("SupplierID"))


VoucherID=ap_createVoucherWithCopyPOWithDIffPOAndUnitPrice(businessunit,supplierID)
'CARACAN

'Accounts Payable --> Batch Processes --> Voucher --> Matching
SelectMainMenu1(GlobalDictionary("VoucherMatchingSelection"))

'Perform the matchingf
status=ap_matchingVoucher(businessunit,VoucherID)

If status="success" Then
	Reporter.ReportEvent micPass,"The matching is sucessfully","done and executed"
End If

'RUn the AUtomatch exception reports
Call AutoMatchExceptionReport()

'RUn the Exception repotrt and run the exisitng report
Call APMatchExceptionActions()

End Function

Public Function ap_createVoucherWithCopyPOWithDIffPOAndUnitPrice(Byref businessunit,Byref supplierID)
'	Dim businessunit,supplierID
	Dim voucherID,approvalStatus,invoiceNo,Total,invoiceDate,i,CopyFrom,PayTerm,MatchStatus,Salestax,Misc,Fright,PONumberFrom
	Dim rc,nCount,temp
'	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
'	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
'	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo")&inVoiceNumberGeneration
	invoiceDate=date-2'GlobalDictionary("invoiceDate")
'	supplierID=GlobalDictionary("SupplierID")
	CopyFrom=GlobalDictionary("CopyFrom")
	PayTerm=GlobalDictionary("PayTerm")
	Salestax=GlobalDictionary("Salestax")
	Misc=GlobalDictionary("Misc")
	Fright=GlobalDictionary("Fright")
	PONumberFrom=GlobalDictionary("PONumberFrom")
	AccountNumber=GlobalDictionary("dtAccountNumber1")
	Dept=GlobalDictionary("dtDept1")
	temp=0
	'wait for the ojects to get loaded
	app_SearchSync()

'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit ","is present and entered "&businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id ","is present and entered "&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		.WebButton("Add").highlight
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()

	.WebEdit("invoiceNo").WaitProperty "visible",true,20000
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo
		Call WriteToReport(micPass,"invoiceNo ","is present and entered "&invoiceNo,false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date ","is present and entred as "&invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	If .WebEdit("PayTerms").Exist(nMINWAIT) Then
		.WebEdit("PayTerms").Set PayTerm
		Call WriteToReport(micPass,"PayTerm ","is present and entered as"&PayTerm,false)
		else
		Call WriteToReport(micFail,"PayTerm","is not present",True)
	End If
End with	
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Exist(nMINWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Click
	End If

	If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Exist(nMINWAIT) Then
'		If InStr(supplierID,"...")<>0 Then
		Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Set Replace(supplierID,"...","")
		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Click
		End If

		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").Exist(nMINWAIT) Then
			If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").RowCount))>1 Then
				Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").ChildItem(2,1,"Link",0).click
			End If
		End If
'		else
'			Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID").Set Trim(supplierID)
'		End If
		Call WriteToReport(micPass,"Supplier ID","is present and value entered"&supplierID,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebList("CopyFrom")
	If .Exist(nMINWAIT) ="False"Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("ExpandCopyPODocs").Click
	End If
	End  With 
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	If (NOT IsEmpty(CopyFrom)) AND  CopyFrom<>"" Then
		temp=1
		with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")		
		If .WebList("CopyFrom").Exist(nMINWAIT) Then
			.WebList("CopyFrom").Select CopyFrom
			Call WriteToReport(micPass,"CopyFrom","is present and selected "&CopyFrom,false)
			else
			Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
		End If
		
		If .Link("Go").Exist(nMINWAIT) Then
'			wait(3)
			.Link("Go").Click
			Call WriteToReport(micPass,"go link ","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Go link","is not present",True)
		End If
		
		If .WebEdit("POBusinessUnit").Exist(nMINWAIT) Then
			.WebEdit("POBusinessUnit").Set businessunit
			Call WriteToReport(micPass,"POBusinessUnit ","is present and entered as"&businessunit,false)
			else
			Call WriteToReport(micFail,"POBusinessUnit","is not present",True)
		End If
		End with	
		If NOT IsEmpty(PONumberfrom) AND PONumberfrom<>"" Then
			If  PONumberfrom>0  Then
				If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PONumberFrom").Exist(nMINWAIT) Then
					Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PONumberFrom").Set PONumberFrom
					Call WriteToReport(micPass,"PONumberFrom ","is present and entered as"&PONumberFrom,false)
					temp=2
					else
					Call WriteToReport(micFail,"PONumberFrom","is not present",True)
				End If
			End If
		End If
		with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
	
			If .WebButton("PONumberLookup").Exist(nMINWAIT) Then
				.WebButton("PONumberLookup").Click
			End If
		End with	
		
For i=0 to 4
	app_SearchSync()
Next		
		'app_SearchSync()'wait(4)
		
		If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").Exist(nMINWAIT) Then
			If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").RowCount))>1 Then
				PONumberFrom=Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").GetCellData(2,2)
				Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").ChildItem(2,1,"Link",0).click
				temp=2
				Call WriteToReport(micPass,"PO number seletced","Selecetd PO number is "&PONumberFrom,True)
			else
				Call WriteToReport(micFail,"invoices for "&businessunit&","&supplierID ,"is not present",True)
			End If
		End If
		
	
		with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
	
		If .WebButton("CopyEntireDocument").Exist(nMINWAIT) Then
			.WebButton("CopyEntireDocument").Click
			Call WriteToReport(micPass,"CopyEntireDocument","is present and clicked",false)
			else
			Call WriteToReport(micFail,"CopyEntireDocument","is not present",True)
		End If
		end with 
		
		else
		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Account")
			.Set AccountNumber
			Call WriteToReport(micPass,"Account number","is present=" & AccountNumber,false)
		End With

		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Dept")
			.Set Dept
			Call WriteToReport(micPass,"Department number","is present=" & Dept,false)
		End  With
	End If
		
	

	
If temp<>1 Then
	
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
'	.WebEdit("Total").WaitProperty "visible",True,20000

	
	app_SearchSync()
'	If StrComp(GlobalDictionary("Selection"),"fright",1)=0 OR StrComp(GlobalDictionary("SelectionSelection"),"quantity",1)=0 Then
	If NOT IsEmpty(Fright) AND Fright<>""Then
		If  Fright>0  Then
			If .WebEdit("freight").Exist(nMINWAIT) Then
				.WebEdit("freight").Set Fright
				Call WriteToReport(micPass,"Fright ","is present and entered as"&Fright,false)
				else
				Call WriteToReport(micFail,"Fright","is not present",True)
			End If
		End If
	End If
	
	wait 3 
	If NOT IsEmpty(Salestax) AND Salestax<>""Then
		If Salestax>0  Then
			If .WebEdit("salesTax").Exist(nMINWAIT) Then
				.WebEdit("salesTax").Set Salestax
				Call WriteToReport(micPass,"Salestax ","is present and entered as"&Salestax,false)
				else
				Call WriteToReport(micFail,"Salestax","is not present",True)
			End If
		End If
	End If
	wait 3 
	If NOT IsEmpty(Misc) AND Misc<>"" Then
		If  Misc>0  Then
			If .WebEdit("MiscellaousAmount").Exist(nMINWAIT) Then
				.WebEdit("MiscellaousAmount").Set Misc
				Call WriteToReport(micPass,"MiscellaousAmount ","is present and entered as"&Misc,false)
				else
				Call WriteToReport(micFail,"MiscellaousAmount","is not present",True)
			End If
		End If
	End If
	
	If NOT IsEmpty(GlobalDictionary("Quantity")) AND GlobalDictionary("Quantity")<>"" Then
		If  GlobalDictionary("Quantity")>0 Then
			If .WebEdit("Quantity").Exist(nMINWAIT) Then
				If IsEmpty(.WebEdit("Quantity").GetROProperty("value")) OR GlobalDictionary("Quantity")="" Then
					appUnitPrice=0
				else:appUnitPrice=Cdbl(.WebEdit("Quantity").GetROProperty("value"))
				End If
				appUnitPrice=Cdbl(.WebEdit("Quantity").GetROProperty("value"))
				Call WriteToReport(micPass,"Quantity captured from application :"&appUnitPrice ,"Quantity is captured from application as "&appUnitPrice ,false)
				appUnitPrice=appUnitPrice+1
				.WebEdit("Quantity").Set(appUnitPrice)
				Call WriteToReport(micPass,"Quantity :"&appUnitPrice ,"Unit price value changed to "&appUnitPrice ,false)
				else
				Call WriteToReport(micFail,"Unitprice","is not present",True)
			End If
		End If
		
		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("unitPrice")
		If .Exist(nMINWAIT) Then
			appUnitPrice=.GetROProperty("value")
			Reporter.ReportEvent micDone,"The Unit price before","incrementing is"&appUnitPrice
			increaseamt="100.00"
			appupdatedunitPrice=Cdbl(appUnitPrice)+cdbl(increaseamt)
			.Set appupdatedunitPrice
			Reporter.ReportEvent micDone,"TYhe unit price after","incrementing is"&appupdatedunitPrice
		End If
		End  With 

		
		If .WebButton("CalculateInvoiceLine").Exist(nMINWAIT) Then
			.WebButton("CalculateInvoiceLine").Click
			Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
		End If
	End If
	
	
	app_SearchSync()
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked for get the difference",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	
	If .WebElement("Difference").Exist(nMINWAIT) Then
		appDifference=.WebElement("Difference").GetROProperty("innertext")
		Call WriteToReport(micPass,"Deifference is captured","Captured from application as"&appDifference,false)
	End If
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		wait 5
		.WebEdit("Total").Click
		appDifference=cdbl(appDifference)+Cdbl(.WebEdit("Total").GetROProperty("value"))
		.WebEdit("Total").Set appDifference
		Call WriteToReport(micPass,"Total : "&appDifference,"is present and entered as "&appDifference,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked to get difeerence",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .WebElement("Difference").Exist(nMINWAIT) Then
		appDifference=.WebElement("Difference").GetROProperty("innertext")
		Call WriteToReport(micPass,"Deifference should be 0","Captured from application as"&appDifference,false)
	End If
	
	app_SearchSync()	
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
		If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
		End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	
	'wait for the ojects to get loaded
	app_SearchSync()
	'wait for the ojects to get loaded
	app_SearchSync()
'Voucher id generation validation	
	If .WebElement("voucherID").Exist(nMINWAIT) Then
		voucherID=.WebElement("voucherID").GetROProperty("innertext")
		If StrComp(voucherID,"NEXT",1)<>0 Then
			Call WriteToReport(micPass,"voucherID : "&voucherID,"is present and generated as "&voucherID,false)
			else
			Call WriteToReport(micFail,"voucherID","doesn't get generated",True)
		End If
	End If
	
	
	If .WebTabStrip("tabSelection").Exist(10) Then
		.WebTabStrip("tabSelection").Select("Voucher Attributes")
		Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
	else
		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		appinvoiceNo=.WebEdit("invoiceNo").GetROProperty("value") 
		If StrComp(Trim(appinvoiceNo),trim(invoiceNo))=0 Then
			Call WriteToReport(micPass,"Voucher Attributes ","data is present",false)
'			else
'			Call WriteToReport(micFail,"Voucher Attributes","data is not present",True)
		End If
	End If
	
'	If .WebTabStrip("tabSelection").Exist(10) Then
'		.WebTabStrip("tabSelection").Select("Invoice Information")
'		Call WriteToReport(micPass,"Invoice Information tab","is present",false)
'	else
'		Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
'	End If
	
	If .WebButton("SubmitForApproval_VoucherAttribute").Exist(nMINWAIT) Then
		.WebButton("SubmitForApproval_VoucherAttribute").Click
		Call WriteToReport(micPass,"SubmitApproval button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"SubmitApproval button in invoice information","is not present",True)
	End If
End with
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Sync
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Click
		wait(2)
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Set voucherID&" is Approved"
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Click
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
'wait for the ojects to get loaded
	app_SearchSync()	
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
	If .WebTabStrip("tabSelection").Exist(nMINWAIT) Then
		.WebTabStrip("tabSelection").Select("Summary")
		Call WriteToReport(micPass,"Summary tab","is present and selected",false)
	elseIf .WebElement("Summary").Exist(nminwait) Then
		.WebElement("Summary").Click
		Call WriteToReport(micPass,"Summary tab","is present and selected",false)
	else
		Call WriteToReport(micFail,"Summary tab","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebElement("approvalStatus").Exist(nMINWAIT) Then
		approvalStatus=.WebElement("approvalStatus").GetROProperty("innertext")
		If StrComp(approvalStatus,"Approved",1)=0 Then
			Call WriteToReport(micPass,"Approval status changed to Approved status","is present",false)
			else
'			Call WriteToReport(micFail,"Approval status","doesn't chaged to Approved, Actual status is "&approvalStatus,True)
		End If
	End If
	
	If .WebElement("MatchStatus").Exist(nMINWAIT) Then
		MatchStatus=.WebElement("MatchStatus").GetROProperty("innertext")
		If StrComp(MatchStatus,"Ready",1)=0 Then
			Call WriteToReport(micPass,"MatchStatus : "&MatchStatus,"is present and generated as "&MatchStatus,false)
		End If
	End If

End with
else
	Call WriteToReport(micFail,"PO Number search","no results(Supllier details) available while PO lookup for BU:"&businessunit,True)
End If

ap_createVoucherWithCopyPOWithDIffPOAndUnitPrice=voucherID 
End Function



'*********************************************************************************************************************************
''' <summary>  
''' InvoiceGSTQSTPOFull()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayCycle"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/1/2018</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************

'AP_02_02_01_InvoiceGSTQSTPOFull
Public Function InvoiceGSTQSTPOFull()
		Dim businessunit,supplierID
	
	sheetName=GlobalDictionary("sheetName")
	connectionString = "Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
	

strSQL=GlobalDictionary("strSQL")
	If NOT dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
		Call WriteToReport(micFail, "Verifying the Record from Database", "No Record Exist for SQL: [" & strSQL & "]",true)
	else
		Call WriteToReport(micPass,"DB records fetched successfully","SQL query executed sucessfully ["&strSQL&"]" ,false)
		Set table=DataTable.GetSheet(sheetName)
		table.SetCurrentRow(1)
		
		GlobalDictionary("InvoiceNumber")=DataTable.Value("VCHR_BLD_KEY_C1",sheetName)
		GlobalDictionary("businessunit")=DataTable.Value("BUSINESS_UNIT",sheetName)
		
	
		'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
		SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		
			'Add business unit and voucgher id in existing value
		with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
			
			.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
			If .WebTabStrip("tabSelectionMain").Exist(nMINWAIT) Then
				.WebTabStrip("tabSelectionMain").Select("Find an Existing Value")
				Call WriteToReport(micPass,"Find an existing Value tab ","is present and clicked",false)
				else
				Call WriteToReport(micFail,"Find an existing Value tab","is not present",True)
			End If
		
			.WebEdit("BusinessUnitFEV").WaitProperty "visible",True,20000
			If .WebEdit("BusinessUnitFEV").Exist(nMINWAIT) Then
				.WebEdit("BusinessUnitFEV").Set GlobalDictionary("businessunit")
				Call WriteToReport(micPass,"Business unit ","is present and entered as "&GlobalDictionary("businessunit"),false)
				else
				Call WriteToReport(micFail,"Business unit","is not present",True)
			End If
			
			If .WebEdit("FinExistingValue_InvoiceNumber").Exist(nMINWAIT) Then
				.WebEdit("FinExistingValue_InvoiceNumber").Set GlobalDictionary("InvoiceNumber")
				Call WriteToReport(micPass,"InvoiceNumber ","is present and entered as "&GlobalDictionary("InvoiceNumber"),false)
				else
				Call WriteToReport(micFail,"InvoiceNumber","is not present",True)
			End If
			
			If .WebButton("Search").Exist(nMINWAIT) Then
				.WebButton("Search").Click
				Call WriteToReport(micPass,"Search button to Search the voucher","is present",false)
				else
				Call WriteToReport(micFail,"Search button to Search the voucher","is not present",True)
			End If
			
			'wait for the ojects to get loaded
			app_SearchSync()
			If .WebElement("PostStatus").Exist(nminwait) Then
				strstatus=.WebElement("PostStatus").GetROProperty("innertext")
				If StrComp(Trim(strstatus),"Posted",1)=0 Then
					Call WriteToReport(micPass,"Post Status of voucher","is present and displayed"&strstatus,false)
					else
					Call WriteToReport(micFail,"Post Status of voucher","is not present",True)
				End If
			End If
			If .WebElement("MatchStatus").Exist(nminwait) Then
				strstatus=.WebElement("MatchStatus").GetROProperty("innertext")
				If StrComp(Trim(strstatus),"Matched",1)=0 Then
					Call WriteToReport(micPass,"Match Status of voucher","is present and displayed"&strstatus,false)
					else
					Call WriteToReport(micFail,"Match Status of voucher","is not present",True)
				End If
			End If
			If .WebElement("EntryStatus").Exist(nminwait) Then
				strstatus=.WebElement("EntryStatus").GetROProperty("innertext")
				If StrComp(Trim(strstatus),"Postable",1)=0 Then
					Call WriteToReport(micPass,"Entry Status of voucher","is present and displayed"&strstatus,false)
					else
					Call WriteToReport(micFail,"Entry Status of voucher","is not present",True)
				End If
			End If
			If .WebElement("approvalStatus").Exist(nminwait) Then
				strstatus=.WebElement("approvalStatus").GetROProperty("innertext")
				If StrComp(Trim(strstatus),"Approved",1)=0 Then
					Call WriteToReport(micPass,"approval Status of voucher","is present and displayed"&strstatus,false)
				else
					Call WriteToReport(micFail,"approval Status of voucher","is not present",True)
				End If
			End If
			If .WebElement("InvoiceInformation").Exist(nminwait) Then
				.WebElement("InvoiceInformation").Click
				Call WriteToReport(micPass,"Invoice Information tab ","is present and clicked",false)
				else
				Call WriteToReport(micFail,"InvoiceInformation tab","is not present",True)
			End If
Dim AccountNumbers,Flag:flag=true
			do while flag
				If .WebTable("DistributionLines").Exist(nminwait) Then
					AccountNumbers=AccountNumbers&";"&Trim(.WebTable("DistributionLines").GetCellData(1,2))
				End If
				If .WebButton("NextLines").Exist(nminwait) Then
					.WebButton("NextLines").Click:wait(3)
				else
					flag=false
				End If
			loop
			If Instr(1,AccountNumbers,GlobalDictionary("GST"),1) And Instr(1,AccountNumbers,GlobalDictionary("QST"),1) Then
				Call WriteToReport(micPass,"GST and QST values are displayed ","Diplayed in the Distribution lines GST as "&GlobalDictionary("GST")&" QST as "&GlobalDictionary("QST"),false)
				else
				Call WriteToReport(micFail,"GST and QST values aren't  displayed in InvoiceInformation tab","GST and QST values aren't displayed",True)
			End If
		End with 

	End If
		
Dim rc,i,k

	strSQL=GlobalDictionary("strSQL1")&"'"&GlobalDictionary("InvoiceNumber")&"'"
	If NOT dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
		Call WriteToReport(micFail, "Verifying the Record from Database", "No Record Exist for SQL: [" & strSQL & "]",true)
	else
		Call WriteToReport(micPass,"DB records fetched successfully","SQL query executed sucessfully ["&strSQL&"]" ,false)
		Set table=DataTable.GetSheet(sheetName)
		
		For k = 1 To table.GetRowCount Step 1
			table.SetCurrentRow(k)
			If Trim(DataTable.Value("LINE_NBR",sheetName))<>0 Then
				Exit for
			End If
		Next
		GlobalDictionary("PO_ID")=DataTable.Value("PO_ID",sheetName)
		GlobalDictionary("businessunit")=DataTable.Value("BUSINESS_UNIT",sheetName)
		'Navigate to Purchasing>Purchase Orders>Review PO Information>Purchase Orders
		SelectMainMenu1(GlobalDictionary("MainMenuSelection1"))

		With Browser("PeopleSoft Browser").Page("PurchaseOrderInquery").PSFrame("PurchaseOrderInquery")
			If .WebEdit("PO_ID").Exist(nminwait) Then
				.WebEdit("PO_ID").Set GlobalDictionary("PO_ID")
				Call WriteToReport(micPass,"PO_ID ","is present and entered as "&GlobalDictionary("PO_ID"),false)
				else
				Call WriteToReport(micFail,"PO_ID","is not present",True)
			End If
			If .WebEdit("Businessunit").Exist(nminwait) Then
				.WebEdit("Businessunit").Set GlobalDictionary("businessunit")
				Call WriteToReport(micPass,"Businessunit ","is present and entered as "&GlobalDictionary("businessunit"),false)
				else
				Call WriteToReport(micFail,"Businessunit","is not present",True)
			End If
			If .WebButton("Search").Exist(nminwait) Then
				.WebButton("Search").Click
				Call WriteToReport(micPass,"Search button ","is present and Clicked",false)
				else
				Call WriteToReport(micFail,"Searh button","is not present",True)
			End If
			app_SearchSync()
			flag=true
Dim str	:str=" Line details "
			If .WebTable("Linesfirst3cols").Exist(nminwait) Then
				rc=.WebTable("Linesfirst3cols").RowCount()
				For i = 1 To rc Step 1
					If StrComp(Trim(.WebTable("Linesfirst3cols").GetCellData(i,3)),Trim(DataTable.Value("INV_ITEM_ID",sheetName)),1)=0 Then
						Call WriteToReport(micPass,"Line details displayed","Line details displayed in row "&i&" out of "&rc&" rows -["&DataTable.Value("INV_ITEM_ID",sheetName)&"]",false)
						flag=false:Exit for
					else:str=str&"["&.WebTable("Linesfirst3cols").GetCellData(i,3)&"],"
					End If
				Next
				If flag Then
					Call WriteToReport(micFAIL," expected DB Line details["&DataTable.Value("INV_ITEM_ID",sheetName)&"] aren't displayed","Line details are not displayed , Actual "&str ,true)
				End If
			End If
		End With
		
	End If
End Function

'*********************************************************************************************************************************
''' <summary>  
''' InvoiceTaxExempt()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayCycle"</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/1/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'AP_02_02_16_InvoiceTaxExempt
Public Function InvoiceTaxExempt()
		Dim businessunit,supplierID
	
	sheetName=GlobalDictionary("sheetName")
	connectionString = "Provider=SQLOLEDB;Server=PSFNREGSQLSTG1;DATABASE=FNREG;uid='';pwd='';Trusted_Connection=Yes"
	

strSQL=GlobalDictionary("strSQL")
	If NOT dbGetSpecifiRecords(strSQL, connectionString, sheetName) Then
		Call WriteToReport(micFail, "Verifying the Record from Database", "No Record Exist for SQL: [" & strSQL & "]",true)
	else
		Call WriteToReport(micPass,"DB records fetched successfully","SQL query executed sucessfully ["&strSQL&"]" ,false)
		Set table=DataTable.GetSheet(sheetName)
		table.SetCurrentRow(1)
		
		GlobalDictionary("VouchersID")=DataTable.Value("VOUCHER_ID",sheetName)
		GlobalDictionary("businessunit")=DataTable.Value("BUSINESS_UNIT",sheetName)
		
	
		'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
		SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		
			'Add business unit and voucgher id in existing value
		with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
			
			.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
			If .WebTabStrip("tabSelectionMain").Exist(nMINWAIT) Then
				.WebTabStrip("tabSelectionMain").Select("Find an Existing Value")
				Call WriteToReport(micPass,"Find an existing Value tab ","is present and clicked",false)
				else
				Call WriteToReport(micFail,"Find an existing Value tab","is not present",True)
			End If
		
			.WebEdit("BusinessUnitFEV").WaitProperty "visible",True,20000
			If .WebEdit("BusinessUnitFEV").Exist(nMINWAIT) Then
				.WebEdit("BusinessUnitFEV").Set GlobalDictionary("businessunit")
				Call WriteToReport(micPass,"Business unit ","is present and entered as "&GlobalDictionary("businessunit"),false)
				else
				Call WriteToReport(micFail,"Business unit","is not present",True)
			End If
			

			If .WebEdit("VoucherIdFEV").Exist(nMINWAIT) Then
				.WebEdit("VoucherIdFEV").Set GlobalDictionary("VouchersID")
				Call WriteToReport(micPass,"VouchersID ","is present and entered as "&GlobalDictionary("VouchersID"),false)
				else
				Call WriteToReport(micFail,"VouchersID","is not present",True)
			End If
			
			If .WebButton("Search").Exist(nMINWAIT) Then
				.WebButton("Search").Click
				Call WriteToReport(micPass,"Search button to Search the voucher","is present",false)
				else
				Call WriteToReport(micFail,"Search button to Search the voucher","is not present",True)
			End If
			
			'wait for the ojects to get loaded
			app_SearchSync()
			If .WebElement("PostStatus").Exist(nminwait) Then
				strstatus=.WebElement("PostStatus").GetROProperty("innertext")
				If StrComp(Trim(strstatus),"Posted",1)=0 Then
					Call WriteToReport(micPass,"Post Status of voucher","is present and displayed"&strstatus,false)
					else
					Call WriteToReport(micFail,"Post Status of voucher","is not present",True)
				End If
			End If
			If .WebElement("MatchStatus").Exist(nminwait) Then
				strstatus=.WebElement("MatchStatus").GetROProperty("innertext")
				If StrComp(Trim(strstatus),"Matched",1)=0 Then
					Call WriteToReport(micPass,"Match Status of voucher","is present and displayed"&strstatus,false)
					else
					Call WriteToReport(micFail,"Match Status of voucher","is not present",True)
				End If
			End If
			If .WebElement("EntryStatus").Exist(nminwait) Then
				strstatus=.WebElement("EntryStatus").GetROProperty("innertext")
				If StrComp(Trim(strstatus),"Postable",1)=0 Then
					Call WriteToReport(micPass,"Entry Status of voucher","is present and displayed"&strstatus,false)
					else
					Call WriteToReport(micFail,"Entry Status of voucher","is not present",True)
				End If
			End If
			If .WebElement("approvalStatus").Exist(nminwait) Then
				strstatus=.WebElement("approvalStatus").GetROProperty("innertext")
				If StrComp(Trim(strstatus),"Approved",1)=0 Then
					Call WriteToReport(micPass,"approval Status of voucher","is present and displayed"&strstatus,false)
				else
					Call WriteToReport(micFail,"approval Status of voucher","is not present",True)
				End If
			End If
'			If .WebElement("InvoiceInformation").Exist(nminwait) Then
'				.WebElement("InvoiceInformation").Click
'				Call WriteToReport(micPass,"Invoice Information tab ","is present and clicked",false)
'				else
'				Call WriteToReport(micFail,"InvoiceInformation tab","is not present",True)
'			End If
		End with 

	End If
End Function


'*********************************************************************************************************************************
''' <summary>  
''' VerifyCompanyType()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayCycle"</note> 
''' </para>
''' </summary>
''' <author>Vijayakumar  N</author>
''' <datecreated>3/1/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'
Public Function VerifyCustomTab()

GlobalDictionary("SignInUser")=GlobalDictionary("Approver2")

'GlobalDictionary("SupplierIdCreated")="VER424"
UserSignIn()

'Navigate to below page
'Suppliers > Supplier Information > Add/Update > Supplier 
'Enter the Supplier ID
SelectMainMenu1(GlobalDictionary("MainMenuSelection5"))

'Enter the Supplier ID
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("FindExistingValue_VendorID")
If .Exist(nMINWAIT) Then
	.Set (GlobalDictionary("SupplierIdCreated"))
	Reporter.ReportEvent micPass,"THe supplier id is ","set which we have created from previous steps="&(GlobalDictionary("SupplierIdCreated"))
End If
End  With 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With


'Validate whether page is opened
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Custom Tab")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Custom Tab is","present details are validated"
End If
End  With 

'Validate whether page is opened
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("Company Type")
If .Exist(nMINWAIT) Then
	dtcompany=.GetROProperty("value")
	Reporter.ReportEvent micPass,"Company Type is","present as "&dtcompany
	
else
	Reporter.ReportEvent micFail,"Company Type is","not Present"
End If
End  With 

if Not (GlobalDictionary("dtCompanyType")=dtcompany)Then

	Reporter.ReportEvent micFail,"Company Type when created"," " &(GlobalDictionary("dtCompanyType"))
	Reporter.ReportEvent micFail,"Company Type is diplayed "," " &dtcompany
	
else
Reporter.ReportEvent micPass,"Company Type when created","" &(GlobalDictionary("dtCompanyType"))
Reporter.ReportEvent micPass,"Company Type is diplayed ","" &dtcompany

Reporter.ReportEvent micPass,"Verify Custom Tab info"," is combined " 


WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("BarbeeVendor Id")
If .Exist(nMINWAIT) Then
	
	Reporter.ReportEvent micPass,"BarbeeVendor Id is","present "
	
else
	Reporter.ReportEvent micFail,"BarbeeVendor Id is","not Present"
End If
End  With 

WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Hold Date")
If .Exist(nMINWAIT) Then
	
	Reporter.ReportEvent micPass,"Hold Date is","present "
	
else
	Reporter.ReportEvent micFail,"Hold Date is","not Present"
End If
End  With 
	
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Hold Requestor")
If .Exist(nMINWAIT) Then
	
	Reporter.ReportEvent micPass,"Hold Requestor is","present "
	
else
	Reporter.ReportEvent micFail,"Hold Requestor is","not Present"
End If
End  With 

WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Hold Reason")
If .Exist(nMINWAIT) Then
	
	Reporter.ReportEvent micPass,"Hold Reason is","present "
	
else
	Reporter.ReportEvent micFail,"Hold Reason is","not Present"
End If
End  With 

WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Vendor Credit Limit")
If .Exist(nMINWAIT) Then
	
	Reporter.ReportEvent micPass,"Vendor Credit Limit is","present "
	
else
	Reporter.ReportEvent micFail,"Vendor Credit Limit is","not Present"
End If
End  With



End If


'GlobalDictionary("SignInUser")=GlobalDictionary("SignInUserStatus")


End Function



'*********************************************************************************************************************************
''' <summary>  
''' VerifySupplier Status()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayCycle"</note> 
''' </para>
''' </summary>
''' <author>Vijayakumar  N</author>
''' <datecreated>3/1/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'
Public Function ChangeandVerifyStatus()

Reporter.ReportEvent micPass,"AP_01_01_21_InactivateVendor"," test case is combined with AP_01_01_18_VendorCustom "

''Navigate to below page
''Suppliers > Supplier Information > Add/Update > Supplier 
''Enter the Supplier ID
'SelectMainMenu1(GlobalDictionary("MainMenuSelection5"))
'
''Enter the Supplier ID
'With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("FindExistingValue_VendorID")
'If .Exist(nMINWAIT) Then
'	.Set (GlobalDictionary("SupplierIdCreated"))
'	Reporter.ReportEvent micPass,"THe supplier id is ","set which we have created from previous steps="&(GlobalDictionary("SupplierIdCreated"))
'End If
'End  With 
'
''CLick on Search button
'With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Search")
'If .Exist(nMINWAIT) Then
'	.Click
'End If
'End  With


'Validate whether page is opened
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("IdentifyingInformation")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Custom Tab is","present details are validated"
End If
End  With 


'Validate whether page is opened
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebList("SupplierStatus_Drpdwn")
If .Exist(nMINWAIT) Then
	.Select (GlobalDictionary("Change Status"))
	Reporter.ReportEvent micPass,"Status Drop down","Status drop down is displayed and select the status as  "&(GlobalDictionary("Change Status"))
	
else
	Reporter.ReportEvent micFail,"Status Drop down","not Present"
End If
End  With 

Wait (2)

WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Save Button","Save Button is present and clicked"
	
else
	Reporter.ReportEvent micFail,"Save Button","not Present"
End If
End  With

Wait(3)

WIth Browser("PeopleSoft Browser").Page("Supplier").WebButton("Warning_OKButton")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Warning message ","Warning message is displayed"
	Reporter.ReportEvent micPass,"WarningOK button","WarningOK button is displayed and clicked"

End If
End  With

app_SearchSync()

'Validate whether page is opened
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Summary tab is","present details are validated"
	
	Else
	Reporter.ReportEvent micFail,"Summary tab is","not present"
	
End If
End  With 

'Validate whether page is opened
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary_Status")
If .Exist(nMINWAIT) Then
	dtStatus=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"Supplier status is","present as "&dtStatus
	
else
	Reporter.ReportEvent micFail,"Supplier status is","not Present"
End If
End  With 



if Not (GlobalDictionary("Change Status")=dtStatus)Then

Reporter.ReportEvent micFail,"Supplier status on summary page is not changed to "," " &dtStatus
	 
else
Reporter.ReportEvent micPass,"Supplier status on summary page is successfully changed to "," " &dtStatus
	


End If


End Function


'*********************************************************************************************************************************
''' <summary>  
''' VerifySupplier Status()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayCycle"</note> 
''' </para>
''' </summary>
''' <author>Vijayakumar  N</author>
''' <datecreated>3/1/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'
Public Function ChangeandCustomTab()

Reporter.ReportEvent micPass,"AP_01_01_20_CustomTab"," test case is combined with AP_01_01_18_VendorCustom "

'Navigate to below page
'Suppliers > Supplier Information > Add/Update > Supplier 
'Enter the Supplier ID
SelectMainMenu1(GlobalDictionary("MainMenuSelection5"))

'Enter the Supplier ID
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebEdit("FindExistingValue_VendorID")
If .Exist(nMINWAIT) Then
	.Set (GlobalDictionary("SupplierIdCreated"))
	Reporter.ReportEvent micPass,"THe supplier id is ","set which we have created from previous steps="&(GlobalDictionary("SupplierIdCreated"))
End If
End  With 

'CLick on Search button
With Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Search")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With


'Validate whether page is opened
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("IdentifyingInformation")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Custom Tab is","present details are validated"
End If
End  With 


'Validate whether page is opened
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebList("SupplierStatus_Drpdwn")
If .Exist(nMINWAIT) Then
	.Select (GlobalDictionary("Change Status"))
	Reporter.ReportEvent micPass,"Status Drop down","Status drop down is displayed and select the status as  "&(GlobalDictionary("Change Status"))
	
else
	Reporter.ReportEvent micFail,"Status Drop down","not Present"
End If
End  With 

Wait (2)

WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Save Button","Save Button is present and clicked"
	
else
	Reporter.ReportEvent micFail,"Save Button","not Present"
End If
End  With

Wait(3)

WIth Browser("PeopleSoft Browser").Page("Supplier").WebButton("Warning_OKButton")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Warning message ","Warning message is displayed"
	Reporter.ReportEvent micPass,"WarningOK button","WarningOK button is displayed and clicked"

End If
End  With

app_SearchSync()

'Validate whether page is opened
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Summary tab is","present details are validated"
	
	Else
	Reporter.ReportEvent micFail,"Summary tab is","not present"
	
End If
End  With 

'Validate whether page is opened
WIth Browser("PeopleSoft Browser").Page("Supplier").Frame("TargetContent").WebElement("Summary_Status")
If .Exist(nMINWAIT) Then
	dtStatus=.GetROProperty("innertext")
	Reporter.ReportEvent micPass,"Supplier status is","present as "&dtStatus
	
else
	Reporter.ReportEvent micFail,"Supplier status is","not Present"
End If
End  With 



if Not (GlobalDictionary("Change Status")=dtStatus)Then

Reporter.ReportEvent micFail,"Supplier status on summary page is not changed to "," " &dtStatus
	 
else
Reporter.ReportEvent micPass,"Supplier status on summary page is successfully changed to "," " &dtStatus
	


End If


End Function





'*********************************************************************************************************************************
''' <summary>  
''' DistrbutionLinesComboEdits()
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are ""</note> 
''' </para>
''' </summary>
''' <author>Gunasekaran S</author>
''' <datecreated>3/1/2019</datecreated>
''' <startstate>NA</startstate>
''' <endstate>NA</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'
'AP_02_02_17
Public Function DistrbutionLinesComboEdits()
	Dim voucherID,businessunit,invoiceNo,Dept,Account,Total,supplierID,invoiceDate,i

	
	For i = 1 To 4 Step 1
		'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
		SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
		'wait for the ojects to get loaded
		app_SearchSync()
		
		businessunit=GlobalDictionary("businessunit")
		voucherID=GlobalDictionary("voucherID")
		invoiceNo=GlobalDictionary("invoiceNo")&Replace(Replace(Replace(now,"/",""),":","")," ","")
		invoiceDate=GlobalDictionary("invoiceDate")
		supplierID=GlobalDictionary("SupplierID")
		Total=GlobalDictionary("Invoice Amount")
		
		If i=1 Then
			Account=GlobalDictionary("Account")
			Dept=GlobalDictionary("Dept")
		ElseIf i=2 Then
			Account=GlobalDictionary("Account1")
			Dept=GlobalDictionary("Dept1")
		ElseIf i=3 Then
			Account=GlobalDictionary("Account2"):Dept=""
		Else
			Account=GlobalDictionary("Account3"):Dept=""
		End If
		
		with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
			If .WebElement("voucher_tabAddNewValue").Exist(nminwait) Then
				.WebElement("voucher_tabAddNewValue").Click
			End If
			If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
				.WebEdit("BusinessUnit").Set businessunit
				Call WriteToReport(micPass,"Business unit : "&businessunit,"is present and entered as "&businessunit,false)
				else
				Call WriteToReport(micFail,"Business unit","is not present",True)
			End If
			
			If .WebEdit("VoucherId").Exist(nMINWAIT) Then
				.WebEdit("VoucherId").Set voucherID
				Call WriteToReport(micPass,"Voucher Id :"&voucherID,"is present and entered as "&voucherID,false)
				else
				Call WriteToReport(micFail,"Voucher Id","is not present",True)
			End If
			'enter invoice id and invoice date and save
			If .WebEdit("InvoiceNumber_AddNewValue").Exist(nMINWAIT) Then
				.WebEdit("InvoiceNumber_AddNewValue").Set invoiceNo
				Call WriteToReport(micPass,"invoiceNo :"&invoiceNo,"is present and entered as "&invoiceNo,false)
				else
				Call WriteToReport(micFail,"invoiceNo","is not present",True)
			End If
			
			If .WebEdit("InvoiceDate_AddNewValue").Exist(nMINWAIT) Then
				.WebEdit("InvoiceDate_AddNewValue").Set invoiceDate
				Call WriteToReport(micPass,"invoice Date : "&invoiceDate,"is present and entered as "&invoiceDate,false)
				else
				Call WriteToReport(micFail,"invoice Date","is not present",True)
			End If
			
			If .WebEdit("SuuplierId_AddValue").Exist(nMINWAIT) Then
				.WebEdit("SuuplierId_AddValue").Set supplierID
				Call WriteToReport(micPass,"Supplier ID : "&supplierID,"is present and entered as "&supplierIDs,false)
				else
				Call WriteToReport(micFail,"Supplier ID","is not present",True)
			End If
			
			If .WebEdit("GrossInvoiceAmount").Exist(nMINWAIT) Then
				.WebEdit("GrossInvoiceAmount").Set Total
				Call WriteToReport(micPass,"Gross Invoice Amount : "&Total,"GrossInvoiceAmount is present and entered as "&Total,false)
				else
				Call WriteToReport(micFail,"Gross Invoice Amount","is not present",True)
			End If
			
			If .WebButton("Add").Exist(nMINWAIT) Then
				wait(5)
				.WebButton("Add").Click
				Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
				else
				Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
			End If
			
			'wait for the ojects to get loaded
			app_SearchSync()
		
				
			If .WebEdit("Account").Exist(nMINWAIT) Then
				.WebEdit("Account").Click
				wait(3)
				.WebEdit("Account").Set Account
				Call WriteToReport(micPass,"Account "&Account,"is present and entered as "&vs,false)
				else
				Call WriteToReport(micFail,"Account","is not present",True)
			End If
			
			If Dept<>"" Then
			If .WebEdit("Dept").Exist(nMINWAIT) Then
				.WebEdit("Dept").Set Dept
				Call WriteToReport(micPass,"Dept "&Dept,"is present and entered as "&Dept,false)
				else
				Call WriteToReport(micFail,"Dept","is not present",True)
			End If
			End If
			
			
			If .WebButton("Save").Exist(nMINWAIT) Then
				.WebButton("Save").Click
				Call WriteToReport(micPass,"Save button in invoice information","is present and clicked",false)
				else
				Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
			End If
		
		end with
		
		wait(3):App_searchSync()
		
		If i <> 2 Then
			With Browser("PeopleSoft Browser").Page("Regular Entry")
				If .WebElement("MessageforDifference").Exist(nminwait) Then
					strMsg=.WebElement("MessageforDifference").GetROProperty("innertext")
					If i=1 Then
						If InStr(1,Trim(strMsg),"invalid ChartField combination DEPTID/ ACCOUNT",1) OR InStr(1,Trim(strMsg),"DEPTID",1) OR InStr(1,Trim(strMsg),"ACCOUNT",1) Then
							Call WriteToReport(micPass,"Expected Eror pop up message is displayed","Error message displayed as "&strMsg,false)
							else
							Call WriteToReport(micFail,"Expected Eror pop up message isn't displayed","Expeced error message is 'invalid ChartField combination DEPTID/ ACCOUNT', Actual Error message displayed as "&strMsg,True)
						End If
						
					ElseIf i=3 Then
						If InStr(1,Trim(strMsg),"Invalid value",1) Then
							Call WriteToReport(micPass,"Expected Eror pop up message is displayed","Error message displayed as "&strMsg,false)
							else
							Call WriteToReport(micFail,"Expected Eror pop up message isn't displayed","Error message displayed as "&strMsg,True)
						End If
					else
						If InStr(1,Trim(strMsg),"invalid ChartField combination DEPTID/ ACCOUNT",1) OR InStr(1,Trim(strMsg),"DEPTID",1) OR InStr(1,Trim(strMsg),"ACCOUNT",1) Then
							Call WriteToReport(micPass,"Expected Eror pop up message is displayed","Error message displayed as "&strMsg,false)
							else
							Call WriteToReport(micFail,"Expected Eror pop up message isn't displayed","Expeced error message is 'invalid ChartField combination DEPTID/ ACCOUNT', Actual Error message displayed as "&strMsg,True)
						End If
					End If
				else:Call WriteToReport(micFail,"Expected Eror pop up isn't displayed","Error message pop up displayed as "&strMsg,True)
				End If
				If .WebButton("OK").Exist(nminwait) Then
					.WebButton("OK").Click
					Call WriteToReport(micPass,"Ok button","is present and clicked",false)
					else
					Call WriteToReport(micFail,"OK button","is not present",True)
				End If
				if .WebElement("MessageforDifference").Exist(nminwait) Then
					strMsg=.WebElement("MessageforDifference").GetROProperty("innertext")
					Call WriteToReport(micPass,"Expected Eror pop up message is displayed","Error message displayed as "&strMsg,false)
				End If
				If .WebButton("OK").Exist(nminwait) Then
					.WebButton("OK").Click
				End If
				If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Go To Review Error").Exist(nminwait) Then
					Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Go To Review Error").Click
					Call WriteToReport(micPass,"Go To Review Error button","Go To Review Error is present and clicked",false)
						With Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Error Distribution Lines").WebTable("DistributionLines")
							If .Exist(nminwait) Then
								Call WriteToReport(micPass,"Error Details","Field Name - "&.GetCellData(1,1)&" and message - "&.GetCellData(1,2),false)
							End If
						End With
						If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Error Distribution Lines").WebButton("Return").Exist(nminwait) Then
							Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("Error Distribution Lines").WebButton("Return").Click
						End If
					else
					 If i=4 Then
					 	Call WriteToReport(micFail,"Go To Review Error button","Go To Review Error is not present and Error doesn't get generated",True)
					 End If
				End If
			End With
		ElseIf i=2 Then
			With Browser("PeopleSoft Browser").Page("Regular Entry")
				If .WebElement("MessageforDifference").Exist(nminwait) Then
					strMsg=.WebElement("MessageforDifference").GetROProperty("innertext")
					Call WriteToReport(micFail,"Expected: Voucher should be saved","Actual: Error message displayed as "&strMsg,True)
					else
					If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucherID").Exist(nminwait) Then
						Call WriteToReport(micPass,"Eror pop up message isn't displayed","Voucher successfully saved with out error and Voucher ID is "&Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("voucherID").GetROProperty("innertext"), false)
						else
						Call WriteToReport(micPass,"Eror pop up message isn't displayed","Voucher successfully saved with out error",false)
					End If
				End If
			end with
		End If
		With Browser("PeopleSoft Browser").Page("Regular Entry")
			If .WebButton("HomeTop").Exist(nminwait) Then
				.WebButton("HomeTop").Click
			End If
			If .WebButton("No").Exist(nminwait) Then
				.WebButton("No").Click
			End If
		End With

	Next
	
End Function


'****************************************************************************************************************************
'*******************************************************************************************************
'2.2.9

Public Function VoucherWithFreightPaymentMessage()

BusinessUnit=(GlobalDictionary("BusinessUnit"))
VoucherID=(GlobalDictionary("VoucherID"))
SelectMainMenu1(GlobalDictionary("MainMenuSelection2"))
supplierID=(GlobalDictionary("supplierID"))

'Navigat to regular entry
SelectMainMenu1(GlobalDictionary("RegularEntry"))

VoucherID=ap_createVoucherWithCopyPO(businessunit,supplierID)
GlobalDictionary("voucherID")=VoucherID

GlobalDictionary("VoucherCreated")=GlobalDictionary("SignInUser")
'Assign the user to KATHOW to chedck whether he is having asseccto proc3ess montir
GlobalDictionary("SignInUser")=GlobalDictionary("Admin")

'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'wait for the ojects to get loaded
app_SearchSync()

'Navigate to Regualr entry pahe
'Navigat to regular entry
SelectMainMenu1(GlobalDictionary("RegularEntry"))

'wait for the ojects to get loaded
app_SearchSync()

Call AddPaymentMessage()

'Assign the user
GlobalDictionary("SignInUser")=GlobalDictionary("VoucherCreated")

'Loging out of application
Call PSFinLogout()

'Logging to application
Call UserSignIn()

'wait for the ojects to get loaded
app_SearchSync()

'Navigate to Regualr entry pahe
'Navigat to regular entry
SelectMainMenu1(GlobalDictionary("RegularEntry"))

'wait for the ojects to get loaded
app_SearchSync()

businessunit=(GlobalDictionary("BusinessUnit"))
voucherID=GlobalDictionary("voucherID")

'Open the existing voucher
Call ap_openExistingVoucher(businessunit,voucherID)

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("tabPayments")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With

'wait for the ojects to get loaded
app_SearchSync()

PaymentMesage=GlobalDictionary("paymentMessage")
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Payments_Message")
If .Exist(nMINWAIT) Then
	dtPaymenrMessage=.GetROProperty("value")
	If instr(1,dtPaymenrMessage,PaymentMesage)>0 Then
		Reporter.ReportEvent micPass,"The payment message is","same as entered and message is"&dtPaymenrMessage
	End If
End If
End  With 

End Function

Public Function AddPaymentMessage()
businessunit=(GlobalDictionary("BusinessUnit"))
voucherID=GlobalDictionary("voucherID")

'Open the existing voucher
Call ap_openExistingVoucher(businessunit,voucherID)

'wait for the ojects to get loaded
app_SearchSync()

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebElement("tabPayments")
If .Exist(nMINWAIT) Then
	.Click
End If
End  With

'wait for the ojects to get loaded
app_SearchSync()

PaymentMesage="Test"&Replace(Replace(replace(Time,":","")," ",""),"/","")
GlobalDictionary("paymentMessage")=PaymentMesage
With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Payments_Message")
If .Exist(nMINWAIT) Then
	.Set PaymentMesage
	Reporter.ReportEvent micPass,"The payment message","set is"&PaymentMesage
End If
End  With 

With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("Save")
If .Exist(nMINWAIT) Then
	.Click
	Reporter.ReportEvent micPass,"Save Button","is present and clicked"
End If
End  With 

'wait for the ojects to get loaded
app_SearchSync()

End Function

'**************************************************************************************************************

'***********************************************************************************************************
Public Function ap_createVoucherWithCopyPO(Byref businessunit,Byref supplierID)
'	Dim businessunit,supplierID
	Dim voucherID,approvalStatus,invoiceNo,Total,invoiceDate,i,CopyFrom,PayTerm,MatchStatus,Salestax,Misc,Fright,PONumberFrom
	Dim rc,nCount,temp
'	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
'	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
'	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo")&inVoiceNumberGeneration
	invoiceDate=date-2'GlobalDictionary("invoiceDate")
	supplierID=GlobalDictionary("SupplierID")
	CopyFrom=GlobalDictionary("CopyFrom")
	PayTerm=GlobalDictionary("PayTerm")
	Salestax=GlobalDictionary("Salestax")
	Misc=GlobalDictionary("Misc")
	Fright=GlobalDictionary("Fright")
	PONumberFrom=GlobalDictionary("PONumberFrom")
	AccountNumber=GlobalDictionary("dtAccountNumber1")
	Dept=GlobalDictionary("dtDept1")
	temp=0
	'wait for the ojects to get loaded
	app_SearchSync()

'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	.WebEdit("BusinessUnit").WaitProperty "visible",True,20000
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit ","is present and entered "&businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id ","is present and entered "&voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		.WebButton("Add").highlight
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()

	.WebEdit("invoiceNo").WaitProperty "visible",true,20000
	'enter invoice id and invoice date and save
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		.WebEdit("invoiceNo").Set invoiceNo
		Call WriteToReport(micPass,"invoiceNo ","is present and entered "&invoiceNo,false)
		else
		Call WriteToReport(micFail,"invoiceNo","is not present",True)
	End If
	
	If .WebEdit("invoiceDate").Exist(nMINWAIT) Then
		.WebEdit("invoiceDate").Set invoiceDate
		Call WriteToReport(micPass,"invoice Date ","is present and entred as "&invoiceDate,false)
		else
		Call WriteToReport(micFail,"invoice Date","is not present",True)
	End If
	If .WebEdit("PayTerms").Exist(nMINWAIT) Then
		.WebEdit("PayTerms").Set PayTerm
		Call WriteToReport(micPass,"PayTerm ","is present and entered as"&PayTerm,false)
		else
		Call WriteToReport(micFail,"PayTerm","is not present",True)
	End If
End with	
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Exist(nMINWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebButton("SupplierIDLookup").Click
	End If

	If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Exist(nMINWAIT) Then
'		If InStr(supplierID,"...")<>0 Then
		Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebEdit("SupplierIDlookup").Set Replace(supplierID,"...","")
		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebButton("LookUp").Click
		End If

		If Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").Exist(nMINWAIT) Then
			If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").RowCount))>1 Then
				Browser("PeopleSoft Browser").Page("Regular Entry").PSFrame("LookupSupllierIDForm").WebTable("SupplierID").ChildItem(2,1,"Link",0).click
			End If
		End If
'		else
'			Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("SupplierID").Set Trim(supplierID)
'		End If
		Call WriteToReport(micPass,"Supplier ID","is present and value entered"&supplierID,false)
		else
		Call WriteToReport(micFail,"Supplier ID","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	
	If (NOT IsEmpty(CopyFrom)) AND  CopyFrom<>"" Then
		temp=1
		with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")		
		If .WebList("CopyFrom").Exist(nMINWAIT) Then
			.WebList("CopyFrom").Select CopyFrom
			Call WriteToReport(micPass,"CopyFrom","is present and selected "&CopyFrom,false)
			else
			Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
		End If
		
		If .Link("Go").Exist(nMINWAIT) Then
'			wait(3)
			.Link("Go").Click
			Call WriteToReport(micPass,"go link ","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Go link","is not present",True)
		End If
		
		If .WebEdit("POBusinessUnit").Exist(nMINWAIT) Then
			.WebEdit("POBusinessUnit").Set businessunit
			Call WriteToReport(micPass,"POBusinessUnit ","is present and entered as"&businessunit,false)
			else
			Call WriteToReport(micFail,"POBusinessUnit","is not present",True)
		End If
		End with	
		If NOT IsEmpty(PONumberfrom) AND PONumberfrom<>"" Then
			If  len(PONumberfrom)>0  Then
				If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PONumberFrom").Exist(nMINWAIT) Then
					Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("PONumberFrom").Set PONumberFrom
					Call WriteToReport(micPass,"PONumberFrom ","is present and entered as"&PONumberFrom,false)
					temp=2
					else
					Call WriteToReport(micFail,"PONumberFrom","is not present",True)
				End If
			End If
		End If
		If temp<>2 Then
			with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
	
				If .WebButton("PONumberLookup").Exist(nMINWAIT) Then
					.WebButton("PONumberLookup").Click
				End If
			End with	
				
			app_SearchSync()'wait(4)
			
			If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").Exist(nMINWAIT) Then
				If Cint(Trim(Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").RowCount))>1 Then
					PONumberFrom=Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").GetCellData(2,2)
					Browser("PeopleSoft Browser").Page("Regular Entry").Frame("lookUpPONumberForm").WebTable("PONumber").ChildItem(2,1,"Link",0).click
					temp=2
					Call WriteToReport(micPass,"PO number seletced","Selecetd PO number is "&PONumberFrom,True)
				else
					Call WriteToReport(micFail,"invoices for "&businessunit&","&supplierID ,"is not present",True)
				End If
			End If
		End If
	
		with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
	
		If .WebButton("CopyEntireDocument").Exist(nMINWAIT) Then
			.WebButton("CopyEntireDocument").Click
			Call WriteToReport(micPass,"CopyEntireDocument","is present and clicked",false)
			else
			Call WriteToReport(micFail,"CopyEntireDocument","is not present",True)
		End If
		end with 
		
		else
		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Account")
			.Set AccountNumber
			Call WriteToReport(micPass,"Account number","is present=" & AccountNumber,false)
		End With

		With Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent").WebEdit("Dept")
			.Set Dept
			Call WriteToReport(micPass,"Department number","is present=" & Dept,false)
		End  With
	End If
		
	

	
If temp<>1 Then
	
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
'	.WebEdit("Total").WaitProperty "visible",True,20000

	
	app_SearchSync()
'	If StrComp(GlobalDictionary("Selection"),"fright",1)=0 OR StrComp(GlobalDictionary("SelectionSelection"),"quantity",1)=0 Then
	If NOT IsEmpty(Fright) AND Fright<>""Then
		If  Fright>0  Then
			If .WebEdit("freight").Exist(nMINWAIT) Then
				.WebEdit("freight").Set Fright
				Call WriteToReport(micPass,"Fright ","is present and entered as"&Fright,false)
				else
				Call WriteToReport(micFail,"Fright","is not present",True)
			End If
		End If
	End If
	
	wait 3 
	If NOT IsEmpty(Salestax) AND Salestax<>""Then
		If Salestax>0  Then
			If .WebEdit("salesTax").Exist(nMINWAIT) Then
				.WebEdit("salesTax").Set Salestax
				Call WriteToReport(micPass,"Salestax ","is present and entered as"&Salestax,false)
				else
				Call WriteToReport(micFail,"Salestax","is not present",True)
			End If
		End If
	End If
	wait 3 
	If NOT IsEmpty(Misc) AND Misc<>"" Then
		If  Misc>0  Then
			If .WebEdit("MiscellaousAmount").Exist(nMINWAIT) Then
				.WebEdit("MiscellaousAmount").Set Misc
				Call WriteToReport(micPass,"MiscellaousAmount ","is present and entered as"&Misc,false)
				else
				Call WriteToReport(micFail,"MiscellaousAmount","is not present",True)
			End If
		End If
	End If
	
	If NOT IsEmpty(GlobalDictionary("Quantity")) AND GlobalDictionary("Quantity")<>"" Then
		If  GlobalDictionary("Quantity")>0 Then
			If .WebEdit("Quantity").Exist(nMINWAIT) Then
				If IsEmpty(.WebEdit("Quantity").GetROProperty("value")) OR GlobalDictionary("Quantity")="" OR .WebEdit("Quantity").GetROProperty("value")="" Then
					appUnitPrice=0
				else:appUnitPrice=Cdbl(.WebEdit("Quantity").GetROProperty("value"))
				End If
'				appUnitPrice=Cdbl(.WebEdit("Quantity").GetROProperty("value"))
				Call WriteToReport(micPass,"Quantity captured from application :"&appUnitPrice ,"Quantity is captured from application as "&appUnitPrice ,false)
				appUnitPrice=appUnitPrice+1
				.WebEdit("Quantity").Set(appUnitPrice)
				Call WriteToReport(micPass,"Quantity :"&appUnitPrice ,"Unit price value changed to "&appUnitPrice ,false)
				else
				Call WriteToReport(micFail,"Unitprice","is not present",True)
			End If
		End If
		End If
	
	
	app_SearchSync()
	
			
			

	
	If .WebEdit("lineAmount_1").Exist(nMINWAIT) Then
			If CInt(.WebEdit("lineAmount_1").GetROProperty("disabled"))=0 Then
				.WebEdit("lineAmount_1").Set GlobalDictionary("LineAmountData")
				Reporter.ReportEvent micPass,"The nit price is","is"&GlobalDictionary("LineAmountData")
			End If
		End If
			If .WebButton("CalculateInvoiceLine").Exist(nMINWAIT) Then
			.WebButton("CalculateInvoiceLine").Click
			Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked",false)
			else
			Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
		End If
		
		

	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked for get the difference",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	
	If .WebElement("Difference").Exist(nMINWAIT) Then
		appDifference=.WebElement("Difference").GetROProperty("innertext")
		Call WriteToReport(micPass,"Deifference is captured","Captured from application as"&appDifference,false)
	End If
	
	If .WebEdit("Total").Exist(nMINWAIT) Then
		.WebEdit("Total").Click
		app_SearchSync()
		wait 5
		.WebEdit("Total").Click
		appDifference=cdbl(appDifference)+Cdbl(.WebEdit("Total").GetROProperty("value"))
		.WebEdit("Total").Set appDifference
		Call WriteToReport(micPass,"Total : "&appDifference,"is present and entered as "&appDifference,false)
		else
		Call WriteToReport(micFail,"Total","is not present",True)
	End If
	
	If .WebButton("Calculate").Exist(nMINWAIT) Then
		.WebButton("Calculate").Click
		Call WriteToReport(micPass,"Calculate button in invoice information","is present and clicked to get difeerence",false)
		else
		Call WriteToReport(micFail,"Calculate button in invoice information","is not present",True)
	End If
	
	If .WebElement("Difference").Exist(nMINWAIT) Then
		appDifference=.WebElement("Difference").GetROProperty("innertext")
		Call WriteToReport(micPass,"Deifference should be 0","Captured from application as"&appDifference,false)
	End If
	
	
	app_SearchSync()	
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present and clicked",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
		If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(nMINWAIT) Then
			Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
		End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
	
	'wait for the ojects to get loaded
	app_SearchSync()
	'wait for the ojects to get loaded
	app_SearchSync()
'Voucher id generation validation	
	If .WebElement("voucherID").Exist(nMINWAIT) Then
		voucherID=.WebElement("voucherID").GetROProperty("innertext")
		If StrComp(voucherID,"NEXT",1)<>0 Then
			Call WriteToReport(micPass,"voucherID : "&voucherID,"is present and generated as "&voucherID,false)
			else
			Call WriteToReport(micFail,"voucherID","doesn't get generated",True)
		End If
	End If
	
	
	If .WebTabStrip("tabSelection").Exist(10) Then
		.WebTabStrip("tabSelection").Select("Voucher Attributes")
		Call WriteToReport(micPass,"Voucher Attributes tab","is present",false)
	else
		Call WriteToReport(micFail,"Voucher Attributes tab","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebEdit("invoiceNo").Exist(nMINWAIT) Then
		appinvoiceNo=.WebEdit("invoiceNo").GetROProperty("value") 
		If StrComp(Trim(appinvoiceNo),trim(invoiceNo))=0 Then
			Call WriteToReport(micPass,"Voucher Attributes ","data is present",false)
'			else
'			Call WriteToReport(micFail,"Voucher Attributes","data is not present",True)
		End If
	End If
	
'	If .WebTabStrip("tabSelection").Exist(10) Then
'		.WebTabStrip("tabSelection").Select("Invoice Information")
'		Call WriteToReport(micPass,"Invoice Information tab","is present",false)
'	else
'		Call WriteToReport(micFail,"Invoice Information tab","is not present",True)
'	End If
	
	If .WebButton("SubmitForApproval_VoucherAttribute").Exist(nMINWAIT) Then
		.WebButton("SubmitForApproval_VoucherAttribute").Click
		Call WriteToReport(micPass,"SubmitApproval button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"SubmitApproval button in invoice information","is not present",True)
	End If
End with
'wait for the ojects to get loaded
	app_SearchSync()
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Sync
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Click
		wait(2)
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebEdit("AdditionalDetails").Set voucherID&" is Approved"
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Exist(nMAXWAIT) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").Frame("Approval Comments").WebButton("OK").Click
	End If
	If Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Exist(10) Then
		Browser("PeopleSoft Browser").Page("Regular Entry").WebButton("OK").Click
	End if
'wait for the ojects to get loaded
	app_SearchSync()	
with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")	
	If .WebTabStrip("tabSelection").Exist(nMINWAIT) Then
		.WebTabStrip("tabSelection").Select("Summary")
		Call WriteToReport(micPass,"Summary tab","is present and selected",false)
	elseIf .WebElement("Summary").Exist(nminwait) Then
		.WebElement("Summary").Click
		Call WriteToReport(micPass,"Summary tab","is present and selected",false)
	else
		Call WriteToReport(micFail,"Summary tab","is not present",True)
	End If
'wait for the ojects to get loaded
	app_SearchSync()	
	If .WebElement("approvalStatus").Exist(nMINWAIT) Then
		approvalStatus=.WebElement("approvalStatus").GetROProperty("innertext")
		If StrComp(approvalStatus,"Approved",1)=0 Then
			Call WriteToReport(micPass,"Approval status changed to Approved status","is present",false)
			else
'			Call WriteToReport(micFail,"Approval status","doesn't chaged to Approved, Actual status is "&approvalStatus,True)
		End If
	End If
	
	If .WebElement("MatchStatus").Exist(nMINWAIT) Then
		MatchStatus=.WebElement("MatchStatus").GetROProperty("innertext")
		If StrComp(MatchStatus,"Ready",1)=0 Then
			Call WriteToReport(micPass,"MatchStatus : "&MatchStatus,"is present and generated as "&MatchStatus,false)
		End If
	End If

End with
else
	Call WriteToReport(micFail,"PO Number search","no results(Supllier details) available while PO lookup for BU:"&businessunit,True)
End If

ap_createVoucherWithCopyPO=voucherID 
End Function

'*********************************************************************************************************************************
''' <summary>  
''' OverridePayNonPO() To override Payment Terms on a Regular (Non-PO Related)  Voucher
'''Parameter1:	None.
''' <para>
''' <note>Required Testcase Inputs are "BusinessUnit, PayTerm, vocherID"</note> 
''' </para>
''' </summary>
''' <author>Vijay anandan</author>
''' <datecreated>12/12/2018</datecreated>
''' <startstate>Logged in as user that has right to post vouchers</startstate>
''' <endstate>Payment resecheduled to current date</endstate>
'Change Control: 
'   NA
'**********************************************************************************************************************************
'2.2.16 - AP new

Public Function DupInvoiceChk()

'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	
	businessunit=GlobalDictionary("businessunit")
	voucherID=GlobalDictionary("voucherID")
	invoiceNo=GlobalDictionary("invoiceNo") & inVoiceNumberGeneration 
	invoiceDate=GlobalDictionary("invoiceDate")
	supplierID=GlobalDictionary("SupplierID")
	Account=GlobalDictionary("Account")
	Dept=GlobalDictionary("Dept")
	Total=GlobalDictionary("Total")
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'Add business unit and voucgher id in existing value
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit ","is present=" &businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id ","is present=" &voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	

	'enter invoice id and invoice date and save

	If .WebEdit("InvoiceNumber_AddNewValue").Exist(nMINWAIT) Then
	.WebEdit("InvoiceNumber_AddNewValue").Set invoiceNo
		Call WriteToReport(micPass,"InvoiceNumber_AddNewValue ","is present=" &invoiceNo,false)
		else
		Call WriteToReport(micFail,"InvoiceNumber_AddNewValue","is not present",True)
	End If
	
	If .WebEdit("InvoiceDate_AddNewValue").Exist(nMINWAIT) Then
		.WebEdit("InvoiceDate_AddNewValue").Set invoiceDate
		Call WriteToReport(micPass,"InvoiceDate_AddNewValue","is present=" &invoiceDate,false)
		else
		Call WriteToReport(micFail,"InvoiceDate_AddNewValue","is not present",True)
	End If
	
	If .WebEdit("SuuplierId_AddValue").Exist(nMINWAIT) Then
		.WebEdit("SuuplierId_AddValue").Set SupplierID
		Call WriteToReport(micPass,"SuuplierId_AddValue","is present=" &SupplierID,false)
		else
		Call WriteToReport(micFail,"SuuplierId_AddValue","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	If .WebEdit("GrossInvoiceAmount").Exist(nMINWAIT) Then
		.WebEdit("GrossInvoiceAmount").Set Total
		Call WriteToReport(micPass,"GrossInvoiceAmount","is present=" &Total,false)
		else
		Call WriteToReport(micFail,"GrossInvoiceAmount","is not present",True)
	End If
	
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If

	'wait for the ojects to get loaded
	app_SearchSync()
		
	If .WebEdit("Account").Exist(nMINWAIT) Then
		.WebEdit("Account").Set Account
		Call WriteToReport(micPass,"Account","is present=" &Account,false)
		else
		Call WriteToReport(micFail,"Account","is not present",True)
	End If
		
	If .WebEdit("Dept").Exist(nMINWAIT) Then
		.WebEdit("Dept").Set Dept
		Call WriteToReport(micPass,"Dept","is present=" &Dept,false)
		else
		Call WriteToReport(micFail,"Dept","is not present",True)
	End If
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
	'End with
	
	'Voucher id generation validation	
	If .WebElement("voucherID").Exist(nMINWAIT) Then
		voucherId=.WebElement("voucherID").GetROProperty("innertext")
		If StrComp(voucherId,"NEXT",1)<>0 Then
			Call WriteToReport(micPass,"voucherID : "&voucherId,"is present and generated as "&voucherId,false)
			else
			Call WriteToReport(micFail,"voucherID","doesn't get generated",True)
		End If
	End If
	End with
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	voucherID=GlobalDictionary("voucherID")
	
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit ","is present=" &businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id ","is present=" &voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	'enter invoice id and invoice date and save
	If .WebEdit("InvoiceNumber_AddNewValue").Exist(nMINWAIT) Then
		.WebEdit("InvoiceNumber_AddNewValue").Set invoiceNo 'iceNo & inVoiceNumberGeneration & Day(Date)
		Call WriteToReport(micPass,"InvoiceNumber_AddNewValue ","is present=" &invoiceNo,false)
		else
		Call WriteToReport(micFail,"InvoiceNumber_AddNewValue","is not present",True)
	End If
	
	If .WebEdit("InvoiceDate_AddNewValue").Exist(nMINWAIT) Then
		.WebEdit("InvoiceDate_AddNewValue").Set invoiceDate
		Call WriteToReport(micPass,"InvoiceDate_AddNewValue","is present=" &invoiceDate,false)
		else
		Call WriteToReport(micFail,"InvoiceDate_AddNewValue","is not present",True)
	End If
	
	If .WebEdit("SuuplierId_AddValue").Exist(nMINWAIT) Then
		.WebEdit("SuuplierId_AddValue").Set SupplierID
		Call WriteToReport(micPass,"SuuplierId_AddValue","is present=" &SupplierID,false)
		else
		Call WriteToReport(micFail,"SuuplierId_AddValue","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	If .WebEdit("GrossInvoiceAmount").Exist(nMINWAIT) Then
		.WebEdit("GrossInvoiceAmount").Set Total
		Call WriteToReport(micPass,"GrossInvoiceAmount","is present=" &Total,false)
		else
		Call WriteToReport(micFail,"GrossInvoiceAmount","is not present",True)
	End If
	
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
'	'validate alert message	
	 With Browser("PeopleSoft Browser").Page("Regular Entry")
      If .WebElement("alertmsg").Exist(nminwait) Then
          WriteToReport micPass,"alertMsg is present","and displayed as"&.WebElement("alertmsg").GetROProperty("innertext"),false
      End If
      If .WebButton("OK").Exist(nminwait) Then
         .WebButton("OK").Click
      End If
    End With
          
	app_SearchSync()
	
	'Navigate to Account Payable --> Vouchers --> ADD/Update-> Regular Entry
	SelectMainMenu1(GlobalDictionary("MainMenuSelection"))
	voucherID=GlobalDictionary("voucherID")
	supplierid=GlobalDictionary("Supplierid")
	
	with Browser("PeopleSoft Browser").Page("Regular Entry").Frame("TargetContent")
	
	If .WebEdit("BusinessUnit").Exist(nMINWAIT) Then
		.WebEdit("BusinessUnit").Set businessunit
		Call WriteToReport(micPass,"Business unit ","is present=" &businessunit,false)
		else
		Call WriteToReport(micFail,"Business unit","is not present",True)
	End If
	
	If .WebEdit("VoucherId").Exist(nMINWAIT) Then
		.WebEdit("VoucherId").Set voucherID
		Call WriteToReport(micPass,"Voucher Id ","is present=" &voucherID,false)
		else
		Call WriteToReport(micFail,"Voucher Id","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	

	'enter invoice id and invoice date and save
	If .WebEdit("InvoiceNumber_AddNewValue").Exist(nMINWAIT) Then
		.WebEdit("InvoiceNumber_AddNewValue").Set invoiceNo
		Call WriteToReport(micPass,"InvoiceNumber_AddNewValue ","is present=" &invoiceNo,false)
		else
		Call WriteToReport(micFail,"InvoiceNumber_AddNewValue","is not present",True)
	End If
	
	If .WebEdit("InvoiceDate_AddNewValue").Exist(nMINWAIT) Then
		.WebEdit("InvoiceDate_AddNewValue").Set invoiceDate
		Call WriteToReport(micPass,"InvoiceDate_AddNewValue","is present=" &invoiceDate,false)
		else
		Call WriteToReport(micFail,"InvoiceDate_AddNewValue","is not present",True)
	End If
	
	If .WebEdit("SuuplierId_AddValue").Exist(nMINWAIT) Then
		.WebEdit("SuuplierId_AddValue").Set Supplierid
		Call WriteToReport(micPass,"SuuplierId_AddValue","is present=" &Supplierid,false)
		else
		Call WriteToReport(micFail,"SuuplierId_AddValue","is not present",True)
	End If
	
	'wait for the ojects to get loaded
	app_SearchSync()
	
	If .WebEdit("GrossInvoiceAmount").Exist(nMINWAIT) Then
		.WebEdit("GrossInvoiceAmount").Set Total
		Call WriteToReport(micPass,"GrossInvoiceAmount","is present=" &Total,false)
		else
		Call WriteToReport(micFail,"GrossInvoiceAmount","is not present",True)
	End If
	
	
	If .WebButton("Add").Exist(nMINWAIT) Then
		.WebButton("Add").Click
		Call WriteToReport(micPass,"Add button to add the voucher","is present",false)
		else
		Call WriteToReport(micFail,"Add button to add the voucher","is not present",True)
	End If
	
	If .WebEdit("Account").Exist(nMINWAIT) Then
		.WebEdit("Account").Set Account
		Call WriteToReport(micPass,"Account","is present=" &Account,false)
		else
		Call WriteToReport(micFail,"Account","is not present",True)
	End If
		
	If .WebEdit("Dept").Exist(nMINWAIT) Then
		.WebEdit("Dept").Set Dept
		Call WriteToReport(micPass,"Dept","is present=" &Dept,false)
		else
		Call WriteToReport(micFail,"Dept","is not present",True)
	End If
	
	If .WebButton("Save").Exist(nMINWAIT) Then
		.WebButton("Save").Click
		Call WriteToReport(micPass,"Save button in invoice information","is present",false)
		else
		Call WriteToReport(micFail,"Save button in invoice information","is not present",True)
	End If
	
	
	'Voucher id generation validation	
	If .WebElement("voucherID").Exist(nMINWAIT) Then
		voucherID=.WebElement("voucherID").GetROProperty("innertext")
		If StrComp(voucherID,"NEXT",1)<>0 Then
			Call WriteToReport(micPass,"voucherID : "&voucherID,"is present and generated as "&voucherID,false)
			else
			Call WriteToReport(micFail,"voucherID","doesn't get generated",True)
		End If
	End If
	End with
	End with 
	
End Function

Public Function MoveToNextPageForApproving()
'CLick on Date From option
With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").Link("DateFrom")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth 

'wait for the ojects to get loaded
app_SearchSync()


With Browser("PeopleSoft Browser").Page("Worklist").PSFrame("Worklist").Link("DateFrom")
If .Exist(nMINWAIT) Then
	.Click
End If
End  WIth	
	

End Function
